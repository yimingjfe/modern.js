(self.webpackChunk_modern_js_main_doc=self.webpackChunk_modern_js_main_doc||[]).push([["docs_zh_configure_app_source_transform-import_mdx"],{99654:function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return l}});var s=n("9880"),i=n("23169");function c(e){var r=Object.assign({p:"p",a:"a",code:"code",ul:"ul",li:"li",strong:"strong",pre:"pre",div:"div",h3:"h3",h4:"h4"},(0,i.useMDXComponents)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.p,{children:["用于按需引入组件库的代码和样式，能力等价于 ",(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/babel-plugin-import",target:"_blank",rel:"noopener noreferrer",children:"babel-plugin-import"}),"。"]}),"\n",(0,s.jsxs)(r.p,{children:["它与 ",(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/babel-plugin-import",target:"_blank",rel:"noopener noreferrer",children:"babel-plugin-import"})," 的区别在于，",(0,s.jsx)(r.code,{children:"source.transformImport"})," 不与 Babel 耦合。Builder 会自动识别当前使用的编译工具是 Babel、SWC 还是 Rspack，并添加相应的按需引入配置。"]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.strong,{children:"类型："})}),"\n"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"type Config =\n  | false\n  | Array<{\n      libraryName: string;\n      libraryDirectory?: string;\n      style?: string | boolean;\n      styleLibraryDirectory?: string;\n      camelToDashComponentName?: boolean;\n      transformToDefaultImport?: boolean;\n      customName?: ((member: string) => string | undefined) | string;\n      customStyleName?: ((member: string) => string | undefined) | string;\n    }>;\n"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.strong,{children:"默认值："})}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:["当项目中安装了 ",(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/antd",target:"_blank",rel:"noopener noreferrer",children:"Ant Design 组件库"})," <= 4.x 版本时，Builder 会自动添加以下默认配置："]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-js",children:"const defaultAntdConfig = {\n  libraryName: 'antd',\n  libraryDirectory: isServer ? 'lib' : 'es',\n  style: true,\n};\n"})}),"\n",(0,s.jsxs)(r.p,{children:["当项目中安装了 ",(0,s.jsx)(r.a,{href:"https://www.npmjs.com/package/@arco-design/web-react",target:"_blank",rel:"noopener noreferrer",children:"Arco Design 组件库"})," 时，Builder 会自动添加以下默认配置："]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-js",children:"const defaultArcoConfig = [\n  {\n    libraryName: '@arco-design/web-react',\n    libraryDirectory: isServer ? 'lib' : 'es',\n    camelToDashComponentName: false,\n    style: true,\n  },\n  {\n    libraryName: '@arco-design/web-react/icon',\n    libraryDirectory: isServer ? 'react-icon-cjs' : 'react-icon',\n    camelToDashComponentName: false,\n  },\n];\n"})}),"\n",(0,s.jsxs)(r.div,{className:"modern-directive tip",children:[(0,s.jsx)(r.div,{className:"modern-directive-title",children:"TIP"}),(0,s.jsx)(r.div,{className:"modern-directive-content",children:(0,s.jsxs)(r.p,{children:["当你添加了 ",(0,s.jsx)(r.code,{children:"antd"})," 或 ",(0,s.jsx)(r.code,{children:"@arco-design/web-react"})," 相关的配置时，优先级会高于上述默认配置。\n"]})})]}),"\n",(0,s.jsxs)(r.h3,{id:"示例",children:["示例",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#示例",children:"#"})]}),"\n",(0,s.jsx)(r.p,{children:"当使用上述 antd 默认配置："}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-js",children:"export default {\n  source: {\n    transformImport: [\n      {\n        libraryName: 'antd',\n        libraryDirectory: 'es',\n        style: true,\n      },\n    ],\n  },\n};\n"})}),"\n",(0,s.jsx)(r.p,{children:"源代码如下："}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-js",children:"import { Button } from 'antd';\n"})}),"\n",(0,s.jsx)(r.p,{children:"会被转换成："}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-js",children:"import Button from 'antd/es/button';\nimport 'antd/es/button/style';\n"})}),"\n",(0,s.jsxs)(r.h3,{id:"禁用默认配置",children:["禁用默认配置",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#禁用默认配置",children:"#"})]}),"\n",(0,s.jsxs)(r.p,{children:["你可以手动设置 ",(0,s.jsx)(r.code,{children:"transformImport: false"})," 来关掉 transformImport 的默认行为。"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-js",children:"export default {\n  source: {\n    transformImport: false,\n  },\n};\n"})}),"\n",(0,s.jsxs)(r.p,{children:["比如，当你使用了 ",(0,s.jsx)(r.code,{children:"externals"})," 来避免打包 antd 时，由于 ",(0,s.jsx)(r.code,{children:"transformImport"})," 默认会转换 antd 的引用路径，导致匹配的路径发生了变化，因此 externals 无法正确生效，此时你可以设置关闭 ",(0,s.jsx)(r.code,{children:"transformImport"})," 来避免该问题。"]}),"\n",(0,s.jsxs)(r.h3,{id:"配置",children:["配置",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#配置",children:"#"})]}),"\n",(0,s.jsxs)(r.h4,{id:"libraryname",children:["libraryName",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#libraryname",children:"#"})]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"类型："})," ",(0,s.jsx)(r.code,{children:"string"})]}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"用于指定需要按需加载的模块名称。当 Builder 遍历代码时，如果遇到了对应模块的 import 语句，则会对其进行转换。"}),"\n",(0,s.jsxs)(r.h4,{id:"librarydirectory",children:["libraryDirectory",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#librarydirectory",children:"#"})]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"类型："})," ",(0,s.jsx)(r.code,{children:"string"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"默认值："})," ",(0,s.jsx)(r.code,{children:"'lib'"})]}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:["用于拼接转换后的路径，拼接规则为 ",(0,s.jsx)(r.code,{children:"${libraryName}/${libraryDirectory}/${member}"}),"，其中 member 为引入成员。"]}),"\n",(0,s.jsx)(r.p,{children:"示例："}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"import { Button } from 'foo';\n"})}),"\n",(0,s.jsx)(r.p,{children:"转换结果:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"import Button from 'foo/lib/button';\n"})}),"\n",(0,s.jsxs)(r.h4,{id:"style",children:["style",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#style",children:"#"})]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"类型："})," ",(0,s.jsx)(r.code,{children:"boolean"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"默认值："})," ",(0,s.jsx)(r.code,{children:"undefined"})]}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:["确定是否需要引入相关样式，若为 ",(0,s.jsx)(r.code,{children:"true"}),"，则会引入路径 ",(0,s.jsx)(r.code,{children:"${libraryName}/${libraryDirectory}/${member}/style"}),"。\n若为 ",(0,s.jsx)(r.code,{children:"false"})," 或 ",(0,s.jsx)(r.code,{children:"undefined"})," 则不会引入样式。"]}),"\n",(0,s.jsxs)(r.p,{children:["当配置为 ",(0,s.jsx)(r.code,{children:"true"})," 时："]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"import { Button } from 'foo';\n"})}),"\n",(0,s.jsx)(r.p,{children:"转换结果:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"import Button from 'foo/lib/button';\nimport 'foo/lib/button/style';\n"})}),"\n",(0,s.jsxs)(r.h4,{id:"stylelibrarydirectory",children:["styleLibraryDirectory",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#stylelibrarydirectory",children:"#"})]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"类型："})," ",(0,s.jsx)(r.code,{children:"string"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"默认值："})," ",(0,s.jsx)(r.code,{children:"undefined"})]}),"\n"]}),"\n",(0,s.jsxs)(r.p,{children:["该配置用于拼接引入样式时的引入路径，若该配置被指定，则 ",(0,s.jsx)(r.code,{children:"style"})," 配置项会被忽略。拼接引入路径为 ",(0,s.jsx)(r.code,{children:"${libraryName}/${styleLibraryDirectory}/${member}"}),"。"]}),"\n",(0,s.jsxs)(r.p,{children:["当配置为 ",(0,s.jsx)(r.code,{children:"styles"})," 时："]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"import { Button } from 'foo';\n"})}),"\n",(0,s.jsx)(r.p,{children:"转换结果:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"import Button from 'foo/lib/button';\nimport 'foo/styles/button';\n"})}),"\n",(0,s.jsxs)(r.h4,{id:"cameltodashcomponentname",children:["camelToDashComponentName",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#cameltodashcomponentname",children:"#"})]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"类型："})," ",(0,s.jsx)(r.code,{children:"boolean"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"默认值："})," ",(0,s.jsx)(r.code,{children:"true"})]}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"是否需要将 camelCase 的引入转换成 kebab-case。"}),"\n",(0,s.jsx)(r.p,{children:"示例："}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"import { ButtonGroup } from 'foo';\n"})}),"\n",(0,s.jsx)(r.p,{children:"转换结果："}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"// 设置成 true：\nimport ButtonGroup from 'foo/button-group';\n// 设置成 false：\nimport ButtonGroup from 'foo/ButtonGroup';\n"})}),"\n",(0,s.jsxs)(r.h4,{id:"transformtodefaultimport",children:["transformToDefaultImport",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#transformtodefaultimport",children:"#"})]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"类型："})," ",(0,s.jsx)(r.code,{children:"boolean"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"默认值："})," ",(0,s.jsx)(r.code,{children:"true"})]}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"是否将导入语句转换成默认导入。"}),"\n",(0,s.jsx)(r.p,{children:"示例："}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"import { Button } from 'foo';\n"})}),"\n",(0,s.jsx)(r.p,{children:"转换结果："}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"// 设置成 true：\nimport Button from 'foo/button';\n// 设置成 false：\nimport { Button } from 'foo/button';\n"})}),"\n",(0,s.jsxs)(r.h4,{id:"customname",children:["customName",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#customname",children:"#"})]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"类型："})," ",(0,s.jsx)(r.code,{children:"((member: string) => string | undefined) | string"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"默认值："})," ",(0,s.jsx)(r.code,{children:"undefined"})]}),"\n"]}),"\n",(0,s.jsxs)(r.div,{className:"modern-directive tip",children:[(0,s.jsx)(r.div,{className:"modern-directive-title",children:"注意"}),(0,s.jsxs)(r.div,{className:"modern-directive-content",children:["\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"函数类型的配置只能在 Webpack 构建中使用。"}),"\n",(0,s.jsx)(r.li,{children:"模版类型的配置只能在 Rspack 构建或者使用了 SWC 的 Webpack 构建中使用。"}),"\n"]}),"\n"]})]}),"\n",(0,s.jsxs)(r.p,{children:["自定义转换后的导入路径，输入是引入的成员，例如配置成 ",(0,s.jsx)(r.code,{children:" (member) => `my-lib/${member}` "}),"，会将 ",(0,s.jsx)(r.code,{children:"import { foo } from 'bar'"})," 转换成 ",(0,s.jsx)(r.code,{children:"import foo from 'my-lib/foo'"}),"。"]}),"\n",(0,s.jsxs)(r.p,{children:["在使用 Rspack 构建时，不能使用函数配置，但可以使用 ",(0,s.jsx)(r.a,{href:"https://handlebarsjs.com/",target:"_blank",rel:"noopener noreferrer",children:"handlebars"})," 模版字符串，对于上面的函数配置，在使用模版字符串时可以用以下模版代替 ",(0,s.jsx)(r.code,{children:"my-lib/{{ member }}"}),"，也可以使用一些内置帮助方法，例如 ",(0,s.jsx)(r.code,{children:"my-lib/{{ kebabCase member }}"})," 来转换成 kebab-case 格式，除了 kebabCase 以外还有 camelCase，snakeCase，upperCase，lowerCase 可以使用。"]}),"\n",(0,s.jsxs)(r.h4,{id:"customstylename",children:["customStyleName",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#customstylename",children:"#"})]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"类型："})," ",(0,s.jsx)(r.code,{children:"((member: string) => string | undefined) | string"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"默认值："})," ",(0,s.jsx)(r.code,{children:"undefined"})]}),"\n"]}),"\n",(0,s.jsxs)(r.div,{className:"modern-directive tip",children:[(0,s.jsx)(r.div,{className:"modern-directive-title",children:"注意"}),(0,s.jsxs)(r.div,{className:"modern-directive-content",children:["\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"函数类型的配置只能在 Webpack 构建中使用。"}),"\n",(0,s.jsx)(r.li,{children:"模版类型的配置只能在 Rspack 构建或者使用了 SWC 的 Webpack 构建中使用。"}),"\n"]}),"\n"]})]}),"\n",(0,s.jsxs)(r.p,{children:["自定义转换后的样式导入路径，输入是引入的成员，例如配置成 ",(0,s.jsx)(r.code,{children:" (member) => `my-lib/${member}` "}),"，会将 ",(0,s.jsx)(r.code,{children:"import { foo } from 'bar'"})," 转换成 ",(0,s.jsx)(r.code,{children:"import foo from 'my-lib/foo'"}),"。"]}),"\n",(0,s.jsxs)(r.p,{children:["在使用 Rspack 构建时，不能使用函数配置，但可以使用 ",(0,s.jsx)(r.a,{href:"https://handlebarsjs.com/",target:"_blank",rel:"noopener noreferrer",children:"handlebars"})," 模版字符串，对于上面的函数配置，在使用模版字符串时可以用以下模版代替 ",(0,s.jsx)(r.code,{children:"my-lib/{{ member }}"}),"，也可以使用一些内置帮助方法，例如 ",(0,s.jsx)(r.code,{children:"my-lib/{{ kebabCase member }}"})," 来转换成 kebab-case 格式，除了 kebabCase 以外还有 camelCase，snakeCase，upperCase，lowerCase 可以使用。"]})]})}var l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=Object.assign({},(0,i.useMDXComponents)(),e.components).wrapper;return r?(0,s.jsx)(r,Object.assign({},e,{children:(0,s.jsx)(c,e)})):c(e)}},64226:function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});!function(e,r){for(var n in r)Object.defineProperty(e,n,{enumerable:!0,get:r[n]})}(r,{frontmatter:function(){return l},title:function(){return d},toc:function(){return a},default:function(){return t}});var s=n("9880"),i=n("23169"),c=n.ir(n("99654")),l={sidebar_label:"transformImport"},d="source.transformImport",a=[];function o(e){var r=Object.assign({h1:"h1",a:"a",div:"div",p:"p"},(0,i.useMDXComponents)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.h1,{id:"sourcetransformimport",children:["source.transformImport",(0,s.jsx)(r.a,{className:"header-anchor","aria-hidden":"true",href:"#sourcetransformimport",children:"#"})]}),"\n",(0,s.jsxs)(r.div,{className:"modern-directive tip",children:[(0,s.jsx)(r.div,{className:"modern-directive-title",children:"TIP"}),(0,s.jsx)(r.div,{className:"modern-directive-content",children:(0,s.jsxs)(r.p,{children:["该配置由 Modern.js Builder 提供，更多信息可参考 ",(0,s.jsx)(r.a,{href:"https://modernjs.dev/builder/api/config-source.html#sourcetransformimport",target:"_blank",rel:"noopener noreferrer",children:"source.transformImport"}),"。\n"]})})]}),"\n","\n",(0,s.jsx)(c.default,{})]})}var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=Object.assign({},(0,i.useMDXComponents)(),e.components).wrapper;return r?(0,s.jsx)(r,Object.assign({},e,{children:(0,s.jsx)(o,e)})):o(e)}}}]);