"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9933],{44993:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>m});var r=n(52983);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=p(n),m=a,f=u["".concat(s,".").concat(m)]||u[m]||c[m]||o;return n?r.createElement(f,i(i({ref:t},d),{},{components:n})):r.createElement(f,i({ref:t},d))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var p=2;p<o;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},97355:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var r=n(18249),a=(n(52983),n(44993));const o={title:"Add Loader"},i=void 0,l={unversionedId:"tutorials/first-app/c05-loader",id:"tutorials/first-app/c05-loader",title:"Add Loader",description:"In the previous chapter, we learned how to add client route.",source:"@site/../../packages/toolkit/main-doc/en/docusaurus-plugin-content-docs/current/tutorials/first-app/c05-loader.md",sourceDirName:"tutorials/first-app",slug:"/tutorials/first-app/c05-loader",permalink:"/v2/en/docs/tutorials/first-app/c05-loader",draft:!1,tags:[],version:"current",frontMatter:{title:"Add Loader"},sidebar:"tutorialsSidebar",previous:{title:"Add Client Route",permalink:"/v2/en/docs/tutorials/first-app/c04-routes"},next:{title:"Add Model",permalink:"/v2/en/docs/tutorials/first-app/c06-model"}},s={},p=[],d={toc:p};function c(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"In the previous chapter, we learned how to add client route."),(0,a.kt)("p",null,"In this chapter, we will learn how to add ",(0,a.kt)("strong",{parentName:"p"},"Loader")," to the routing component."),(0,a.kt)("p",null,"By far, we have provided data to components through hardcoding. If you want to get data from the remote, you usually use ",(0,a.kt)("inlineCode",{parentName:"p"},"useEffect")," to do it. But when SSR is enabled, ",(0,a.kt)("inlineCode",{parentName:"p"},"useEffect")," will not be executed at the server level, so this SSR can only render a very limited UI."),(0,a.kt)("p",null,"Modern.js provides the ability of Data Loader to support homogeneous data acquisition in components to maximize the value of SSR."),(0,a.kt)("p",null,"Below we demonstrate how to add Data Loader to the routing component and simulate remote data acquisition. We use faker to mock the required data, first install dependency:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"pnpm add faker@5\npnpm add @types/faker@5 -D\n")),(0,a.kt)("p",null,"Modify ",(0,a.kt)("inlineCode",{parentName:"p"},"src/routes/page.tsx"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx"},"import { name, internet } from 'faker';\n\ntype LoaderData = {\n  code: number;\n  data: {\n    name: string;\n    avatar: string;\n    email: string;\n  }[];\n};\n\nexport const loader = async (): Promise<LoaderData> => {\n  const data = new Array(20).fill(0).map(() => {\n    const firstName = name.firstName();\n    return {\n      name: firstName,\n      avatar: `https://avatars.dicebear.com/api/identicon/${firstName}.svg`,\n      email: internet.email(),\n    };\n  });\n\n  return {\n    code: 200,\n    data,\n  };\n};\n")),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"Data Loader doesn't just work for SSR. In CSR projects, Data Loader can also avoid data acquisition dependency UI rendering, which solves the problem of requesting dynamic grid layout. In the future, Modern.js will also add more capabilities to this feature, such as pre-fetching, data caching, etc.")),(0,a.kt)("p",null,"Modern.js also provides a hooks API called ",(0,a.kt)("inlineCode",{parentName:"p"},"useLoaderData"),", we modify the exported component of ",(0,a.kt)("inlineCode",{parentName:"p"},"src/routes/page.tsx"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx",metastring:"{1,4,13}","{1,4,13}":!0},"import { useLoaderData } from '@modern-js/runtime/router';\n\nfunction Index() {\n  const { data } = useLoaderData() as LoaderData;\n\n  return (\n    <div className=\"container lg mx-auto\">\n      <Helmet>\n        <title>All</title>\n      </Helmet>\n      <List\n        dataSource={data}\n        renderItem={info => <Item key={info.name} info={info} />}\n      />\n    </div>\n  );\n}\n\nexport default Index;\n")),(0,a.kt)("p",null,"Re-execute ",(0,a.kt)("inlineCode",{parentName:"p"},"pnpm run dev"),", view ",(0,a.kt)("inlineCode",{parentName:"p"},"view-source: http://localhost:8080/"),', or view the "Preview" of the HTML request in the Network panel of devtools, you can see that the HTML rendered by SSR already contains the complete UI:'),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://lf3-static.bytednsdoc.com/obj/eden-cn/aphqeh7uhohpquloj/modern-js/docs/11/display6.png",alt:"display6"})))}c.isMDXComponent=!0}}]);