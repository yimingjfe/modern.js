"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2815],{44993:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var r=n(52983);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=u(n),m=o,g=c["".concat(s,".").concat(m)]||c[m]||d[m]||a;return n?r.createElement(g,i(i({ref:t},p),{},{components:n})):r.createElement(g,i({ref:t},p))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var u=2;u<a;u++)i[u]=n[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},99657:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>l,toc:()=>u});var r=n(18249),o=(n(52983),n(44993));const a={title:"Static Site Generation",sidebar_position:4},i=void 0,l={unversionedId:"guides/advanced-features/ssg",id:"guides/advanced-features/ssg",title:"Static Site Generation",description:"Static Site Generation is a solution for rendering complete static web pages at build time based on data and templates.",source:"@site/../../packages/toolkit/main-doc/en/docusaurus-plugin-content-docs/current/guides/advanced-features/ssg.md",sourceDirName:"guides/advanced-features",slug:"/guides/advanced-features/ssg",permalink:"/v2/en/docs/guides/advanced-features/ssg",draft:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{title:"Static Site Generation",sidebar_position:4},sidebar:"guidesSidebar",previous:{title:"Server-side rendering",permalink:"/v2/en/docs/guides/advanced-features/ssr"},next:{title:"Compatibility",permalink:"/v2/en/docs/guides/advanced-features/compatibility"}},s={},u=[{value:"Conventional Routing",id:"conventional-routing",level:3},{value:"Self-controlled Routing",id:"self-controlled-routing",level:3}],p={toc:u};function d(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Static Site Generation is a solution for rendering complete static web pages at build time based on data and templates."),(0,o.kt)("p",null,"First need to execute ",(0,o.kt)("inlineCode",{parentName:"p"},"pnpm run new")," to enable the SSG features:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"? \u8bf7\u9009\u62e9\u4f60\u60f3\u8981\u7684\u64cd\u4f5c \u542f\u7528\u53ef\u9009\u529f\u80fd\n? \u542f\u7528\u53ef\u9009\u529f\u80fd \u542f\u7528\u300cSSG\u300d\u529f\u80fd\n")),(0,o.kt)("p",null,"After execute script\uff0cregister SSG plugin in ",(0,o.kt)("inlineCode",{parentName:"p"},"modern.config.ts"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="modern.config.ts"',title:'"modern.config.ts"'},"import ssgPlugin from '@modern-js/plugin-ssg';\n\n// https://modernjs.dev/docs/apis/app/config\nexport default defineConfig({\n  output: {\n    ssg: true,\n  },\n  plugins: [..., ssgPlugin()],\n});\n")),(0,o.kt)("p",null,"SSG in ",(0,o.kt)("strong",{parentName:"p"},"Conventional Routing")," and ",(0,o.kt)("strong",{parentName:"p"},"Self-controlled Routing")," has different usage."),(0,o.kt)("h3",{id:"conventional-routing"},"Conventional Routing"),(0,o.kt)("p",null,"Modern.js generate routes based on the file structure under the entry, so the framework can collect complete routing information."),(0,o.kt)("p",null,"For example, the following is a project directory structure using conventional routing:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},".\n\u251c\u2500\u2500 src\n\u2502\xa0\xa0 \u2514\u2500\u2500 routes\n\u2502\xa0\xa0     \u251c\u2500\u2500 layout.tsx\n\u2502\xa0\xa0     \u251c\u2500\u2500 page.tsx\n\u2502\xa0\xa0     \u2514\u2500\u2500 user\n\u2502\xa0\xa0         \u251c\u2500\u2500 layout.tsx\n\u2502\xa0\xa0         \u251c\u2500\u2500 page.tsx\n\u2502\xa0\xa0         \u2514\u2500\u2500 profile\n\u2502\xa0\xa0             \u2514\u2500\u2500 page.tsx\n")),(0,o.kt)("p",null,"The above file directory will generate the following three routes:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"/")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"/user")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"/user/profile"))),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"If you don't know the rules for routing, you can first check ",(0,o.kt)("a",{parentName:"p",href:"/docs/guides/basic-features/routes"},"routes"),".")),(0,o.kt)("p",null,"add component to ",(0,o.kt)("inlineCode",{parentName:"p"},"src/routes/page.tsx"),"\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="src/routes/page.tsx"',title:'"src/routes/page.tsx"'},"export default () => {\n  return <div>Index Page</div>;\n};\n")),(0,o.kt)("p",null,"SSG is also render in Node.js. So we can enable SSR in developmenet env, expose code problems in advance and verify SSG rendering effect\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="modern.config.ts"',title:'"modern.config.ts"'},"export default defineConfig({\n  server: {\n    ssr: process.env.NODE_ENV === 'development',\n  }\n}\n")),(0,o.kt)("p",null,"Execute the ",(0,o.kt)("inlineCode",{parentName:"p"},"pnpm run dev")," command in the project to view the ",(0,o.kt)("inlineCode",{parentName:"p"},"dist/")," directory, and only generate an HTML file ",(0,o.kt)("inlineCode",{parentName:"p"},"main/index.html"),"."),(0,o.kt)("p",null,"Execute the ",(0,o.kt)("inlineCode",{parentName:"p"},"pnpm run build")," command in the root path of the project. After the construction is completed, view the ",(0,o.kt)("inlineCode",{parentName:"p"},"dist/")," directory, and generate ",(0,o.kt)("inlineCode",{parentName:"p"},"main/index.html"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"main/user/index.html")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"main/user/profile/index.html")," three HTML files, the content corresponds to the above three routes."),(0,o.kt)("p",null,"Using ",(0,o.kt)("strong",{parentName:"p"},"Conventional Routing"),", each route will generate a HTML file. Looking at the ",(0,o.kt)("inlineCode",{parentName:"p"},"main/index.html"),", we can find the text content containing the ",(0,o.kt)("inlineCode",{parentName:"p"},"Index Page"),", which is exactly the effect of SSG."),(0,o.kt)("p",null,"After executing ",(0,o.kt)("inlineCode",{parentName:"p"},"pnpm run serve")," to start the project, visit the page in the Network, view the document returned by the request. The document contains the complete page content rendered by the component."),(0,o.kt)("h3",{id:"self-controlled-routing"},"Self-controlled Routing"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Self-controlled routing")," is a custom routing through component code, which requires the application to run to obtain accurate routing information. Therefore, the SSG function cannot be used out of the box. At this time, the user needs to inform the Modern.js framework in advance which routes need to enable the SSG."),(0,o.kt)("p",null,"For example, there is the following code, which contains multiple routes. When setting ",(0,o.kt)("inlineCode",{parentName:"p"},"output.ssg")," to ",(0,o.kt)("inlineCode",{parentName:"p"},"true"),", only the entry route '/' will be rendered by default:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'title="src/App.tsx"',title:'"src/App.tsx"'},"import { useRuntimeContext } from '@modern-js/runtime';\nimport { Routes, Route, BrowserRouter } from '@modern-js/runtime/router';\nimport { StaticRouter } from '@modern-js/runtime/router/server';\n\nconst Router = typeof window === 'undefined' ? StaticRouter : BrowserRouter;\n\nexport default () => {\n  const { context } = useRuntimeContext();\n  return (\n    <Router location={context.request.pathname}>\n      <Routes>\n        <Route index element={<div>index</div>} />\n        <Route path=\"about\" element={<div>about</div>} />\n      </Routes>\n    </Router>\n  );\n};\n")),(0,o.kt)("p",null,"If we want to enable the SSG of ",(0,o.kt)("inlineCode",{parentName:"p"},"/about")," at the same time, we can configure the ",(0,o.kt)("inlineCode",{parentName:"p"},"output.ssg")," to tell Modern.js to enable the SSG of the specified route."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="modern.config.ts"',title:'"modern.config.ts"'},"export default defineConfig({\n  output: {\n    ssg: {\n      routes: ['/', '/about'],\n    },\n  },\n});\n")),(0,o.kt)("p",null,"run ",(0,o.kt)("inlineCode",{parentName:"p"},"pnpm run build")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"pnpm run serve"),"\uff0caccess ",(0,o.kt)("inlineCode",{parentName:"p"},"http://localhost:8080/about"),". In the Preview view, you can see that the page has been rendered\u3002"),(0,o.kt)("p",null,"Looking at the bundle file, a new ",(0,o.kt)("inlineCode",{parentName:"p"},"main/about/index.html")," file has been added in the ",(0,o.kt)("inlineCode",{parentName:"p"},"dist/")," directory."),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"The above only introduces the single entry, more related content can be viewed ",(0,o.kt)("a",{parentName:"p",href:"/docs/configure/app/output/ssg"},"SSG API"),"\u3002")))}d.isMDXComponent=!0}}]);