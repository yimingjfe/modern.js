"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9948],{44993:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>m});var a=t(52983);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function r(e,n){if(null==e)return{};var t,a,l=function(e,n){if(null==e)return{};var t,a,l={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var s=a.createContext({}),p=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},u=function(e){var n=p(e.components);return a.createElement(s.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},c=a.forwardRef((function(e,n){var t=e.components,l=e.mdxType,o=e.originalType,s=e.parentName,u=r(e,["components","mdxType","originalType","parentName"]),c=p(t),m=l,b=c["".concat(s,".").concat(m)]||c[m]||d[m]||o;return t?a.createElement(b,i(i({ref:n},u),{},{components:t})):a.createElement(b,i({ref:n},u))}));function m(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var o=t.length,i=new Array(o);i[0]=c;var r={};for(var s in n)hasOwnProperty.call(n,s)&&(r[s]=n[s]);r.originalType=e,r.mdxType="string"==typeof e?e:l,i[1]=r;for(var p=2;p<o;p++)i[p]=t[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}c.displayName="MDXCreateElement"},30662:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>s,default:()=>m,frontMatter:()=>r,metadata:()=>p,toc:()=>d});var a=t(18249),l=(t(52983),t(44993));const o={toc:[{value:"Function Type",id:"function-type",level:3},{value:"Object Type",id:"object-type",level:3},{value:"Util Functions",id:"util-functions",level:3},{value:"addPlugins",id:"addplugins",level:4},{value:"addPresets",id:"addpresets",level:4},{value:"removePlugins",id:"removeplugins",level:4},{value:"removePresets",id:"removepresets",level:4},{value:"addIncludes",id:"addincludes",level:4},{value:"addExcludes",id:"addexcludes",level:4},{value:"modifyPresetEnvOptions",id:"modifypresetenvoptions",level:4},{value:"modifyPresetReactOptions",id:"modifypresetreactoptions",level:4}]};function i(e){let{components:n,...t}=e;return(0,l.kt)("wrapper",(0,a.Z)({},o,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Type: ",(0,l.kt)("inlineCode",{parentName:"li"},"Object | Function")),(0,l.kt)("li",{parentName:"ul"},"Default: ",(0,l.kt)("inlineCode",{parentName:"li"},"undefined"))),(0,l.kt)("p",null,"By ",(0,l.kt)("inlineCode",{parentName:"p"},"tools.babel")," you can modify the options of ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/babel/babel-loader"},"babel-loader"),"."),(0,l.kt)("h3",{id:"function-type"},"Function Type"),(0,l.kt)("p",null,"When ",(0,l.kt)("inlineCode",{parentName:"p"},"tools.babel"),"'s type is Function\uff0cthe default babel config will be passed in as the first parameter, the config object can be modified directly, or a value can be returned as the final result. The second parameter provides some util functions that can be called directly:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"export default {\n  tools: {\n    babel(config) {\n      // Add a babel plugin\n      // note: the plugin have been added to the default config to support antd load on demand\n      config.plugins.push([\n        'babel-plugin-import',\n        {\n          libraryName: 'xxx-components',\n          libraryDirectory: 'es',\n          style: true,\n        },\n      ]);\n    },\n  },\n};\n")),(0,l.kt)("h3",{id:"object-type"},"Object Type"),(0,l.kt)("p",null,"When ",(0,l.kt)("inlineCode",{parentName:"p"},"tools.babel"),"'s type is ",(0,l.kt)("inlineCode",{parentName:"p"},"Object"),", the config will be merged with default config by ",(0,l.kt)("inlineCode",{parentName:"p"},"Object.assign"),". Note that ",(0,l.kt)("inlineCode",{parentName:"p"},"Object.assign")," is a shallow copy and will completely overwrite the built-in ",(0,l.kt)("inlineCode",{parentName:"p"},"presets")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"plugins")," array, please use it with caution."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"export default {\n  tools: {\n    babel: {\n      plugins: [\n        [\n          'babel-plugin-import',\n          {\n            libraryName: 'xxx-components',\n            libraryDirectory: 'es',\n            style: true,\n          },\n        ],\n      ],\n    },\n  },\n};\n")),(0,l.kt)("h3",{id:"util-functions"},"Util Functions"),(0,l.kt)("p",null,"When ",(0,l.kt)("inlineCode",{parentName:"p"},"tools.babel")," is a Function, the tool functions available for the second parameter are as follows:"),(0,l.kt)("h4",{id:"addplugins"},"addPlugins"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Type: ",(0,l.kt)("inlineCode",{parentName:"li"},"(plugins: BabelPlugin[]) => void"))),(0,l.kt)("p",null,"Add some Babel plugins. For example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"export default {\n  tools: {\n    babel(config, { addPlugins }) {\n      addPlugins([\n        [\n          'babel-plugin-import',\n          {\n            libraryName: 'xxx-components',\n            libraryDirectory: 'es',\n            style: true,\n          },\n        ],\n      ]);\n    },\n  },\n};\n")),(0,l.kt)("h4",{id:"addpresets"},"addPresets"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Type: ",(0,l.kt)("inlineCode",{parentName:"li"},"(presets: BabelPlugin[]) => void"))),(0,l.kt)("p",null,"Add Babel preset configuration. (No need to add presets in most cases)"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"export default {\n  tools: {\n    babel(config, { addPresets }) {\n      addPresets(['@babel/preset-env']);\n    },\n  },\n};\n")),(0,l.kt)("h4",{id:"removeplugins"},"removePlugins"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Type: ",(0,l.kt)("inlineCode",{parentName:"li"},"(plugins: string | string[]) => void"))),(0,l.kt)("p",null,"To remove the Babel plugin, just pass in the name of the plugin to be removed, you can pass in a single string or an array of strings."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"export default {\n  tools: {\n    babel(config, { removePlugins }) {\n      removePlugins('babel-plugin-import');\n    },\n  },\n};\n")),(0,l.kt)("h4",{id:"removepresets"},"removePresets"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Type: ",(0,l.kt)("inlineCode",{parentName:"li"},"(presets: string | string[]) => void"))),(0,l.kt)("p",null,"To remove the Babel preset configuration, pass in the name of the preset to be removed, you can pass in a single string or an array of strings."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"export default {\n  tools: {\n    babel(config, { removePresets }) {\n      removePresets('@babel/preset-env');\n    },\n  },\n};\n")),(0,l.kt)("h4",{id:"addincludes"},"addIncludes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Type: ",(0,l.kt)("inlineCode",{parentName:"li"},"(includes: string | RegExp | (string | RegExp)[]) => void"))),(0,l.kt)("p",null,"By default, Babel will only compile the application code in the src directory. With ",(0,l.kt)("inlineCode",{parentName:"p"},"addIncludes")," you can specify that Babel compile some files in node_modules. For example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"export default {\n  tools: {\n    babel(config, { addIncludes }) {\n      addIncludes('node_modules/xxx-components');\n    },\n  },\n};\n")),(0,l.kt)("p",null,"Note that Babel cannot compile CommonJS modules by default. When you use ",(0,l.kt)("inlineCode",{parentName:"p"},"source.include")," to compile CommonJS modules, you need to set Babel's ",(0,l.kt)("inlineCode",{parentName:"p"},"sourceType")," config to ",(0,l.kt)("inlineCode",{parentName:"p"},"unambiguous"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ts"},"export default {\n  tools: {\n    babel(config) {\n      config.sourceType = 'unambiguous';\n    },\n  },\n};\n")),(0,l.kt)("p",null,"Setting ",(0,l.kt)("inlineCode",{parentName:"p"},"sourceType")," to ",(0,l.kt)("inlineCode",{parentName:"p"},"unambiguous")," may have some other effects, please refer to ",(0,l.kt)("a",{parentName:"p",href:"https://babeljs.io/docs/en/options#sourcetype"},"Babel official documentation"),"."),(0,l.kt)("admonition",{type:"tip"},(0,l.kt)("p",{parentName:"admonition"},"Builder provides a more general ",(0,l.kt)("a",{parentName:"p",href:"https://modernjs.dev/builder/en/api/config-source.html#source-include"},"source.include")," config than ",(0,l.kt)("inlineCode",{parentName:"p"},"addIncludes"),", and it is recommended to use this configuration item first.")),(0,l.kt)("h4",{id:"addexcludes"},"addExcludes"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Type: ",(0,l.kt)("inlineCode",{parentName:"li"},"(excludes: string | RegExp | (string | RegExp)[]) => void"))),(0,l.kt)("p",null,"Contrary to ",(0,l.kt)("inlineCode",{parentName:"p"},"addIncludes"),", specifies that certain files are excluded from Babel's compilation."),(0,l.kt)("p",null,"For example, without compiling files in the ",(0,l.kt)("inlineCode",{parentName:"p"},"src/example")," directory:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"export default {\n  tools: {\n    babel(config, { addExcludes }) {\n      addExcludes('src/example');\n    },\n  },\n};\n")),(0,l.kt)("h4",{id:"modifypresetenvoptions"},"modifyPresetEnvOptions"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Type: ",(0,l.kt)("inlineCode",{parentName:"li"},"(options: PresetEnvOptions) => void"))),(0,l.kt)("p",null,"Modify the configuration of ",(0,l.kt)("a",{parentName:"p",href:"https://babeljs.io/docs/en/babel-preset-env"},"@babel/preset-env"),", the configuration you pass in will be shallowly merged with default config. For example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"export default {\n  tools: {\n    babel(config, { modifyPresetEnvOptions }) {\n      modifyPresetEnvOptions({\n        targets: {\n          browsers: ['last 2 versions'],\n        },\n      });\n    },\n  },\n};\n")),(0,l.kt)("h4",{id:"modifypresetreactoptions"},"modifyPresetReactOptions"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Type: ",(0,l.kt)("inlineCode",{parentName:"li"},"(options: PresetReactOptions) => void"))),(0,l.kt)("p",null,"Modify the configuration of ",(0,l.kt)("a",{parentName:"p",href:"https://babeljs.io/docs/en/babel-preset-react"},"@babel/preset-react"),", the configuration you pass in will be shallowly merged with default config. For example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"export default {\n  tools: {\n    babel(config, { modifyPresetReactOptions }) {\n      modifyPresetReactOptions({\n        pragma: 'React.createElement',\n      });\n    },\n  },\n};\n")))}i.isMDXComponent=!0;const r={title:"tools.babel",sidebar_label:"babel"},s=void 0,p={unversionedId:"configure/app/tools/babel",id:"configure/app/tools/babel",title:"tools.babel",description:"This configuration is Modern.js Builder configuration, more detail can see tools.babel\u3002",source:"@site/../../packages/toolkit/main-doc/en/docusaurus-plugin-content-docs/current/configure/app/tools/babel.md",sourceDirName:"configure/app/tools",slug:"/configure/app/tools/babel",permalink:"/v2/en/docs/configure/app/tools/babel",draft:!1,tags:[],version:"current",frontMatter:{title:"tools.babel",sidebar_label:"babel"},sidebar:"configsAppSidebar",previous:{title:"autoprefixer",permalink:"/v2/en/docs/configure/app/tools/autoprefixer"},next:{title:"cssExtract",permalink:"/v2/en/docs/configure/app/tools/css-extract"}},u={},d=[],c={toc:d};function m(e){let{components:n,...t}=e;return(0,l.kt)("wrapper",(0,a.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("admonition",{title:"BUILDER",type:"info"},(0,l.kt)("p",{parentName:"admonition"},"This configuration is Modern.js Builder configuration, more detail can see ",(0,l.kt)("a",{parentName:"p",href:"https://modernjs.dev/builder/zh/api/config-tools.html#tools-babel"},"tools.babel"),"\u3002")),(0,l.kt)(i,{mdxType:"Main"}))}m.isMDXComponent=!0}}]);