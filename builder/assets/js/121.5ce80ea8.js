(window.webpackJsonp=window.webpackJsonp||[]).push([[121],{358:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"node-polyfill-插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#node-polyfill-插件"}},[s._v("#")]),s._v(" Node Polyfill 插件")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("Node Polyfill 介绍")]),s._v(" "),t("p",[s._v("通常情况下，我们不会在浏览器端使用 Node 模块。但在当前代码需要同时在 Node 端和浏览器端运行时，用到一些 Node 模块是有可能的。Node Polyfill 为这些 Node 模块提供了浏览器版本的 polyfills。")])]),s._v(" "),t("p",[s._v("通过使用 Node Polyfill 插件，会自动注入 Node 核心模块在浏览器端的 polyfills，让你可以在浏览器端放心使用这些模块。")]),s._v(" "),t("h2",{attrs:{id:"快速开始"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#快速开始"}},[s._v("#")]),s._v(" 快速开始")]),s._v(" "),t("h3",{attrs:{id:"安装插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装插件"}},[s._v("#")]),s._v(" 安装插件")]),s._v(" "),t("p",[s._v("你可以通过如下的命令安装插件:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# npm")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" @modern-js/builder-plugin-node-polyfill -D\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yarn")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" @modern-js/builder-plugin-node-polyfill -D\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pnpm")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" @modern-js/builder-plugin-node-polyfill -D\n")])])]),t("h3",{attrs:{id:"注册插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#注册插件"}},[s._v("#")]),s._v(" 注册插件")]),s._v(" "),t("p",[s._v("在 Modern.js / EdenX 等上层框架中，你可以通过 "),t("code",[s._v("builderPlugins")]),s._v(" 配置项来注册 node polyfill 插件：")]),s._v(" "),t("div",{staticClass:"language-ts extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ts"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" PluginNodePolyfill "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@modern-js/builder-plugin-node-polyfill'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  builderPlugins"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("PluginNodePolyfill")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("当你直接调用 Builder 的 Node API 时，可以通过 "),t("code",[s._v("addPlugins")]),s._v(" 方法来注册 node polyfill 插件：")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" PluginNodePolyfill "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@modern-js/builder-plugin-node-polyfill'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 往 builder 实例上添加插件")]),s._v("\nbuilder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("addPlugins")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("PluginNodePolyfill")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h2",{attrs:{id:"node-polyfills"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#node-polyfills"}},[s._v("#")]),s._v(" Node Polyfills")]),s._v(" "),t("h3",{attrs:{id:"globals"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#globals"}},[s._v("#")]),s._v(" Globals")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("Buffer")])]),s._v(" "),t("li",[t("code",[s._v("process")])])]),s._v(" "),t("p",[s._v("当直接在代码中使用以上模块时，对应 polyfill 会被注入。")]),s._v(" "),t("div",{staticClass:"language-ts extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ts"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" bufferData "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Buffer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("from")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xxxx'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"modules"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#modules"}},[s._v("#")]),s._v(" Modules")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("assert")])]),s._v(" "),t("li",[t("code",[s._v("buffer")])]),s._v(" "),t("li",[t("code",[s._v("console")])]),s._v(" "),t("li",[t("code",[s._v("constants")])]),s._v(" "),t("li",[t("code",[s._v("crypto")])]),s._v(" "),t("li",[t("code",[s._v("domain")])]),s._v(" "),t("li",[t("code",[s._v("events")])]),s._v(" "),t("li",[t("code",[s._v("http")])]),s._v(" "),t("li",[t("code",[s._v("https")])]),s._v(" "),t("li",[t("code",[s._v("os")])]),s._v(" "),t("li",[t("code",[s._v("path")])]),s._v(" "),t("li",[t("code",[s._v("punycode")])]),s._v(" "),t("li",[t("code",[s._v("process")])]),s._v(" "),t("li",[t("code",[s._v("querystring")])]),s._v(" "),t("li",[t("code",[s._v("stream")])]),s._v(" "),t("li",[t("code",[s._v("_stream_duplex")])]),s._v(" "),t("li",[t("code",[s._v("_stream_passthrough")])]),s._v(" "),t("li",[t("code",[s._v("_stream_readable")])]),s._v(" "),t("li",[t("code",[s._v("_stream_transform")])]),s._v(" "),t("li",[t("code",[s._v("_stream_writable")])]),s._v(" "),t("li",[t("code",[s._v("string_decoder")])]),s._v(" "),t("li",[t("code",[s._v("sys")])]),s._v(" "),t("li",[t("code",[s._v("timers")])]),s._v(" "),t("li",[t("code",[s._v("tty")])]),s._v(" "),t("li",[t("code",[s._v("url")])]),s._v(" "),t("li",[t("code",[s._v("util")])]),s._v(" "),t("li",[t("code",[s._v("vm")])]),s._v(" "),t("li",[t("code",[s._v("zlib")])])]),s._v(" "),t("p",[s._v("当通过 import / require 等语法在代码中引用以上模块时，对应 polyfill 会被注入。")]),s._v(" "),t("div",{staticClass:"language-ts extra-class"},[t("pre",{pre:!0,attrs:{class:"language-ts"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" Buffer "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'buffer'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" bufferData "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Buffer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("from")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xxxx'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])])])}),[],!1,null,null,null);t.default=e.exports}}]);