(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[]]);!function(n){function e(e){for(var o,s,a=e[0],l=e[1],d=e[2],u=0,p=[];u<a.length;u++)s=a[u],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&p.push(i[s][0]),i[s]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(n[o]=l[o]);for(c&&c(e);p.length;)p.shift()();return r.push.apply(r,d||[]),t()}function t(){for(var n,e=0;e<r.length;e++){for(var t=r[e],o=!0,a=1;a<t.length;a++){var l=t[a];0!==i[l]&&(o=!1)}o&&(r.splice(e--,1),n=s(s.s=t[0]))}return n}var o={},i={1:0},r=[];function s(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.e=function(n){var e=[],t=i[n];if(0!==t)if(t)e.push(t[2]);else{var o=new Promise((function(e,o){t=i[n]=[e,o]}));e.push(t[2]=o);var r,a=document.createElement("script");a.charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.src=function(n){return s.p+"assets/js/"+({}[n]||n)+"."+{2:"ab5db946",3:"c43424b5",4:"6f76eaa4",5:"09740a1f",6:"ab8e9722",7:"bacd4157",8:"d0de7c53",9:"aaa07314",10:"62697ae6",11:"8555a632",12:"e643b309",13:"b4c26474",14:"c2bd4dd4",15:"730c690c",16:"0458c6ac",17:"7f1f1c8f",18:"9fe84904",19:"c66bf656",20:"02f301b6",21:"2ea2ec0f",22:"62516ef9",23:"fe2b3f46",24:"0985e1d9",25:"a6a4f8ca",26:"d1b99776",27:"cccdc504",28:"b3bfc8e4",29:"42ddcaf0",30:"811c66dd",31:"c9ca5660",32:"74860284",33:"7a935a5b",34:"0640e9f9",35:"fb139079",36:"a0779a9e",37:"5d4319db",38:"a9c1bb44",39:"a3963474",40:"1e7599c2",41:"8a253edf",42:"7d80b3a3",43:"2ea20f43",44:"7d26027b",45:"dddb0e55",46:"93c3632d",47:"2689adf5",48:"a337defb",49:"b983a91a",50:"4dd7e231",51:"920505f8",52:"b8d1d39e",53:"28081881",54:"fa987aeb",55:"8eeb7e9c",56:"8704de96",57:"0c9c6b04",58:"743c933c",59:"a29e56d8",60:"b68af011",61:"8e6c21da",62:"428546c7",63:"f9366b1c",64:"ba3c9318",65:"8efe543d",66:"0084aa69",67:"ba56b3b2",68:"4d69e73d",69:"bea1a195",70:"172c1a68",71:"fabca4af",72:"4221c757",73:"081776d3",74:"8e4772c9",75:"670f642b",76:"605f3bca",77:"3f21e28b",78:"217e66f8",79:"dea208a6",80:"b14edd3a",81:"51629de0",82:"a8bc170b",83:"dd0a081b",84:"e97e9a20",85:"a8abb061",86:"69948ce7",87:"b36cb60d",88:"5a4ccfa5",89:"c93c120a",90:"a9ab711a",91:"03e5749f",92:"2852a3c2",93:"e49ce204",94:"2ba39f90",95:"f9e00c95",96:"2d77afea",97:"f3f04030",98:"1fd7551f",99:"e0d7b6c4",100:"10194562",101:"6e2e0fef",102:"9940cf81",103:"9e257905",104:"7ccbcbf8",105:"1bb1a05b",106:"e08c4d34",107:"0c64309d",108:"1ab027f2",109:"b3c67a5f",110:"09962cf7",111:"70e372c3",112:"26886542",113:"ce553f8c",114:"52bd122e",115:"22d1c00b",116:"5a562780",117:"93d2673f",118:"be7e4a7f",119:"82609c32",120:"55f6c264",121:"73d9afac",122:"50ab9821",123:"a3384414",124:"e68ca6d1",125:"264142a9",126:"99a22881",127:"0d5ce8f8",128:"2be7cbc9",129:"e8d802a3",130:"ee8bfa3e",131:"e352246a",132:"d73f7f6e",133:"023d72e3",134:"58b84c02",135:"8911d558",136:"935f03b0",137:"99b0ec32",138:"64b1315d",139:"2c0798e5",140:"e57268b4",141:"206ac15e",142:"c708a1eb"}[n]+".js"}(n);var l=new Error;r=function(e){a.onerror=a.onload=null,clearTimeout(d);var t=i[n];if(0!==t){if(t){var o=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;l.message="Loading chunk "+n+" failed.\n("+o+": "+r+")",l.name="ChunkLoadError",l.type=o,l.request=r,t[1](l)}i[n]=void 0}};var d=setTimeout((function(){r({type:"timeout",target:a})}),12e4);a.onerror=a.onload=r,document.head.appendChild(a)}return Promise.all(e)},s.m=n,s.c=o,s.d=function(n,e,t){s.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:t})},s.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},s.t=function(n,e){if(1&e&&(n=s(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var t=Object.create(null);if(s.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var o in n)s.d(t,o,function(e){return n[e]}.bind(null,o));return t},s.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return s.d(e,"a",e),e},s.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},s.p="/builder/",s.oe=function(n){throw console.error(n),n};var a=window.webpackJsonp=window.webpackJsonp||[],l=a.push.bind(a);a.push=e,a=a.slice();for(var d=0;d<a.length;d++)e(a[d]);var c=l;r.push([52,0]),t()}([function(n,e,t){"use strict";t.d(e,"a",(function(){return Gt}));
/*!
 * Vue.js v2.7.13
 * (c) 2014-2022 Evan You
 * Released under the MIT License.
 */
var o=Object.freeze({}),i=Array.isArray;function r(n){return null==n}function s(n){return null!=n}function a(n){return!0===n}function l(n){return"string"==typeof n||"number"==typeof n||"symbol"==typeof n||"boolean"==typeof n}function d(n){return"function"==typeof n}function c(n){return null!==n&&"object"==typeof n}var u=Object.prototype.toString;function p(n){return"[object Object]"===u.call(n)}function m(n){return"[object RegExp]"===u.call(n)}function f(n){var e=parseFloat(String(n));return e>=0&&Math.floor(e)===e&&isFinite(n)}function h(n){return s(n)&&"function"==typeof n.then&&"function"==typeof n.catch}function g(n){return null==n?"":Array.isArray(n)||p(n)&&n.toString===u?JSON.stringify(n,null,2):String(n)}function b(n){var e=parseFloat(n);return isNaN(e)?n:e}function y(n,e){for(var t=Object.create(null),o=n.split(","),i=0;i<o.length;i++)t[o[i]]=!0;return e?function(n){return t[n.toLowerCase()]}:function(n){return t[n]}}y("slot,component",!0);var v=y("key,ref,slot,slot-scope,is");function w(n,e){var t=n.length;if(t){if(e===n[t-1])return void(n.length=t-1);var o=n.indexOf(e);if(o>-1)return n.splice(o,1)}}var x=Object.prototype.hasOwnProperty;function k(n,e){return x.call(n,e)}function S(n){var e=Object.create(null);return function(t){return e[t]||(e[t]=n(t))}}var j=/-(\w)/g,T=S((function(n){return n.replace(j,(function(n,e){return e?e.toUpperCase():""}))})),C=S((function(n){return n.charAt(0).toUpperCase()+n.slice(1)})),z=/\B([A-Z])/g,P=S((function(n){return n.replace(z,"-$1").toLowerCase()}));var I=Function.prototype.bind?function(n,e){return n.bind(e)}:function(n,e){function t(t){var o=arguments.length;return o?o>1?n.apply(e,arguments):n.call(e,t):n.call(e)}return t._length=n.length,t};function B(n,e){e=e||0;for(var t=n.length-e,o=new Array(t);t--;)o[t]=n[t+e];return o}function E(n,e){for(var t in e)n[t]=e[t];return n}function _(n){for(var e={},t=0;t<n.length;t++)n[t]&&E(e,n[t]);return e}function M(n,e,t){}var O=function(n,e,t){return!1},D=function(n){return n};function L(n,e){if(n===e)return!0;var t=c(n),o=c(e);if(!t||!o)return!t&&!o&&String(n)===String(e);try{var i=Array.isArray(n),r=Array.isArray(e);if(i&&r)return n.length===e.length&&n.every((function(n,t){return L(n,e[t])}));if(n instanceof Date&&e instanceof Date)return n.getTime()===e.getTime();if(i||r)return!1;var s=Object.keys(n),a=Object.keys(e);return s.length===a.length&&s.every((function(t){return L(n[t],e[t])}))}catch(n){return!1}}function A(n,e){for(var t=0;t<n.length;t++)if(L(n[t],e))return t;return-1}function R(n){var e=!1;return function(){e||(e=!0,n.apply(this,arguments))}}function N(n,e){return n===e?0===n&&1/n!=1/e:n==n||e==e}var U=["component","directive","filter"],W=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch","renderTracked","renderTriggered"],F={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:O,isReservedAttr:O,isUnknownElement:O,getTagNamespace:M,parsePlatformTagName:D,mustUseProp:O,async:!0,_lifecycleHooks:W},H=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function q(n){var e=(n+"").charCodeAt(0);return 36===e||95===e}function $(n,e,t,o){Object.defineProperty(n,e,{value:t,enumerable:!!o,writable:!0,configurable:!0})}var J=new RegExp("[^".concat(H.source,".$_\\d]"));var G="__proto__"in{},V="undefined"!=typeof window,Y=V&&window.navigator.userAgent.toLowerCase(),K=Y&&/msie|trident/.test(Y),X=Y&&Y.indexOf("msie 9.0")>0,Z=Y&&Y.indexOf("edge/")>0;Y&&Y.indexOf("android");var Q=Y&&/iphone|ipad|ipod|ios/.test(Y);Y&&/chrome\/\d+/.test(Y),Y&&/phantomjs/.test(Y);var nn,en=Y&&Y.match(/firefox\/(\d+)/),tn={}.watch,on=!1;if(V)try{var rn={};Object.defineProperty(rn,"passive",{get:function(){on=!0}}),window.addEventListener("test-passive",null,rn)}catch(n){}var sn=function(){return void 0===nn&&(nn=!V&&"undefined"!=typeof global&&(global.process&&"server"===global.process.env.VUE_ENV)),nn},an=V&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function ln(n){return"function"==typeof n&&/native code/.test(n.toString())}var dn,cn="undefined"!=typeof Symbol&&ln(Symbol)&&"undefined"!=typeof Reflect&&ln(Reflect.ownKeys);dn="undefined"!=typeof Set&&ln(Set)?Set:function(){function n(){this.set=Object.create(null)}return n.prototype.has=function(n){return!0===this.set[n]},n.prototype.add=function(n){this.set[n]=!0},n.prototype.clear=function(){this.set=Object.create(null)},n}();var un=null;function pn(n){void 0===n&&(n=null),n||un&&un._scope.off(),un=n,n&&n._scope.on()}var mn=function(){function n(n,e,t,o,i,r,s,a){this.tag=n,this.data=e,this.children=t,this.text=o,this.elm=i,this.ns=void 0,this.context=r,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=e&&e.key,this.componentOptions=s,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=a,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1}return Object.defineProperty(n.prototype,"child",{get:function(){return this.componentInstance},enumerable:!1,configurable:!0}),n}(),fn=function(n){void 0===n&&(n="");var e=new mn;return e.text=n,e.isComment=!0,e};function hn(n){return new mn(void 0,void 0,void 0,String(n))}function gn(n){var e=new mn(n.tag,n.data,n.children&&n.children.slice(),n.text,n.elm,n.context,n.componentOptions,n.asyncFactory);return e.ns=n.ns,e.isStatic=n.isStatic,e.key=n.key,e.isComment=n.isComment,e.fnContext=n.fnContext,e.fnOptions=n.fnOptions,e.fnScopeId=n.fnScopeId,e.asyncMeta=n.asyncMeta,e.isCloned=!0,e}var bn=0,yn=[],vn=function(){function n(){this._pending=!1,this.id=bn++,this.subs=[]}return n.prototype.addSub=function(n){this.subs.push(n)},n.prototype.removeSub=function(n){this.subs[this.subs.indexOf(n)]=null,this._pending||(this._pending=!0,yn.push(this))},n.prototype.depend=function(e){n.target&&n.target.addDep(this)},n.prototype.notify=function(n){var e=this.subs.filter((function(n){return n}));for(var t=0,o=e.length;t<o;t++){0,e[t].update()}},n}();vn.target=null;var wn=[];function xn(n){wn.push(n),vn.target=n}function kn(){wn.pop(),vn.target=wn[wn.length-1]}var Sn=Array.prototype,jn=Object.create(Sn);["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(n){var e=Sn[n];$(jn,n,(function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var i,r=e.apply(this,t),s=this.__ob__;switch(n){case"push":case"unshift":i=t;break;case"splice":i=t.slice(2)}return i&&s.observeArray(i),s.dep.notify(),r}))}));var Tn=new WeakMap;function Cn(n){return zn(n,!0),$(n,"__v_isShallow",!0),n}function zn(n,e){if(!Pn(n)){Dn(n,e,sn());0}}function Pn(n){return!(!n||!n.__v_isReadonly)}var In=Object.getOwnPropertyNames(jn),Bn={},En=!0;function _n(n){En=n}var Mn={notify:M,depend:M,addSub:M,removeSub:M},On=function(){function n(n,e,t){if(void 0===e&&(e=!1),void 0===t&&(t=!1),this.value=n,this.shallow=e,this.mock=t,this.dep=t?Mn:new vn,this.vmCount=0,$(n,"__ob__",this),i(n)){if(!t)if(G)n.__proto__=jn;else for(var o=0,r=In.length;o<r;o++){$(n,a=In[o],jn[a])}e||this.observeArray(n)}else{var s=Object.keys(n);for(o=0;o<s.length;o++){var a;Ln(n,a=s[o],Bn,void 0,e,t)}}}return n.prototype.observeArray=function(n){for(var e=0,t=n.length;e<t;e++)Dn(n[e],!1,this.mock)},n}();function Dn(n,e,t){return n&&k(n,"__ob__")&&n.__ob__ instanceof On?n.__ob__:!En||!t&&sn()||!i(n)&&!p(n)||!Object.isExtensible(n)||n.__v_skip||Tn.has(n)||Un(n)||n instanceof mn?void 0:new On(n,e,t)}function Ln(n,e,t,o,r,s){var a=new vn,l=Object.getOwnPropertyDescriptor(n,e);if(!l||!1!==l.configurable){var d=l&&l.get,c=l&&l.set;d&&!c||t!==Bn&&2!==arguments.length||(t=n[e]);var u=!r&&Dn(t,!1,s);return Object.defineProperty(n,e,{enumerable:!0,configurable:!0,get:function(){var e=d?d.call(n):t;return vn.target&&(a.depend(),u&&(u.dep.depend(),i(e)&&Nn(e))),Un(e)&&!r?e.value:e},set:function(e){var o=d?d.call(n):t;if(N(o,e)){if(c)c.call(n,e);else{if(d)return;if(!r&&Un(o)&&!Un(e))return void(o.value=e);t=e}u=!r&&Dn(e,!1,s),a.notify()}}}),a}}function An(n,e,t){if(!Pn(n)){var o=n.__ob__;return i(n)&&f(e)?(n.length=Math.max(n.length,e),n.splice(e,1,t),o&&!o.shallow&&o.mock&&Dn(t,!1,!0),t):e in n&&!(e in Object.prototype)?(n[e]=t,t):n._isVue||o&&o.vmCount?t:o?(Ln(o.value,e,t,void 0,o.shallow,o.mock),o.dep.notify(),t):(n[e]=t,t)}}function Rn(n,e){if(i(n)&&f(e))n.splice(e,1);else{var t=n.__ob__;n._isVue||t&&t.vmCount||Pn(n)||k(n,e)&&(delete n[e],t&&t.dep.notify())}}function Nn(n){for(var e=void 0,t=0,o=n.length;t<o;t++)(e=n[t])&&e.__ob__&&e.__ob__.dep.depend(),i(e)&&Nn(e)}function Un(n){return!(!n||!0!==n.__v_isRef)}function Wn(n,e,t){Object.defineProperty(n,t,{enumerable:!0,configurable:!0,get:function(){var n=e[t];if(Un(n))return n.value;var o=n&&n.__ob__;return o&&o.dep.depend(),n},set:function(n){var o=e[t];Un(o)&&!Un(n)?o.value=n:e[t]=n}})}new WeakMap,new WeakMap;"".concat("watcher"," callback"),"".concat("watcher"," getter"),"".concat("watcher"," cleanup");var Fn;var Hn=function(){function n(n){void 0===n&&(n=!1),this.detached=n,this.active=!0,this.effects=[],this.cleanups=[],this.parent=Fn,!n&&Fn&&(this.index=(Fn.scopes||(Fn.scopes=[])).push(this)-1)}return n.prototype.run=function(n){if(this.active){var e=Fn;try{return Fn=this,n()}finally{Fn=e}}else 0},n.prototype.on=function(){Fn=this},n.prototype.off=function(){Fn=this.parent},n.prototype.stop=function(n){if(this.active){var e=void 0,t=void 0;for(e=0,t=this.effects.length;e<t;e++)this.effects[e].teardown();for(e=0,t=this.cleanups.length;e<t;e++)this.cleanups[e]();if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].stop(!0);if(!this.detached&&this.parent&&!n){var o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0,this.active=!1}},n}();function qn(n){var e=n._provided,t=n.$parent&&n.$parent._provided;return t===e?n._provided=Object.create(t):e}var $n=S((function(n){var e="&"===n.charAt(0),t="~"===(n=e?n.slice(1):n).charAt(0),o="!"===(n=t?n.slice(1):n).charAt(0);return{name:n=o?n.slice(1):n,once:t,capture:o,passive:e}}));function Jn(n,e){function t(){var n=t.fns;if(!i(n))return Pe(n,null,arguments,e,"v-on handler");for(var o=n.slice(),r=0;r<o.length;r++)Pe(o[r],null,arguments,e,"v-on handler")}return t.fns=n,t}function Gn(n,e,t,o,i,s){var l,d,c,u;for(l in n)d=n[l],c=e[l],u=$n(l),r(d)||(r(c)?(r(d.fns)&&(d=n[l]=Jn(d,s)),a(u.once)&&(d=n[l]=i(u.name,d,u.capture)),t(u.name,d,u.capture,u.passive,u.params)):d!==c&&(c.fns=d,n[l]=c));for(l in e)r(n[l])&&o((u=$n(l)).name,e[l],u.capture)}function Vn(n,e,t){var o;n instanceof mn&&(n=n.data.hook||(n.data.hook={}));var i=n[e];function l(){t.apply(this,arguments),w(o.fns,l)}r(i)?o=Jn([l]):s(i.fns)&&a(i.merged)?(o=i).fns.push(l):o=Jn([i,l]),o.merged=!0,n[e]=o}function Yn(n,e,t,o,i){if(s(e)){if(k(e,t))return n[t]=e[t],i||delete e[t],!0;if(k(e,o))return n[t]=e[o],i||delete e[o],!0}return!1}function Kn(n){return l(n)?[hn(n)]:i(n)?function n(e,t){var o,d,c,u,p=[];for(o=0;o<e.length;o++)r(d=e[o])||"boolean"==typeof d||(c=p.length-1,u=p[c],i(d)?d.length>0&&(Xn((d=n(d,"".concat(t||"","_").concat(o)))[0])&&Xn(u)&&(p[c]=hn(u.text+d[0].text),d.shift()),p.push.apply(p,d)):l(d)?Xn(u)?p[c]=hn(u.text+d):""!==d&&p.push(hn(d)):Xn(d)&&Xn(u)?p[c]=hn(u.text+d.text):(a(e._isVList)&&s(d.tag)&&r(d.key)&&s(t)&&(d.key="__vlist".concat(t,"_").concat(o,"__")),p.push(d)));return p}(n):void 0}function Xn(n){return s(n)&&s(n.text)&&!1===n.isComment}function Zn(n,e){var t,o,r,a,l=null;if(i(n)||"string"==typeof n)for(l=new Array(n.length),t=0,o=n.length;t<o;t++)l[t]=e(n[t],t);else if("number"==typeof n)for(l=new Array(n),t=0;t<n;t++)l[t]=e(t+1,t);else if(c(n))if(cn&&n[Symbol.iterator]){l=[];for(var d=n[Symbol.iterator](),u=d.next();!u.done;)l.push(e(u.value,l.length)),u=d.next()}else for(r=Object.keys(n),l=new Array(r.length),t=0,o=r.length;t<o;t++)a=r[t],l[t]=e(n[a],a,t);return s(l)||(l=[]),l._isVList=!0,l}function Qn(n,e,t,o){var i,r=this.$scopedSlots[n];r?(t=t||{},o&&(t=E(E({},o),t)),i=r(t)||(d(e)?e():e)):i=this.$slots[n]||(d(e)?e():e);var s=t&&t.slot;return s?this.$createElement("template",{slot:s},i):i}function ne(n){return Et(this.$options,"filters",n,!0)||D}function ee(n,e){return i(n)?-1===n.indexOf(e):n!==e}function te(n,e,t,o,i){var r=F.keyCodes[e]||t;return i&&o&&!F.keyCodes[e]?ee(i,o):r?ee(r,n):o?P(o)!==e:void 0===n}function oe(n,e,t,o,r){if(t)if(c(t)){i(t)&&(t=_(t));var s=void 0,a=function(i){if("class"===i||"style"===i||v(i))s=n;else{var a=n.attrs&&n.attrs.type;s=o||F.mustUseProp(e,a,i)?n.domProps||(n.domProps={}):n.attrs||(n.attrs={})}var l=T(i),d=P(i);l in s||d in s||(s[i]=t[i],r&&((n.on||(n.on={}))["update:".concat(i)]=function(n){t[i]=n}))};for(var l in t)a(l)}else;return n}function ie(n,e){var t=this._staticTrees||(this._staticTrees=[]),o=t[n];return o&&!e||se(o=t[n]=this.$options.staticRenderFns[n].call(this._renderProxy,this._c,this),"__static__".concat(n),!1),o}function re(n,e,t){return se(n,"__once__".concat(e).concat(t?"_".concat(t):""),!0),n}function se(n,e,t){if(i(n))for(var o=0;o<n.length;o++)n[o]&&"string"!=typeof n[o]&&ae(n[o],"".concat(e,"_").concat(o),t);else ae(n,e,t)}function ae(n,e,t){n.isStatic=!0,n.key=e,n.isOnce=t}function le(n,e){if(e)if(p(e)){var t=n.on=n.on?E({},n.on):{};for(var o in e){var i=t[o],r=e[o];t[o]=i?[].concat(i,r):r}}else;return n}function de(n,e,t,o){e=e||{$stable:!t};for(var r=0;r<n.length;r++){var s=n[r];i(s)?de(s,e,t):s&&(s.proxy&&(s.fn.proxy=!0),e[s.key]=s.fn)}return o&&(e.$key=o),e}function ce(n,e){for(var t=0;t<e.length;t+=2){var o=e[t];"string"==typeof o&&o&&(n[e[t]]=e[t+1])}return n}function ue(n,e){return"string"==typeof n?e+n:n}function pe(n){n._o=re,n._n=b,n._s=g,n._l=Zn,n._t=Qn,n._q=L,n._i=A,n._m=ie,n._f=ne,n._k=te,n._b=oe,n._v=hn,n._e=fn,n._u=de,n._g=le,n._d=ce,n._p=ue}function me(n,e){if(!n||!n.length)return{};for(var t={},o=0,i=n.length;o<i;o++){var r=n[o],s=r.data;if(s&&s.attrs&&s.attrs.slot&&delete s.attrs.slot,r.context!==e&&r.fnContext!==e||!s||null==s.slot)(t.default||(t.default=[])).push(r);else{var a=s.slot,l=t[a]||(t[a]=[]);"template"===r.tag?l.push.apply(l,r.children||[]):l.push(r)}}for(var d in t)t[d].every(fe)&&delete t[d];return t}function fe(n){return n.isComment&&!n.asyncFactory||" "===n.text}function he(n){return n.isComment&&n.asyncFactory}function ge(n,e,t,i){var r,s=Object.keys(t).length>0,a=e?!!e.$stable:!s,l=e&&e.$key;if(e){if(e._normalized)return e._normalized;if(a&&i&&i!==o&&l===i.$key&&!s&&!i.$hasNormal)return i;for(var d in r={},e)e[d]&&"$"!==d[0]&&(r[d]=be(n,t,d,e[d]))}else r={};for(var c in t)c in r||(r[c]=ye(t,c));return e&&Object.isExtensible(e)&&(e._normalized=r),$(r,"$stable",a),$(r,"$key",l),$(r,"$hasNormal",s),r}function be(n,e,t,o){var r=function(){var e=un;pn(n);var t=arguments.length?o.apply(null,arguments):o({}),r=(t=t&&"object"==typeof t&&!i(t)?[t]:Kn(t))&&t[0];return pn(e),t&&(!r||1===t.length&&r.isComment&&!he(r))?void 0:t};return o.proxy&&Object.defineProperty(e,t,{get:r,enumerable:!0,configurable:!0}),r}function ye(n,e){return function(){return n[e]}}function ve(n){return{get attrs(){if(!n._attrsProxy){var e=n._attrsProxy={};$(e,"_v_attr_proxy",!0),we(e,n.$attrs,o,n,"$attrs")}return n._attrsProxy},get listeners(){n._listenersProxy||we(n._listenersProxy={},n.$listeners,o,n,"$listeners");return n._listenersProxy},get slots(){return function(n){n._slotsProxy||ke(n._slotsProxy={},n.$scopedSlots);return n._slotsProxy}(n)},emit:I(n.$emit,n),expose:function(e){e&&Object.keys(e).forEach((function(t){return Wn(n,e,t)}))}}}function we(n,e,t,o,i){var r=!1;for(var s in e)s in n?e[s]!==t[s]&&(r=!0):(r=!0,xe(n,s,o,i));for(var s in n)s in e||(r=!0,delete n[s]);return r}function xe(n,e,t,o){Object.defineProperty(n,e,{enumerable:!0,configurable:!0,get:function(){return t[o][e]}})}function ke(n,e){for(var t in e)n[t]=e[t];for(var t in n)t in e||delete n[t]}var Se=null;function je(n,e){return(n.__esModule||cn&&"Module"===n[Symbol.toStringTag])&&(n=n.default),c(n)?e.extend(n):n}function Te(n){if(i(n))for(var e=0;e<n.length;e++){var t=n[e];if(s(t)&&(s(t.componentOptions)||he(t)))return t}}function Ce(n,e,t,o,u,p){return(i(t)||l(t))&&(u=o,o=t,t=void 0),a(p)&&(u=2),function(n,e,t,o,l){if(s(t)&&s(t.__ob__))return fn();s(t)&&s(t.is)&&(e=t.is);if(!e)return fn();0;i(o)&&d(o[0])&&((t=t||{}).scopedSlots={default:o[0]},o.length=0);2===l?o=Kn(o):1===l&&(o=function(n){for(var e=0;e<n.length;e++)if(i(n[e]))return Array.prototype.concat.apply([],n);return n}(o));var u,p;if("string"==typeof e){var m=void 0;p=n.$vnode&&n.$vnode.ns||F.getTagNamespace(e),u=F.isReservedTag(e)?new mn(F.parsePlatformTagName(e),t,o,void 0,void 0,n):t&&t.pre||!s(m=Et(n.$options,"components",e))?new mn(e,t,o,void 0,void 0,n):xt(m,t,n,o,e)}else u=xt(e,t,n,o);return i(u)?u:s(u)?(s(p)&&function n(e,t,o){e.ns=t,"foreignObject"===e.tag&&(t=void 0,o=!0);if(s(e.children))for(var i=0,l=e.children.length;i<l;i++){var d=e.children[i];s(d.tag)&&(r(d.ns)||a(o)&&"svg"!==d.tag)&&n(d,t,o)}}(u,p),s(t)&&function(n){c(n.style)&&He(n.style);c(n.class)&&He(n.class)}(t),u):fn()}(n,e,t,o,u)}function ze(n,e,t){xn();try{if(e)for(var o=e;o=o.$parent;){var i=o.$options.errorCaptured;if(i)for(var r=0;r<i.length;r++)try{if(!1===i[r].call(o,n,e,t))return}catch(n){Ie(n,o,"errorCaptured hook")}}Ie(n,e,t)}finally{kn()}}function Pe(n,e,t,o,i){var r;try{(r=t?n.apply(e,t):n.call(e))&&!r._isVue&&h(r)&&!r._handled&&(r.catch((function(n){return ze(n,o,i+" (Promise/async)")})),r._handled=!0)}catch(n){ze(n,o,i)}return r}function Ie(n,e,t){if(F.errorHandler)try{return F.errorHandler.call(null,n,e,t)}catch(e){e!==n&&Be(e,null,"config.errorHandler")}Be(n,e,t)}function Be(n,e,t){if(!V||"undefined"==typeof console)throw n;console.error(n)}var Ee,_e=!1,Me=[],Oe=!1;function De(){Oe=!1;var n=Me.slice(0);Me.length=0;for(var e=0;e<n.length;e++)n[e]()}if("undefined"!=typeof Promise&&ln(Promise)){var Le=Promise.resolve();Ee=function(){Le.then(De),Q&&setTimeout(M)},_e=!0}else if(K||"undefined"==typeof MutationObserver||!ln(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())Ee="undefined"!=typeof setImmediate&&ln(setImmediate)?function(){setImmediate(De)}:function(){setTimeout(De,0)};else{var Ae=1,Re=new MutationObserver(De),Ne=document.createTextNode(String(Ae));Re.observe(Ne,{characterData:!0}),Ee=function(){Ae=(Ae+1)%2,Ne.data=String(Ae)},_e=!0}function Ue(n,e){var t;if(Me.push((function(){if(n)try{n.call(e)}catch(n){ze(n,e,"nextTick")}else t&&t(e)})),Oe||(Oe=!0,Ee()),!n&&"undefined"!=typeof Promise)return new Promise((function(n){t=n}))}function We(n){return function(e,t){if(void 0===t&&(t=un),t)return function(n,e,t){var o=n.$options;o[e]=zt(o[e],t)}(t,n,e)}}We("beforeMount"),We("mounted"),We("beforeUpdate"),We("updated"),We("beforeDestroy"),We("destroyed"),We("activated"),We("deactivated"),We("serverPrefetch"),We("renderTracked"),We("renderTriggered"),We("errorCaptured");var Fe=new dn;function He(n){return function n(e,t){var o,r,s=i(e);if(!s&&!c(e)||e.__v_skip||Object.isFrozen(e)||e instanceof mn)return;if(e.__ob__){var a=e.__ob__.dep.id;if(t.has(a))return;t.add(a)}if(s)for(o=e.length;o--;)n(e[o],t);else if(Un(e))n(e.value,t);else for(r=Object.keys(e),o=r.length;o--;)n(e[r[o]],t)}(n,Fe),Fe.clear(),n}var qe,$e=0,Je=function(){function n(n,e,t,o,i){var r,s;r=this,void 0===(s=Fn&&!Fn._vm?Fn:n?n._scope:void 0)&&(s=Fn),s&&s.active&&s.effects.push(r),(this.vm=n)&&i&&(n._watcher=this),o?(this.deep=!!o.deep,this.user=!!o.user,this.lazy=!!o.lazy,this.sync=!!o.sync,this.before=o.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=t,this.id=++$e,this.active=!0,this.post=!1,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new dn,this.newDepIds=new dn,this.expression="",d(e)?this.getter=e:(this.getter=function(n){if(!J.test(n)){var e=n.split(".");return function(n){for(var t=0;t<e.length;t++){if(!n)return;n=n[e[t]]}return n}}}(e),this.getter||(this.getter=M)),this.value=this.lazy?void 0:this.get()}return n.prototype.get=function(){var n;xn(this);var e=this.vm;try{n=this.getter.call(e,e)}catch(n){if(!this.user)throw n;ze(n,e,'getter for watcher "'.concat(this.expression,'"'))}finally{this.deep&&He(n),kn(),this.cleanupDeps()}return n},n.prototype.addDep=function(n){var e=n.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(n),this.depIds.has(e)||n.addSub(this))},n.prototype.cleanupDeps=function(){for(var n=this.deps.length;n--;){var e=this.deps[n];this.newDepIds.has(e.id)||e.removeSub(this)}var t=this.depIds;this.depIds=this.newDepIds,this.newDepIds=t,this.newDepIds.clear(),t=this.deps,this.deps=this.newDeps,this.newDeps=t,this.newDeps.length=0},n.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():mt(this)},n.prototype.run=function(){if(this.active){var n=this.get();if(n!==this.value||c(n)||this.deep){var e=this.value;if(this.value=n,this.user){var t='callback for watcher "'.concat(this.expression,'"');Pe(this.cb,this.vm,[n,e],this.vm,t)}else this.cb.call(this.vm,n,e)}}},n.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},n.prototype.depend=function(){for(var n=this.deps.length;n--;)this.deps[n].depend()},n.prototype.teardown=function(){if(this.vm&&!this.vm._isBeingDestroyed&&w(this.vm._scope.effects,this),this.active){for(var n=this.deps.length;n--;)this.deps[n].removeSub(this);this.active=!1,this.onStop&&this.onStop()}},n}();function Ge(n,e){qe.$on(n,e)}function Ve(n,e){qe.$off(n,e)}function Ye(n,e){var t=qe;return function o(){var i=e.apply(null,arguments);null!==i&&t.$off(n,o)}}function Ke(n,e,t){qe=n,Gn(e,t||{},Ge,Ve,Ye,n),qe=void 0}var Xe=null;function Ze(n){var e=Xe;return Xe=n,function(){Xe=e}}function Qe(n){for(;n&&(n=n.$parent);)if(n._inactive)return!0;return!1}function nt(n,e){if(e){if(n._directInactive=!1,Qe(n))return}else if(n._directInactive)return;if(n._inactive||null===n._inactive){n._inactive=!1;for(var t=0;t<n.$children.length;t++)nt(n.$children[t]);et(n,"activated")}}function et(n,e,t,o){void 0===o&&(o=!0),xn();var i=un;o&&pn(n);var r=n.$options[e],s="".concat(e," hook");if(r)for(var a=0,l=r.length;a<l;a++)Pe(r[a],n,t||null,n,s);n._hasHookEvent&&n.$emit("hook:"+e),o&&pn(i),kn()}var tt=[],ot=[],it={},rt=!1,st=!1,at=0;var lt=0,dt=Date.now;if(V&&!K){var ct=window.performance;ct&&"function"==typeof ct.now&&dt()>document.createEvent("Event").timeStamp&&(dt=function(){return ct.now()})}var ut=function(n,e){if(n.post){if(!e.post)return 1}else if(e.post)return-1;return n.id-e.id};function pt(){var n,e;for(lt=dt(),st=!0,tt.sort(ut),at=0;at<tt.length;at++)(n=tt[at]).before&&n.before(),e=n.id,it[e]=null,n.run();var t=ot.slice(),o=tt.slice();at=tt.length=ot.length=0,it={},rt=st=!1,function(n){for(var e=0;e<n.length;e++)n[e]._inactive=!0,nt(n[e],!0)}(t),function(n){var e=n.length;for(;e--;){var t=n[e],o=t.vm;o&&o._watcher===t&&o._isMounted&&!o._isDestroyed&&et(o,"updated")}}(o),function(){for(var n=0;n<yn.length;n++){var e=yn[n];e.subs=e.subs.filter((function(n){return n})),e._pending=!1}yn.length=0}(),an&&F.devtools&&an.emit("flush")}function mt(n){var e=n.id;if(null==it[e]&&(n!==vn.target||!n.noRecurse)){if(it[e]=!0,st){for(var t=tt.length-1;t>at&&tt[t].id>n.id;)t--;tt.splice(t+1,0,n)}else tt.push(n);rt||(rt=!0,Ue(pt))}}function ft(n,e){if(n){for(var t=Object.create(null),o=cn?Reflect.ownKeys(n):Object.keys(n),i=0;i<o.length;i++){var r=o[i];if("__ob__"!==r){var s=n[r].from;if(s in e._provided)t[r]=e._provided[s];else if("default"in n[r]){var a=n[r].default;t[r]=d(a)?a.call(e):a}else 0}}return t}}function ht(n,e,t,r,s){var l,d=this,c=s.options;k(r,"_uid")?(l=Object.create(r))._original=r:(l=r,r=r._original);var u=a(c._compiled),p=!u;this.data=n,this.props=e,this.children=t,this.parent=r,this.listeners=n.on||o,this.injections=ft(c.inject,r),this.slots=function(){return d.$slots||ge(r,n.scopedSlots,d.$slots=me(t,r)),d.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return ge(r,n.scopedSlots,this.slots())}}),u&&(this.$options=c,this.$slots=this.slots(),this.$scopedSlots=ge(r,n.scopedSlots,this.$slots)),c._scopeId?this._c=function(n,e,t,o){var s=Ce(l,n,e,t,o,p);return s&&!i(s)&&(s.fnScopeId=c._scopeId,s.fnContext=r),s}:this._c=function(n,e,t,o){return Ce(l,n,e,t,o,p)}}function gt(n,e,t,o,i){var r=gn(n);return r.fnContext=t,r.fnOptions=o,e.slot&&((r.data||(r.data={})).slot=e.slot),r}function bt(n,e){for(var t in e)n[T(t)]=e[t]}function yt(n){return n.name||n.__name||n._componentTag}pe(ht.prototype);var vt={init:function(n,e){if(n.componentInstance&&!n.componentInstance._isDestroyed&&n.data.keepAlive){var t=n;vt.prepatch(t,t)}else{(n.componentInstance=function(n,e){var t={_isComponent:!0,_parentVnode:n,parent:e},o=n.data.inlineTemplate;s(o)&&(t.render=o.render,t.staticRenderFns=o.staticRenderFns);return new n.componentOptions.Ctor(t)}(n,Xe)).$mount(e?n.elm:void 0,e)}},prepatch:function(n,e){var t=e.componentOptions;!function(n,e,t,i,r){var s=i.data.scopedSlots,a=n.$scopedSlots,l=!!(s&&!s.$stable||a!==o&&!a.$stable||s&&n.$scopedSlots.$key!==s.$key||!s&&n.$scopedSlots.$key),d=!!(r||n.$options._renderChildren||l),c=n.$vnode;n.$options._parentVnode=i,n.$vnode=i,n._vnode&&(n._vnode.parent=i),n.$options._renderChildren=r;var u=i.data.attrs||o;n._attrsProxy&&we(n._attrsProxy,u,c.data&&c.data.attrs||o,n,"$attrs")&&(d=!0),n.$attrs=u,t=t||o;var p=n.$options._parentListeners;if(n._listenersProxy&&we(n._listenersProxy,t,p||o,n,"$listeners"),n.$listeners=n.$options._parentListeners=t,Ke(n,t,p),e&&n.$options.props){_n(!1);for(var m=n._props,f=n.$options._propKeys||[],h=0;h<f.length;h++){var g=f[h],b=n.$options.props;m[g]=_t(g,b,e,n)}_n(!0),n.$options.propsData=e}d&&(n.$slots=me(r,i.context),n.$forceUpdate())}(e.componentInstance=n.componentInstance,t.propsData,t.listeners,e,t.children)},insert:function(n){var e,t=n.context,o=n.componentInstance;o._isMounted||(o._isMounted=!0,et(o,"mounted")),n.data.keepAlive&&(t._isMounted?((e=o)._inactive=!1,ot.push(e)):nt(o,!0))},destroy:function(n){var e=n.componentInstance;e._isDestroyed||(n.data.keepAlive?function n(e,t){if(!(t&&(e._directInactive=!0,Qe(e))||e._inactive)){e._inactive=!0;for(var o=0;o<e.$children.length;o++)n(e.$children[o]);et(e,"deactivated")}}(e,!0):e.$destroy())}},wt=Object.keys(vt);function xt(n,e,t,l,d){if(!r(n)){var u=t.$options._base;if(c(n)&&(n=u.extend(n)),"function"==typeof n){var p;if(r(n.cid)&&void 0===(n=function(n,e){if(a(n.error)&&s(n.errorComp))return n.errorComp;if(s(n.resolved))return n.resolved;var t=Se;if(t&&s(n.owners)&&-1===n.owners.indexOf(t)&&n.owners.push(t),a(n.loading)&&s(n.loadingComp))return n.loadingComp;if(t&&!s(n.owners)){var o=n.owners=[t],i=!0,l=null,d=null;t.$on("hook:destroyed",(function(){return w(o,t)}));var u=function(n){for(var e=0,t=o.length;e<t;e++)o[e].$forceUpdate();n&&(o.length=0,null!==l&&(clearTimeout(l),l=null),null!==d&&(clearTimeout(d),d=null))},p=R((function(t){n.resolved=je(t,e),i?o.length=0:u(!0)})),m=R((function(e){s(n.errorComp)&&(n.error=!0,u(!0))})),f=n(p,m);return c(f)&&(h(f)?r(n.resolved)&&f.then(p,m):h(f.component)&&(f.component.then(p,m),s(f.error)&&(n.errorComp=je(f.error,e)),s(f.loading)&&(n.loadingComp=je(f.loading,e),0===f.delay?n.loading=!0:l=setTimeout((function(){l=null,r(n.resolved)&&r(n.error)&&(n.loading=!0,u(!1))}),f.delay||200)),s(f.timeout)&&(d=setTimeout((function(){d=null,r(n.resolved)&&m(null)}),f.timeout)))),i=!1,n.loading?n.loadingComp:n.resolved}}(p=n,u)))return function(n,e,t,o,i){var r=fn();return r.asyncFactory=n,r.asyncMeta={data:e,context:t,children:o,tag:i},r}(p,e,t,l,d);e=e||{},Jt(n),s(e.model)&&function(n,e){var t=n.model&&n.model.prop||"value",o=n.model&&n.model.event||"input";(e.attrs||(e.attrs={}))[t]=e.model.value;var r=e.on||(e.on={}),a=r[o],l=e.model.callback;s(a)?(i(a)?-1===a.indexOf(l):a!==l)&&(r[o]=[l].concat(a)):r[o]=l}(n.options,e);var m=function(n,e,t){var o=e.options.props;if(!r(o)){var i={},a=n.attrs,l=n.props;if(s(a)||s(l))for(var d in o){var c=P(d);Yn(i,l,d,c,!0)||Yn(i,a,d,c,!1)}return i}}(e,n);if(a(n.options.functional))return function(n,e,t,r,a){var l=n.options,d={},c=l.props;if(s(c))for(var u in c)d[u]=_t(u,c,e||o);else s(t.attrs)&&bt(d,t.attrs),s(t.props)&&bt(d,t.props);var p=new ht(t,d,a,r,n),m=l.render.call(null,p._c,p);if(m instanceof mn)return gt(m,t,p.parent,l,p);if(i(m)){for(var f=Kn(m)||[],h=new Array(f.length),g=0;g<f.length;g++)h[g]=gt(f[g],t,p.parent,l,p);return h}}(n,m,e,t,l);var f=e.on;if(e.on=e.nativeOn,a(n.options.abstract)){var g=e.slot;e={},g&&(e.slot=g)}!function(n){for(var e=n.hook||(n.hook={}),t=0;t<wt.length;t++){var o=wt[t],i=e[o],r=vt[o];i===r||i&&i._merged||(e[o]=i?kt(r,i):r)}}(e);var b=yt(n.options)||d;return new mn("vue-component-".concat(n.cid).concat(b?"-".concat(b):""),e,void 0,void 0,void 0,t,{Ctor:n,propsData:m,listeners:f,tag:d,children:l},p)}}}function kt(n,e){var t=function(t,o){n(t,o),e(t,o)};return t._merged=!0,t}var St=M,jt=F.optionMergeStrategies;function Tt(n,e){if(!e)return n;for(var t,o,i,r=cn?Reflect.ownKeys(e):Object.keys(e),s=0;s<r.length;s++)"__ob__"!==(t=r[s])&&(o=n[t],i=e[t],k(n,t)?o!==i&&p(o)&&p(i)&&Tt(o,i):An(n,t,i));return n}function Ct(n,e,t){return t?function(){var o=d(e)?e.call(t,t):e,i=d(n)?n.call(t,t):n;return o?Tt(o,i):i}:e?n?function(){return Tt(d(e)?e.call(this,this):e,d(n)?n.call(this,this):n)}:e:n}function zt(n,e){var t=e?n?n.concat(e):i(e)?e:[e]:n;return t?function(n){for(var e=[],t=0;t<n.length;t++)-1===e.indexOf(n[t])&&e.push(n[t]);return e}(t):t}function Pt(n,e,t,o){var i=Object.create(n||null);return e?E(i,e):i}jt.data=function(n,e,t){return t?Ct(n,e,t):e&&"function"!=typeof e?n:Ct(n,e)},W.forEach((function(n){jt[n]=zt})),U.forEach((function(n){jt[n+"s"]=Pt})),jt.watch=function(n,e,t,o){if(n===tn&&(n=void 0),e===tn&&(e=void 0),!e)return Object.create(n||null);if(!n)return e;var r={};for(var s in E(r,n),e){var a=r[s],l=e[s];a&&!i(a)&&(a=[a]),r[s]=a?a.concat(l):i(l)?l:[l]}return r},jt.props=jt.methods=jt.inject=jt.computed=function(n,e,t,o){if(!n)return e;var i=Object.create(null);return E(i,n),e&&E(i,e),i},jt.provide=Ct;var It=function(n,e){return void 0===e?n:e};function Bt(n,e,t){if(d(e)&&(e=e.options),function(n,e){var t=n.props;if(t){var o,r,s={};if(i(t))for(o=t.length;o--;)"string"==typeof(r=t[o])&&(s[T(r)]={type:null});else if(p(t))for(var a in t)r=t[a],s[T(a)]=p(r)?r:{type:r};else 0;n.props=s}}(e),function(n,e){var t=n.inject;if(t){var o=n.inject={};if(i(t))for(var r=0;r<t.length;r++)o[t[r]]={from:t[r]};else if(p(t))for(var s in t){var a=t[s];o[s]=p(a)?E({from:s},a):{from:a}}else 0}}(e),function(n){var e=n.directives;if(e)for(var t in e){var o=e[t];d(o)&&(e[t]={bind:o,update:o})}}(e),!e._base&&(e.extends&&(n=Bt(n,e.extends,t)),e.mixins))for(var o=0,r=e.mixins.length;o<r;o++)n=Bt(n,e.mixins[o],t);var s,a={};for(s in n)l(s);for(s in e)k(n,s)||l(s);function l(o){var i=jt[o]||It;a[o]=i(n[o],e[o],t,o)}return a}function Et(n,e,t,o){if("string"==typeof t){var i=n[e];if(k(i,t))return i[t];var r=T(t);if(k(i,r))return i[r];var s=C(r);return k(i,s)?i[s]:i[t]||i[r]||i[s]}}function _t(n,e,t,o){var i=e[n],r=!k(t,n),s=t[n],a=Lt(Boolean,i.type);if(a>-1)if(r&&!k(i,"default"))s=!1;else if(""===s||s===P(n)){var l=Lt(String,i.type);(l<0||a<l)&&(s=!0)}if(void 0===s){s=function(n,e,t){if(!k(e,"default"))return;var o=e.default;0;if(n&&n.$options.propsData&&void 0===n.$options.propsData[t]&&void 0!==n._props[t])return n._props[t];return d(o)&&"Function"!==Ot(e.type)?o.call(n):o}(o,i,n);var c=En;_n(!0),Dn(s),_n(c)}return s}var Mt=/^\s*function (\w+)/;function Ot(n){var e=n&&n.toString().match(Mt);return e?e[1]:""}function Dt(n,e){return Ot(n)===Ot(e)}function Lt(n,e){if(!i(e))return Dt(e,n)?0:-1;for(var t=0,o=e.length;t<o;t++)if(Dt(e[t],n))return t;return-1}var At={enumerable:!0,configurable:!0,get:M,set:M};function Rt(n,e,t){At.get=function(){return this[e][t]},At.set=function(n){this[e][t]=n},Object.defineProperty(n,t,At)}function Nt(n){var e=n.$options;if(e.props&&function(n,e){var t=n.$options.propsData||{},o=n._props=Cn({}),i=n.$options._propKeys=[];n.$parent&&_n(!1);var r=function(r){i.push(r);var s=_t(r,e,t,n);Ln(o,r,s),r in n||Rt(n,"_props",r)};for(var s in e)r(s);_n(!0)}(n,e.props),function(n){var e=n.$options,t=e.setup;if(t){var o=n._setupContext=ve(n);pn(n),xn();var i=Pe(t,null,[n._props||Cn({}),o],n,"setup");if(kn(),pn(),d(i))e.render=i;else if(c(i))if(n._setupState=i,i.__sfc){var r=n._setupProxy={};for(var s in i)"__sfc"!==s&&Wn(r,i,s)}else for(var s in i)q(s)||Wn(n,i,s);else 0}}(n),e.methods&&function(n,e){n.$options.props;for(var t in e)n[t]="function"!=typeof e[t]?M:I(e[t],n)}(n,e.methods),e.data)!function(n){var e=n.$options.data;p(e=n._data=d(e)?function(n,e){xn();try{return n.call(e,e)}catch(n){return ze(n,e,"data()"),{}}finally{kn()}}(e,n):e||{})||(e={});var t=Object.keys(e),o=n.$options.props,i=(n.$options.methods,t.length);for(;i--;){var r=t[i];0,o&&k(o,r)||q(r)||Rt(n,"_data",r)}var s=Dn(e);s&&s.vmCount++}(n);else{var t=Dn(n._data={});t&&t.vmCount++}e.computed&&function(n,e){var t=n._computedWatchers=Object.create(null),o=sn();for(var i in e){var r=e[i],s=d(r)?r:r.get;0,o||(t[i]=new Je(n,s||M,M,Ut)),i in n||Wt(n,i,r)}}(n,e.computed),e.watch&&e.watch!==tn&&function(n,e){for(var t in e){var o=e[t];if(i(o))for(var r=0;r<o.length;r++)qt(n,t,o[r]);else qt(n,t,o)}}(n,e.watch)}var Ut={lazy:!0};function Wt(n,e,t){var o=!sn();d(t)?(At.get=o?Ft(e):Ht(t),At.set=M):(At.get=t.get?o&&!1!==t.cache?Ft(e):Ht(t.get):M,At.set=t.set||M),Object.defineProperty(n,e,At)}function Ft(n){return function(){var e=this._computedWatchers&&this._computedWatchers[n];if(e)return e.dirty&&e.evaluate(),vn.target&&e.depend(),e.value}}function Ht(n){return function(){return n.call(this,this)}}function qt(n,e,t,o){return p(t)&&(o=t,t=t.handler),"string"==typeof t&&(t=n[t]),n.$watch(e,t,o)}var $t=0;function Jt(n){var e=n.options;if(n.super){var t=Jt(n.super);if(t!==n.superOptions){n.superOptions=t;var o=function(n){var e,t=n.options,o=n.sealedOptions;for(var i in t)t[i]!==o[i]&&(e||(e={}),e[i]=t[i]);return e}(n);o&&E(n.extendOptions,o),(e=n.options=Bt(t,n.extendOptions)).name&&(e.components[e.name]=n)}}return e}function Gt(n){this._init(n)}function Vt(n){n.cid=0;var e=1;n.extend=function(n){n=n||{};var t=this,o=t.cid,i=n._Ctor||(n._Ctor={});if(i[o])return i[o];var r=yt(n)||yt(t.options);var s=function(n){this._init(n)};return(s.prototype=Object.create(t.prototype)).constructor=s,s.cid=e++,s.options=Bt(t.options,n),s.super=t,s.options.props&&function(n){var e=n.options.props;for(var t in e)Rt(n.prototype,"_props",t)}(s),s.options.computed&&function(n){var e=n.options.computed;for(var t in e)Wt(n.prototype,t,e[t])}(s),s.extend=t.extend,s.mixin=t.mixin,s.use=t.use,U.forEach((function(n){s[n]=t[n]})),r&&(s.options.components[r]=s),s.superOptions=t.options,s.extendOptions=n,s.sealedOptions=E({},s.options),i[o]=s,s}}function Yt(n){return n&&(yt(n.Ctor.options)||n.tag)}function Kt(n,e){return i(n)?n.indexOf(e)>-1:"string"==typeof n?n.split(",").indexOf(e)>-1:!!m(n)&&n.test(e)}function Xt(n,e){var t=n.cache,o=n.keys,i=n._vnode;for(var r in t){var s=t[r];if(s){var a=s.name;a&&!e(a)&&Zt(t,r,o,i)}}}function Zt(n,e,t,o){var i=n[e];!i||o&&i.tag===o.tag||i.componentInstance.$destroy(),n[e]=null,w(t,e)}!function(n){n.prototype._init=function(n){var e=this;e._uid=$t++,e._isVue=!0,e.__v_skip=!0,e._scope=new Hn(!0),e._scope._vm=!0,n&&n._isComponent?function(n,e){var t=n.$options=Object.create(n.constructor.options),o=e._parentVnode;t.parent=e.parent,t._parentVnode=o;var i=o.componentOptions;t.propsData=i.propsData,t._parentListeners=i.listeners,t._renderChildren=i.children,t._componentTag=i.tag,e.render&&(t.render=e.render,t.staticRenderFns=e.staticRenderFns)}(e,n):e.$options=Bt(Jt(e.constructor),n||{},e),e._renderProxy=e,e._self=e,function(n){var e=n.$options,t=e.parent;if(t&&!e.abstract){for(;t.$options.abstract&&t.$parent;)t=t.$parent;t.$children.push(n)}n.$parent=t,n.$root=t?t.$root:n,n.$children=[],n.$refs={},n._provided=t?t._provided:Object.create(null),n._watcher=null,n._inactive=null,n._directInactive=!1,n._isMounted=!1,n._isDestroyed=!1,n._isBeingDestroyed=!1}(e),function(n){n._events=Object.create(null),n._hasHookEvent=!1;var e=n.$options._parentListeners;e&&Ke(n,e)}(e),function(n){n._vnode=null,n._staticTrees=null;var e=n.$options,t=n.$vnode=e._parentVnode,i=t&&t.context;n.$slots=me(e._renderChildren,i),n.$scopedSlots=t?ge(n.$parent,t.data.scopedSlots,n.$slots):o,n._c=function(e,t,o,i){return Ce(n,e,t,o,i,!1)},n.$createElement=function(e,t,o,i){return Ce(n,e,t,o,i,!0)};var r=t&&t.data;Ln(n,"$attrs",r&&r.attrs||o,null,!0),Ln(n,"$listeners",e._parentListeners||o,null,!0)}(e),et(e,"beforeCreate",void 0,!1),function(n){var e=ft(n.$options.inject,n);e&&(_n(!1),Object.keys(e).forEach((function(t){Ln(n,t,e[t])})),_n(!0))}(e),Nt(e),function(n){var e=n.$options.provide;if(e){var t=d(e)?e.call(n):e;if(!c(t))return;for(var o=qn(n),i=cn?Reflect.ownKeys(t):Object.keys(t),r=0;r<i.length;r++){var s=i[r];Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(t,s))}}}(e),et(e,"created"),e.$options.el&&e.$mount(e.$options.el)}}(Gt),function(n){var e={get:function(){return this._data}},t={get:function(){return this._props}};Object.defineProperty(n.prototype,"$data",e),Object.defineProperty(n.prototype,"$props",t),n.prototype.$set=An,n.prototype.$delete=Rn,n.prototype.$watch=function(n,e,t){if(p(e))return qt(this,n,e,t);(t=t||{}).user=!0;var o=new Je(this,n,e,t);if(t.immediate){var i='callback for immediate watcher "'.concat(o.expression,'"');xn(),Pe(e,this,[o.value],this,i),kn()}return function(){o.teardown()}}}(Gt),function(n){var e=/^hook:/;n.prototype.$on=function(n,t){var o=this;if(i(n))for(var r=0,s=n.length;r<s;r++)o.$on(n[r],t);else(o._events[n]||(o._events[n]=[])).push(t),e.test(n)&&(o._hasHookEvent=!0);return o},n.prototype.$once=function(n,e){var t=this;function o(){t.$off(n,o),e.apply(t,arguments)}return o.fn=e,t.$on(n,o),t},n.prototype.$off=function(n,e){var t=this;if(!arguments.length)return t._events=Object.create(null),t;if(i(n)){for(var o=0,r=n.length;o<r;o++)t.$off(n[o],e);return t}var s,a=t._events[n];if(!a)return t;if(!e)return t._events[n]=null,t;for(var l=a.length;l--;)if((s=a[l])===e||s.fn===e){a.splice(l,1);break}return t},n.prototype.$emit=function(n){var e=this,t=e._events[n];if(t){t=t.length>1?B(t):t;for(var o=B(arguments,1),i='event handler for "'.concat(n,'"'),r=0,s=t.length;r<s;r++)Pe(t[r],e,o,e,i)}return e}}(Gt),function(n){n.prototype._update=function(n,e){var t=this,o=t.$el,i=t._vnode,r=Ze(t);t._vnode=n,t.$el=i?t.__patch__(i,n):t.__patch__(t.$el,n,e,!1),r(),o&&(o.__vue__=null),t.$el&&(t.$el.__vue__=t);for(var s=t;s&&s.$vnode&&s.$parent&&s.$vnode===s.$parent._vnode;)s.$parent.$el=s.$el,s=s.$parent},n.prototype.$forceUpdate=function(){this._watcher&&this._watcher.update()},n.prototype.$destroy=function(){var n=this;if(!n._isBeingDestroyed){et(n,"beforeDestroy"),n._isBeingDestroyed=!0;var e=n.$parent;!e||e._isBeingDestroyed||n.$options.abstract||w(e.$children,n),n._scope.stop(),n._data.__ob__&&n._data.__ob__.vmCount--,n._isDestroyed=!0,n.__patch__(n._vnode,null),et(n,"destroyed"),n.$off(),n.$el&&(n.$el.__vue__=null),n.$vnode&&(n.$vnode.parent=null)}}}(Gt),function(n){pe(n.prototype),n.prototype.$nextTick=function(n){return Ue(n,this)},n.prototype._render=function(){var n,e=this,t=e.$options,o=t.render,r=t._parentVnode;r&&e._isMounted&&(e.$scopedSlots=ge(e.$parent,r.data.scopedSlots,e.$slots,e.$scopedSlots),e._slotsProxy&&ke(e._slotsProxy,e.$scopedSlots)),e.$vnode=r;try{pn(e),Se=e,n=o.call(e._renderProxy,e.$createElement)}catch(t){ze(t,e,"render"),n=e._vnode}finally{Se=null,pn()}return i(n)&&1===n.length&&(n=n[0]),n instanceof mn||(n=fn()),n.parent=r,n}}(Gt);var Qt=[String,RegExp,Array],no={KeepAlive:{name:"keep-alive",abstract:!0,props:{include:Qt,exclude:Qt,max:[String,Number]},methods:{cacheVNode:function(){var n=this.cache,e=this.keys,t=this.vnodeToCache,o=this.keyToCache;if(t){var i=t.tag,r=t.componentInstance,s=t.componentOptions;n[o]={name:Yt(s),tag:i,componentInstance:r},e.push(o),this.max&&e.length>parseInt(this.max)&&Zt(n,e[0],e,this._vnode),this.vnodeToCache=null}}},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var n in this.cache)Zt(this.cache,n,this.keys)},mounted:function(){var n=this;this.cacheVNode(),this.$watch("include",(function(e){Xt(n,(function(n){return Kt(e,n)}))})),this.$watch("exclude",(function(e){Xt(n,(function(n){return!Kt(e,n)}))}))},updated:function(){this.cacheVNode()},render:function(){var n=this.$slots.default,e=Te(n),t=e&&e.componentOptions;if(t){var o=Yt(t),i=this.include,r=this.exclude;if(i&&(!o||!Kt(i,o))||r&&o&&Kt(r,o))return e;var s=this.cache,a=this.keys,l=null==e.key?t.Ctor.cid+(t.tag?"::".concat(t.tag):""):e.key;s[l]?(e.componentInstance=s[l].componentInstance,w(a,l),a.push(l)):(this.vnodeToCache=e,this.keyToCache=l),e.data.keepAlive=!0}return e||n&&n[0]}}};!function(n){var e={get:function(){return F}};Object.defineProperty(n,"config",e),n.util={warn:St,extend:E,mergeOptions:Bt,defineReactive:Ln},n.set=An,n.delete=Rn,n.nextTick=Ue,n.observable=function(n){return Dn(n),n},n.options=Object.create(null),U.forEach((function(e){n.options[e+"s"]=Object.create(null)})),n.options._base=n,E(n.options.components,no),function(n){n.use=function(n){var e=this._installedPlugins||(this._installedPlugins=[]);if(e.indexOf(n)>-1)return this;var t=B(arguments,1);return t.unshift(this),d(n.install)?n.install.apply(n,t):d(n)&&n.apply(null,t),e.push(n),this}}(n),function(n){n.mixin=function(n){return this.options=Bt(this.options,n),this}}(n),Vt(n),function(n){U.forEach((function(e){n[e]=function(n,t){return t?("component"===e&&p(t)&&(t.name=t.name||n,t=this.options._base.extend(t)),"directive"===e&&d(t)&&(t={bind:t,update:t}),this.options[e+"s"][n]=t,t):this.options[e+"s"][n]}}))}(n)}(Gt),Object.defineProperty(Gt.prototype,"$isServer",{get:sn}),Object.defineProperty(Gt.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(Gt,"FunctionalRenderContext",{value:ht}),Gt.version="2.7.13";var eo=y("style,class"),to=y("input,textarea,option,select,progress"),oo=y("contenteditable,draggable,spellcheck"),io=y("events,caret,typing,plaintext-only"),ro=y("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible"),so="http://www.w3.org/1999/xlink",ao=function(n){return":"===n.charAt(5)&&"xlink"===n.slice(0,5)},lo=function(n){return ao(n)?n.slice(6,n.length):""},co=function(n){return null==n||!1===n};function uo(n){for(var e=n.data,t=n,o=n;s(o.componentInstance);)(o=o.componentInstance._vnode)&&o.data&&(e=po(o.data,e));for(;s(t=t.parent);)t&&t.data&&(e=po(e,t.data));return function(n,e){if(s(n)||s(e))return mo(n,fo(e));return""}(e.staticClass,e.class)}function po(n,e){return{staticClass:mo(n.staticClass,e.staticClass),class:s(n.class)?[n.class,e.class]:e.class}}function mo(n,e){return n?e?n+" "+e:n:e||""}function fo(n){return Array.isArray(n)?function(n){for(var e,t="",o=0,i=n.length;o<i;o++)s(e=fo(n[o]))&&""!==e&&(t&&(t+=" "),t+=e);return t}(n):c(n)?function(n){var e="";for(var t in n)n[t]&&(e&&(e+=" "),e+=t);return e}(n):"string"==typeof n?n:""}var ho={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},go=y("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),bo=y("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),yo=function(n){return go(n)||bo(n)};var vo=Object.create(null);var wo=y("text,number,password,search,email,tel,url");var xo=Object.freeze({__proto__:null,createElement:function(n,e){var t=document.createElement(n);return"select"!==n||e.data&&e.data.attrs&&void 0!==e.data.attrs.multiple&&t.setAttribute("multiple","multiple"),t},createElementNS:function(n,e){return document.createElementNS(ho[n],e)},createTextNode:function(n){return document.createTextNode(n)},createComment:function(n){return document.createComment(n)},insertBefore:function(n,e,t){n.insertBefore(e,t)},removeChild:function(n,e){n.removeChild(e)},appendChild:function(n,e){n.appendChild(e)},parentNode:function(n){return n.parentNode},nextSibling:function(n){return n.nextSibling},tagName:function(n){return n.tagName},setTextContent:function(n,e){n.textContent=e},setStyleScope:function(n,e){n.setAttribute(e,"")}}),ko={create:function(n,e){So(e)},update:function(n,e){n.data.ref!==e.data.ref&&(So(n,!0),So(e))},destroy:function(n){So(n,!0)}};function So(n,e){var t=n.data.ref;if(s(t)){var o=n.context,r=n.componentInstance||n.elm,a=e?null:r,l=e?void 0:r;if(d(t))Pe(t,o,[a],o,"template ref function");else{var c=n.data.refInFor,u="string"==typeof t||"number"==typeof t,p=Un(t),m=o.$refs;if(u||p)if(c){var f=u?m[t]:t.value;e?i(f)&&w(f,r):i(f)?f.includes(r)||f.push(r):u?(m[t]=[r],jo(o,t,m[t])):t.value=[r]}else if(u){if(e&&m[t]!==r)return;m[t]=l,jo(o,t,a)}else if(p){if(e&&t.value!==r)return;t.value=a}else 0}}}function jo(n,e,t){var o=n._setupState;o&&k(o,e)&&(Un(o[e])?o[e].value=t:o[e]=t)}var To=new mn("",{},[]),Co=["create","activate","update","remove","destroy"];function zo(n,e){return n.key===e.key&&n.asyncFactory===e.asyncFactory&&(n.tag===e.tag&&n.isComment===e.isComment&&s(n.data)===s(e.data)&&function(n,e){if("input"!==n.tag)return!0;var t,o=s(t=n.data)&&s(t=t.attrs)&&t.type,i=s(t=e.data)&&s(t=t.attrs)&&t.type;return o===i||wo(o)&&wo(i)}(n,e)||a(n.isAsyncPlaceholder)&&r(e.asyncFactory.error))}function Po(n,e,t){var o,i,r={};for(o=e;o<=t;++o)s(i=n[o].key)&&(r[i]=o);return r}var Io={create:Bo,update:Bo,destroy:function(n){Bo(n,To)}};function Bo(n,e){(n.data.directives||e.data.directives)&&function(n,e){var t,o,i,r=n===To,s=e===To,a=_o(n.data.directives,n.context),l=_o(e.data.directives,e.context),d=[],c=[];for(t in l)o=a[t],i=l[t],o?(i.oldValue=o.value,i.oldArg=o.arg,Oo(i,"update",e,n),i.def&&i.def.componentUpdated&&c.push(i)):(Oo(i,"bind",e,n),i.def&&i.def.inserted&&d.push(i));if(d.length){var u=function(){for(var t=0;t<d.length;t++)Oo(d[t],"inserted",e,n)};r?Vn(e,"insert",u):u()}c.length&&Vn(e,"postpatch",(function(){for(var t=0;t<c.length;t++)Oo(c[t],"componentUpdated",e,n)}));if(!r)for(t in a)l[t]||Oo(a[t],"unbind",n,n,s)}(n,e)}var Eo=Object.create(null);function _o(n,e){var t,o,i=Object.create(null);if(!n)return i;for(t=0;t<n.length;t++){if((o=n[t]).modifiers||(o.modifiers=Eo),i[Mo(o)]=o,e._setupState&&e._setupState.__sfc){var r=o.def||Et(e,"_setupState","v-"+o.name);o.def="function"==typeof r?{bind:r,update:r}:r}o.def=o.def||Et(e.$options,"directives",o.name)}return i}function Mo(n){return n.rawName||"".concat(n.name,".").concat(Object.keys(n.modifiers||{}).join("."))}function Oo(n,e,t,o,i){var r=n.def&&n.def[e];if(r)try{r(t.elm,n,t,o,i)}catch(o){ze(o,t.context,"directive ".concat(n.name," ").concat(e," hook"))}}var Do=[ko,Io];function Lo(n,e){var t=e.componentOptions;if(!(s(t)&&!1===t.Ctor.options.inheritAttrs||r(n.data.attrs)&&r(e.data.attrs))){var o,i,l=e.elm,d=n.data.attrs||{},c=e.data.attrs||{};for(o in(s(c.__ob__)||a(c._v_attr_proxy))&&(c=e.data.attrs=E({},c)),c)i=c[o],d[o]!==i&&Ao(l,o,i,e.data.pre);for(o in(K||Z)&&c.value!==d.value&&Ao(l,"value",c.value),d)r(c[o])&&(ao(o)?l.removeAttributeNS(so,lo(o)):oo(o)||l.removeAttribute(o))}}function Ao(n,e,t,o){o||n.tagName.indexOf("-")>-1?Ro(n,e,t):ro(e)?co(t)?n.removeAttribute(e):(t="allowfullscreen"===e&&"EMBED"===n.tagName?"true":e,n.setAttribute(e,t)):oo(e)?n.setAttribute(e,function(n,e){return co(e)||"false"===e?"false":"contenteditable"===n&&io(e)?e:"true"}(e,t)):ao(e)?co(t)?n.removeAttributeNS(so,lo(e)):n.setAttributeNS(so,e,t):Ro(n,e,t)}function Ro(n,e,t){if(co(t))n.removeAttribute(e);else{if(K&&!X&&"TEXTAREA"===n.tagName&&"placeholder"===e&&""!==t&&!n.__ieph){var o=function(e){e.stopImmediatePropagation(),n.removeEventListener("input",o)};n.addEventListener("input",o),n.__ieph=!0}n.setAttribute(e,t)}}var No={create:Lo,update:Lo};function Uo(n,e){var t=e.elm,o=e.data,i=n.data;if(!(r(o.staticClass)&&r(o.class)&&(r(i)||r(i.staticClass)&&r(i.class)))){var a=uo(e),l=t._transitionClasses;s(l)&&(a=mo(a,fo(l))),a!==t._prevClass&&(t.setAttribute("class",a),t._prevClass=a)}}var Wo,Fo={create:Uo,update:Uo};function Ho(n,e,t){var o=Wo;return function i(){var r=e.apply(null,arguments);null!==r&&Jo(n,i,t,o)}}var qo=_e&&!(en&&Number(en[1])<=53);function $o(n,e,t,o){if(qo){var i=lt,r=e;e=r._wrapper=function(n){if(n.target===n.currentTarget||n.timeStamp>=i||n.timeStamp<=0||n.target.ownerDocument!==document)return r.apply(this,arguments)}}Wo.addEventListener(n,e,on?{capture:t,passive:o}:t)}function Jo(n,e,t,o){(o||Wo).removeEventListener(n,e._wrapper||e,t)}function Go(n,e){if(!r(n.data.on)||!r(e.data.on)){var t=e.data.on||{},o=n.data.on||{};Wo=e.elm||n.elm,function(n){if(s(n.__r)){var e=K?"change":"input";n[e]=[].concat(n.__r,n[e]||[]),delete n.__r}s(n.__c)&&(n.change=[].concat(n.__c,n.change||[]),delete n.__c)}(t),Gn(t,o,$o,Jo,Ho,e.context),Wo=void 0}}var Vo,Yo={create:Go,update:Go,destroy:function(n){return Go(n,To)}};function Ko(n,e){if(!r(n.data.domProps)||!r(e.data.domProps)){var t,o,i=e.elm,l=n.data.domProps||{},d=e.data.domProps||{};for(t in(s(d.__ob__)||a(d._v_attr_proxy))&&(d=e.data.domProps=E({},d)),l)t in d||(i[t]="");for(t in d){if(o=d[t],"textContent"===t||"innerHTML"===t){if(e.children&&(e.children.length=0),o===l[t])continue;1===i.childNodes.length&&i.removeChild(i.childNodes[0])}if("value"===t&&"PROGRESS"!==i.tagName){i._value=o;var c=r(o)?"":String(o);Xo(i,c)&&(i.value=c)}else if("innerHTML"===t&&bo(i.tagName)&&r(i.innerHTML)){(Vo=Vo||document.createElement("div")).innerHTML="<svg>".concat(o,"</svg>");for(var u=Vo.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;u.firstChild;)i.appendChild(u.firstChild)}else if(o!==l[t])try{i[t]=o}catch(n){}}}}function Xo(n,e){return!n.composing&&("OPTION"===n.tagName||function(n,e){var t=!0;try{t=document.activeElement!==n}catch(n){}return t&&n.value!==e}(n,e)||function(n,e){var t=n.value,o=n._vModifiers;if(s(o)){if(o.number)return b(t)!==b(e);if(o.trim)return t.trim()!==e.trim()}return t!==e}(n,e))}var Zo={create:Ko,update:Ko},Qo=S((function(n){var e={},t=/:(.+)/;return n.split(/;(?![^(]*\))/g).forEach((function(n){if(n){var o=n.split(t);o.length>1&&(e[o[0].trim()]=o[1].trim())}})),e}));function ni(n){var e=ei(n.style);return n.staticStyle?E(n.staticStyle,e):e}function ei(n){return Array.isArray(n)?_(n):"string"==typeof n?Qo(n):n}var ti,oi=/^--/,ii=/\s*!important$/,ri=function(n,e,t){if(oi.test(e))n.style.setProperty(e,t);else if(ii.test(t))n.style.setProperty(P(e),t.replace(ii,""),"important");else{var o=ai(e);if(Array.isArray(t))for(var i=0,r=t.length;i<r;i++)n.style[o]=t[i];else n.style[o]=t}},si=["Webkit","Moz","ms"],ai=S((function(n){if(ti=ti||document.createElement("div").style,"filter"!==(n=T(n))&&n in ti)return n;for(var e=n.charAt(0).toUpperCase()+n.slice(1),t=0;t<si.length;t++){var o=si[t]+e;if(o in ti)return o}}));function li(n,e){var t=e.data,o=n.data;if(!(r(t.staticStyle)&&r(t.style)&&r(o.staticStyle)&&r(o.style))){var i,a,l=e.elm,d=o.staticStyle,c=o.normalizedStyle||o.style||{},u=d||c,p=ei(e.data.style)||{};e.data.normalizedStyle=s(p.__ob__)?E({},p):p;var m=function(n,e){var t,o={};if(e)for(var i=n;i.componentInstance;)(i=i.componentInstance._vnode)&&i.data&&(t=ni(i.data))&&E(o,t);(t=ni(n.data))&&E(o,t);for(var r=n;r=r.parent;)r.data&&(t=ni(r.data))&&E(o,t);return o}(e,!0);for(a in u)r(m[a])&&ri(l,a,"");for(a in m)(i=m[a])!==u[a]&&ri(l,a,null==i?"":i)}}var di={create:li,update:li},ci=/\s+/;function ui(n,e){if(e&&(e=e.trim()))if(n.classList)e.indexOf(" ")>-1?e.split(ci).forEach((function(e){return n.classList.add(e)})):n.classList.add(e);else{var t=" ".concat(n.getAttribute("class")||""," ");t.indexOf(" "+e+" ")<0&&n.setAttribute("class",(t+e).trim())}}function pi(n,e){if(e&&(e=e.trim()))if(n.classList)e.indexOf(" ")>-1?e.split(ci).forEach((function(e){return n.classList.remove(e)})):n.classList.remove(e),n.classList.length||n.removeAttribute("class");else{for(var t=" ".concat(n.getAttribute("class")||""," "),o=" "+e+" ";t.indexOf(o)>=0;)t=t.replace(o," ");(t=t.trim())?n.setAttribute("class",t):n.removeAttribute("class")}}function mi(n){if(n){if("object"==typeof n){var e={};return!1!==n.css&&E(e,fi(n.name||"v")),E(e,n),e}return"string"==typeof n?fi(n):void 0}}var fi=S((function(n){return{enterClass:"".concat(n,"-enter"),enterToClass:"".concat(n,"-enter-to"),enterActiveClass:"".concat(n,"-enter-active"),leaveClass:"".concat(n,"-leave"),leaveToClass:"".concat(n,"-leave-to"),leaveActiveClass:"".concat(n,"-leave-active")}})),hi=V&&!X,gi="transition",bi="transitionend",yi="animation",vi="animationend";hi&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(gi="WebkitTransition",bi="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(yi="WebkitAnimation",vi="webkitAnimationEnd"));var wi=V?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(n){return n()};function xi(n){wi((function(){wi(n)}))}function ki(n,e){var t=n._transitionClasses||(n._transitionClasses=[]);t.indexOf(e)<0&&(t.push(e),ui(n,e))}function Si(n,e){n._transitionClasses&&w(n._transitionClasses,e),pi(n,e)}function ji(n,e,t){var o=Ci(n,e),i=o.type,r=o.timeout,s=o.propCount;if(!i)return t();var a="transition"===i?bi:vi,l=0,d=function(){n.removeEventListener(a,c),t()},c=function(e){e.target===n&&++l>=s&&d()};setTimeout((function(){l<s&&d()}),r+1),n.addEventListener(a,c)}var Ti=/\b(transform|all)(,|$)/;function Ci(n,e){var t,o=window.getComputedStyle(n),i=(o[gi+"Delay"]||"").split(", "),r=(o[gi+"Duration"]||"").split(", "),s=zi(i,r),a=(o[yi+"Delay"]||"").split(", "),l=(o[yi+"Duration"]||"").split(", "),d=zi(a,l),c=0,u=0;return"transition"===e?s>0&&(t="transition",c=s,u=r.length):"animation"===e?d>0&&(t="animation",c=d,u=l.length):u=(t=(c=Math.max(s,d))>0?s>d?"transition":"animation":null)?"transition"===t?r.length:l.length:0,{type:t,timeout:c,propCount:u,hasTransform:"transition"===t&&Ti.test(o[gi+"Property"])}}function zi(n,e){for(;n.length<e.length;)n=n.concat(n);return Math.max.apply(null,e.map((function(e,t){return Pi(e)+Pi(n[t])})))}function Pi(n){return 1e3*Number(n.slice(0,-1).replace(",","."))}function Ii(n,e){var t=n.elm;s(t._leaveCb)&&(t._leaveCb.cancelled=!0,t._leaveCb());var o=mi(n.data.transition);if(!r(o)&&!s(t._enterCb)&&1===t.nodeType){for(var i=o.css,a=o.type,l=o.enterClass,u=o.enterToClass,p=o.enterActiveClass,m=o.appearClass,f=o.appearToClass,h=o.appearActiveClass,g=o.beforeEnter,y=o.enter,v=o.afterEnter,w=o.enterCancelled,x=o.beforeAppear,k=o.appear,S=o.afterAppear,j=o.appearCancelled,T=o.duration,C=Xe,z=Xe.$vnode;z&&z.parent;)C=z.context,z=z.parent;var P=!C._isMounted||!n.isRootInsert;if(!P||k||""===k){var I=P&&m?m:l,B=P&&h?h:p,E=P&&f?f:u,_=P&&x||g,M=P&&d(k)?k:y,O=P&&S||v,D=P&&j||w,L=b(c(T)?T.enter:T);0;var A=!1!==i&&!X,N=_i(M),U=t._enterCb=R((function(){A&&(Si(t,E),Si(t,B)),U.cancelled?(A&&Si(t,I),D&&D(t)):O&&O(t),t._enterCb=null}));n.data.show||Vn(n,"insert",(function(){var e=t.parentNode,o=e&&e._pending&&e._pending[n.key];o&&o.tag===n.tag&&o.elm._leaveCb&&o.elm._leaveCb(),M&&M(t,U)})),_&&_(t),A&&(ki(t,I),ki(t,B),xi((function(){Si(t,I),U.cancelled||(ki(t,E),N||(Ei(L)?setTimeout(U,L):ji(t,a,U)))}))),n.data.show&&(e&&e(),M&&M(t,U)),A||N||U()}}}function Bi(n,e){var t=n.elm;s(t._enterCb)&&(t._enterCb.cancelled=!0,t._enterCb());var o=mi(n.data.transition);if(r(o)||1!==t.nodeType)return e();if(!s(t._leaveCb)){var i=o.css,a=o.type,l=o.leaveClass,d=o.leaveToClass,u=o.leaveActiveClass,p=o.beforeLeave,m=o.leave,f=o.afterLeave,h=o.leaveCancelled,g=o.delayLeave,y=o.duration,v=!1!==i&&!X,w=_i(m),x=b(c(y)?y.leave:y);0;var k=t._leaveCb=R((function(){t.parentNode&&t.parentNode._pending&&(t.parentNode._pending[n.key]=null),v&&(Si(t,d),Si(t,u)),k.cancelled?(v&&Si(t,l),h&&h(t)):(e(),f&&f(t)),t._leaveCb=null}));g?g(S):S()}function S(){k.cancelled||(!n.data.show&&t.parentNode&&((t.parentNode._pending||(t.parentNode._pending={}))[n.key]=n),p&&p(t),v&&(ki(t,l),ki(t,u),xi((function(){Si(t,l),k.cancelled||(ki(t,d),w||(Ei(x)?setTimeout(k,x):ji(t,a,k)))}))),m&&m(t,k),v||w||k())}}function Ei(n){return"number"==typeof n&&!isNaN(n)}function _i(n){if(r(n))return!1;var e=n.fns;return s(e)?_i(Array.isArray(e)?e[0]:e):(n._length||n.length)>1}function Mi(n,e){!0!==e.data.show&&Ii(e)}var Oi=function(n){var e,t,o={},d=n.modules,c=n.nodeOps;for(e=0;e<Co.length;++e)for(o[Co[e]]=[],t=0;t<d.length;++t)s(d[t][Co[e]])&&o[Co[e]].push(d[t][Co[e]]);function u(n){var e=c.parentNode(n);s(e)&&c.removeChild(e,n)}function p(n,e,t,i,r,l,d){if(s(n.elm)&&s(l)&&(n=l[d]=gn(n)),n.isRootInsert=!r,!function(n,e,t,i){var r=n.data;if(s(r)){var l=s(n.componentInstance)&&r.keepAlive;if(s(r=r.hook)&&s(r=r.init)&&r(n,!1),s(n.componentInstance))return m(n,e),f(t,n.elm,i),a(l)&&function(n,e,t,i){var r,a=n;for(;a.componentInstance;)if(a=a.componentInstance._vnode,s(r=a.data)&&s(r=r.transition)){for(r=0;r<o.activate.length;++r)o.activate[r](To,a);e.push(a);break}f(t,n.elm,i)}(n,e,t,i),!0}}(n,e,t,i)){var u=n.data,p=n.children,g=n.tag;s(g)?(n.elm=n.ns?c.createElementNS(n.ns,g):c.createElement(g,n),v(n),h(n,p,e),s(u)&&b(n,e),f(t,n.elm,i)):a(n.isComment)?(n.elm=c.createComment(n.text),f(t,n.elm,i)):(n.elm=c.createTextNode(n.text),f(t,n.elm,i))}}function m(n,e){s(n.data.pendingInsert)&&(e.push.apply(e,n.data.pendingInsert),n.data.pendingInsert=null),n.elm=n.componentInstance.$el,g(n)?(b(n,e),v(n)):(So(n),e.push(n))}function f(n,e,t){s(n)&&(s(t)?c.parentNode(t)===n&&c.insertBefore(n,e,t):c.appendChild(n,e))}function h(n,e,t){if(i(e)){0;for(var o=0;o<e.length;++o)p(e[o],t,n.elm,null,!0,e,o)}else l(n.text)&&c.appendChild(n.elm,c.createTextNode(String(n.text)))}function g(n){for(;n.componentInstance;)n=n.componentInstance._vnode;return s(n.tag)}function b(n,t){for(var i=0;i<o.create.length;++i)o.create[i](To,n);s(e=n.data.hook)&&(s(e.create)&&e.create(To,n),s(e.insert)&&t.push(n))}function v(n){var e;if(s(e=n.fnScopeId))c.setStyleScope(n.elm,e);else for(var t=n;t;)s(e=t.context)&&s(e=e.$options._scopeId)&&c.setStyleScope(n.elm,e),t=t.parent;s(e=Xe)&&e!==n.context&&e!==n.fnContext&&s(e=e.$options._scopeId)&&c.setStyleScope(n.elm,e)}function w(n,e,t,o,i,r){for(;o<=i;++o)p(t[o],r,n,e,!1,t,o)}function x(n){var e,t,i=n.data;if(s(i))for(s(e=i.hook)&&s(e=e.destroy)&&e(n),e=0;e<o.destroy.length;++e)o.destroy[e](n);if(s(e=n.children))for(t=0;t<n.children.length;++t)x(n.children[t])}function k(n,e,t){for(;e<=t;++e){var o=n[e];s(o)&&(s(o.tag)?(S(o),x(o)):u(o.elm))}}function S(n,e){if(s(e)||s(n.data)){var t,i=o.remove.length+1;for(s(e)?e.listeners+=i:e=function(n,e){function t(){0==--t.listeners&&u(n)}return t.listeners=e,t}(n.elm,i),s(t=n.componentInstance)&&s(t=t._vnode)&&s(t.data)&&S(t,e),t=0;t<o.remove.length;++t)o.remove[t](n,e);s(t=n.data.hook)&&s(t=t.remove)?t(n,e):e()}else u(n.elm)}function j(n,e,t,o){for(var i=t;i<o;i++){var r=e[i];if(s(r)&&zo(n,r))return i}}function T(n,e,t,i,l,d){if(n!==e){s(e.elm)&&s(i)&&(e=i[l]=gn(e));var u=e.elm=n.elm;if(a(n.isAsyncPlaceholder))s(e.asyncFactory.resolved)?P(n.elm,e,t):e.isAsyncPlaceholder=!0;else if(a(e.isStatic)&&a(n.isStatic)&&e.key===n.key&&(a(e.isCloned)||a(e.isOnce)))e.componentInstance=n.componentInstance;else{var m,f=e.data;s(f)&&s(m=f.hook)&&s(m=m.prepatch)&&m(n,e);var h=n.children,b=e.children;if(s(f)&&g(e)){for(m=0;m<o.update.length;++m)o.update[m](n,e);s(m=f.hook)&&s(m=m.update)&&m(n,e)}r(e.text)?s(h)&&s(b)?h!==b&&function(n,e,t,o,i){var a,l,d,u=0,m=0,f=e.length-1,h=e[0],g=e[f],b=t.length-1,y=t[0],v=t[b],x=!i;for(0;u<=f&&m<=b;)r(h)?h=e[++u]:r(g)?g=e[--f]:zo(h,y)?(T(h,y,o,t,m),h=e[++u],y=t[++m]):zo(g,v)?(T(g,v,o,t,b),g=e[--f],v=t[--b]):zo(h,v)?(T(h,v,o,t,b),x&&c.insertBefore(n,h.elm,c.nextSibling(g.elm)),h=e[++u],v=t[--b]):zo(g,y)?(T(g,y,o,t,m),x&&c.insertBefore(n,g.elm,h.elm),g=e[--f],y=t[++m]):(r(a)&&(a=Po(e,u,f)),r(l=s(y.key)?a[y.key]:j(y,e,u,f))?p(y,o,n,h.elm,!1,t,m):zo(d=e[l],y)?(T(d,y,o,t,m),e[l]=void 0,x&&c.insertBefore(n,d.elm,h.elm)):p(y,o,n,h.elm,!1,t,m),y=t[++m]);u>f?w(n,r(t[b+1])?null:t[b+1].elm,t,m,b,o):m>b&&k(e,u,f)}(u,h,b,t,d):s(b)?(s(n.text)&&c.setTextContent(u,""),w(u,null,b,0,b.length-1,t)):s(h)?k(h,0,h.length-1):s(n.text)&&c.setTextContent(u,""):n.text!==e.text&&c.setTextContent(u,e.text),s(f)&&s(m=f.hook)&&s(m=m.postpatch)&&m(n,e)}}}function C(n,e,t){if(a(t)&&s(n.parent))n.parent.data.pendingInsert=e;else for(var o=0;o<e.length;++o)e[o].data.hook.insert(e[o])}var z=y("attrs,class,staticClass,staticStyle,key");function P(n,e,t,o){var i,r=e.tag,l=e.data,d=e.children;if(o=o||l&&l.pre,e.elm=n,a(e.isComment)&&s(e.asyncFactory))return e.isAsyncPlaceholder=!0,!0;if(s(l)&&(s(i=l.hook)&&s(i=i.init)&&i(e,!0),s(i=e.componentInstance)))return m(e,t),!0;if(s(r)){if(s(d))if(n.hasChildNodes())if(s(i=l)&&s(i=i.domProps)&&s(i=i.innerHTML)){if(i!==n.innerHTML)return!1}else{for(var c=!0,u=n.firstChild,p=0;p<d.length;p++){if(!u||!P(u,d[p],t,o)){c=!1;break}u=u.nextSibling}if(!c||u)return!1}else h(e,d,t);if(s(l)){var f=!1;for(var g in l)if(!z(g)){f=!0,b(e,t);break}!f&&l.class&&He(l.class)}}else n.data!==e.text&&(n.data=e.text);return!0}return function(n,e,t,i){if(!r(e)){var l,d=!1,u=[];if(r(n))d=!0,p(e,u);else{var m=s(n.nodeType);if(!m&&zo(n,e))T(n,e,u,null,null,i);else{if(m){if(1===n.nodeType&&n.hasAttribute("data-server-rendered")&&(n.removeAttribute("data-server-rendered"),t=!0),a(t)&&P(n,e,u))return C(e,u,!0),n;l=n,n=new mn(c.tagName(l).toLowerCase(),{},[],void 0,l)}var f=n.elm,h=c.parentNode(f);if(p(e,u,f._leaveCb?null:h,c.nextSibling(f)),s(e.parent))for(var b=e.parent,y=g(e);b;){for(var v=0;v<o.destroy.length;++v)o.destroy[v](b);if(b.elm=e.elm,y){for(var w=0;w<o.create.length;++w)o.create[w](To,b);var S=b.data.hook.insert;if(S.merged)for(var j=1;j<S.fns.length;j++)S.fns[j]()}else So(b);b=b.parent}s(h)?k([n],0,0):s(n.tag)&&x(n)}}return C(e,u,d),e.elm}s(n)&&x(n)}}({nodeOps:xo,modules:[No,Fo,Yo,Zo,di,V?{create:Mi,activate:Mi,remove:function(n,e){!0!==n.data.show?Bi(n,e):e()}}:{}].concat(Do)});X&&document.addEventListener("selectionchange",(function(){var n=document.activeElement;n&&n.vmodel&&Fi(n,"input")}));var Di={inserted:function(n,e,t,o){"select"===t.tag?(o.elm&&!o.elm._vOptions?Vn(t,"postpatch",(function(){Di.componentUpdated(n,e,t)})):Li(n,e,t.context),n._vOptions=[].map.call(n.options,Ni)):("textarea"===t.tag||wo(n.type))&&(n._vModifiers=e.modifiers,e.modifiers.lazy||(n.addEventListener("compositionstart",Ui),n.addEventListener("compositionend",Wi),n.addEventListener("change",Wi),X&&(n.vmodel=!0)))},componentUpdated:function(n,e,t){if("select"===t.tag){Li(n,e,t.context);var o=n._vOptions,i=n._vOptions=[].map.call(n.options,Ni);if(i.some((function(n,e){return!L(n,o[e])})))(n.multiple?e.value.some((function(n){return Ri(n,i)})):e.value!==e.oldValue&&Ri(e.value,i))&&Fi(n,"change")}}};function Li(n,e,t){Ai(n,e,t),(K||Z)&&setTimeout((function(){Ai(n,e,t)}),0)}function Ai(n,e,t){var o=e.value,i=n.multiple;if(!i||Array.isArray(o)){for(var r,s,a=0,l=n.options.length;a<l;a++)if(s=n.options[a],i)r=A(o,Ni(s))>-1,s.selected!==r&&(s.selected=r);else if(L(Ni(s),o))return void(n.selectedIndex!==a&&(n.selectedIndex=a));i||(n.selectedIndex=-1)}}function Ri(n,e){return e.every((function(e){return!L(e,n)}))}function Ni(n){return"_value"in n?n._value:n.value}function Ui(n){n.target.composing=!0}function Wi(n){n.target.composing&&(n.target.composing=!1,Fi(n.target,"input"))}function Fi(n,e){var t=document.createEvent("HTMLEvents");t.initEvent(e,!0,!0),n.dispatchEvent(t)}function Hi(n){return!n.componentInstance||n.data&&n.data.transition?n:Hi(n.componentInstance._vnode)}var qi={model:Di,show:{bind:function(n,e,t){var o=e.value,i=(t=Hi(t)).data&&t.data.transition,r=n.__vOriginalDisplay="none"===n.style.display?"":n.style.display;o&&i?(t.data.show=!0,Ii(t,(function(){n.style.display=r}))):n.style.display=o?r:"none"},update:function(n,e,t){var o=e.value;!o!=!e.oldValue&&((t=Hi(t)).data&&t.data.transition?(t.data.show=!0,o?Ii(t,(function(){n.style.display=n.__vOriginalDisplay})):Bi(t,(function(){n.style.display="none"}))):n.style.display=o?n.__vOriginalDisplay:"none")},unbind:function(n,e,t,o,i){i||(n.style.display=n.__vOriginalDisplay)}}},$i={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function Ji(n){var e=n&&n.componentOptions;return e&&e.Ctor.options.abstract?Ji(Te(e.children)):n}function Gi(n){var e={},t=n.$options;for(var o in t.propsData)e[o]=n[o];var i=t._parentListeners;for(var o in i)e[T(o)]=i[o];return e}function Vi(n,e){if(/\d-keep-alive$/.test(e.tag))return n("keep-alive",{props:e.componentOptions.propsData})}var Yi=function(n){return n.tag||he(n)},Ki=function(n){return"show"===n.name},Xi={name:"transition",props:$i,abstract:!0,render:function(n){var e=this,t=this.$slots.default;if(t&&(t=t.filter(Yi)).length){0;var o=this.mode;0;var i=t[0];if(function(n){for(;n=n.parent;)if(n.data.transition)return!0}(this.$vnode))return i;var r=Ji(i);if(!r)return i;if(this._leaving)return Vi(n,i);var s="__transition-".concat(this._uid,"-");r.key=null==r.key?r.isComment?s+"comment":s+r.tag:l(r.key)?0===String(r.key).indexOf(s)?r.key:s+r.key:r.key;var a=(r.data||(r.data={})).transition=Gi(this),d=this._vnode,c=Ji(d);if(r.data.directives&&r.data.directives.some(Ki)&&(r.data.show=!0),c&&c.data&&!function(n,e){return e.key===n.key&&e.tag===n.tag}(r,c)&&!he(c)&&(!c.componentInstance||!c.componentInstance._vnode.isComment)){var u=c.data.transition=E({},a);if("out-in"===o)return this._leaving=!0,Vn(u,"afterLeave",(function(){e._leaving=!1,e.$forceUpdate()})),Vi(n,i);if("in-out"===o){if(he(r))return d;var p,m=function(){p()};Vn(a,"afterEnter",m),Vn(a,"enterCancelled",m),Vn(u,"delayLeave",(function(n){p=n}))}}return i}}},Zi=E({tag:String,moveClass:String},$i);function Qi(n){n.elm._moveCb&&n.elm._moveCb(),n.elm._enterCb&&n.elm._enterCb()}function nr(n){n.data.newPos=n.elm.getBoundingClientRect()}function er(n){var e=n.data.pos,t=n.data.newPos,o=e.left-t.left,i=e.top-t.top;if(o||i){n.data.moved=!0;var r=n.elm.style;r.transform=r.WebkitTransform="translate(".concat(o,"px,").concat(i,"px)"),r.transitionDuration="0s"}}delete Zi.mode;var tr={Transition:Xi,TransitionGroup:{props:Zi,beforeMount:function(){var n=this,e=this._update;this._update=function(t,o){var i=Ze(n);n.__patch__(n._vnode,n.kept,!1,!0),n._vnode=n.kept,i(),e.call(n,t,o)}},render:function(n){for(var e=this.tag||this.$vnode.data.tag||"span",t=Object.create(null),o=this.prevChildren=this.children,i=this.$slots.default||[],r=this.children=[],s=Gi(this),a=0;a<i.length;a++){if((c=i[a]).tag)if(null!=c.key&&0!==String(c.key).indexOf("__vlist"))r.push(c),t[c.key]=c,(c.data||(c.data={})).transition=s;else;}if(o){var l=[],d=[];for(a=0;a<o.length;a++){var c;(c=o[a]).data.transition=s,c.data.pos=c.elm.getBoundingClientRect(),t[c.key]?l.push(c):d.push(c)}this.kept=n(e,null,l),this.removed=d}return n(e,null,r)},updated:function(){var n=this.prevChildren,e=this.moveClass||(this.name||"v")+"-move";n.length&&this.hasMove(n[0].elm,e)&&(n.forEach(Qi),n.forEach(nr),n.forEach(er),this._reflow=document.body.offsetHeight,n.forEach((function(n){if(n.data.moved){var t=n.elm,o=t.style;ki(t,e),o.transform=o.WebkitTransform=o.transitionDuration="",t.addEventListener(bi,t._moveCb=function n(o){o&&o.target!==t||o&&!/transform$/.test(o.propertyName)||(t.removeEventListener(bi,n),t._moveCb=null,Si(t,e))})}})))},methods:{hasMove:function(n,e){if(!hi)return!1;if(this._hasMove)return this._hasMove;var t=n.cloneNode();n._transitionClasses&&n._transitionClasses.forEach((function(n){pi(t,n)})),ui(t,e),t.style.display="none",this.$el.appendChild(t);var o=Ci(t);return this.$el.removeChild(t),this._hasMove=o.hasTransform}}}};Gt.config.mustUseProp=function(n,e,t){return"value"===t&&to(n)&&"button"!==e||"selected"===t&&"option"===n||"checked"===t&&"input"===n||"muted"===t&&"video"===n},Gt.config.isReservedTag=yo,Gt.config.isReservedAttr=eo,Gt.config.getTagNamespace=function(n){return bo(n)?"svg":"math"===n?"math":void 0},Gt.config.isUnknownElement=function(n){if(!V)return!0;if(yo(n))return!1;if(n=n.toLowerCase(),null!=vo[n])return vo[n];var e=document.createElement(n);return n.indexOf("-")>-1?vo[n]=e.constructor===window.HTMLUnknownElement||e.constructor===window.HTMLElement:vo[n]=/HTMLUnknownElement/.test(e.toString())},E(Gt.options.directives,qi),E(Gt.options.components,tr),Gt.prototype.__patch__=V?Oi:M,Gt.prototype.$mount=function(n,e){return function(n,e,t){var o;n.$el=e,n.$options.render||(n.$options.render=fn),et(n,"beforeMount"),o=function(){n._update(n._render(),t)},new Je(n,o,M,{before:function(){n._isMounted&&!n._isDestroyed&&et(n,"beforeUpdate")}},!0),t=!1;var i=n._preWatchers;if(i)for(var r=0;r<i.length;r++)i[r].run();return null==n.$vnode&&(n._isMounted=!0,et(n,"mounted")),n}(this,n=n&&V?function(n){if("string"==typeof n){var e=document.querySelector(n);return e||document.createElement("div")}return n}(n):void 0,e)},V&&setTimeout((function(){F.devtools&&an&&an.emit("init",Gt)}),0)},function(n,e){var t=Array.isArray;n.exports=t},function(n,e,t){var o=t(27),i="object"==typeof self&&self&&self.Object===Object&&self,r=o||i||Function("return this")();n.exports=r},function(n,e,t){var o=t(71),i=t(74);n.exports=function(n,e){var t=i(n,e);return o(t)?t:void 0}},function(n,e,t){"use strict";function o(n,e,t,o,i,r,s,a){var l,d="function"==typeof n?n.options:n;if(e&&(d.render=e,d.staticRenderFns=t,d._compiled=!0),o&&(d.functional=!0),r&&(d._scopeId="data-v-"+r),s?(l=function(n){(n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(n=__VUE_SSR_CONTEXT__),i&&i.call(this,n),n&&n._registeredComponents&&n._registeredComponents.add(s)},d._ssrRegister=l):i&&(l=a?function(){i.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:i),l)if(d.functional){d._injectStyles=l;var c=d.render;d.render=function(n,e){return l.call(e),c(n,e)}}else{var u=d.beforeCreate;d.beforeCreate=u?[].concat(u,l):[l]}return{exports:n,options:d}}t.d(e,"a",(function(){return o}))},function(n,e){n.exports=function(n){return null!=n&&"object"==typeof n}},function(n,e,t){var o=t(7),i=t(56),r=t(57),s=o?o.toStringTag:void 0;n.exports=function(n){return null==n?void 0===n?"[object Undefined]":"[object Null]":s&&s in Object(n)?i(n):r(n)}},function(n,e,t){var o=t(2).Symbol;n.exports=o},function(n,e,t){var o=t(61),i=t(62),r=t(63),s=t(64),a=t(65);function l(n){var e=-1,t=null==n?0:n.length;for(this.clear();++e<t;){var o=n[e];this.set(o[0],o[1])}}l.prototype.clear=o,l.prototype.delete=i,l.prototype.get=r,l.prototype.has=s,l.prototype.set=a,n.exports=l},function(n,e,t){var o=t(29);n.exports=function(n,e){for(var t=n.length;t--;)if(o(n[t][0],e))return t;return-1}},function(n,e,t){var o=t(3)(Object,"create");n.exports=o},function(n,e,t){var o=t(83);n.exports=function(n,e){var t=n.__data__;return o(e)?t["string"==typeof e?"string":"hash"]:t.map}},function(n,e,t){var o=t(22);n.exports=function(n){if("string"==typeof n||o(n))return n;var e=n+"";return"0"==e&&1/n==-1/0?"-0":e}},function(n,e){var t=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,r=/^0o[0-7]+$/i,s=parseInt,a="object"==typeof global&&global&&global.Object===Object&&global,l="object"==typeof self&&self&&self.Object===Object&&self,d=a||l||Function("return this")(),c=Object.prototype.toString,u=Math.max,p=Math.min,m=function(){return d.Date.now()};function f(n){var e=typeof n;return!!n&&("object"==e||"function"==e)}function h(n){if("number"==typeof n)return n;if(function(n){return"symbol"==typeof n||function(n){return!!n&&"object"==typeof n}(n)&&"[object Symbol]"==c.call(n)}(n))return NaN;if(f(n)){var e="function"==typeof n.valueOf?n.valueOf():n;n=f(e)?e+"":e}if("string"!=typeof n)return 0===n?n:+n;n=n.replace(t,"");var a=i.test(n);return a||r.test(n)?s(n.slice(2),a?2:8):o.test(n)?NaN:+n}n.exports=function(n,e,t){var o,i,r,s,a,l,d=0,c=!1,g=!1,b=!0;if("function"!=typeof n)throw new TypeError("Expected a function");function y(e){var t=o,r=i;return o=i=void 0,d=e,s=n.apply(r,t)}function v(n){return d=n,a=setTimeout(x,e),c?y(n):s}function w(n){var t=n-l;return void 0===l||t>=e||t<0||g&&n-d>=r}function x(){var n=m();if(w(n))return k(n);a=setTimeout(x,function(n){var t=e-(n-l);return g?p(t,r-(n-d)):t}(n))}function k(n){return a=void 0,b&&o?y(n):(o=i=void 0,s)}function S(){var n=m(),t=w(n);if(o=arguments,i=this,l=n,t){if(void 0===a)return v(l);if(g)return a=setTimeout(x,e),y(l)}return void 0===a&&(a=setTimeout(x,e)),s}return e=h(e)||0,f(t)&&(c=!!t.leading,r=(g="maxWait"in t)?u(h(t.maxWait)||0,e):r,b="trailing"in t?!!t.trailing:b),S.cancel=function(){void 0!==a&&clearTimeout(a),d=0,o=l=i=a=void 0},S.flush=function(){return void 0===a?s:k(m())},S}},function(n,e,t){var o,i;
/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT */void 0===(i="function"==typeof(o=function(){var n,e,t={version:"0.2.0"},o=t.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};function i(n,e,t){return n<e?e:n>t?t:n}function r(n){return 100*(-1+n)}t.configure=function(n){var e,t;for(e in n)void 0!==(t=n[e])&&n.hasOwnProperty(e)&&(o[e]=t);return this},t.status=null,t.set=function(n){var e=t.isStarted();n=i(n,o.minimum,1),t.status=1===n?null:n;var l=t.render(!e),d=l.querySelector(o.barSelector),c=o.speed,u=o.easing;return l.offsetWidth,s((function(e){""===o.positionUsing&&(o.positionUsing=t.getPositioningCSS()),a(d,function(n,e,t){var i;return(i="translate3d"===o.positionUsing?{transform:"translate3d("+r(n)+"%,0,0)"}:"translate"===o.positionUsing?{transform:"translate("+r(n)+"%,0)"}:{"margin-left":r(n)+"%"}).transition="all "+e+"ms "+t,i}(n,c,u)),1===n?(a(l,{transition:"none",opacity:1}),l.offsetWidth,setTimeout((function(){a(l,{transition:"all "+c+"ms linear",opacity:0}),setTimeout((function(){t.remove(),e()}),c)}),c)):setTimeout(e,c)})),this},t.isStarted=function(){return"number"==typeof t.status},t.start=function(){t.status||t.set(0);var n=function(){setTimeout((function(){t.status&&(t.trickle(),n())}),o.trickleSpeed)};return o.trickle&&n(),this},t.done=function(n){return n||t.status?t.inc(.3+.5*Math.random()).set(1):this},t.inc=function(n){var e=t.status;return e?("number"!=typeof n&&(n=(1-e)*i(Math.random()*e,.1,.95)),e=i(e+n,0,.994),t.set(e)):t.start()},t.trickle=function(){return t.inc(Math.random()*o.trickleRate)},n=0,e=0,t.promise=function(o){return o&&"resolved"!==o.state()?(0===e&&t.start(),n++,e++,o.always((function(){0==--e?(n=0,t.done()):t.set((n-e)/n)})),this):this},t.render=function(n){if(t.isRendered())return document.getElementById("nprogress");d(document.documentElement,"nprogress-busy");var e=document.createElement("div");e.id="nprogress",e.innerHTML=o.template;var i,s=e.querySelector(o.barSelector),l=n?"-100":r(t.status||0),c=document.querySelector(o.parent);return a(s,{transition:"all 0 linear",transform:"translate3d("+l+"%,0,0)"}),o.showSpinner||(i=e.querySelector(o.spinnerSelector))&&p(i),c!=document.body&&d(c,"nprogress-custom-parent"),c.appendChild(e),e},t.remove=function(){c(document.documentElement,"nprogress-busy"),c(document.querySelector(o.parent),"nprogress-custom-parent");var n=document.getElementById("nprogress");n&&p(n)},t.isRendered=function(){return!!document.getElementById("nprogress")},t.getPositioningCSS=function(){var n=document.body.style,e="WebkitTransform"in n?"Webkit":"MozTransform"in n?"Moz":"msTransform"in n?"ms":"OTransform"in n?"O":"";return e+"Perspective"in n?"translate3d":e+"Transform"in n?"translate":"margin"};var s=function(){var n=[];function e(){var t=n.shift();t&&t(e)}return function(t){n.push(t),1==n.length&&e()}}(),a=function(){var n=["Webkit","O","Moz","ms"],e={};function t(t){return t=t.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,(function(n,e){return e.toUpperCase()})),e[t]||(e[t]=function(e){var t=document.body.style;if(e in t)return e;for(var o,i=n.length,r=e.charAt(0).toUpperCase()+e.slice(1);i--;)if((o=n[i]+r)in t)return o;return e}(t))}function o(n,e,o){e=t(e),n.style[e]=o}return function(n,e){var t,i,r=arguments;if(2==r.length)for(t in e)void 0!==(i=e[t])&&e.hasOwnProperty(t)&&o(n,t,i);else o(n,r[1],r[2])}}();function l(n,e){return("string"==typeof n?n:u(n)).indexOf(" "+e+" ")>=0}function d(n,e){var t=u(n),o=t+e;l(t,e)||(n.className=o.substring(1))}function c(n,e){var t,o=u(n);l(n,e)&&(t=o.replace(" "+e+" "," "),n.className=t.substring(1,t.length-1))}function u(n){return(" "+(n.className||"")+" ").replace(/\s+/gi," ")}function p(n){n&&n.parentNode&&n.parentNode.removeChild(n)}return t})?o.call(e,t,e,n):o)||(n.exports=i)},function(n,e,t){var o=t(55),i=t(5),r=Object.prototype,s=r.hasOwnProperty,a=r.propertyIsEnumerable,l=o(function(){return arguments}())?o:function(n){return i(n)&&s.call(n,"callee")&&!a.call(n,"callee")};n.exports=l},function(n,e,t){var o=t(3)(t(2),"Map");n.exports=o},function(n,e){n.exports=function(n){var e=typeof n;return null!=n&&("object"==e||"function"==e)}},function(n,e,t){var o=t(75),i=t(82),r=t(84),s=t(85),a=t(86);function l(n){var e=-1,t=null==n?0:n.length;for(this.clear();++e<t;){var o=n[e];this.set(o[0],o[1])}}l.prototype.clear=o,l.prototype.delete=i,l.prototype.get=r,l.prototype.has=s,l.prototype.set=a,n.exports=l},function(n,e){n.exports=function(n){var e=-1,t=Array(n.size);return n.forEach((function(n){t[++e]=n})),t}},function(n,e){n.exports=function(n){return"number"==typeof n&&n>-1&&n%1==0&&n<=9007199254740991}},function(n,e,t){var o=t(1),i=t(22),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;n.exports=function(n,e){if(o(n))return!1;var t=typeof n;return!("number"!=t&&"symbol"!=t&&"boolean"!=t&&null!=n&&!i(n))||(s.test(n)||!r.test(n)||null!=e&&n in Object(e))}},function(n,e,t){var o=t(6),i=t(5);n.exports=function(n){return"symbol"==typeof n||i(n)&&"[object Symbol]"==o(n)}},function(n,e){n.exports=function(n){return n}},function(n,e){function t(n,e){for(var t=0,o=n.length-1;o>=0;o--){var i=n[o];"."===i?n.splice(o,1):".."===i?(n.splice(o,1),t++):t&&(n.splice(o,1),t--)}if(e)for(;t--;t)n.unshift("..");return n}function o(n,e){if(n.filter)return n.filter(e);for(var t=[],o=0;o<n.length;o++)e(n[o],o,n)&&t.push(n[o]);return t}e.resolve=function(){for(var n="",e=!1,i=arguments.length-1;i>=-1&&!e;i--){var r=i>=0?arguments[i]:process.cwd();if("string"!=typeof r)throw new TypeError("Arguments to path.resolve must be strings");r&&(n=r+"/"+n,e="/"===r.charAt(0))}return(e?"/":"")+(n=t(o(n.split("/"),(function(n){return!!n})),!e).join("/"))||"."},e.normalize=function(n){var r=e.isAbsolute(n),s="/"===i(n,-1);return(n=t(o(n.split("/"),(function(n){return!!n})),!r).join("/"))||r||(n="."),n&&s&&(n+="/"),(r?"/":"")+n},e.isAbsolute=function(n){return"/"===n.charAt(0)},e.join=function(){var n=Array.prototype.slice.call(arguments,0);return e.normalize(o(n,(function(n,e){if("string"!=typeof n)throw new TypeError("Arguments to path.join must be strings");return n})).join("/"))},e.relative=function(n,t){function o(n){for(var e=0;e<n.length&&""===n[e];e++);for(var t=n.length-1;t>=0&&""===n[t];t--);return e>t?[]:n.slice(e,t-e+1)}n=e.resolve(n).substr(1),t=e.resolve(t).substr(1);for(var i=o(n.split("/")),r=o(t.split("/")),s=Math.min(i.length,r.length),a=s,l=0;l<s;l++)if(i[l]!==r[l]){a=l;break}var d=[];for(l=a;l<i.length;l++)d.push("..");return(d=d.concat(r.slice(a))).join("/")},e.sep="/",e.delimiter=":",e.dirname=function(n){if("string"!=typeof n&&(n+=""),0===n.length)return".";for(var e=n.charCodeAt(0),t=47===e,o=-1,i=!0,r=n.length-1;r>=1;--r)if(47===(e=n.charCodeAt(r))){if(!i){o=r;break}}else i=!1;return-1===o?t?"/":".":t&&1===o?"/":n.slice(0,o)},e.basename=function(n,e){var t=function(n){"string"!=typeof n&&(n+="");var e,t=0,o=-1,i=!0;for(e=n.length-1;e>=0;--e)if(47===n.charCodeAt(e)){if(!i){t=e+1;break}}else-1===o&&(i=!1,o=e+1);return-1===o?"":n.slice(t,o)}(n);return e&&t.substr(-1*e.length)===e&&(t=t.substr(0,t.length-e.length)),t},e.extname=function(n){"string"!=typeof n&&(n+="");for(var e=-1,t=0,o=-1,i=!0,r=0,s=n.length-1;s>=0;--s){var a=n.charCodeAt(s);if(47!==a)-1===o&&(i=!1,o=s+1),46===a?-1===e?e=s:1!==r&&(r=1):-1!==e&&(r=-1);else if(!i){t=s+1;break}}return-1===e||-1===o||0===r||1===r&&e===o-1&&e===t+1?"":n.slice(e,o)};var i="b"==="ab".substr(-1)?function(n,e,t){return n.substr(e,t)}:function(n,e,t){return e<0&&(e=n.length+e),n.substr(e,t)}},function(n,e){n.exports=function(n){return n.webpackPolyfill||(n.deprecate=function(){},n.paths=[],n.children||(n.children=[]),Object.defineProperty(n,"loaded",{enumerable:!0,get:function(){return n.l}}),Object.defineProperty(n,"id",{enumerable:!0,get:function(){return n.i}}),n.webpackPolyfill=1),n}},function(n,e){n.exports=function(n,e){for(var t=-1,o=e.length,i=n.length;++t<o;)n[i+t]=e[t];return n}},function(n,e){var t="object"==typeof global&&global&&global.Object===Object&&global;n.exports=t},function(n,e,t){var o=t(8),i=t(66),r=t(67),s=t(68),a=t(69),l=t(70);function d(n){var e=this.__data__=new o(n);this.size=e.size}d.prototype.clear=i,d.prototype.delete=r,d.prototype.get=s,d.prototype.has=a,d.prototype.set=l,n.exports=d},function(n,e){n.exports=function(n,e){return n===e||n!=n&&e!=e}},function(n,e,t){var o=t(6),i=t(17);n.exports=function(n){if(!i(n))return!1;var e=o(n);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(n,e){var t=Function.prototype.toString;n.exports=function(n){if(null!=n){try{return t.call(n)}catch(n){}try{return n+""}catch(n){}}return""}},function(n,e,t){var o=t(87),i=t(5);n.exports=function n(e,t,r,s,a){return e===t||(null==e||null==t||!i(e)&&!i(t)?e!=e&&t!=t:o(e,t,r,s,n,a))}},function(n,e,t){var o=t(34),i=t(90),r=t(35);n.exports=function(n,e,t,s,a,l){var d=1&t,c=n.length,u=e.length;if(c!=u&&!(d&&u>c))return!1;var p=l.get(n),m=l.get(e);if(p&&m)return p==e&&m==n;var f=-1,h=!0,g=2&t?new o:void 0;for(l.set(n,e),l.set(e,n);++f<c;){var b=n[f],y=e[f];if(s)var v=d?s(y,b,f,e,n,l):s(b,y,f,n,e,l);if(void 0!==v){if(v)continue;h=!1;break}if(g){if(!i(e,(function(n,e){if(!r(g,e)&&(b===n||a(b,n,t,s,l)))return g.push(e)}))){h=!1;break}}else if(b!==y&&!a(b,y,t,s,l)){h=!1;break}}return l.delete(n),l.delete(e),h}},function(n,e,t){var o=t(18),i=t(88),r=t(89);function s(n){var e=-1,t=null==n?0:n.length;for(this.__data__=new o;++e<t;)this.add(n[e])}s.prototype.add=s.prototype.push=i,s.prototype.has=r,n.exports=s},function(n,e){n.exports=function(n,e){return n.has(e)}},function(n,e,t){var o=t(100),i=t(106),r=t(40);n.exports=function(n){return r(n)?o(n):i(n)}},function(n,e,t){(function(n){var o=t(2),i=t(102),r=e&&!e.nodeType&&e,s=r&&"object"==typeof n&&n&&!n.nodeType&&n,a=s&&s.exports===r?o.Buffer:void 0,l=(a?a.isBuffer:void 0)||i;n.exports=l}).call(this,t(25)(n))},function(n,e){var t=/^(?:0|[1-9]\d*)$/;n.exports=function(n,e){var o=typeof n;return!!(e=null==e?9007199254740991:e)&&("number"==o||"symbol"!=o&&t.test(n))&&n>-1&&n%1==0&&n<e}},function(n,e,t){var o=t(103),i=t(104),r=t(105),s=r&&r.isTypedArray,a=s?i(s):o;n.exports=a},function(n,e,t){var o=t(30),i=t(20);n.exports=function(n){return null!=n&&i(n.length)&&!o(n)}},function(n,e,t){var o=t(3)(t(2),"Set");n.exports=o},function(n,e,t){var o=t(17);n.exports=function(n){return n==n&&!o(n)}},function(n,e){n.exports=function(n,e){return function(t){return null!=t&&(t[n]===e&&(void 0!==e||n in Object(t)))}}},function(n,e,t){var o=t(45),i=t(12);n.exports=function(n,e){for(var t=0,r=(e=o(e,n)).length;null!=n&&t<r;)n=n[i(e[t++])];return t&&t==r?n:void 0}},function(n,e,t){var o=t(1),i=t(21),r=t(117),s=t(120);n.exports=function(n,e){return o(n)?n:i(n,e)?[n]:r(s(n))}},function(n,e,t){},function(n,e,t){},function(n,e,t){},function(n,e,t){var o=t(53),i=t(58),r=t(129),s=t(137),a=t(146),l=t(51),d=r((function(n){var e=l(n);return a(e)&&(e=void 0),s(o(n,1,a,!0),i(e,2))}));n.exports=d},function(n,e,t){"use strict";
/*!
 * escape-html
 * Copyright(c) 2012-2013 TJ Holowaychuk
 * Copyright(c) 2015 Andreas Lubbe
 * Copyright(c) 2015 Tiancheng "Timothy" Gu
 * MIT Licensed
 */var o=/["'&<>]/;n.exports=function(n){var e,t=""+n,i=o.exec(t);if(!i)return t;var r="",s=0,a=0;for(s=i.index;s<t.length;s++){switch(t.charCodeAt(s)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#39;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}a!==s&&(r+=t.substring(a,s)),a=s+1,r+=e}return a!==s?r+t.substring(a,s):r}},function(n,e){n.exports=function(n){var e=null==n?0:n.length;return e?n[e-1]:void 0}},function(n,e,t){n.exports=t(154)},function(n,e,t){var o=t(26),i=t(54);n.exports=function n(e,t,r,s,a){var l=-1,d=e.length;for(r||(r=i),a||(a=[]);++l<d;){var c=e[l];t>0&&r(c)?t>1?n(c,t-1,r,s,a):o(a,c):s||(a[a.length]=c)}return a}},function(n,e,t){var o=t(7),i=t(15),r=t(1),s=o?o.isConcatSpreadable:void 0;n.exports=function(n){return r(n)||i(n)||!!(s&&n&&n[s])}},function(n,e,t){var o=t(6),i=t(5);n.exports=function(n){return i(n)&&"[object Arguments]"==o(n)}},function(n,e,t){var o=t(7),i=Object.prototype,r=i.hasOwnProperty,s=i.toString,a=o?o.toStringTag:void 0;n.exports=function(n){var e=r.call(n,a),t=n[a];try{n[a]=void 0;var o=!0}catch(n){}var i=s.call(n);return o&&(e?n[a]=t:delete n[a]),i}},function(n,e){var t=Object.prototype.toString;n.exports=function(n){return t.call(n)}},function(n,e,t){var o=t(59),i=t(115),r=t(23),s=t(1),a=t(126);n.exports=function(n){return"function"==typeof n?n:null==n?r:"object"==typeof n?s(n)?i(n[0],n[1]):o(n):a(n)}},function(n,e,t){var o=t(60),i=t(114),r=t(43);n.exports=function(n){var e=i(n);return 1==e.length&&e[0][2]?r(e[0][0],e[0][1]):function(t){return t===n||o(t,n,e)}}},function(n,e,t){var o=t(28),i=t(32);n.exports=function(n,e,t,r){var s=t.length,a=s,l=!r;if(null==n)return!a;for(n=Object(n);s--;){var d=t[s];if(l&&d[2]?d[1]!==n[d[0]]:!(d[0]in n))return!1}for(;++s<a;){var c=(d=t[s])[0],u=n[c],p=d[1];if(l&&d[2]){if(void 0===u&&!(c in n))return!1}else{var m=new o;if(r)var f=r(u,p,c,n,e,m);if(!(void 0===f?i(p,u,3,r,m):f))return!1}}return!0}},function(n,e){n.exports=function(){this.__data__=[],this.size=0}},function(n,e,t){var o=t(9),i=Array.prototype.splice;n.exports=function(n){var e=this.__data__,t=o(e,n);return!(t<0)&&(t==e.length-1?e.pop():i.call(e,t,1),--this.size,!0)}},function(n,e,t){var o=t(9);n.exports=function(n){var e=this.__data__,t=o(e,n);return t<0?void 0:e[t][1]}},function(n,e,t){var o=t(9);n.exports=function(n){return o(this.__data__,n)>-1}},function(n,e,t){var o=t(9);n.exports=function(n,e){var t=this.__data__,i=o(t,n);return i<0?(++this.size,t.push([n,e])):t[i][1]=e,this}},function(n,e,t){var o=t(8);n.exports=function(){this.__data__=new o,this.size=0}},function(n,e){n.exports=function(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}},function(n,e){n.exports=function(n){return this.__data__.get(n)}},function(n,e){n.exports=function(n){return this.__data__.has(n)}},function(n,e,t){var o=t(8),i=t(16),r=t(18);n.exports=function(n,e){var t=this.__data__;if(t instanceof o){var s=t.__data__;if(!i||s.length<199)return s.push([n,e]),this.size=++t.size,this;t=this.__data__=new r(s)}return t.set(n,e),this.size=t.size,this}},function(n,e,t){var o=t(30),i=t(72),r=t(17),s=t(31),a=/^\[object .+?Constructor\]$/,l=Function.prototype,d=Object.prototype,c=l.toString,u=d.hasOwnProperty,p=RegExp("^"+c.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");n.exports=function(n){return!(!r(n)||i(n))&&(o(n)?p:a).test(s(n))}},function(n,e,t){var o,i=t(73),r=(o=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+o:"";n.exports=function(n){return!!r&&r in n}},function(n,e,t){var o=t(2)["__core-js_shared__"];n.exports=o},function(n,e){n.exports=function(n,e){return null==n?void 0:n[e]}},function(n,e,t){var o=t(76),i=t(8),r=t(16);n.exports=function(){this.size=0,this.__data__={hash:new o,map:new(r||i),string:new o}}},function(n,e,t){var o=t(77),i=t(78),r=t(79),s=t(80),a=t(81);function l(n){var e=-1,t=null==n?0:n.length;for(this.clear();++e<t;){var o=n[e];this.set(o[0],o[1])}}l.prototype.clear=o,l.prototype.delete=i,l.prototype.get=r,l.prototype.has=s,l.prototype.set=a,n.exports=l},function(n,e,t){var o=t(10);n.exports=function(){this.__data__=o?o(null):{},this.size=0}},function(n,e){n.exports=function(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}},function(n,e,t){var o=t(10),i=Object.prototype.hasOwnProperty;n.exports=function(n){var e=this.__data__;if(o){var t=e[n];return"__lodash_hash_undefined__"===t?void 0:t}return i.call(e,n)?e[n]:void 0}},function(n,e,t){var o=t(10),i=Object.prototype.hasOwnProperty;n.exports=function(n){var e=this.__data__;return o?void 0!==e[n]:i.call(e,n)}},function(n,e,t){var o=t(10);n.exports=function(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=o&&void 0===e?"__lodash_hash_undefined__":e,this}},function(n,e,t){var o=t(11);n.exports=function(n){var e=o(this,n).delete(n);return this.size-=e?1:0,e}},function(n,e){n.exports=function(n){var e=typeof n;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==n:null===n}},function(n,e,t){var o=t(11);n.exports=function(n){return o(this,n).get(n)}},function(n,e,t){var o=t(11);n.exports=function(n){return o(this,n).has(n)}},function(n,e,t){var o=t(11);n.exports=function(n,e){var t=o(this,n),i=t.size;return t.set(n,e),this.size+=t.size==i?0:1,this}},function(n,e,t){var o=t(28),i=t(33),r=t(91),s=t(94),a=t(110),l=t(1),d=t(37),c=t(39),u="[object Object]",p=Object.prototype.hasOwnProperty;n.exports=function(n,e,t,m,f,h){var g=l(n),b=l(e),y=g?"[object Array]":a(n),v=b?"[object Array]":a(e),w=(y="[object Arguments]"==y?u:y)==u,x=(v="[object Arguments]"==v?u:v)==u,k=y==v;if(k&&d(n)){if(!d(e))return!1;g=!0,w=!1}if(k&&!w)return h||(h=new o),g||c(n)?i(n,e,t,m,f,h):r(n,e,y,t,m,f,h);if(!(1&t)){var S=w&&p.call(n,"__wrapped__"),j=x&&p.call(e,"__wrapped__");if(S||j){var T=S?n.value():n,C=j?e.value():e;return h||(h=new o),f(T,C,t,m,h)}}return!!k&&(h||(h=new o),s(n,e,t,m,f,h))}},function(n,e){n.exports=function(n){return this.__data__.set(n,"__lodash_hash_undefined__"),this}},function(n,e){n.exports=function(n){return this.__data__.has(n)}},function(n,e){n.exports=function(n,e){for(var t=-1,o=null==n?0:n.length;++t<o;)if(e(n[t],t,n))return!0;return!1}},function(n,e,t){var o=t(7),i=t(92),r=t(29),s=t(33),a=t(93),l=t(19),d=o?o.prototype:void 0,c=d?d.valueOf:void 0;n.exports=function(n,e,t,o,d,u,p){switch(t){case"[object DataView]":if(n.byteLength!=e.byteLength||n.byteOffset!=e.byteOffset)return!1;n=n.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(n.byteLength!=e.byteLength||!u(new i(n),new i(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return r(+n,+e);case"[object Error]":return n.name==e.name&&n.message==e.message;case"[object RegExp]":case"[object String]":return n==e+"";case"[object Map]":var m=a;case"[object Set]":var f=1&o;if(m||(m=l),n.size!=e.size&&!f)return!1;var h=p.get(n);if(h)return h==e;o|=2,p.set(n,e);var g=s(m(n),m(e),o,d,u,p);return p.delete(n),g;case"[object Symbol]":if(c)return c.call(n)==c.call(e)}return!1}},function(n,e,t){var o=t(2).Uint8Array;n.exports=o},function(n,e){n.exports=function(n){var e=-1,t=Array(n.size);return n.forEach((function(n,o){t[++e]=[o,n]})),t}},function(n,e,t){var o=t(95),i=Object.prototype.hasOwnProperty;n.exports=function(n,e,t,r,s,a){var l=1&t,d=o(n),c=d.length;if(c!=o(e).length&&!l)return!1;for(var u=c;u--;){var p=d[u];if(!(l?p in e:i.call(e,p)))return!1}var m=a.get(n),f=a.get(e);if(m&&f)return m==e&&f==n;var h=!0;a.set(n,e),a.set(e,n);for(var g=l;++u<c;){var b=n[p=d[u]],y=e[p];if(r)var v=l?r(y,b,p,e,n,a):r(b,y,p,n,e,a);if(!(void 0===v?b===y||s(b,y,t,r,a):v)){h=!1;break}g||(g="constructor"==p)}if(h&&!g){var w=n.constructor,x=e.constructor;w==x||!("constructor"in n)||!("constructor"in e)||"function"==typeof w&&w instanceof w&&"function"==typeof x&&x instanceof x||(h=!1)}return a.delete(n),a.delete(e),h}},function(n,e,t){var o=t(96),i=t(97),r=t(36);n.exports=function(n){return o(n,r,i)}},function(n,e,t){var o=t(26),i=t(1);n.exports=function(n,e,t){var r=e(n);return i(n)?r:o(r,t(n))}},function(n,e,t){var o=t(98),i=t(99),r=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(n){return null==n?[]:(n=Object(n),o(s(n),(function(e){return r.call(n,e)})))}:i;n.exports=a},function(n,e){n.exports=function(n,e){for(var t=-1,o=null==n?0:n.length,i=0,r=[];++t<o;){var s=n[t];e(s,t,n)&&(r[i++]=s)}return r}},function(n,e){n.exports=function(){return[]}},function(n,e,t){var o=t(101),i=t(15),r=t(1),s=t(37),a=t(38),l=t(39),d=Object.prototype.hasOwnProperty;n.exports=function(n,e){var t=r(n),c=!t&&i(n),u=!t&&!c&&s(n),p=!t&&!c&&!u&&l(n),m=t||c||u||p,f=m?o(n.length,String):[],h=f.length;for(var g in n)!e&&!d.call(n,g)||m&&("length"==g||u&&("offset"==g||"parent"==g)||p&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||a(g,h))||f.push(g);return f}},function(n,e){n.exports=function(n,e){for(var t=-1,o=Array(n);++t<n;)o[t]=e(t);return o}},function(n,e){n.exports=function(){return!1}},function(n,e,t){var o=t(6),i=t(20),r=t(5),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,n.exports=function(n){return r(n)&&i(n.length)&&!!s[o(n)]}},function(n,e){n.exports=function(n){return function(e){return n(e)}}},function(n,e,t){(function(n){var o=t(27),i=e&&!e.nodeType&&e,r=i&&"object"==typeof n&&n&&!n.nodeType&&n,s=r&&r.exports===i&&o.process,a=function(){try{var n=r&&r.require&&r.require("util").types;return n||s&&s.binding&&s.binding("util")}catch(n){}}();n.exports=a}).call(this,t(25)(n))},function(n,e,t){var o=t(107),i=t(108),r=Object.prototype.hasOwnProperty;n.exports=function(n){if(!o(n))return i(n);var e=[];for(var t in Object(n))r.call(n,t)&&"constructor"!=t&&e.push(t);return e}},function(n,e){var t=Object.prototype;n.exports=function(n){var e=n&&n.constructor;return n===("function"==typeof e&&e.prototype||t)}},function(n,e,t){var o=t(109)(Object.keys,Object);n.exports=o},function(n,e){n.exports=function(n,e){return function(t){return n(e(t))}}},function(n,e,t){var o=t(111),i=t(16),r=t(112),s=t(41),a=t(113),l=t(6),d=t(31),c=d(o),u=d(i),p=d(r),m=d(s),f=d(a),h=l;(o&&"[object DataView]"!=h(new o(new ArrayBuffer(1)))||i&&"[object Map]"!=h(new i)||r&&"[object Promise]"!=h(r.resolve())||s&&"[object Set]"!=h(new s)||a&&"[object WeakMap]"!=h(new a))&&(h=function(n){var e=l(n),t="[object Object]"==e?n.constructor:void 0,o=t?d(t):"";if(o)switch(o){case c:return"[object DataView]";case u:return"[object Map]";case p:return"[object Promise]";case m:return"[object Set]";case f:return"[object WeakMap]"}return e}),n.exports=h},function(n,e,t){var o=t(3)(t(2),"DataView");n.exports=o},function(n,e,t){var o=t(3)(t(2),"Promise");n.exports=o},function(n,e,t){var o=t(3)(t(2),"WeakMap");n.exports=o},function(n,e,t){var o=t(42),i=t(36);n.exports=function(n){for(var e=i(n),t=e.length;t--;){var r=e[t],s=n[r];e[t]=[r,s,o(s)]}return e}},function(n,e,t){var o=t(32),i=t(116),r=t(123),s=t(21),a=t(42),l=t(43),d=t(12);n.exports=function(n,e){return s(n)&&a(e)?l(d(n),e):function(t){var s=i(t,n);return void 0===s&&s===e?r(t,n):o(e,s,3)}}},function(n,e,t){var o=t(44);n.exports=function(n,e,t){var i=null==n?void 0:o(n,e);return void 0===i?t:i}},function(n,e,t){var o=t(118),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,s=o((function(n){var e=[];return 46===n.charCodeAt(0)&&e.push(""),n.replace(i,(function(n,t,o,i){e.push(o?i.replace(r,"$1"):t||n)})),e}));n.exports=s},function(n,e,t){var o=t(119);n.exports=function(n){var e=o(n,(function(n){return 500===t.size&&t.clear(),n})),t=e.cache;return e}},function(n,e,t){var o=t(18);function i(n,e){if("function"!=typeof n||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var t=function(){var o=arguments,i=e?e.apply(this,o):o[0],r=t.cache;if(r.has(i))return r.get(i);var s=n.apply(this,o);return t.cache=r.set(i,s)||r,s};return t.cache=new(i.Cache||o),t}i.Cache=o,n.exports=i},function(n,e,t){var o=t(121);n.exports=function(n){return null==n?"":o(n)}},function(n,e,t){var o=t(7),i=t(122),r=t(1),s=t(22),a=o?o.prototype:void 0,l=a?a.toString:void 0;n.exports=function n(e){if("string"==typeof e)return e;if(r(e))return i(e,n)+"";if(s(e))return l?l.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},function(n,e){n.exports=function(n,e){for(var t=-1,o=null==n?0:n.length,i=Array(o);++t<o;)i[t]=e(n[t],t,n);return i}},function(n,e,t){var o=t(124),i=t(125);n.exports=function(n,e){return null!=n&&i(n,e,o)}},function(n,e){n.exports=function(n,e){return null!=n&&e in Object(n)}},function(n,e,t){var o=t(45),i=t(15),r=t(1),s=t(38),a=t(20),l=t(12);n.exports=function(n,e,t){for(var d=-1,c=(e=o(e,n)).length,u=!1;++d<c;){var p=l(e[d]);if(!(u=null!=n&&t(n,p)))break;n=n[p]}return u||++d!=c?u:!!(c=null==n?0:n.length)&&a(c)&&s(p,c)&&(r(n)||i(n))}},function(n,e,t){var o=t(127),i=t(128),r=t(21),s=t(12);n.exports=function(n){return r(n)?o(s(n)):i(n)}},function(n,e){n.exports=function(n){return function(e){return null==e?void 0:e[n]}}},function(n,e,t){var o=t(44);n.exports=function(n){return function(e){return o(e,n)}}},function(n,e,t){var o=t(23),i=t(130),r=t(132);n.exports=function(n,e){return r(i(n,e,o),n+"")}},function(n,e,t){var o=t(131),i=Math.max;n.exports=function(n,e,t){return e=i(void 0===e?n.length-1:e,0),function(){for(var r=arguments,s=-1,a=i(r.length-e,0),l=Array(a);++s<a;)l[s]=r[e+s];s=-1;for(var d=Array(e+1);++s<e;)d[s]=r[s];return d[e]=t(l),o(n,this,d)}}},function(n,e){n.exports=function(n,e,t){switch(t.length){case 0:return n.call(e);case 1:return n.call(e,t[0]);case 2:return n.call(e,t[0],t[1]);case 3:return n.call(e,t[0],t[1],t[2])}return n.apply(e,t)}},function(n,e,t){var o=t(133),i=t(136)(o);n.exports=i},function(n,e,t){var o=t(134),i=t(135),r=t(23),s=i?function(n,e){return i(n,"toString",{configurable:!0,enumerable:!1,value:o(e),writable:!0})}:r;n.exports=s},function(n,e){n.exports=function(n){return function(){return n}}},function(n,e,t){var o=t(3),i=function(){try{var n=o(Object,"defineProperty");return n({},"",{}),n}catch(n){}}();n.exports=i},function(n,e){var t=Date.now;n.exports=function(n){var e=0,o=0;return function(){var i=t(),r=16-(i-o);if(o=i,r>0){if(++e>=800)return arguments[0]}else e=0;return n.apply(void 0,arguments)}}},function(n,e,t){var o=t(34),i=t(138),r=t(143),s=t(35),a=t(144),l=t(19);n.exports=function(n,e,t){var d=-1,c=i,u=n.length,p=!0,m=[],f=m;if(t)p=!1,c=r;else if(u>=200){var h=e?null:a(n);if(h)return l(h);p=!1,c=s,f=new o}else f=e?[]:m;n:for(;++d<u;){var g=n[d],b=e?e(g):g;if(g=t||0!==g?g:0,p&&b==b){for(var y=f.length;y--;)if(f[y]===b)continue n;e&&f.push(b),m.push(g)}else c(f,b,t)||(f!==m&&f.push(b),m.push(g))}return m}},function(n,e,t){var o=t(139);n.exports=function(n,e){return!!(null==n?0:n.length)&&o(n,e,0)>-1}},function(n,e,t){var o=t(140),i=t(141),r=t(142);n.exports=function(n,e,t){return e==e?r(n,e,t):o(n,i,t)}},function(n,e){n.exports=function(n,e,t,o){for(var i=n.length,r=t+(o?1:-1);o?r--:++r<i;)if(e(n[r],r,n))return r;return-1}},function(n,e){n.exports=function(n){return n!=n}},function(n,e){n.exports=function(n,e,t){for(var o=t-1,i=n.length;++o<i;)if(n[o]===e)return o;return-1}},function(n,e){n.exports=function(n,e,t){for(var o=-1,i=null==n?0:n.length;++o<i;)if(t(e,n[o]))return!0;return!1}},function(n,e,t){var o=t(41),i=t(145),r=t(19),s=o&&1/r(new o([,-0]))[1]==1/0?function(n){return new o(n)}:i;n.exports=s},function(n,e){n.exports=function(){}},function(n,e,t){var o=t(40),i=t(5);n.exports=function(n){return i(n)&&o(n)}},function(n,e,t){},function(n,e,t){},function(n,e,t){},function(n,e,t){},function(n,e,t){"use strict";t(46)},function(n,e,t){"use strict";t(47)},function(n,e,t){"use strict";t(48)},function(n,e,t){"use strict";t.r(e);var o=t(0);
/*!
  * vue-router v3.6.5
  * (c) 2022 Evan You
  * @license MIT
  */function i(n,e){for(var t in e)n[t]=e[t];return n}var r=/[!'()*]/g,s=function(n){return"%"+n.charCodeAt(0).toString(16)},a=/%2C/g,l=function(n){return encodeURIComponent(n).replace(r,s).replace(a,",")};function d(n){try{return decodeURIComponent(n)}catch(n){0}return n}var c=function(n){return null==n||"object"==typeof n?n:String(n)};function u(n){var e={};return(n=n.trim().replace(/^(\?|#|&)/,""))?(n.split("&").forEach((function(n){var t=n.replace(/\+/g," ").split("="),o=d(t.shift()),i=t.length>0?d(t.join("=")):null;void 0===e[o]?e[o]=i:Array.isArray(e[o])?e[o].push(i):e[o]=[e[o],i]})),e):e}function p(n){var e=n?Object.keys(n).map((function(e){var t=n[e];if(void 0===t)return"";if(null===t)return l(e);if(Array.isArray(t)){var o=[];return t.forEach((function(n){void 0!==n&&(null===n?o.push(l(e)):o.push(l(e)+"="+l(n)))})),o.join("&")}return l(e)+"="+l(t)})).filter((function(n){return n.length>0})).join("&"):null;return e?"?"+e:""}var m=/\/?$/;function f(n,e,t,o){var i=o&&o.options.stringifyQuery,r=e.query||{};try{r=h(r)}catch(n){}var s={name:e.name||n&&n.name,meta:n&&n.meta||{},path:e.path||"/",hash:e.hash||"",query:r,params:e.params||{},fullPath:y(e,i),matched:n?b(n):[]};return t&&(s.redirectedFrom=y(t,i)),Object.freeze(s)}function h(n){if(Array.isArray(n))return n.map(h);if(n&&"object"==typeof n){var e={};for(var t in n)e[t]=h(n[t]);return e}return n}var g=f(null,{path:"/"});function b(n){for(var e=[];n;)e.unshift(n),n=n.parent;return e}function y(n,e){var t=n.path,o=n.query;void 0===o&&(o={});var i=n.hash;return void 0===i&&(i=""),(t||"/")+(e||p)(o)+i}function v(n,e,t){return e===g?n===e:!!e&&(n.path&&e.path?n.path.replace(m,"")===e.path.replace(m,"")&&(t||n.hash===e.hash&&w(n.query,e.query)):!(!n.name||!e.name)&&(n.name===e.name&&(t||n.hash===e.hash&&w(n.query,e.query)&&w(n.params,e.params))))}function w(n,e){if(void 0===n&&(n={}),void 0===e&&(e={}),!n||!e)return n===e;var t=Object.keys(n).sort(),o=Object.keys(e).sort();return t.length===o.length&&t.every((function(t,i){var r=n[t];if(o[i]!==t)return!1;var s=e[t];return null==r||null==s?r===s:"object"==typeof r&&"object"==typeof s?w(r,s):String(r)===String(s)}))}function x(n){for(var e=0;e<n.matched.length;e++){var t=n.matched[e];for(var o in t.instances){var i=t.instances[o],r=t.enteredCbs[o];if(i&&r){delete t.enteredCbs[o];for(var s=0;s<r.length;s++)i._isBeingDestroyed||r[s](i)}}}}var k={name:"RouterView",functional:!0,props:{name:{type:String,default:"default"}},render:function(n,e){var t=e.props,o=e.children,r=e.parent,s=e.data;s.routerView=!0;for(var a=r.$createElement,l=t.name,d=r.$route,c=r._routerViewCache||(r._routerViewCache={}),u=0,p=!1;r&&r._routerRoot!==r;){var m=r.$vnode?r.$vnode.data:{};m.routerView&&u++,m.keepAlive&&r._directInactive&&r._inactive&&(p=!0),r=r.$parent}if(s.routerViewDepth=u,p){var f=c[l],h=f&&f.component;return h?(f.configProps&&S(h,s,f.route,f.configProps),a(h,s,o)):a()}var g=d.matched[u],b=g&&g.components[l];if(!g||!b)return c[l]=null,a();c[l]={component:b},s.registerRouteInstance=function(n,e){var t=g.instances[l];(e&&t!==n||!e&&t===n)&&(g.instances[l]=e)},(s.hook||(s.hook={})).prepatch=function(n,e){g.instances[l]=e.componentInstance},s.hook.init=function(n){n.data.keepAlive&&n.componentInstance&&n.componentInstance!==g.instances[l]&&(g.instances[l]=n.componentInstance),x(d)};var y=g.props&&g.props[l];return y&&(i(c[l],{route:d,configProps:y}),S(b,s,d,y)),a(b,s,o)}};function S(n,e,t,o){var r=e.props=function(n,e){switch(typeof e){case"undefined":return;case"object":return e;case"function":return e(n);case"boolean":return e?n.params:void 0;default:0}}(t,o);if(r){r=e.props=i({},r);var s=e.attrs=e.attrs||{};for(var a in r)n.props&&a in n.props||(s[a]=r[a],delete r[a])}}function j(n,e,t){var o=n.charAt(0);if("/"===o)return n;if("?"===o||"#"===o)return e+n;var i=e.split("/");t&&i[i.length-1]||i.pop();for(var r=n.replace(/^\//,"").split("/"),s=0;s<r.length;s++){var a=r[s];".."===a?i.pop():"."!==a&&i.push(a)}return""!==i[0]&&i.unshift(""),i.join("/")}function T(n){return n.replace(/\/(?:\s*\/)+/g,"/")}var C=Array.isArray||function(n){return"[object Array]"==Object.prototype.toString.call(n)},z=W,P=M,I=function(n,e){return D(M(n,e),e)},B=D,E=U,_=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function M(n,e){for(var t,o=[],i=0,r=0,s="",a=e&&e.delimiter||"/";null!=(t=_.exec(n));){var l=t[0],d=t[1],c=t.index;if(s+=n.slice(r,c),r=c+l.length,d)s+=d[1];else{var u=n[r],p=t[2],m=t[3],f=t[4],h=t[5],g=t[6],b=t[7];s&&(o.push(s),s="");var y=null!=p&&null!=u&&u!==p,v="+"===g||"*"===g,w="?"===g||"*"===g,x=t[2]||a,k=f||h;o.push({name:m||i++,prefix:p||"",delimiter:x,optional:w,repeat:v,partial:y,asterisk:!!b,pattern:k?A(k):b?".*":"[^"+L(x)+"]+?"})}}return r<n.length&&(s+=n.substr(r)),s&&o.push(s),o}function O(n){return encodeURI(n).replace(/[\/?#]/g,(function(n){return"%"+n.charCodeAt(0).toString(16).toUpperCase()}))}function D(n,e){for(var t=new Array(n.length),o=0;o<n.length;o++)"object"==typeof n[o]&&(t[o]=new RegExp("^(?:"+n[o].pattern+")$",N(e)));return function(e,o){for(var i="",r=e||{},s=(o||{}).pretty?O:encodeURIComponent,a=0;a<n.length;a++){var l=n[a];if("string"!=typeof l){var d,c=r[l.name];if(null==c){if(l.optional){l.partial&&(i+=l.prefix);continue}throw new TypeError('Expected "'+l.name+'" to be defined')}if(C(c)){if(!l.repeat)throw new TypeError('Expected "'+l.name+'" to not repeat, but received `'+JSON.stringify(c)+"`");if(0===c.length){if(l.optional)continue;throw new TypeError('Expected "'+l.name+'" to not be empty')}for(var u=0;u<c.length;u++){if(d=s(c[u]),!t[a].test(d))throw new TypeError('Expected all "'+l.name+'" to match "'+l.pattern+'", but received `'+JSON.stringify(d)+"`");i+=(0===u?l.prefix:l.delimiter)+d}}else{if(d=l.asterisk?encodeURI(c).replace(/[?#]/g,(function(n){return"%"+n.charCodeAt(0).toString(16).toUpperCase()})):s(c),!t[a].test(d))throw new TypeError('Expected "'+l.name+'" to match "'+l.pattern+'", but received "'+d+'"');i+=l.prefix+d}}else i+=l}return i}}function L(n){return n.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function A(n){return n.replace(/([=!:$\/()])/g,"\\$1")}function R(n,e){return n.keys=e,n}function N(n){return n&&n.sensitive?"":"i"}function U(n,e,t){C(e)||(t=e||t,e=[]);for(var o=(t=t||{}).strict,i=!1!==t.end,r="",s=0;s<n.length;s++){var a=n[s];if("string"==typeof a)r+=L(a);else{var l=L(a.prefix),d="(?:"+a.pattern+")";e.push(a),a.repeat&&(d+="(?:"+l+d+")*"),r+=d=a.optional?a.partial?l+"("+d+")?":"(?:"+l+"("+d+"))?":l+"("+d+")"}}var c=L(t.delimiter||"/"),u=r.slice(-c.length)===c;return o||(r=(u?r.slice(0,-c.length):r)+"(?:"+c+"(?=$))?"),r+=i?"$":o&&u?"":"(?="+c+"|$)",R(new RegExp("^"+r,N(t)),e)}function W(n,e,t){return C(e)||(t=e||t,e=[]),t=t||{},n instanceof RegExp?function(n,e){var t=n.source.match(/\((?!\?)/g);if(t)for(var o=0;o<t.length;o++)e.push({name:o,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return R(n,e)}(n,e):C(n)?function(n,e,t){for(var o=[],i=0;i<n.length;i++)o.push(W(n[i],e,t).source);return R(new RegExp("(?:"+o.join("|")+")",N(t)),e)}(n,e,t):function(n,e,t){return U(M(n,t),e,t)}(n,e,t)}z.parse=P,z.compile=I,z.tokensToFunction=B,z.tokensToRegExp=E;var F=Object.create(null);function H(n,e,t){e=e||{};try{var o=F[n]||(F[n]=z.compile(n));return"string"==typeof e.pathMatch&&(e[0]=e.pathMatch),o(e,{pretty:!0})}catch(n){return""}finally{delete e[0]}}function q(n,e,t,o){var r="string"==typeof n?{path:n}:n;if(r._normalized)return r;if(r.name){var s=(r=i({},n)).params;return s&&"object"==typeof s&&(r.params=i({},s)),r}if(!r.path&&r.params&&e){(r=i({},r))._normalized=!0;var a=i(i({},e.params),r.params);if(e.name)r.name=e.name,r.params=a;else if(e.matched.length){var l=e.matched[e.matched.length-1].path;r.path=H(l,a,e.path)}else 0;return r}var d=function(n){var e="",t="",o=n.indexOf("#");o>=0&&(e=n.slice(o),n=n.slice(0,o));var i=n.indexOf("?");return i>=0&&(t=n.slice(i+1),n=n.slice(0,i)),{path:n,query:t,hash:e}}(r.path||""),p=e&&e.path||"/",m=d.path?j(d.path,p,t||r.append):p,f=function(n,e,t){void 0===e&&(e={});var o,i=t||u;try{o=i(n||"")}catch(n){o={}}for(var r in e){var s=e[r];o[r]=Array.isArray(s)?s.map(c):c(s)}return o}(d.query,r.query,o&&o.options.parseQuery),h=r.hash||d.hash;return h&&"#"!==h.charAt(0)&&(h="#"+h),{_normalized:!0,path:m,query:f,hash:h}}var $,J=function(){},G={name:"RouterLink",props:{to:{type:[String,Object],required:!0},tag:{type:String,default:"a"},custom:Boolean,exact:Boolean,exactPath:Boolean,append:Boolean,replace:Boolean,activeClass:String,exactActiveClass:String,ariaCurrentValue:{type:String,default:"page"},event:{type:[String,Array],default:"click"}},render:function(n){var e=this,t=this.$router,o=this.$route,r=t.resolve(this.to,o,this.append),s=r.location,a=r.route,l=r.href,d={},c=t.options.linkActiveClass,u=t.options.linkExactActiveClass,p=null==c?"router-link-active":c,h=null==u?"router-link-exact-active":u,g=null==this.activeClass?p:this.activeClass,b=null==this.exactActiveClass?h:this.exactActiveClass,y=a.redirectedFrom?f(null,q(a.redirectedFrom),null,t):a;d[b]=v(o,y,this.exactPath),d[g]=this.exact||this.exactPath?d[b]:function(n,e){return 0===n.path.replace(m,"/").indexOf(e.path.replace(m,"/"))&&(!e.hash||n.hash===e.hash)&&function(n,e){for(var t in e)if(!(t in n))return!1;return!0}(n.query,e.query)}(o,y);var w=d[b]?this.ariaCurrentValue:null,x=function(n){V(n)&&(e.replace?t.replace(s,J):t.push(s,J))},k={click:V};Array.isArray(this.event)?this.event.forEach((function(n){k[n]=x})):k[this.event]=x;var S={class:d},j=!this.$scopedSlots.$hasNormal&&this.$scopedSlots.default&&this.$scopedSlots.default({href:l,route:a,navigate:x,isActive:d[g],isExactActive:d[b]});if(j){if(1===j.length)return j[0];if(j.length>1||!j.length)return 0===j.length?n():n("span",{},j)}if("a"===this.tag)S.on=k,S.attrs={href:l,"aria-current":w};else{var T=function n(e){var t;if(e)for(var o=0;o<e.length;o++){if("a"===(t=e[o]).tag)return t;if(t.children&&(t=n(t.children)))return t}}(this.$slots.default);if(T){T.isStatic=!1;var C=T.data=i({},T.data);for(var z in C.on=C.on||{},C.on){var P=C.on[z];z in k&&(C.on[z]=Array.isArray(P)?P:[P])}for(var I in k)I in C.on?C.on[I].push(k[I]):C.on[I]=x;var B=T.data.attrs=i({},T.data.attrs);B.href=l,B["aria-current"]=w}else S.on=k}return n(this.tag,S,this.$slots.default)}};function V(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey||n.defaultPrevented||void 0!==n.button&&0!==n.button)){if(n.currentTarget&&n.currentTarget.getAttribute){var e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}var Y="undefined"!=typeof window;function K(n,e,t,o,i){var r=e||[],s=t||Object.create(null),a=o||Object.create(null);n.forEach((function(n){!function n(e,t,o,i,r,s){var a=i.path,l=i.name;0;var d=i.pathToRegexpOptions||{},c=function(n,e,t){t||(n=n.replace(/\/$/,""));if("/"===n[0])return n;if(null==e)return n;return T(e.path+"/"+n)}(a,r,d.strict);"boolean"==typeof i.caseSensitive&&(d.sensitive=i.caseSensitive);var u={path:c,regex:X(c,d),components:i.components||{default:i.component},alias:i.alias?"string"==typeof i.alias?[i.alias]:i.alias:[],instances:{},enteredCbs:{},name:l,parent:r,matchAs:s,redirect:i.redirect,beforeEnter:i.beforeEnter,meta:i.meta||{},props:null==i.props?{}:i.components?i.props:{default:i.props}};i.children&&i.children.forEach((function(i){var r=s?T(s+"/"+i.path):void 0;n(e,t,o,i,u,r)}));t[u.path]||(e.push(u.path),t[u.path]=u);if(void 0!==i.alias)for(var p=Array.isArray(i.alias)?i.alias:[i.alias],m=0;m<p.length;++m){0;var f={path:p[m],children:i.children};n(e,t,o,f,r,u.path||"/")}l&&(o[l]||(o[l]=u))}(r,s,a,n,i)}));for(var l=0,d=r.length;l<d;l++)"*"===r[l]&&(r.push(r.splice(l,1)[0]),d--,l--);return{pathList:r,pathMap:s,nameMap:a}}function X(n,e){return z(n,[],e)}function Z(n,e){var t=K(n),o=t.pathList,i=t.pathMap,r=t.nameMap;function s(n,t,s){var a=q(n,t,!1,e),d=a.name;if(d){var c=r[d];if(!c)return l(null,a);var u=c.regex.keys.filter((function(n){return!n.optional})).map((function(n){return n.name}));if("object"!=typeof a.params&&(a.params={}),t&&"object"==typeof t.params)for(var p in t.params)!(p in a.params)&&u.indexOf(p)>-1&&(a.params[p]=t.params[p]);return a.path=H(c.path,a.params),l(c,a,s)}if(a.path){a.params={};for(var m=0;m<o.length;m++){var f=o[m],h=i[f];if(Q(h.regex,a.path,a.params))return l(h,a,s)}}return l(null,a)}function a(n,t){var o=n.redirect,i="function"==typeof o?o(f(n,t,null,e)):o;if("string"==typeof i&&(i={path:i}),!i||"object"!=typeof i)return l(null,t);var a=i,d=a.name,c=a.path,u=t.query,p=t.hash,m=t.params;if(u=a.hasOwnProperty("query")?a.query:u,p=a.hasOwnProperty("hash")?a.hash:p,m=a.hasOwnProperty("params")?a.params:m,d){r[d];return s({_normalized:!0,name:d,query:u,hash:p,params:m},void 0,t)}if(c){var h=function(n,e){return j(n,e.parent?e.parent.path:"/",!0)}(c,n);return s({_normalized:!0,path:H(h,m),query:u,hash:p},void 0,t)}return l(null,t)}function l(n,t,o){return n&&n.redirect?a(n,o||t):n&&n.matchAs?function(n,e,t){var o=s({_normalized:!0,path:H(t,e.params)});if(o){var i=o.matched,r=i[i.length-1];return e.params=o.params,l(r,e)}return l(null,e)}(0,t,n.matchAs):f(n,t,o,e)}return{match:s,addRoute:function(n,e){var t="object"!=typeof n?r[n]:void 0;K([e||n],o,i,r,t),t&&t.alias.length&&K(t.alias.map((function(n){return{path:n,children:[e]}})),o,i,r,t)},getRoutes:function(){return o.map((function(n){return i[n]}))},addRoutes:function(n){K(n,o,i,r)}}}function Q(n,e,t){var o=e.match(n);if(!o)return!1;if(!t)return!0;for(var i=1,r=o.length;i<r;++i){var s=n.keys[i-1];s&&(t[s.name||"pathMatch"]="string"==typeof o[i]?d(o[i]):o[i])}return!0}var nn=Y&&window.performance&&window.performance.now?window.performance:Date;function en(){return nn.now().toFixed(3)}var tn=en();function on(){return tn}function rn(n){return tn=n}var sn=Object.create(null);function an(){"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual");var n=window.location.protocol+"//"+window.location.host,e=window.location.href.replace(n,""),t=i({},window.history.state);return t.key=on(),window.history.replaceState(t,"",e),window.addEventListener("popstate",cn),function(){window.removeEventListener("popstate",cn)}}function ln(n,e,t,o){if(n.app){var i=n.options.scrollBehavior;i&&n.app.$nextTick((function(){var r=function(){var n=on();if(n)return sn[n]}(),s=i.call(n,e,t,o?r:null);s&&("function"==typeof s.then?s.then((function(n){hn(n,r)})).catch((function(n){0})):hn(s,r))}))}}function dn(){var n=on();n&&(sn[n]={x:window.pageXOffset,y:window.pageYOffset})}function cn(n){dn(),n.state&&n.state.key&&rn(n.state.key)}function un(n){return mn(n.x)||mn(n.y)}function pn(n){return{x:mn(n.x)?n.x:window.pageXOffset,y:mn(n.y)?n.y:window.pageYOffset}}function mn(n){return"number"==typeof n}var fn=/^#\d/;function hn(n,e){var t,o="object"==typeof n;if(o&&"string"==typeof n.selector){var i=fn.test(n.selector)?document.getElementById(n.selector.slice(1)):document.querySelector(n.selector);if(i){var r=n.offset&&"object"==typeof n.offset?n.offset:{};e=function(n,e){var t=document.documentElement.getBoundingClientRect(),o=n.getBoundingClientRect();return{x:o.left-t.left-e.x,y:o.top-t.top-e.y}}(i,r={x:mn((t=r).x)?t.x:0,y:mn(t.y)?t.y:0})}else un(n)&&(e=pn(n))}else o&&un(n)&&(e=pn(n));e&&("scrollBehavior"in document.documentElement.style?window.scrollTo({left:e.x,top:e.y,behavior:n.behavior}):window.scrollTo(e.x,e.y))}var gn,bn=Y&&((-1===(gn=window.navigator.userAgent).indexOf("Android 2.")&&-1===gn.indexOf("Android 4.0")||-1===gn.indexOf("Mobile Safari")||-1!==gn.indexOf("Chrome")||-1!==gn.indexOf("Windows Phone"))&&window.history&&"function"==typeof window.history.pushState);function yn(n,e){dn();var t=window.history;try{if(e){var o=i({},t.state);o.key=on(),t.replaceState(o,"",n)}else t.pushState({key:rn(en())},"",n)}catch(t){window.location[e?"replace":"assign"](n)}}function vn(n){yn(n,!0)}var wn={redirected:2,aborted:4,cancelled:8,duplicated:16};function xn(n,e){return Sn(n,e,wn.redirected,'Redirected when going from "'+n.fullPath+'" to "'+function(n){if("string"==typeof n)return n;if("path"in n)return n.path;var e={};return jn.forEach((function(t){t in n&&(e[t]=n[t])})),JSON.stringify(e,null,2)}(e)+'" via a navigation guard.')}function kn(n,e){return Sn(n,e,wn.cancelled,'Navigation cancelled from "'+n.fullPath+'" to "'+e.fullPath+'" with a new navigation.')}function Sn(n,e,t,o){var i=new Error(o);return i._isRouter=!0,i.from=n,i.to=e,i.type=t,i}var jn=["params","query","hash"];function Tn(n){return Object.prototype.toString.call(n).indexOf("Error")>-1}function Cn(n,e){return Tn(n)&&n._isRouter&&(null==e||n.type===e)}function zn(n,e,t){var o=function(i){i>=n.length?t():n[i]?e(n[i],(function(){o(i+1)})):o(i+1)};o(0)}function Pn(n){return function(e,t,o){var i=!1,r=0,s=null;In(n,(function(n,e,t,a){if("function"==typeof n&&void 0===n.cid){i=!0,r++;var l,d=_n((function(e){var i;((i=e).__esModule||En&&"Module"===i[Symbol.toStringTag])&&(e=e.default),n.resolved="function"==typeof e?e:$.extend(e),t.components[a]=e,--r<=0&&o()})),c=_n((function(n){var e="Failed to resolve async component "+a+": "+n;s||(s=Tn(n)?n:new Error(e),o(s))}));try{l=n(d,c)}catch(n){c(n)}if(l)if("function"==typeof l.then)l.then(d,c);else{var u=l.component;u&&"function"==typeof u.then&&u.then(d,c)}}})),i||o()}}function In(n,e){return Bn(n.map((function(n){return Object.keys(n.components).map((function(t){return e(n.components[t],n.instances[t],n,t)}))})))}function Bn(n){return Array.prototype.concat.apply([],n)}var En="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;function _n(n){var e=!1;return function(){for(var t=[],o=arguments.length;o--;)t[o]=arguments[o];if(!e)return e=!0,n.apply(this,t)}}var Mn=function(n,e){this.router=n,this.base=function(n){if(!n)if(Y){var e=document.querySelector("base");n=(n=e&&e.getAttribute("href")||"/").replace(/^https?:\/\/[^\/]+/,"")}else n="/";"/"!==n.charAt(0)&&(n="/"+n);return n.replace(/\/$/,"")}(e),this.current=g,this.pending=null,this.ready=!1,this.readyCbs=[],this.readyErrorCbs=[],this.errorCbs=[],this.listeners=[]};function On(n,e,t,o){var i=In(n,(function(n,o,i,r){var s=function(n,e){"function"!=typeof n&&(n=$.extend(n));return n.options[e]}(n,e);if(s)return Array.isArray(s)?s.map((function(n){return t(n,o,i,r)})):t(s,o,i,r)}));return Bn(o?i.reverse():i)}function Dn(n,e){if(e)return function(){return n.apply(e,arguments)}}Mn.prototype.listen=function(n){this.cb=n},Mn.prototype.onReady=function(n,e){this.ready?n():(this.readyCbs.push(n),e&&this.readyErrorCbs.push(e))},Mn.prototype.onError=function(n){this.errorCbs.push(n)},Mn.prototype.transitionTo=function(n,e,t){var o,i=this;try{o=this.router.match(n,this.current)}catch(n){throw this.errorCbs.forEach((function(e){e(n)})),n}var r=this.current;this.confirmTransition(o,(function(){i.updateRoute(o),e&&e(o),i.ensureURL(),i.router.afterHooks.forEach((function(n){n&&n(o,r)})),i.ready||(i.ready=!0,i.readyCbs.forEach((function(n){n(o)})))}),(function(n){t&&t(n),n&&!i.ready&&(Cn(n,wn.redirected)&&r===g||(i.ready=!0,i.readyErrorCbs.forEach((function(e){e(n)}))))}))},Mn.prototype.confirmTransition=function(n,e,t){var o=this,i=this.current;this.pending=n;var r,s,a=function(n){!Cn(n)&&Tn(n)&&(o.errorCbs.length?o.errorCbs.forEach((function(e){e(n)})):console.error(n)),t&&t(n)},l=n.matched.length-1,d=i.matched.length-1;if(v(n,i)&&l===d&&n.matched[l]===i.matched[d])return this.ensureURL(),n.hash&&ln(this.router,i,n,!1),a(((s=Sn(r=i,n,wn.duplicated,'Avoided redundant navigation to current location: "'+r.fullPath+'".')).name="NavigationDuplicated",s));var c=function(n,e){var t,o=Math.max(n.length,e.length);for(t=0;t<o&&n[t]===e[t];t++);return{updated:e.slice(0,t),activated:e.slice(t),deactivated:n.slice(t)}}(this.current.matched,n.matched),u=c.updated,p=c.deactivated,m=c.activated,f=[].concat(function(n){return On(n,"beforeRouteLeave",Dn,!0)}(p),this.router.beforeHooks,function(n){return On(n,"beforeRouteUpdate",Dn)}(u),m.map((function(n){return n.beforeEnter})),Pn(m)),h=function(e,t){if(o.pending!==n)return a(kn(i,n));try{e(n,i,(function(e){!1===e?(o.ensureURL(!0),a(function(n,e){return Sn(n,e,wn.aborted,'Navigation aborted from "'+n.fullPath+'" to "'+e.fullPath+'" via a navigation guard.')}(i,n))):Tn(e)?(o.ensureURL(!0),a(e)):"string"==typeof e||"object"==typeof e&&("string"==typeof e.path||"string"==typeof e.name)?(a(xn(i,n)),"object"==typeof e&&e.replace?o.replace(e):o.push(e)):t(e)}))}catch(n){a(n)}};zn(f,h,(function(){zn(function(n){return On(n,"beforeRouteEnter",(function(n,e,t,o){return function(n,e,t){return function(o,i,r){return n(o,i,(function(n){"function"==typeof n&&(e.enteredCbs[t]||(e.enteredCbs[t]=[]),e.enteredCbs[t].push(n)),r(n)}))}}(n,t,o)}))}(m).concat(o.router.resolveHooks),h,(function(){if(o.pending!==n)return a(kn(i,n));o.pending=null,e(n),o.router.app&&o.router.app.$nextTick((function(){x(n)}))}))}))},Mn.prototype.updateRoute=function(n){this.current=n,this.cb&&this.cb(n)},Mn.prototype.setupListeners=function(){},Mn.prototype.teardown=function(){this.listeners.forEach((function(n){n()})),this.listeners=[],this.current=g,this.pending=null};var Ln=function(n){function e(e,t){n.call(this,e,t),this._startLocation=An(this.base)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.setupListeners=function(){var n=this;if(!(this.listeners.length>0)){var e=this.router,t=e.options.scrollBehavior,o=bn&&t;o&&this.listeners.push(an());var i=function(){var t=n.current,i=An(n.base);n.current===g&&i===n._startLocation||n.transitionTo(i,(function(n){o&&ln(e,n,t,!0)}))};window.addEventListener("popstate",i),this.listeners.push((function(){window.removeEventListener("popstate",i)}))}},e.prototype.go=function(n){window.history.go(n)},e.prototype.push=function(n,e,t){var o=this,i=this.current;this.transitionTo(n,(function(n){yn(T(o.base+n.fullPath)),ln(o.router,n,i,!1),e&&e(n)}),t)},e.prototype.replace=function(n,e,t){var o=this,i=this.current;this.transitionTo(n,(function(n){vn(T(o.base+n.fullPath)),ln(o.router,n,i,!1),e&&e(n)}),t)},e.prototype.ensureURL=function(n){if(An(this.base)!==this.current.fullPath){var e=T(this.base+this.current.fullPath);n?yn(e):vn(e)}},e.prototype.getCurrentLocation=function(){return An(this.base)},e}(Mn);function An(n){var e=window.location.pathname,t=e.toLowerCase(),o=n.toLowerCase();return!n||t!==o&&0!==t.indexOf(T(o+"/"))||(e=e.slice(n.length)),(e||"/")+window.location.search+window.location.hash}var Rn=function(n){function e(e,t,o){n.call(this,e,t),o&&function(n){var e=An(n);if(!/^\/#/.test(e))return window.location.replace(T(n+"/#"+e)),!0}(this.base)||Nn()}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.setupListeners=function(){var n=this;if(!(this.listeners.length>0)){var e=this.router.options.scrollBehavior,t=bn&&e;t&&this.listeners.push(an());var o=function(){var e=n.current;Nn()&&n.transitionTo(Un(),(function(o){t&&ln(n.router,o,e,!0),bn||Hn(o.fullPath)}))},i=bn?"popstate":"hashchange";window.addEventListener(i,o),this.listeners.push((function(){window.removeEventListener(i,o)}))}},e.prototype.push=function(n,e,t){var o=this,i=this.current;this.transitionTo(n,(function(n){Fn(n.fullPath),ln(o.router,n,i,!1),e&&e(n)}),t)},e.prototype.replace=function(n,e,t){var o=this,i=this.current;this.transitionTo(n,(function(n){Hn(n.fullPath),ln(o.router,n,i,!1),e&&e(n)}),t)},e.prototype.go=function(n){window.history.go(n)},e.prototype.ensureURL=function(n){var e=this.current.fullPath;Un()!==e&&(n?Fn(e):Hn(e))},e.prototype.getCurrentLocation=function(){return Un()},e}(Mn);function Nn(){var n=Un();return"/"===n.charAt(0)||(Hn("/"+n),!1)}function Un(){var n=window.location.href,e=n.indexOf("#");return e<0?"":n=n.slice(e+1)}function Wn(n){var e=window.location.href,t=e.indexOf("#");return(t>=0?e.slice(0,t):e)+"#"+n}function Fn(n){bn?yn(Wn(n)):window.location.hash=n}function Hn(n){bn?vn(Wn(n)):window.location.replace(Wn(n))}var qn=function(n){function e(e,t){n.call(this,e,t),this.stack=[],this.index=-1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.push=function(n,e,t){var o=this;this.transitionTo(n,(function(n){o.stack=o.stack.slice(0,o.index+1).concat(n),o.index++,e&&e(n)}),t)},e.prototype.replace=function(n,e,t){var o=this;this.transitionTo(n,(function(n){o.stack=o.stack.slice(0,o.index).concat(n),e&&e(n)}),t)},e.prototype.go=function(n){var e=this,t=this.index+n;if(!(t<0||t>=this.stack.length)){var o=this.stack[t];this.confirmTransition(o,(function(){var n=e.current;e.index=t,e.updateRoute(o),e.router.afterHooks.forEach((function(e){e&&e(o,n)}))}),(function(n){Cn(n,wn.duplicated)&&(e.index=t)}))}},e.prototype.getCurrentLocation=function(){var n=this.stack[this.stack.length-1];return n?n.fullPath:"/"},e.prototype.ensureURL=function(){},e}(Mn),$n=function(n){void 0===n&&(n={}),this.app=null,this.apps=[],this.options=n,this.beforeHooks=[],this.resolveHooks=[],this.afterHooks=[],this.matcher=Z(n.routes||[],this);var e=n.mode||"hash";switch(this.fallback="history"===e&&!bn&&!1!==n.fallback,this.fallback&&(e="hash"),Y||(e="abstract"),this.mode=e,e){case"history":this.history=new Ln(this,n.base);break;case"hash":this.history=new Rn(this,n.base,this.fallback);break;case"abstract":this.history=new qn(this,n.base);break;default:0}},Jn={currentRoute:{configurable:!0}};$n.prototype.match=function(n,e,t){return this.matcher.match(n,e,t)},Jn.currentRoute.get=function(){return this.history&&this.history.current},$n.prototype.init=function(n){var e=this;if(this.apps.push(n),n.$once("hook:destroyed",(function(){var t=e.apps.indexOf(n);t>-1&&e.apps.splice(t,1),e.app===n&&(e.app=e.apps[0]||null),e.app||e.history.teardown()})),!this.app){this.app=n;var t=this.history;if(t instanceof Ln||t instanceof Rn){var o=function(n){t.setupListeners(),function(n){var o=t.current,i=e.options.scrollBehavior;bn&&i&&"fullPath"in n&&ln(e,n,o,!1)}(n)};t.transitionTo(t.getCurrentLocation(),o,o)}t.listen((function(n){e.apps.forEach((function(e){e._route=n}))}))}},$n.prototype.beforeEach=function(n){return Vn(this.beforeHooks,n)},$n.prototype.beforeResolve=function(n){return Vn(this.resolveHooks,n)},$n.prototype.afterEach=function(n){return Vn(this.afterHooks,n)},$n.prototype.onReady=function(n,e){this.history.onReady(n,e)},$n.prototype.onError=function(n){this.history.onError(n)},$n.prototype.push=function(n,e,t){var o=this;if(!e&&!t&&"undefined"!=typeof Promise)return new Promise((function(e,t){o.history.push(n,e,t)}));this.history.push(n,e,t)},$n.prototype.replace=function(n,e,t){var o=this;if(!e&&!t&&"undefined"!=typeof Promise)return new Promise((function(e,t){o.history.replace(n,e,t)}));this.history.replace(n,e,t)},$n.prototype.go=function(n){this.history.go(n)},$n.prototype.back=function(){this.go(-1)},$n.prototype.forward=function(){this.go(1)},$n.prototype.getMatchedComponents=function(n){var e=n?n.matched?n:this.resolve(n).route:this.currentRoute;return e?[].concat.apply([],e.matched.map((function(n){return Object.keys(n.components).map((function(e){return n.components[e]}))}))):[]},$n.prototype.resolve=function(n,e,t){var o=q(n,e=e||this.history.current,t,this),i=this.match(o,e),r=i.redirectedFrom||i.fullPath;return{location:o,route:i,href:function(n,e,t){var o="hash"===t?"#"+e:e;return n?T(n+"/"+o):o}(this.history.base,r,this.mode),normalizedTo:o,resolved:i}},$n.prototype.getRoutes=function(){return this.matcher.getRoutes()},$n.prototype.addRoute=function(n,e){this.matcher.addRoute(n,e),this.history.current!==g&&this.history.transitionTo(this.history.getCurrentLocation())},$n.prototype.addRoutes=function(n){this.matcher.addRoutes(n),this.history.current!==g&&this.history.transitionTo(this.history.getCurrentLocation())},Object.defineProperties($n.prototype,Jn);var Gn=$n;function Vn(n,e){return n.push(e),function(){var t=n.indexOf(e);t>-1&&n.splice(t,1)}}$n.install=function n(e){if(!n.installed||$!==e){n.installed=!0,$=e;var t=function(n){return void 0!==n},o=function(n,e){var o=n.$options._parentVnode;t(o)&&t(o=o.data)&&t(o=o.registerRouteInstance)&&o(n,e)};e.mixin({beforeCreate:function(){t(this.$options.router)?(this._routerRoot=this,this._router=this.$options.router,this._router.init(this),e.util.defineReactive(this,"_route",this._router.history.current)):this._routerRoot=this.$parent&&this.$parent._routerRoot||this,o(this,this)},destroyed:function(){o(this)}}),Object.defineProperty(e.prototype,"$router",{get:function(){return this._routerRoot._router}}),Object.defineProperty(e.prototype,"$route",{get:function(){return this._routerRoot._route}}),e.component("RouterView",k),e.component("RouterLink",G);var i=e.config.optionMergeStrategies;i.beforeRouteEnter=i.beforeRouteLeave=i.beforeRouteUpdate=i.created}},$n.version="3.6.5",$n.isNavigationFailure=Cn,$n.NavigationFailureType=wn,$n.START_LOCATION=g,Y&&window.Vue&&window.Vue.use($n);var Yn={NotFound:()=>t.e(13).then(t.bind(null,232)),Layout:()=>Promise.all([t.e(0),t.e(2),t.e(142)]).then(t.bind(null,230))},Kn={"v-02063ddf":()=>t.e(14).then(t.bind(null,237)),"v-9f22f8a8":()=>t.e(15).then(t.bind(null,238)),"v-16179d28":()=>t.e(16).then(t.bind(null,239)),"v-77f8ec80":()=>t.e(17).then(t.bind(null,240)),"v-5d4e540c":()=>t.e(18).then(t.bind(null,241)),"v-2ecbbb6c":()=>t.e(19).then(t.bind(null,242)),"v-367cff22":()=>t.e(20).then(t.bind(null,243)),"v-18368a94":()=>t.e(21).then(t.bind(null,244)),"v-a85495a8":()=>t.e(22).then(t.bind(null,245)),"v-0bcd9810":()=>t.e(23).then(t.bind(null,246)),"v-585d4b02":()=>t.e(24).then(t.bind(null,247)),"v-f69b32e8":()=>t.e(25).then(t.bind(null,248)),"v-3c8c2c3a":()=>t.e(26).then(t.bind(null,249)),"v-639989dc":()=>t.e(27).then(t.bind(null,250)),"v-d6e21568":()=>t.e(28).then(t.bind(null,251)),"v-ef49e4a8":()=>t.e(29).then(t.bind(null,252)),"v-37d5e88c":()=>t.e(30).then(t.bind(null,253)),"v-18a6139e":()=>t.e(31).then(t.bind(null,254)),"v-d370d328":()=>t.e(32).then(t.bind(null,255)),"v-2b1edeba":()=>t.e(33).then(t.bind(null,256)),"v-32ec190c":()=>t.e(34).then(t.bind(null,257)),"v-5b459728":()=>t.e(35).then(t.bind(null,258)),"v-2678376c":()=>t.e(36).then(t.bind(null,259)),"v-96bdfd28":()=>t.e(37).then(t.bind(null,260)),"v-126341d2":()=>t.e(38).then(t.bind(null,261)),"v-b6305f44":()=>t.e(39).then(t.bind(null,262)),"v-52f7ed14":()=>t.e(40).then(t.bind(null,263)),"v-001e1ca8":()=>t.e(41).then(t.bind(null,264)),"v-3967f6cc":()=>t.e(42).then(t.bind(null,265)),"v-4c5cb470":()=>t.e(43).then(t.bind(null,266)),"v-a411f128":()=>t.e(44).then(t.bind(null,267)),"v-918c2668":()=>t.e(45).then(t.bind(null,268)),"v-5ecee514":()=>t.e(46).then(t.bind(null,269)),"v-65ca61ec":()=>t.e(47).then(t.bind(null,270)),"v-7a63004c":()=>t.e(48).then(t.bind(null,271)),"v-13197cac":()=>t.e(49).then(t.bind(null,272)),"v-01157b6c":()=>t.e(50).then(t.bind(null,273)),"v-408b0e68":()=>t.e(51).then(t.bind(null,274)),"v-4fede3cc":()=>t.e(52).then(t.bind(null,275)),"v-1f2ac5a8":()=>t.e(53).then(t.bind(null,276)),"v-0bf79dec":()=>t.e(54).then(t.bind(null,277)),"v-d7c44de8":()=>t.e(55).then(t.bind(null,278)),"v-40511e8c":()=>t.e(56).then(t.bind(null,279)),"v-fe8b9b74":()=>t.e(57).then(t.bind(null,280)),"v-68c8b2cc":()=>t.e(58).then(t.bind(null,281)),"v-92fa34e8":()=>t.e(59).then(t.bind(null,282)),"v-4eed870c":()=>t.e(60).then(t.bind(null,283)),"v-312b8968":()=>t.e(61).then(t.bind(null,284)),"v-b0db3db4":()=>t.e(62).then(t.bind(null,285)),"v-4df7304c":()=>t.e(63).then(t.bind(null,286)),"v-0613ddec":()=>t.e(64).then(t.bind(null,287)),"v-1e762fa2":()=>t.e(65).then(t.bind(null,288)),"v-239a7502":()=>t.e(66).then(t.bind(null,289)),"v-c2c39494":()=>t.e(67).then(t.bind(null,290)),"v-26b6f1cc":()=>t.e(68).then(t.bind(null,291)),"v-d6f0ab44":()=>t.e(69).then(t.bind(null,292)),"v-d4ca9fa4":()=>t.e(70).then(t.bind(null,293)),"v-7d6046a8":()=>t.e(71).then(t.bind(null,294)),"v-10fbe28c":()=>t.e(72).then(t.bind(null,295)),"v-1b08f7ac":()=>t.e(73).then(t.bind(null,296)),"v-0e8ad0c4":()=>t.e(74).then(t.bind(null,297)),"v-b56ff930":()=>t.e(75).then(t.bind(null,298)),"v-42c62992":()=>t.e(76).then(t.bind(null,299)),"v-39956c96":()=>t.e(77).then(t.bind(null,300)),"v-67d941bf":()=>t.e(78).then(t.bind(null,301)),"v-2cc513e8":()=>t.e(79).then(t.bind(null,302)),"v-25796e4c":()=>t.e(80).then(t.bind(null,303)),"v-4f7a5876":()=>t.e(81).then(t.bind(null,304)),"v-86a08da8":()=>t.e(82).then(t.bind(null,305)),"v-5671b58c":()=>t.e(83).then(t.bind(null,306)),"v-4311ae18":()=>t.e(84).then(t.bind(null,307)),"v-7f5b896c":()=>t.e(85).then(t.bind(null,308)),"v-5908a168":()=>t.e(86).then(t.bind(null,309)),"v-2564926e":()=>t.e(87).then(t.bind(null,310)),"v-3857cc90":()=>t.e(88).then(t.bind(null,311)),"v-843d4e28":()=>t.e(89).then(t.bind(null,312)),"v-1d4ee519":()=>t.e(90).then(t.bind(null,313)),"v-702e38d2":()=>t.e(91).then(t.bind(null,314)),"v-648430a8":()=>t.e(92).then(t.bind(null,315)),"v-8e3f6ae8":()=>t.e(93).then(t.bind(null,316)),"v-44fecf6c":()=>t.e(94).then(t.bind(null,317)),"v-3acc1114":()=>t.e(95).then(t.bind(null,318)),"v-b91f0568":()=>t.e(96).then(t.bind(null,319)),"v-10b58620":()=>t.e(97).then(t.bind(null,320)),"v-210da8ac":()=>t.e(98).then(t.bind(null,321)),"v-7f0277e8":()=>t.e(99).then(t.bind(null,322)),"v-5647fecc":()=>t.e(100).then(t.bind(null,323)),"v-4eefa60c":()=>t.e(101).then(t.bind(null,324)),"v-2601e070":()=>t.e(102).then(t.bind(null,325)),"v-716e2e94":()=>t.e(103).then(t.bind(null,326)),"v-4210ca6c":()=>t.e(104).then(t.bind(null,327)),"v-2796ebcc":()=>t.e(105).then(t.bind(null,328)),"v-6937be2c":()=>t.e(106).then(t.bind(null,329)),"v-65d1537e":()=>t.e(107).then(t.bind(null,330)),"v-54c5fce8":()=>t.e(108).then(t.bind(null,331)),"v-42403228":()=>t.e(109).then(t.bind(null,332)),"v-2b55434a":()=>t.e(110).then(t.bind(null,333)),"v-d360c268":()=>t.e(111).then(t.bind(null,334)),"v-68848fec":()=>t.e(112).then(t.bind(null,335)),"v-c2df693c":()=>t.e(113).then(t.bind(null,336)),"v-6076e08c":()=>t.e(114).then(t.bind(null,337)),"v-3f1bddec":()=>t.e(115).then(t.bind(null,338)),"v-3e0f736c":()=>t.e(116).then(t.bind(null,339)),"v-04d8f7e8":()=>t.e(117).then(t.bind(null,340)),"v-7bb93a4c":()=>t.e(118).then(t.bind(null,341)),"v-eeaadaa8":()=>t.e(119).then(t.bind(null,342)),"v-64ccadac":()=>t.e(120).then(t.bind(null,343)),"v-9b4b2228":()=>t.e(124).then(t.bind(null,344)),"v-0f10356c":()=>t.e(125).then(t.bind(null,345)),"v-5dd5c348":()=>t.e(126).then(t.bind(null,346)),"v-89347ba8":()=>t.e(127).then(t.bind(null,347)),"v-179524e8":()=>t.e(128).then(t.bind(null,348)),"v-2b0ade98":()=>t.e(129).then(t.bind(null,349)),"v-03937a10":()=>t.e(130).then(t.bind(null,350)),"v-6c2cd7a8":()=>t.e(131).then(t.bind(null,351)),"v-7df4d328":()=>t.e(132).then(t.bind(null,352)),"v-610e0894":()=>t.e(133).then(t.bind(null,353)),"v-7e33e2b8":()=>t.e(134).then(t.bind(null,354)),"v-2ebe6e8c":()=>t.e(135).then(t.bind(null,355)),"v-7e6a746c":()=>t.e(136).then(t.bind(null,356)),"v-4b8e348c":()=>t.e(137).then(t.bind(null,357)),"v-223d54d4":()=>t.e(138).then(t.bind(null,358)),"v-626a7ec4":()=>t.e(139).then(t.bind(null,359)),"v-1d61f788":()=>t.e(140).then(t.bind(null,360)),"v-52c66bcc":()=>t.e(141).then(t.bind(null,361)),"v-1231f5e0":()=>t.e(122).then(t.bind(null,362)),"v-0c3100fc":()=>t.e(121).then(t.bind(null,363)),"v-31efbb28":()=>t.e(123).then(t.bind(null,364))};function Xn(n){const e=Object.create(null);return function(t){return e[t]||(e[t]=n(t))}}const Zn=/-(\w)/g,Qn=Xn(n=>n.replace(Zn,(n,e)=>e?e.toUpperCase():"")),ne=/\B([A-Z])/g,ee=Xn(n=>n.replace(ne,"-$1").toLowerCase()),te=Xn(n=>n.charAt(0).toUpperCase()+n.slice(1));function oe(n,e){if(!e)return;if(n(e))return n(e);return e.includes("-")?n(te(Qn(e))):n(te(e))||n(ee(e))}const ie=Object.assign({},Yn,Kn),re=n=>ie[n],se=n=>Kn[n],ae=n=>Yn[n],le=n=>o.a.component(n);function de(n){return oe(se,n)}function ce(n){return oe(ae,n)}function ue(n){return oe(re,n)}function pe(n){return oe(le,n)}function me(...n){return Promise.all(n.filter(n=>n).map(async n=>{if(!pe(n)&&ue(n)){const e=await ue(n)();o.a.component(n,e.default)}}))}function fe(n,e){"undefined"!=typeof window&&window.__VUEPRESS__&&(window.__VUEPRESS__[n]=e)}var he=t(49),ge=t.n(he),be=t(50),ye=t.n(be),ve={created(){if(this.siteMeta=this.$site.headTags.filter(([n])=>"meta"===n).map(([n,e])=>e),this.$ssrContext){const e=this.getMergedMetaTags();this.$ssrContext.title=this.$title,this.$ssrContext.lang=this.$lang,this.$ssrContext.pageMeta=(n=e)?n.map(n=>{let e="<meta";return Object.keys(n).forEach(t=>{e+=` ${t}="${ye()(n[t])}"`}),e+">"}).join("\n    "):"",this.$ssrContext.canonicalLink=xe(this.$canonicalUrl)}var n},mounted(){this.currentMetaTags=[...document.querySelectorAll("meta")],this.updateMeta(),this.updateCanonicalLink()},methods:{updateMeta(){document.title=this.$title,document.documentElement.lang=this.$lang;const n=this.getMergedMetaTags();this.currentMetaTags=ke(n,this.currentMetaTags)},getMergedMetaTags(){const n=this.$page.frontmatter.meta||[];return ge()([{name:"description",content:this.$description}],n,this.siteMeta,Se)},updateCanonicalLink(){we(),this.$canonicalUrl&&document.head.insertAdjacentHTML("beforeend",xe(this.$canonicalUrl))}},watch:{$page(){this.updateMeta(),this.updateCanonicalLink()}},beforeDestroy(){ke(null,this.currentMetaTags),we()}};function we(){const n=document.querySelector("link[rel='canonical']");n&&n.remove()}function xe(n=""){return n?`<link href="${n}" rel="canonical" />`:""}function ke(n,e){if(e&&[...e].filter(n=>n.parentNode===document.head).forEach(n=>document.head.removeChild(n)),n)return n.map(n=>{const e=document.createElement("meta");return Object.keys(n).forEach(t=>{e.setAttribute(t,n[t])}),document.head.appendChild(e),e})}function Se(n){for(const e of["name","property","itemprop"])if(n.hasOwnProperty(e))return n[e]+e;return JSON.stringify(n)}var je=t(13),Te=t.n(je),Ce={mounted(){window.addEventListener("scroll",this.onScroll)},methods:{onScroll:Te()((function(){this.setActiveHash()}),300),setActiveHash(){const n=[].slice.call(document.querySelectorAll(".sidebar-link")),e=[].slice.call(document.querySelectorAll(".header-anchor")).filter(e=>n.some(n=>n.hash===e.hash)),t=Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop),o=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),i=window.innerHeight+t;for(let n=0;n<e.length;n++){const r=e[n],s=e[n+1],a=0===n&&0===t||t>=r.parentElement.offsetTop+10&&(!s||t<s.parentElement.offsetTop-10),l=decodeURIComponent(this.$route.hash);if(a&&l!==decodeURIComponent(r.hash)){const t=r;if(i===o)for(let t=n+1;t<e.length;t++)if(l===decodeURIComponent(e[t].hash))return;return this.$vuepress.$set("disableScrollBehavior",!0),void this.$router.replace(decodeURIComponent(t.hash),()=>{this.$nextTick(()=>{this.$vuepress.$set("disableScrollBehavior",!1)})})}}}},beforeDestroy(){window.removeEventListener("scroll",this.onScroll)}},ze=(t(147),{data:()=>({zoom:null}),mounted(){this.updateCopy()},updated(){this.updateCopy()},methods:{updateCopy(){setTimeout(()=>{document.querySelectorAll('div[class*="language-"]').forEach(this.generateCopyButton)},1e3)},generateCopyButton:function(n){if(n.classList.contains("codecopy-enabled"))return;const e=document.createElement("span");e.className="code-copy",e.title="Click to Copy to Clipboard",e.addEventListener("click",()=>{this.copyToClipboard(n.innerText),e.classList.add("copied");const t=setTimeout(()=>{e.classList.remove("copied"),clearTimeout(t)},2e3)}),n.appendChild(e),n.classList.add("codecopy-enabled")},copyToClipboard:function(n){const e=document.createElement("textarea");e.value=n,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e);const t=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);e.select(),document.execCommand("copy"),document.body.removeChild(e),t&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(t))}}}),Pe=t(14),Ie=t.n(Pe),Be={mounted(){Ie.a.configure({showSpinner:!1}),this.$router.beforeEach((n,e,t)=>{n.path===e.path||o.a.component(n.name)||Ie.a.start(),t()}),this.$router.afterEach(()=>{Ie.a.done(),this.isSidebarOpen=!1})}},Ee=(t(148),Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o])}return n}),_e=function(n){return"IMG"===n.tagName},Me=function(n){return n&&1===n.nodeType},Oe=function(n){return".svg"===(n.currentSrc||n.src).substr(-4).toLowerCase()},De=function(n){try{return Array.isArray(n)?n.filter(_e):function(n){return NodeList.prototype.isPrototypeOf(n)}(n)?[].slice.call(n).filter(_e):Me(n)?[n].filter(_e):"string"==typeof n?[].slice.call(document.querySelectorAll(n)).filter(_e):[]}catch(n){throw new TypeError("The provided selector is invalid.\nExpects a CSS selector, a Node element, a NodeList or an array.\nSee: https://github.com/francoischalifour/medium-zoom")}},Le=function(n){var e=document.createElement("div");return e.classList.add("medium-zoom-overlay"),e.style.background=n,e},Ae=function(n){var e=n.getBoundingClientRect(),t=e.top,o=e.left,i=e.width,r=e.height,s=n.cloneNode(),a=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,l=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;return s.removeAttribute("id"),s.style.position="absolute",s.style.top=t+a+"px",s.style.left=o+l+"px",s.style.width=i+"px",s.style.height=r+"px",s.style.transform="",s},Re=function(n,e){var t=Ee({bubbles:!1,cancelable:!1,detail:void 0},e);if("function"==typeof window.CustomEvent)return new CustomEvent(n,t);var o=document.createEvent("CustomEvent");return o.initCustomEvent(n,t.bubbles,t.cancelable,t.detail),o};!function(n,e){void 0===e&&(e={});var t=e.insertAt;if(n&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===t&&o.firstChild?o.insertBefore(i,o.firstChild):o.appendChild(i),i.styleSheet?i.styleSheet.cssText=n:i.appendChild(document.createTextNode(n))}}(".medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}");var Ne=function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=window.Promise||function(n){function e(){}n(e,e)},i=function(n){var e=n.target;e!==T?-1!==v.indexOf(e)&&h({target:e}):f()},r=function(){if(!x&&j.original){var n=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;Math.abs(k-n)>S.scrollOffset&&setTimeout(f,150)}},s=function(n){var e=n.key||n.keyCode;"Escape"!==e&&"Esc"!==e&&27!==e||f()},a=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=n;if(n.background&&(T.style.background=n.background),n.container&&n.container instanceof Object&&(e.container=Ee({},S.container,n.container)),n.template){var t=Me(n.template)?n.template:document.querySelector(n.template);e.template=t}return S=Ee({},S,e),v.forEach((function(n){n.dispatchEvent(Re("medium-zoom:update",{detail:{zoom:C}}))})),C},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n(Ee({},S,e))},d=function(){for(var n=arguments.length,e=Array(n),t=0;t<n;t++)e[t]=arguments[t];var o=e.reduce((function(n,e){return[].concat(n,De(e))}),[]);return o.filter((function(n){return-1===v.indexOf(n)})).forEach((function(n){v.push(n),n.classList.add("medium-zoom-image")})),w.forEach((function(n){var e=n.type,t=n.listener,i=n.options;o.forEach((function(n){n.addEventListener(e,t,i)}))})),C},c=function(){for(var n=arguments.length,e=Array(n),t=0;t<n;t++)e[t]=arguments[t];j.zoomed&&f();var o=e.length>0?e.reduce((function(n,e){return[].concat(n,De(e))}),[]):v;return o.forEach((function(n){n.classList.remove("medium-zoom-image"),n.dispatchEvent(Re("medium-zoom:detach",{detail:{zoom:C}}))})),v=v.filter((function(n){return-1===o.indexOf(n)})),C},u=function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return v.forEach((function(o){o.addEventListener("medium-zoom:"+n,e,t)})),w.push({type:"medium-zoom:"+n,listener:e,options:t}),C},p=function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return v.forEach((function(o){o.removeEventListener("medium-zoom:"+n,e,t)})),w=w.filter((function(t){return!(t.type==="medium-zoom:"+n&&t.listener.toString()===e.toString())})),C},m=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=n.target,t=function(){var n={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,left:0,top:0,right:0,bottom:0},e=void 0,t=void 0;if(S.container)if(S.container instanceof Object)e=(n=Ee({},n,S.container)).width-n.left-n.right-2*S.margin,t=n.height-n.top-n.bottom-2*S.margin;else{var o=(Me(S.container)?S.container:document.querySelector(S.container)).getBoundingClientRect(),i=o.width,r=o.height,s=o.left,a=o.top;n=Ee({},n,{width:i,height:r,left:s,top:a})}e=e||n.width-2*S.margin,t=t||n.height-2*S.margin;var l=j.zoomedHd||j.original,d=Oe(l)?e:l.naturalWidth||e,c=Oe(l)?t:l.naturalHeight||t,u=l.getBoundingClientRect(),p=u.top,m=u.left,f=u.width,h=u.height,g=Math.min(d,e)/f,b=Math.min(c,t)/h,y=Math.min(g,b),v="scale("+y+") translate3d("+((e-f)/2-m+S.margin+n.left)/y+"px, "+((t-h)/2-p+S.margin+n.top)/y+"px, 0)";j.zoomed.style.transform=v,j.zoomedHd&&(j.zoomedHd.style.transform=v)};return new o((function(n){if(e&&-1===v.indexOf(e))n(C);else{if(j.zoomed)n(C);else{if(e)j.original=e;else{if(!(v.length>0))return void n(C);var o=v;j.original=o[0]}if(j.original.dispatchEvent(Re("medium-zoom:open",{detail:{zoom:C}})),k=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,x=!0,j.zoomed=Ae(j.original),document.body.appendChild(T),S.template){var i=Me(S.template)?S.template:document.querySelector(S.template);j.template=document.createElement("div"),j.template.appendChild(i.content.cloneNode(!0)),document.body.appendChild(j.template)}if(document.body.appendChild(j.zoomed),window.requestAnimationFrame((function(){document.body.classList.add("medium-zoom--opened")})),j.original.classList.add("medium-zoom-image--hidden"),j.zoomed.classList.add("medium-zoom-image--opened"),j.zoomed.addEventListener("click",f),j.zoomed.addEventListener("transitionend",(function e(){x=!1,j.zoomed.removeEventListener("transitionend",e),j.original.dispatchEvent(Re("medium-zoom:opened",{detail:{zoom:C}})),n(C)})),j.original.getAttribute("data-zoom-src")){j.zoomedHd=j.zoomed.cloneNode(),j.zoomedHd.removeAttribute("srcset"),j.zoomedHd.removeAttribute("sizes"),j.zoomedHd.src=j.zoomed.getAttribute("data-zoom-src"),j.zoomedHd.onerror=function(){clearInterval(r),console.warn("Unable to reach the zoom image target "+j.zoomedHd.src),j.zoomedHd=null,t()};var r=setInterval((function(){j.zoomedHd.complete&&(clearInterval(r),j.zoomedHd.classList.add("medium-zoom-image--opened"),j.zoomedHd.addEventListener("click",f),document.body.appendChild(j.zoomedHd),t())}),10)}else if(j.original.hasAttribute("srcset")){j.zoomedHd=j.zoomed.cloneNode(),j.zoomedHd.removeAttribute("sizes"),j.zoomedHd.removeAttribute("loading");var s=j.zoomedHd.addEventListener("load",(function(){j.zoomedHd.removeEventListener("load",s),j.zoomedHd.classList.add("medium-zoom-image--opened"),j.zoomedHd.addEventListener("click",f),document.body.appendChild(j.zoomedHd),t()}))}else t()}}}))},f=function(){return new o((function(n){if(!x&&j.original){x=!0,document.body.classList.remove("medium-zoom--opened"),j.zoomed.style.transform="",j.zoomedHd&&(j.zoomedHd.style.transform=""),j.template&&(j.template.style.transition="opacity 150ms",j.template.style.opacity=0),j.original.dispatchEvent(Re("medium-zoom:close",{detail:{zoom:C}})),j.zoomed.addEventListener("transitionend",(function e(){j.original.classList.remove("medium-zoom-image--hidden"),document.body.removeChild(j.zoomed),j.zoomedHd&&document.body.removeChild(j.zoomedHd),document.body.removeChild(T),j.zoomed.classList.remove("medium-zoom-image--opened"),j.template&&document.body.removeChild(j.template),x=!1,j.zoomed.removeEventListener("transitionend",e),j.original.dispatchEvent(Re("medium-zoom:closed",{detail:{zoom:C}})),j.original=null,j.zoomed=null,j.zoomedHd=null,j.template=null,n(C)}))}else n(C)}))},h=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=n.target;return j.original?f():m({target:e})},g=function(){return S},b=function(){return v},y=function(){return j.original},v=[],w=[],x=!1,k=0,S=t,j={original:null,zoomed:null,zoomedHd:null,template:null};"[object Object]"===Object.prototype.toString.call(e)?S=e:(e||"string"==typeof e)&&d(e),S=Ee({margin:0,background:"#fff",scrollOffset:40,container:null,template:null},S);var T=Le(S.background);document.addEventListener("click",i),document.addEventListener("keyup",s),document.addEventListener("scroll",r),window.addEventListener("resize",f);var C={open:m,close:f,toggle:h,update:a,clone:l,attach:d,detach:c,on:u,off:p,getOptions:g,getImages:b,getZoomedImage:y};return C},Ue=[ve,Ce,ze,Be,{data:()=>({zoom:null}),mounted(){this.updateZoom()},updated(){this.updateZoom()},methods:{updateZoom(){setTimeout(()=>{this.zoom&&this.zoom.detach(),this.zoom=Ne(".theme-default-content :not(a) > img",void 0)},1e3)}}}],We={name:"GlobalLayout",computed:{layout(){const n=this.getLayout();return fe("layout",n),o.a.component(n)}},methods:{getLayout(){if(this.$page.path){const n=this.$page.frontmatter.layout;return n&&(this.$vuepress.getLayoutAsyncComponent(n)||this.$vuepress.getVueComponent(n))?n:"Layout"}return"NotFound"}}},Fe=t(4),He=Object(Fe.a)(We,(function(){return(0,this._self._c)(this.layout,{tag:"component"})}),[],!1,null,null,null).exports;!function(n,e,t){switch(e){case"components":n[e]||(n[e]={}),Object.assign(n[e],t);break;case"mixins":n[e]||(n[e]=[]),n[e].push(...t);break;default:throw new Error("Unknown option name.")}}(He,"mixins",Ue);const qe=[{name:"v-02063ddf",path:"/en/",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-02063ddf").then(t)}},{path:"/en/index.html",redirect:"/en/"},{name:"v-9f22f8a8",path:"/en/api/builder-core.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-9f22f8a8").then(t)}},{name:"v-16179d28",path:"/en/api/builder-instance.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-16179d28").then(t)}},{name:"v-77f8ec80",path:"/en/api/builder-types.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-77f8ec80").then(t)}},{name:"v-5d4e540c",path:"/en/api/config-dev.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-5d4e540c").then(t)}},{name:"v-2ecbbb6c",path:"/en/api/config-experiments.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-2ecbbb6c").then(t)}},{name:"v-367cff22",path:"/en/api/config-html.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-367cff22").then(t)}},{name:"v-18368a94",path:"/en/api/config-output.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-18368a94").then(t)}},{name:"v-a85495a8",path:"/en/api/config-performance.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-a85495a8").then(t)}},{name:"v-0bcd9810",path:"/en/api/config-security.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-0bcd9810").then(t)}},{name:"v-585d4b02",path:"/en/api/config-source.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-585d4b02").then(t)}},{name:"v-f69b32e8",path:"/en/api/config-tools.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-f69b32e8").then(t)}},{name:"v-3c8c2c3a",path:"/en/api/",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-3c8c2c3a").then(t)}},{path:"/en/api/index.html",redirect:"/en/api/"},{name:"v-639989dc",path:"/en/api/plugin-core.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-639989dc").then(t)}},{name:"v-d6e21568",path:"/en/api/plugin-hooks.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-d6e21568").then(t)}},{name:"v-ef49e4a8",path:"/en/guide/advanced/alias.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-ef49e4a8").then(t)}},{name:"v-37d5e88c",path:"/en/guide/advanced/browser-compatibility.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-37d5e88c").then(t)}},{name:"v-18a6139e",path:"/en/guide/advanced/browserslist.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-18a6139e").then(t)}},{name:"v-d370d328",path:"/en/guide/advanced/custom-webpack-config.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-d370d328").then(t)}},{name:"v-2b1edeba",path:"/en/guide/advanced/define.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-2b1edeba").then(t)}},{name:"v-32ec190c",path:"/en/guide/advanced/hmr.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-32ec190c").then(t)}},{name:"v-5b459728",path:"/en/guide/advanced/rem.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-5b459728").then(t)}},{name:"v-2678376c",path:"/en/guide/basic/build-target.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-2678376c").then(t)}},{name:"v-96bdfd28",path:"/en/guide/basic/builder-config.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-96bdfd28").then(t)}},{name:"v-126341d2",path:"/en/guide/basic/css-modules.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-126341d2").then(t)}},{name:"v-b6305f44",path:"/en/guide/basic/css-usage.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-b6305f44").then(t)}},{name:"v-52f7ed14",path:"/en/guide/basic/html-template.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-52f7ed14").then(t)}},{name:"v-001e1ca8",path:"/en/guide/basic/json-files.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-001e1ca8").then(t)}},{name:"v-3967f6cc",path:"/en/guide/basic/output-files.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-3967f6cc").then(t)}},{name:"v-4c5cb470",path:"/en/guide/basic/static-assets.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-4c5cb470").then(t)}},{name:"v-a411f128",path:"/en/guide/basic/svg-assets.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-a411f128").then(t)}},{name:"v-918c2668",path:"/en/guide/basic/typescript.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-918c2668").then(t)}},{name:"v-5ecee514",path:"/en/guide/debug/inspector.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-5ecee514").then(t)}},{name:"v-65ca61ec",path:"/en/guide/faq/exceptions.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-65ca61ec").then(t)}},{name:"v-7a63004c",path:"/en/guide/faq/features.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-7a63004c").then(t)}},{name:"v-13197cac",path:"/en/guide/faq/general.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-13197cac").then(t)}},{name:"v-01157b6c",path:"/en/guide/features.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-01157b6c").then(t)}},{name:"v-408b0e68",path:"/en/guide/glossary.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-408b0e68").then(t)}},{name:"v-4fede3cc",path:"/en/guide/introduction.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-4fede3cc").then(t)}},{name:"v-1f2ac5a8",path:"/en/guide/optimization/build-performance.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-1f2ac5a8").then(t)}},{name:"v-0bf79dec",path:"/en/guide/optimization/inline-assets.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-0bf79dec").then(t)}},{name:"v-d7c44de8",path:"/en/guide/optimization/optimize-bundle.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-d7c44de8").then(t)}},{name:"v-40511e8c",path:"/en/guide/optimization/split-chunk.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-40511e8c").then(t)}},{name:"v-fe8b9b74",path:"/en/guide/quick-start.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-fe8b9b74").then(t)}},{name:"v-68c8b2cc",path:"/en/plugins/integration.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-68c8b2cc").then(t)}},{name:"v-92fa34e8",path:"/en/plugins/introduction.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-92fa34e8").then(t)}},{name:"v-4eed870c",path:"/en/plugins/list.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-4eed870c").then(t)}},{name:"v-312b8968",path:"/en/plugins/plugin-esbuild.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-312b8968").then(t)}},{name:"v-b0db3db4",path:"/en/plugins/plugin-image-compress.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-b0db3db4").then(t)}},{name:"v-4df7304c",path:"/en/plugins/plugin-node-polyfill.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-4df7304c").then(t)}},{name:"v-0613ddec",path:"/en/plugins/plugin-swc.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-0613ddec").then(t)}},{name:"v-1e762fa2",path:"/en/plugins/testing.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-1e762fa2").then(t)}},{name:"v-239a7502",path:"/en/shared/getBuilderConfig.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-239a7502").then(t)}},{name:"v-c2c39494",path:"/en/shared/getHTMLPaths.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-c2c39494").then(t)}},{name:"v-26b6f1cc",path:"/en/shared/getNormalizedConfig.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-26b6f1cc").then(t)}},{name:"v-d6f0ab44",path:"/en/shared/isPluginExists.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-d6f0ab44").then(t)}},{name:"v-d4ca9fa4",path:"/en/shared/onAfterBuild.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-d4ca9fa4").then(t)}},{name:"v-7d6046a8",path:"/en/shared/onAfterCreateCompiler.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-7d6046a8").then(t)}},{name:"v-10fbe28c",path:"/en/shared/onAfterStartDevServer.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-10fbe28c").then(t)}},{name:"v-1b08f7ac",path:"/en/shared/onBeforeBuild.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-1b08f7ac").then(t)}},{name:"v-0e8ad0c4",path:"/en/shared/onBeforeCreateCompiler.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-0e8ad0c4").then(t)}},{name:"v-b56ff930",path:"/en/shared/onBeforeStartDevServer.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-b56ff930").then(t)}},{name:"v-42c62992",path:"/en/shared/onDevCompileDone.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-42c62992").then(t)}},{name:"v-39956c96",path:"/en/shared/onExit.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-39956c96").then(t)}},{name:"v-67d941bf",path:"/zh/",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-67d941bf").then(t)}},{path:"/zh/index.html",redirect:"/zh/"},{name:"v-2cc513e8",path:"/zh/api/builder-core.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-2cc513e8").then(t)}},{name:"v-25796e4c",path:"/zh/api/builder-instance.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-25796e4c").then(t)}},{name:"v-4f7a5876",path:"/zh/api/builder-types.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-4f7a5876").then(t)}},{name:"v-86a08da8",path:"/zh/api/config-dev.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-86a08da8").then(t)}},{name:"v-5671b58c",path:"/zh/api/config-experiments.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-5671b58c").then(t)}},{name:"v-4311ae18",path:"/zh/api/config-html.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-4311ae18").then(t)}},{name:"v-7f5b896c",path:"/zh/api/config-output.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-7f5b896c").then(t)}},{name:"v-5908a168",path:"/zh/api/config-performance.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-5908a168").then(t)}},{name:"v-2564926e",path:"/zh/api/config-security.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-2564926e").then(t)}},{name:"v-3857cc90",path:"/zh/api/config-source.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-3857cc90").then(t)}},{name:"v-843d4e28",path:"/zh/api/config-tools.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-843d4e28").then(t)}},{name:"v-1d4ee519",path:"/zh/api/",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-1d4ee519").then(t)}},{path:"/zh/api/index.html",redirect:"/zh/api/"},{name:"v-702e38d2",path:"/zh/api/plugin-core.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-702e38d2").then(t)}},{name:"v-648430a8",path:"/zh/api/plugin-hooks.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-648430a8").then(t)}},{name:"v-8e3f6ae8",path:"/zh/guide/advanced/alias.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-8e3f6ae8").then(t)}},{name:"v-44fecf6c",path:"/zh/guide/advanced/browser-compatibility.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-44fecf6c").then(t)}},{name:"v-3acc1114",path:"/zh/guide/advanced/browserslist.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-3acc1114").then(t)}},{name:"v-b91f0568",path:"/zh/guide/advanced/custom-webpack-config.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-b91f0568").then(t)}},{name:"v-10b58620",path:"/zh/guide/advanced/define.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-10b58620").then(t)}},{name:"v-210da8ac",path:"/zh/guide/advanced/hmr.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-210da8ac").then(t)}},{name:"v-7f0277e8",path:"/zh/guide/advanced/rem.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-7f0277e8").then(t)}},{name:"v-5647fecc",path:"/zh/guide/basic/build-target.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-5647fecc").then(t)}},{name:"v-4eefa60c",path:"/zh/guide/basic/builder-config.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-4eefa60c").then(t)}},{name:"v-2601e070",path:"/zh/guide/basic/css-modules.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-2601e070").then(t)}},{name:"v-716e2e94",path:"/zh/guide/basic/css-usage.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-716e2e94").then(t)}},{name:"v-4210ca6c",path:"/zh/guide/basic/html-template.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-4210ca6c").then(t)}},{name:"v-2796ebcc",path:"/zh/guide/basic/json-files.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-2796ebcc").then(t)}},{name:"v-6937be2c",path:"/zh/guide/basic/output-files.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-6937be2c").then(t)}},{name:"v-65d1537e",path:"/zh/guide/basic/static-assets.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-65d1537e").then(t)}},{name:"v-54c5fce8",path:"/zh/guide/basic/svg-assets.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-54c5fce8").then(t)}},{name:"v-42403228",path:"/zh/guide/basic/typescript.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-42403228").then(t)}},{name:"v-2b55434a",path:"/zh/guide/debug/inspector.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-2b55434a").then(t)}},{name:"v-d360c268",path:"/zh/guide/faq/exceptions.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-d360c268").then(t)}},{name:"v-68848fec",path:"/zh/guide/faq/features.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-68848fec").then(t)}},{name:"v-c2df693c",path:"/zh/guide/faq/general.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-c2df693c").then(t)}},{name:"v-6076e08c",path:"/zh/guide/features.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-6076e08c").then(t)}},{name:"v-3f1bddec",path:"/zh/guide/glossary.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-3f1bddec").then(t)}},{name:"v-3e0f736c",path:"/zh/guide/introduction.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-3e0f736c").then(t)}},{name:"v-04d8f7e8",path:"/zh/guide/optimization/build-performance.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-04d8f7e8").then(t)}},{name:"v-7bb93a4c",path:"/zh/guide/optimization/inline-assets.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-7bb93a4c").then(t)}},{name:"v-eeaadaa8",path:"/zh/guide/optimization/optimize-bundle.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-eeaadaa8").then(t)}},{name:"v-64ccadac",path:"/zh/guide/optimization/split-chunk.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-64ccadac").then(t)}},{name:"v-9b4b2228",path:"/zh/plugins/list.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-9b4b2228").then(t)}},{name:"v-0f10356c",path:"/zh/plugins/plugin-esbuild.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-0f10356c").then(t)}},{name:"v-5dd5c348",path:"/zh/plugins/plugin-image-compress.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-5dd5c348").then(t)}},{name:"v-89347ba8",path:"/zh/plugins/plugin-node-polyfill.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-89347ba8").then(t)}},{name:"v-179524e8",path:"/zh/plugins/plugin-swc.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-179524e8").then(t)}},{name:"v-2b0ade98",path:"/zh/plugins/testing.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-2b0ade98").then(t)}},{name:"v-03937a10",path:"/zh/shared/getBuilderConfig.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-03937a10").then(t)}},{name:"v-6c2cd7a8",path:"/zh/shared/getHTMLPaths.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-6c2cd7a8").then(t)}},{name:"v-7df4d328",path:"/zh/shared/getNormalizedConfig.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-7df4d328").then(t)}},{name:"v-610e0894",path:"/zh/shared/isPluginExists.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-610e0894").then(t)}},{name:"v-7e33e2b8",path:"/zh/shared/onAfterBuild.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-7e33e2b8").then(t)}},{name:"v-2ebe6e8c",path:"/zh/shared/onAfterCreateCompiler.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-2ebe6e8c").then(t)}},{name:"v-7e6a746c",path:"/zh/shared/onAfterStartDevServer.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-7e6a746c").then(t)}},{name:"v-4b8e348c",path:"/zh/shared/onBeforeBuild.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-4b8e348c").then(t)}},{name:"v-223d54d4",path:"/zh/shared/onBeforeCreateCompiler.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-223d54d4").then(t)}},{name:"v-626a7ec4",path:"/zh/shared/onBeforeStartDevServer.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-626a7ec4").then(t)}},{name:"v-1d61f788",path:"/zh/shared/onDevCompileDone.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-1d61f788").then(t)}},{name:"v-52c66bcc",path:"/zh/shared/onExit.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-52c66bcc").then(t)}},{name:"v-1231f5e0",path:"/zh/plugins/integration.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-1231f5e0").then(t)}},{name:"v-0c3100fc",path:"/zh/guide/quick-start.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-0c3100fc").then(t)}},{name:"v-31efbb28",path:"/zh/plugins/introduction.html",component:He,beforeEnter:(n,e,t)=>{me("Layout","v-31efbb28").then(t)}},{path:"*",component:He}],$e={title:"",description:"",base:"/builder/",headTags:[["link",{rel:"icon",href:"https://lf3-static.bytednsdoc.com/obj/eden-cn/zq-uylkvT/ljhwZthlaukjlkulzlp/eden-x-logo.png"}],["meta",{name:"theme-color",content:"#5c6ac4"}],["meta",{name:"apple-mobile-web-app-capable",content:"yes"}],["meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"}],["meta",{name:"apple-mobile-web-app-status-bar-style",content:"black"}]],pages:[{title:"Home",frontmatter:{home:!0,actionText:"Introduction",actionLink:"/en/guide/introduction.html",subActionText:"Quick Start",subActionLink:"/en/guide/quick-start.html",features:[{title:"Out of the box",details:"Based on the practical experience of ByteDance, provide useful features for web development by default."},{title:"Deep optimization",details:"Built-in multiple split chunk strategies, automatically optimize static assets, ensure performance of production app."},{title:"Extensible",details:"Provides rich configuration items and a flexible plugin system to support in-depth customization of all features."}]},regularPath:"/en/",relativePath:"en/README.md",key:"v-02063ddf",path:"/en/",lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"The Modern\n\nWeb Build Engine\n\nA Build Engine for Modern Web Development\n\nCopyright © 2022 ByteDance.",normalizedContent:"the modern\n\nweb build engine\n\na build engine for modern web development\n\ncopyright © 2022 bytedance.",charsets:{}},{title:"Builder Core",frontmatter:{extractApiHeaders:[2]},regularPath:"/en/api/builder-core.html",relativePath:"en/api/builder-core.md",key:"v-9f22f8a8",path:"/en/api/builder-core.html",headers:[{level:2,title:"createBuilder",slug:"createbuilder",normalizedTitle:"createbuilder",charIndex:89},{level:2,title:"mergeBuilderConfig",slug:"mergebuilderconfig",normalizedTitle:"mergebuilderconfig",charIndex:2082},{level:2,title:"webpack",slug:"webpack",normalizedTitle:"webpack",charIndex:211},{level:2,title:"HtmlWebpackPlugin",slug:"htmlwebpackplugin",normalizedTitle:"htmlwebpackplugin",charIndex:2980}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"createBuilder mergeBuilderConfig webpack HtmlWebpackPlugin",content:"# Builder Core\n\nThis section describes some of the core methods provided by Builder.\n\n\n# createBuilder\n\nCreate a Builder instance object.\n\nWhen using this method, it needs to be used with the @modern-js/builder-webpack-provider or @modern-js/builder-rspack-provider. Providers implements corresponding build feature based on specific bundlers.\n\n\n# Webpack Provider\n\nWhen builderWebpackProvider is passed, the Builder will use webpack as the bundler for building.\n\nimport { createBuilder } from '@modern-js/builder';\nimport { builderWebpackProvider } from '@modern-js/builder-webpack-provider';\n\nconst provider = builderWebpackProvider({\n  builderConfig: {\n    // some configs\n  },\n});\n\nconst builder = await createBuilder(provider, {\n  // some options\n});\n\n\n\n# Rspack Provider\n\nWhen builderRspackProvider is passed, the Builder will use rspack as the bundler for building.\n\nimport { createBuilder } from '@modern-js/builder';\nimport { builderRspackProvider } from '@modern-js/builder-rspack-provider';\n\nconst provider = builderRspackProvider({\n  builderConfig: {\n    // some configs\n  },\n});\n\nconst builder = await createBuilder(provider, {\n  // some options\n});\n\n\n> Tips: @modern-js/builder-rspack-provider has not been developed yet.\n\n\n# options\n\nThe second parameter of createBuilder is a options object, you can pass in the following options:\n\ntype BuilderEntry = Record<string, string | string[]>;\n\ntype BuilderTarget = 'web' | 'node' | 'modern-web' | 'web-worker';\n\ntype CreateBuilderOptions = {\n  cwd?: string;\n  entry?: BuilderEntry;\n  target?: BuilderTarget | BuilderTarget[];\n  framework?: string;\n  configPath?: string | null;\n};\n\n\nDescription:\n\n * cwd: The root path of the current build, the default value is process.cwd().\n * entry: Build entry object.\n * target: Build target type, the default value is ['web'], see chapter Build Target for details.\n * framework: The name of the framework, a unique identifier, the default value is 'modern.js'.\n * configPath: The path to the framework config file (absolute path), this parameter affects the build cache update.\n\n\n# mergeBuilderConfig\n\nMerges multiple Builder config objects and returns a new merged object.\n\n * Type\n\nfunction mergeBuilderConfig(...configs: BuilderConfig[]): BuilderConfig;\n\n\n * Example\n\nimport { mergeBuilderConfig } from '@modern-js/builder';\n\nconst config1 = {\n  dev: {\n    https: false,\n  },\n};\nconst config2 = {\n  dev: {\n    https: true,\n  },\n};\n\nconst mergedConfig = mergeBuilderConfig(config1, config2);\n\nconsole.log(mergedConfig); // { dev: { https: true } }\n\n\n> This method does not modify the original config object.\n\n\n# webpack\n\nA webpack object for consuming webpack builtin plugins or type definitions.\n\n * Example\n\nimport webpack from '@modern-js/builder-webpack-provider/webpack';\n\nnew webpack.DefinePlugin();\n\n\n> In most scenarios, it is recommended to import webpack from Builder instead of manually installing a \"webpack\" dependency, which can avoid multi-instance problems.\n\n\n# HtmlWebpackPlugin\n\nHtmlWebpackPlugin object, usually used to implement custom plugins of HtmlWebpackPlugin.\n\n * Example\n\nimport HtmlWebpackPlugin from '@modern-js/builder-webpack-provider/html-webpack-plugin';\n\n\n> In most scenarios, it is recommended to import HtmlWebpackPlugin from builder instead of manually installing a \"html-webpack-plugin\" dependency, which can avoid multi-instance problems.",normalizedContent:"# builder core\n\nthis section describes some of the core methods provided by builder.\n\n\n# createbuilder\n\ncreate a builder instance object.\n\nwhen using this method, it needs to be used with the @modern-js/builder-webpack-provider or @modern-js/builder-rspack-provider. providers implements corresponding build feature based on specific bundlers.\n\n\n# webpack provider\n\nwhen builderwebpackprovider is passed, the builder will use webpack as the bundler for building.\n\nimport { createbuilder } from '@modern-js/builder';\nimport { builderwebpackprovider } from '@modern-js/builder-webpack-provider';\n\nconst provider = builderwebpackprovider({\n  builderconfig: {\n    // some configs\n  },\n});\n\nconst builder = await createbuilder(provider, {\n  // some options\n});\n\n\n\n# rspack provider\n\nwhen builderrspackprovider is passed, the builder will use rspack as the bundler for building.\n\nimport { createbuilder } from '@modern-js/builder';\nimport { builderrspackprovider } from '@modern-js/builder-rspack-provider';\n\nconst provider = builderrspackprovider({\n  builderconfig: {\n    // some configs\n  },\n});\n\nconst builder = await createbuilder(provider, {\n  // some options\n});\n\n\n> tips: @modern-js/builder-rspack-provider has not been developed yet.\n\n\n# options\n\nthe second parameter of createbuilder is a options object, you can pass in the following options:\n\ntype builderentry = record<string, string | string[]>;\n\ntype buildertarget = 'web' | 'node' | 'modern-web' | 'web-worker';\n\ntype createbuilderoptions = {\n  cwd?: string;\n  entry?: builderentry;\n  target?: buildertarget | buildertarget[];\n  framework?: string;\n  configpath?: string | null;\n};\n\n\ndescription:\n\n * cwd: the root path of the current build, the default value is process.cwd().\n * entry: build entry object.\n * target: build target type, the default value is ['web'], see chapter build target for details.\n * framework: the name of the framework, a unique identifier, the default value is 'modern.js'.\n * configpath: the path to the framework config file (absolute path), this parameter affects the build cache update.\n\n\n# mergebuilderconfig\n\nmerges multiple builder config objects and returns a new merged object.\n\n * type\n\nfunction mergebuilderconfig(...configs: builderconfig[]): builderconfig;\n\n\n * example\n\nimport { mergebuilderconfig } from '@modern-js/builder';\n\nconst config1 = {\n  dev: {\n    https: false,\n  },\n};\nconst config2 = {\n  dev: {\n    https: true,\n  },\n};\n\nconst mergedconfig = mergebuilderconfig(config1, config2);\n\nconsole.log(mergedconfig); // { dev: { https: true } }\n\n\n> this method does not modify the original config object.\n\n\n# webpack\n\na webpack object for consuming webpack builtin plugins or type definitions.\n\n * example\n\nimport webpack from '@modern-js/builder-webpack-provider/webpack';\n\nnew webpack.defineplugin();\n\n\n> in most scenarios, it is recommended to import webpack from builder instead of manually installing a \"webpack\" dependency, which can avoid multi-instance problems.\n\n\n# htmlwebpackplugin\n\nhtmlwebpackplugin object, usually used to implement custom plugins of htmlwebpackplugin.\n\n * example\n\nimport htmlwebpackplugin from '@modern-js/builder-webpack-provider/html-webpack-plugin';\n\n\n> in most scenarios, it is recommended to import htmlwebpackplugin from builder instead of manually installing a \"html-webpack-plugin\" dependency, which can avoid multi-instance problems.",charsets:{cjk:!0}},{title:"Builder Instance",frontmatter:{extractApiHeaders:[2]},regularPath:"/en/api/builder-instance.html",relativePath:"en/api/builder-instance.md",key:"v-16179d28",path:"/en/api/builder-instance.html",headers:[{level:2,title:"builder.context",slug:"builder-context",normalizedTitle:"builder.context",charIndex:110},{level:2,title:"builder.build",slug:"builder-build",normalizedTitle:"builder.build",charIndex:1906},{level:2,title:"builder.startDevServer",slug:"builder-startdevserver",normalizedTitle:"builder.startdevserver",charIndex:2693},{level:2,title:"builder.createCompiler",slug:"builder-createcompiler",normalizedTitle:"builder.createcompiler",charIndex:4644},{level:2,title:"builder.addPlugins",slug:"builder-addplugins",normalizedTitle:"builder.addplugins",charIndex:5127},{level:2,title:"builder.removePlugins",slug:"builder-removeplugins",normalizedTitle:"builder.removeplugins",charIndex:5763},{level:2,title:"builder.isPluginExists",slug:"builder-ispluginexists",normalizedTitle:"builder.ispluginexists",charIndex:6202},{level:2,title:"builder.inspectConfig",slug:"builder-inspectconfig",normalizedTitle:"builder.inspectconfig",charIndex:6444},{level:2,title:"builder.onBeforeCreateCompiler",slug:"builder-onbeforecreatecompiler",normalizedTitle:"builder.onbeforecreatecompiler",charIndex:7535},{level:2,title:"builder.onAfterCreateCompiler",slug:"builder-onaftercreatecompiler",normalizedTitle:"builder.onaftercreatecompiler",charIndex:8106},{level:2,title:"builder.onBeforeBuild",slug:"builder-onbeforebuild",normalizedTitle:"builder.onbeforebuild",charIndex:8634},{level:2,title:"builder.onAfterBuild",slug:"builder-onafterbuild",normalizedTitle:"builder.onafterbuild",charIndex:9083},{level:2,title:"builder.onBeforeStartDevServer",slug:"builder-onbeforestartdevserver",normalizedTitle:"builder.onbeforestartdevserver",charIndex:9433},{level:2,title:"builder.onAfterStartDevServer",slug:"builder-onafterstartdevserver",normalizedTitle:"builder.onafterstartdevserver",charIndex:9693},{level:2,title:"builder.onDevCompileDone",slug:"builder-ondevcompiledone",normalizedTitle:"builder.ondevcompiledone",charIndex:10049},{level:2,title:"builder.onExit",slug:"builder-onexit",normalizedTitle:"builder.onexit",charIndex:10496},{level:2,title:"builder.getBuilderConfig",slug:"builder-getbuilderconfig",normalizedTitle:"builder.getbuilderconfig",charIndex:10724},{level:2,title:"builder.getNormalizedConfig",slug:"builder-getnormalizedconfig",normalizedTitle:"builder.getnormalizedconfig",charIndex:11046},{level:2,title:"builder.getHTMLPaths",slug:"builder-gethtmlpaths",normalizedTitle:"builder.gethtmlpaths",charIndex:11675}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"builder.context builder.build builder.startDevServer builder.createCompiler builder.addPlugins builder.removePlugins builder.isPluginExists builder.inspectConfig builder.onBeforeCreateCompiler builder.onAfterCreateCompiler builder.onBeforeBuild builder.onAfterBuild builder.onBeforeStartDevServer builder.onAfterStartDevServer builder.onDevCompileDone builder.onExit builder.getBuilderConfig builder.getNormalizedConfig builder.getHTMLPaths",content:"# Builder Instance\n\nThis section describes all the properties and methods on the Builder instance object.\n\n\n# builder.context\n\nbuilder.context is a read-only object that provides some context infos.\n\n\n# builder.context.entry\n\nThe entry object, corresponding to the entry option of createBuilder method.\n\n * Type\n\ntype BuilderEntry = Record<string, string | string[]>;\n\n\n\n# builder.context.target\n\nBuild target type, corresponding to the target option of createBuilder method.\n\n * Type\n\ntype BuilderTarget = 'web' | 'node' | 'modern-web' | 'web-worker';\n\ntype Context = {\n  target: BuilderTarget | BuilderTarget[];\n};\n\n\n\n# builder.context.rootPath\n\nThe root path of current build, corresponding to the cwd option of createBuilder method.\n\n * Type\n\ntype RootPath = string;\n\n\n\n# builder.context.srcPath\n\nThe absolute path to the src directory.\n\n * Type\n\ntype SrcPath = string;\n\n\n\n# builder.context.distPath\n\nThe absolute path of the output directory, corresponding to the output.distPath.root config in BuilderConfig.\n\n * Type\n\ntype DistPath = string;\n\n\n\n# builder.context.cachePath\n\nThe absolute path of the build cache files.\n\n * Type\n\ntype CachePath = string;\n\n\n\n# builder.context.configPath\n\nThe absolute path to the framework config file, corresponding to the configPath option of createBuilder method.\n\n * Type\n\ntype ConfigPath = string | undefined;\n\n\n\n# builder.context.tsconfigPath\n\nThe absolute path of the tsconfig.json file, or undefined if the tsconfig.json file does not exist in current project.\n\n * Type\n\ntype TsconfigPath = string | undefined;\n\n\n\n# builder.context.framework\n\nThe name of the framework, a unique identifier, the default value is 'modern.js'.\n\n * Type\n\ntype Framework = string | undefined;\n\n\n\n# builder.context.devServer\n\nDev Server information, including the current Dev Server hostname and port number.\n\n * Type\n\ntype DevServer = {\n  hostname: string;\n  port: number;\n};\n\n\n\n# builder.build\n\nPerform a production build.\n\n * Type\n\ntype BuildOptions = {\n  mode?: 'development' | 'production';\n  watch?: boolean;\n  // custom Compiler object\n  compiler?: Compiler | MultiCompiler;\n};\n\nfunction Build(options?: BuildOptions): Promise<void>;\n\n\n * Example\n\nawait builder.build();\n\n\n\n# Development environment build\n\nIf you need to perform a development build, you can set the mode option to 'development'.\n\nawait builder.build({\n  mode: 'development',\n});\n\n\n\n# Monitor file changes\n\nIf you need to watch file changes and re-build, you can set the watch option to true.\n\nawait builder.build({\n  watch: true,\n});\n\n\n\n# Custom Compiler\n\nIn some cases, you may want to use a custom compiler:\n\nconst compiler = webpack({\n  // ...\n});\nawait builder.build({\n  compiler,\n});\n\n\n\n# builder.startDevServer\n\nStart the local Dev Server, based on the Modern.js Dev Server.\n\n * Type\n\ntype StartDevServerOptions = {\n  // Whether to output URL infos, the default is true\n  printURLs?: boolean;\n  // Whether to throw an exception when the port is occupied, the default is false\n  strictPort?: boolean;\n  // custom Compiler object\n  compiler?: Compiler | MultiCompiler;\n  // passing through the build-independent dev server configuration\n  serverOptions?: Partial<ModernDevServerOptions>;\n};\n\ntype StartDevServerResult = {\n  urls: string[];\n  port: number;\n  server: Server;\n};\n\nfunction StartDevServer(\n  options?: StartDevServerOptions,\n): Promise<StartDevServerResult>;\n\n\n * Example\n\nStart Dev Server:\n\nawait builder.startDevServer();\n\n\nAfter successfully starting Dev Server, you can see the following logs:\n\ninfo    Starting dev server...\ninfo    Dev server running at:\n\n  > Local:    http://localhost:8080\n  > Network:  http://192.168.0.1:8080\n\n\nstartDevServer returns the following parameters:\n\n * urls: URLs to access Dev Server.\n * port: The actual listening port number.\n * server: Server instance object.\n\nconst { urls, port, server } = await builder.startDevServer();\nconsole.log(urls); // ['http://localhost:8080', 'http://192.168.0.1:8080']\nconsole.log(port); // 8080\n\n// Close the Dev Server\nawait server.close();\n\n\n\n# Disable print URLs\n\nSetting printURLs to false to disable the default URL output, so you can custom the logs.\n\nawait builder.startDevServer({\n  printURLs: false,\n});\n\n\n\n# Strict Port\n\nWhen a port is occupied, Builder will automatically increment the port number until an available port is found.\n\nSet strictPort to true and Builder will throw an exception when the port is occupied.\n\nawait builder.startDevServer({\n  strictPort: true,\n});\n\n\n\n# Custom Compiler\n\nIn some cases, you may want to use a custom compiler:\n\nconst compiler = webpack({\n  // ...\n});\nawait builder.startDevServer({\n  compiler,\n});\n\n\n\n# builder.createCompiler\n\nCreate a Compiler object.\n\nWhen the target option of createBuilder contains only one value, the return value is Compiler; when target contains multiple values, the return value is MultiCompiler.\n\n * Type\n\nfunction CreateCompiler(): Promise<Compiler | MultiCompiler>;\n\n\n * Example\n\nconst compiler = await builder.createCompiler();\n\n\n> In most scenarios, you do not need to use this API unless you need to custom the Dev Server or other advanced scenarios.\n\n\n# builder.addPlugins\n\nRegister one or more Builder plugins, which can be called multiple times.\n\nThis method needs to be called before compiling. If it is called after compiling, it will not affect the compilation result.\n\n * Type\n\ntype AddPluginsOptions = { before?: string } | { after?: string };\n\nfunction AddPlugins(\n  plugins: BuilderPlugins[],\n  options?: AddPluginsOptions,\n): Promise<void>;\n\n\n * Example\n\nbuilder.addPlugins([PluginFoo(), PluginBar()]);\n\n// Insert before the bar plugin\nbuilder.addPlugins([PluginFoo()], { before: 'bar' });\n\n// Insert after the bar plugin\nbuilder.addPlugins([PluginFoo()], { after: 'bar' });\n\n\n\n# builder.removePlugins\n\nRemoves one or more Builder plugins, which can be called multiple times.\n\nThis method needs to be called before compiling. If it is called after compiling, it will not affect the compilation result.\n\n * Type\n\nfunction RemovePlugins(pluginNames: string[]): void;\n\n\n * Example\n\n// add plugin\nconst pluginFoo = PluginFoo();\nbuilder.addPlugins(pluginFoo);\n\n// remove plugin\nbuilder.removePlugins([pluginFoo.name]);\n\n\n\n# builder.isPluginExists\n\nDetermines whether a plugin has been registered.\n\n * Type\n\nfunction IsPluginExists(pluginName: string): boolean;\n\n\n * Example\n\nbuilder.addPlugins([PluginFoo()]);\n\nbuilder.isPluginExists(PluginFoo().name); // true\n\n\n\n# builder.inspectConfig\n\nInspect the final generated builder config and bundler config.\n\n * Type\n\ntype InspectConfigOptions = {\n  // View the config in the specified environment, the default is \"development\", can be set to \"production\"\n  env?: BuilderMode;\n  // Whether to enable verbose mode, display the complete content of the function in the config, the default is `false`\n  verbose?: boolean;\n  // Specify the output path, defaults to the value configured by `output.distPath.root`\n  outputPath?: string;\n  // Whether to write the result to disk, the default is `false`\n  writeToDisk?: boolean;\n};\n\nasync function InspectConfig(options?: InspectConfigOptions): Promise<{\n  builderConfig: string;\n  bundlerConfigs: string[];\n  origin: {\n    builderConfig: BuilderConfig;\n    bundlerConfigs: BundlerConfigs[];\n  };\n}>;\n\n\n * Example\n\nGet the config content in string format:\n\nconst { builderConfig, bundlerConfigs } = await builder.inspectConfig();\n\nconsole.log(builderConfig, bundlerConfigs);\n\n\nWrite the config content to disk:\n\nawait builder.inspectConfig({\n  writeToDisk: true,\n});\n\n\n\n# builder.onBeforeCreateCompiler\n\nCalled before creating the compiler instance, when you execute builder.startDevServer, builder.build or builder.createCompiler, this hook will be called. You can get the final config object of the bundler through the bundlerConfigs parameter.\n\n * Type\n\nfunction OnBeforeCreateCompiler(\n  callback: (params: {\n    bundlerConfigs: WebpackConfig[] | RspackConfig[];\n  }) => Promise<void> | void,\n): void;\n\n\n * Example\n\nbuilder.onBeforeCreateCompiler(({ bundlerConfigs }) => {\n  console.log('the bundler config is ', bundlerConfigs);\n});\n\n\n\n# builder.onAfterCreateCompiler\n\nCalled after creating a compiler instance, before executing a build, when you execute builder.startDevServer, builder.build or builder.createCompiler, this hook will be called. You can get the compiler instance through the compiler parameter.\n\n * Type\n\nfunction OnAfterCreateCompiler(callback: (params: {\n  compiler: Compiler | MultiCompiler;\n}) => Promise<void> | void;): void;\n\n\n * Example\n\nbuilder.onAfterCreateCompiler(({ compiler }) => {\n  console.log('the compiler is ', compiler);\n});\n\n\n\n# builder.onBeforeBuild\n\nCalled before executing the production environment build, you can get the final config object of the bundler through the bundlerConfigs parameter.\n\n * Type\n\nfunction OnBeforeBuild(\n  callback: (params: {\n    bundlerConfigs?: WebpackConfig[] | RspackConfig[];\n  }) => Promise<void> | void,\n): void;\n\n\n * Example\n\nbuilder.onBeforeBuild(({ bundlerConfigs }) => {\n  console.log('the bundler config is ', bundlerConfigs);\n});\n\n\n\n# builder.onAfterBuild\n\nCalled after executing the production build, you can get the build result information through the stats parameter.\n\n * Type\n\nfunction OnAfterBuild(\n  callback: (params: { stats?: Stats | MultiStats }) => Promise<void> | void,\n): void;\n\n\n * Example\n\nbuilder.onAfterBuild(({ stats }) => {\n  console.log(stats?.toJson());\n});\n\n\n\n# builder.onBeforeStartDevServer\n\nCalled before starting the development server.\n\n * Type\n\nfunction OnBeforeStartDevServer(callback: () => Promise<void> | void): void;\n\n\n * Example\n\nbuilder.onBeforeStartDevServer(() => {\n  console.log('before start!');\n});\n\n\n\n# builder.onAfterStartDevServer\n\nCalled after starting the development server, you can get the port number through the port parameter.\n\n * Type\n\nfunction OnAfterStartDevServer(\n  callback: (params: { port: number }) => Promise<void> | void,\n): void;\n\n\n * Example\n\nbuilder.onAfterStartDevServer(({ port }) => {\n  console.log('this port is: ', port);\n});\n\n\n\n# builder.onDevCompileDone\n\nCalled after each development environment build, you can use isFirstCompile to determine whether it is the first build.\n\n * Type\n\nfunction OnDevCompileDone(\n  callback: (params: { isFirstCompile: boolean }) => Promise<void> | void,\n): void;\n\n\n * Example\n\nbuilder.onDevCompileDone(({ isFirstCompile }) => {\n  if (isFirstCompile) {\n    console.log('first compile!');\n  } else {\n    console.log('re-compile!');\n  }\n});\n\n\n\n# builder.onExit\n\nCalled when the process is going to exit, this hook can only execute synchronous code.\n\n * Type\n\nfunction OnExit(callback: () => void): void;\n\n\n * Example\n\nbuilder.onExit(() => {\n  console.log('exit!');\n});\n\n\n\n# builder.getBuilderConfig\n\nGet the Builder config, this method must be called after the modifyBuilderConfig hook is executed.\n\n * Type\n\nfunction GetBuilderConfig(): Readonly<BuilderConfig>;\n\n\n * Example\n\nbuilder.onBeforeBuild(() => {\n  const config = builder.getBuilderConfig();\n  console.log(config.html?.title);\n});\n\n\n\n# builder.getNormalizedConfig\n\nGet the normalized Builder config, this method must be called after the modifyBuilderConfig hook is executed.\n\nCompared with the api.getBuilderConfig method, the config returned by this method has been normalized, and the type definition of the config will be narrowed. For example, the undefined type of config.html will be removed.\n\nIt is recommended to use this method to get the Builder config.\n\n * Type\n\nfunction GetNormalizedConfig(): Readonly<NormalizedConfig>;\n\n\n * Example\n\nbuilder.onBeforeBuild(() => {\n  const config = api.getNormalizedConfig();\n  console.log(config.html.title);\n});\n\n\n\n# builder.getHTMLPaths\n\nGet path information for all HTML assets.\n\nThis method will return an object, the key is the entry name and the value is the relative path of the HTML file in the dist directory.\n\n * Type\n\nfunction GetHTMLPaths(): Record<string, string>;\n\n\n * Example\n\nbuilder.onBeforeBuild(() => {\n  const htmlPaths = api.getHTMLPaths();\n  console.log(htmlPaths); // { main: 'html/main/index.html' };\n});\n",normalizedContent:"# builder instance\n\nthis section describes all the properties and methods on the builder instance object.\n\n\n# builder.context\n\nbuilder.context is a read-only object that provides some context infos.\n\n\n# builder.context.entry\n\nthe entry object, corresponding to the entry option of createbuilder method.\n\n * type\n\ntype builderentry = record<string, string | string[]>;\n\n\n\n# builder.context.target\n\nbuild target type, corresponding to the target option of createbuilder method.\n\n * type\n\ntype buildertarget = 'web' | 'node' | 'modern-web' | 'web-worker';\n\ntype context = {\n  target: buildertarget | buildertarget[];\n};\n\n\n\n# builder.context.rootpath\n\nthe root path of current build, corresponding to the cwd option of createbuilder method.\n\n * type\n\ntype rootpath = string;\n\n\n\n# builder.context.srcpath\n\nthe absolute path to the src directory.\n\n * type\n\ntype srcpath = string;\n\n\n\n# builder.context.distpath\n\nthe absolute path of the output directory, corresponding to the output.distpath.root config in builderconfig.\n\n * type\n\ntype distpath = string;\n\n\n\n# builder.context.cachepath\n\nthe absolute path of the build cache files.\n\n * type\n\ntype cachepath = string;\n\n\n\n# builder.context.configpath\n\nthe absolute path to the framework config file, corresponding to the configpath option of createbuilder method.\n\n * type\n\ntype configpath = string | undefined;\n\n\n\n# builder.context.tsconfigpath\n\nthe absolute path of the tsconfig.json file, or undefined if the tsconfig.json file does not exist in current project.\n\n * type\n\ntype tsconfigpath = string | undefined;\n\n\n\n# builder.context.framework\n\nthe name of the framework, a unique identifier, the default value is 'modern.js'.\n\n * type\n\ntype framework = string | undefined;\n\n\n\n# builder.context.devserver\n\ndev server information, including the current dev server hostname and port number.\n\n * type\n\ntype devserver = {\n  hostname: string;\n  port: number;\n};\n\n\n\n# builder.build\n\nperform a production build.\n\n * type\n\ntype buildoptions = {\n  mode?: 'development' | 'production';\n  watch?: boolean;\n  // custom compiler object\n  compiler?: compiler | multicompiler;\n};\n\nfunction build(options?: buildoptions): promise<void>;\n\n\n * example\n\nawait builder.build();\n\n\n\n# development environment build\n\nif you need to perform a development build, you can set the mode option to 'development'.\n\nawait builder.build({\n  mode: 'development',\n});\n\n\n\n# monitor file changes\n\nif you need to watch file changes and re-build, you can set the watch option to true.\n\nawait builder.build({\n  watch: true,\n});\n\n\n\n# custom compiler\n\nin some cases, you may want to use a custom compiler:\n\nconst compiler = webpack({\n  // ...\n});\nawait builder.build({\n  compiler,\n});\n\n\n\n# builder.startdevserver\n\nstart the local dev server, based on the modern.js dev server.\n\n * type\n\ntype startdevserveroptions = {\n  // whether to output url infos, the default is true\n  printurls?: boolean;\n  // whether to throw an exception when the port is occupied, the default is false\n  strictport?: boolean;\n  // custom compiler object\n  compiler?: compiler | multicompiler;\n  // passing through the build-independent dev server configuration\n  serveroptions?: partial<moderndevserveroptions>;\n};\n\ntype startdevserverresult = {\n  urls: string[];\n  port: number;\n  server: server;\n};\n\nfunction startdevserver(\n  options?: startdevserveroptions,\n): promise<startdevserverresult>;\n\n\n * example\n\nstart dev server:\n\nawait builder.startdevserver();\n\n\nafter successfully starting dev server, you can see the following logs:\n\ninfo    starting dev server...\ninfo    dev server running at:\n\n  > local:    http://localhost:8080\n  > network:  http://192.168.0.1:8080\n\n\nstartdevserver returns the following parameters:\n\n * urls: urls to access dev server.\n * port: the actual listening port number.\n * server: server instance object.\n\nconst { urls, port, server } = await builder.startdevserver();\nconsole.log(urls); // ['http://localhost:8080', 'http://192.168.0.1:8080']\nconsole.log(port); // 8080\n\n// close the dev server\nawait server.close();\n\n\n\n# disable print urls\n\nsetting printurls to false to disable the default url output, so you can custom the logs.\n\nawait builder.startdevserver({\n  printurls: false,\n});\n\n\n\n# strict port\n\nwhen a port is occupied, builder will automatically increment the port number until an available port is found.\n\nset strictport to true and builder will throw an exception when the port is occupied.\n\nawait builder.startdevserver({\n  strictport: true,\n});\n\n\n\n# custom compiler\n\nin some cases, you may want to use a custom compiler:\n\nconst compiler = webpack({\n  // ...\n});\nawait builder.startdevserver({\n  compiler,\n});\n\n\n\n# builder.createcompiler\n\ncreate a compiler object.\n\nwhen the target option of createbuilder contains only one value, the return value is compiler; when target contains multiple values, the return value is multicompiler.\n\n * type\n\nfunction createcompiler(): promise<compiler | multicompiler>;\n\n\n * example\n\nconst compiler = await builder.createcompiler();\n\n\n> in most scenarios, you do not need to use this api unless you need to custom the dev server or other advanced scenarios.\n\n\n# builder.addplugins\n\nregister one or more builder plugins, which can be called multiple times.\n\nthis method needs to be called before compiling. if it is called after compiling, it will not affect the compilation result.\n\n * type\n\ntype addpluginsoptions = { before?: string } | { after?: string };\n\nfunction addplugins(\n  plugins: builderplugins[],\n  options?: addpluginsoptions,\n): promise<void>;\n\n\n * example\n\nbuilder.addplugins([pluginfoo(), pluginbar()]);\n\n// insert before the bar plugin\nbuilder.addplugins([pluginfoo()], { before: 'bar' });\n\n// insert after the bar plugin\nbuilder.addplugins([pluginfoo()], { after: 'bar' });\n\n\n\n# builder.removeplugins\n\nremoves one or more builder plugins, which can be called multiple times.\n\nthis method needs to be called before compiling. if it is called after compiling, it will not affect the compilation result.\n\n * type\n\nfunction removeplugins(pluginnames: string[]): void;\n\n\n * example\n\n// add plugin\nconst pluginfoo = pluginfoo();\nbuilder.addplugins(pluginfoo);\n\n// remove plugin\nbuilder.removeplugins([pluginfoo.name]);\n\n\n\n# builder.ispluginexists\n\ndetermines whether a plugin has been registered.\n\n * type\n\nfunction ispluginexists(pluginname: string): boolean;\n\n\n * example\n\nbuilder.addplugins([pluginfoo()]);\n\nbuilder.ispluginexists(pluginfoo().name); // true\n\n\n\n# builder.inspectconfig\n\ninspect the final generated builder config and bundler config.\n\n * type\n\ntype inspectconfigoptions = {\n  // view the config in the specified environment, the default is \"development\", can be set to \"production\"\n  env?: buildermode;\n  // whether to enable verbose mode, display the complete content of the function in the config, the default is `false`\n  verbose?: boolean;\n  // specify the output path, defaults to the value configured by `output.distpath.root`\n  outputpath?: string;\n  // whether to write the result to disk, the default is `false`\n  writetodisk?: boolean;\n};\n\nasync function inspectconfig(options?: inspectconfigoptions): promise<{\n  builderconfig: string;\n  bundlerconfigs: string[];\n  origin: {\n    builderconfig: builderconfig;\n    bundlerconfigs: bundlerconfigs[];\n  };\n}>;\n\n\n * example\n\nget the config content in string format:\n\nconst { builderconfig, bundlerconfigs } = await builder.inspectconfig();\n\nconsole.log(builderconfig, bundlerconfigs);\n\n\nwrite the config content to disk:\n\nawait builder.inspectconfig({\n  writetodisk: true,\n});\n\n\n\n# builder.onbeforecreatecompiler\n\ncalled before creating the compiler instance, when you execute builder.startdevserver, builder.build or builder.createcompiler, this hook will be called. you can get the final config object of the bundler through the bundlerconfigs parameter.\n\n * type\n\nfunction onbeforecreatecompiler(\n  callback: (params: {\n    bundlerconfigs: webpackconfig[] | rspackconfig[];\n  }) => promise<void> | void,\n): void;\n\n\n * example\n\nbuilder.onbeforecreatecompiler(({ bundlerconfigs }) => {\n  console.log('the bundler config is ', bundlerconfigs);\n});\n\n\n\n# builder.onaftercreatecompiler\n\ncalled after creating a compiler instance, before executing a build, when you execute builder.startdevserver, builder.build or builder.createcompiler, this hook will be called. you can get the compiler instance through the compiler parameter.\n\n * type\n\nfunction onaftercreatecompiler(callback: (params: {\n  compiler: compiler | multicompiler;\n}) => promise<void> | void;): void;\n\n\n * example\n\nbuilder.onaftercreatecompiler(({ compiler }) => {\n  console.log('the compiler is ', compiler);\n});\n\n\n\n# builder.onbeforebuild\n\ncalled before executing the production environment build, you can get the final config object of the bundler through the bundlerconfigs parameter.\n\n * type\n\nfunction onbeforebuild(\n  callback: (params: {\n    bundlerconfigs?: webpackconfig[] | rspackconfig[];\n  }) => promise<void> | void,\n): void;\n\n\n * example\n\nbuilder.onbeforebuild(({ bundlerconfigs }) => {\n  console.log('the bundler config is ', bundlerconfigs);\n});\n\n\n\n# builder.onafterbuild\n\ncalled after executing the production build, you can get the build result information through the stats parameter.\n\n * type\n\nfunction onafterbuild(\n  callback: (params: { stats?: stats | multistats }) => promise<void> | void,\n): void;\n\n\n * example\n\nbuilder.onafterbuild(({ stats }) => {\n  console.log(stats?.tojson());\n});\n\n\n\n# builder.onbeforestartdevserver\n\ncalled before starting the development server.\n\n * type\n\nfunction onbeforestartdevserver(callback: () => promise<void> | void): void;\n\n\n * example\n\nbuilder.onbeforestartdevserver(() => {\n  console.log('before start!');\n});\n\n\n\n# builder.onafterstartdevserver\n\ncalled after starting the development server, you can get the port number through the port parameter.\n\n * type\n\nfunction onafterstartdevserver(\n  callback: (params: { port: number }) => promise<void> | void,\n): void;\n\n\n * example\n\nbuilder.onafterstartdevserver(({ port }) => {\n  console.log('this port is: ', port);\n});\n\n\n\n# builder.ondevcompiledone\n\ncalled after each development environment build, you can use isfirstcompile to determine whether it is the first build.\n\n * type\n\nfunction ondevcompiledone(\n  callback: (params: { isfirstcompile: boolean }) => promise<void> | void,\n): void;\n\n\n * example\n\nbuilder.ondevcompiledone(({ isfirstcompile }) => {\n  if (isfirstcompile) {\n    console.log('first compile!');\n  } else {\n    console.log('re-compile!');\n  }\n});\n\n\n\n# builder.onexit\n\ncalled when the process is going to exit, this hook can only execute synchronous code.\n\n * type\n\nfunction onexit(callback: () => void): void;\n\n\n * example\n\nbuilder.onexit(() => {\n  console.log('exit!');\n});\n\n\n\n# builder.getbuilderconfig\n\nget the builder config, this method must be called after the modifybuilderconfig hook is executed.\n\n * type\n\nfunction getbuilderconfig(): readonly<builderconfig>;\n\n\n * example\n\nbuilder.onbeforebuild(() => {\n  const config = builder.getbuilderconfig();\n  console.log(config.html?.title);\n});\n\n\n\n# builder.getnormalizedconfig\n\nget the normalized builder config, this method must be called after the modifybuilderconfig hook is executed.\n\ncompared with the api.getbuilderconfig method, the config returned by this method has been normalized, and the type definition of the config will be narrowed. for example, the undefined type of config.html will be removed.\n\nit is recommended to use this method to get the builder config.\n\n * type\n\nfunction getnormalizedconfig(): readonly<normalizedconfig>;\n\n\n * example\n\nbuilder.onbeforebuild(() => {\n  const config = api.getnormalizedconfig();\n  console.log(config.html.title);\n});\n\n\n\n# builder.gethtmlpaths\n\nget path information for all html assets.\n\nthis method will return an object, the key is the entry name and the value is the relative path of the html file in the dist directory.\n\n * type\n\nfunction gethtmlpaths(): record<string, string>;\n\n\n * example\n\nbuilder.onbeforebuild(() => {\n  const htmlpaths = api.gethtmlpaths();\n  console.log(htmlpaths); // { main: 'html/main/index.html' };\n});\n",charsets:{cjk:!0}},{title:"Builder Types",frontmatter:{extractApiHeaders:[2]},regularPath:"/en/api/builder-types.html",relativePath:"en/api/builder-types.md",key:"v-77f8ec80",path:"/en/api/builder-types.html",headers:[{level:2,title:"BuilderInstance",slug:"builderinstance",normalizedTitle:"builderinstance",charIndex:98},{level:2,title:"BuilderContext",slug:"buildercontext",normalizedTitle:"buildercontext",charIndex:583},{level:2,title:"BuilderPlugin",slug:"builderplugin",normalizedTitle:"builderplugin",charIndex:771},{level:2,title:"BuilderTarget",slug:"buildertarget",normalizedTitle:"buildertarget",charIndex:1119},{level:2,title:"BuilderEntry",slug:"builderentry",normalizedTitle:"builderentry",charIndex:1223},{level:2,title:"CreateBuilderOptions",slug:"createbuilderoptions",normalizedTitle:"createbuilderoptions",charIndex:1357}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"BuilderInstance BuilderContext BuilderPlugin BuilderTarget BuilderEntry CreateBuilderOptions",content:"# Builder Types\n\nThis section describes some of the type definitions provided by the Builder.\n\n\n# BuilderInstance\n\nThe type of the Builder instance.\n\nimport type { BuilderInstance } from '@modern-js/builder';\n\nlet builder: BuilderInstance;\n\n\nYou can pass in the Provider type through generics to make the type definition of the Builder instance more accurate:\n\nimport type { createBuilder, type BuilderInstance } from '@modern-js/builder';\nimport type { BuilderWebpackProvider } from '@modern-js/builder-webpack-provider';\n\nlet builder: BuilderInstance<BuilderWebpackProvider>;\n\n\n\n# BuilderContext\n\nThe type of the context property in the Builder instance.\n\nimport type { BuilderContext } from '@modern-js/builder';\n\nconst context: BuilderContext = builder.context;\n\n\n\n# BuilderPlugin\n\nThe type of Builder plugin, should be used with the BuilderPluginAPI type exported from the provider.\n\nimport type { BuilderPlugin } from '@modern-js/builder';\nimport type { BuilderPluginAPI } from '@modern-js/builder-webpack-provider';\n\nconst myPlugin: BuilderPlugin<BuilderPluginAPI> = {\n  name: 'my-plugin',\n  setup() {},\n};\n\n\n\n# BuilderTarget\n\nThe type of build target.\n\nimport type { BuilderTarget } from '@modern-js/builder';\n\n\n\n# BuilderEntry\n\nThe type of the entry option to the createBuilder method.\n\nimport type { BuilderEntry } from '@modern-js/builder';\n\n\n\n# CreateBuilderOptions\n\nThe param type of createBuilder method.\n\nimport type { CreateBuilderOptions } from '@modern-js/builder';\n",normalizedContent:"# builder types\n\nthis section describes some of the type definitions provided by the builder.\n\n\n# builderinstance\n\nthe type of the builder instance.\n\nimport type { builderinstance } from '@modern-js/builder';\n\nlet builder: builderinstance;\n\n\nyou can pass in the provider type through generics to make the type definition of the builder instance more accurate:\n\nimport type { createbuilder, type builderinstance } from '@modern-js/builder';\nimport type { builderwebpackprovider } from '@modern-js/builder-webpack-provider';\n\nlet builder: builderinstance<builderwebpackprovider>;\n\n\n\n# buildercontext\n\nthe type of the context property in the builder instance.\n\nimport type { buildercontext } from '@modern-js/builder';\n\nconst context: buildercontext = builder.context;\n\n\n\n# builderplugin\n\nthe type of builder plugin, should be used with the builderpluginapi type exported from the provider.\n\nimport type { builderplugin } from '@modern-js/builder';\nimport type { builderpluginapi } from '@modern-js/builder-webpack-provider';\n\nconst myplugin: builderplugin<builderpluginapi> = {\n  name: 'my-plugin',\n  setup() {},\n};\n\n\n\n# buildertarget\n\nthe type of build target.\n\nimport type { buildertarget } from '@modern-js/builder';\n\n\n\n# builderentry\n\nthe type of the entry option to the createbuilder method.\n\nimport type { builderentry } from '@modern-js/builder';\n\n\n\n# createbuilderoptions\n\nthe param type of createbuilder method.\n\nimport type { createbuilderoptions } from '@modern-js/builder';\n",charsets:{}},{title:"Dev Config",frontmatter:{extractApiHeaders:[2]},regularPath:"/en/api/config-dev.html",relativePath:"en/api/config-dev.md",key:"v-5d4e540c",path:"/en/api/config-dev.html",headers:[{level:2,title:"dev.assetPrefix",slug:"dev-assetprefix",normalizedTitle:"dev.assetprefix",charIndex:87},{level:2,title:"dev.hmr",slug:"dev-hmr",normalizedTitle:"dev.hmr",charIndex:1229},{level:2,title:"dev.https",slug:"dev-https",normalizedTitle:"dev.https",charIndex:1443},{level:2,title:"dev.port",slug:"dev-port",normalizedTitle:"dev.port",charIndex:2784},{level:2,title:"dev.progressBar",slug:"dev-progressbar",normalizedTitle:"dev.progressbar",charIndex:3083},{level:2,title:"dev.startUrl",slug:"dev-starturl",normalizedTitle:"dev.starturl",charIndex:3501}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"dev.assetPrefix dev.hmr dev.https dev.port dev.progressBar dev.startUrl",content:"# Dev Config\n\nThis section describes some dev configurations in Modern.js Builder.\n\n\n# dev.assetPrefix\n\n * Type: boolean | string\n * Default: '/'\n\nSet the URL prefix of static assets in the development environment, similar to the output.publicPath config of webpack.\n\nassetPrefix will affect the URLs of most of the static assets, including JavaScript files, CSS files, images, videos, etc. If an incorrect value is specified, you'll receive 404 errors while loading these resources.\n\nThis config is only used in the development environment. In the production environment, please use the output.assetPrefix to set the URL prefix.\n\n# Boolean Type\n\nIf assetPrefix is set to true, the URL prefix will be //ip:port/:\n\nexport default {\n  dev: {\n    assetPrefix: true,\n  },\n};\n\n\nThe script URL will be:\n\n<script defer src=\"//${ip}:8080/static/js/main.js\"><\/script>\n\n\nIf assetPrefix is set to false or not set, / is used as the default value.\n\n# String type\n\nWhen the value of assetPrefix is string type, the string will be used as the URL prefix:\n\nexport default {\n  dev: {\n    assetPrefix: 'http://example.com/assets/',\n  },\n};\n\n\nThe script URL will be:\n\n<script defer src=\"http://example.com/assets/static/js/main.js\"><\/script>\n\n\n\n# dev.hmr\n\n * Type: boolean\n * Default: true\n\nWhether to enable Hot Module Replacement.\n\nIf hmr is set to false, the HMR and react-refresh will no longer work.\n\nexport default {\n  dev: {\n    hmr: false,\n  },\n};\n\n\n\n# dev.https\n\n * Type: boolean | { key: string; cert: string }\n * Default: false\n\nAfter configuring this option, you can enable HTTPS Dev Server, and disabling the HTTP Dev Server.\n\nHTTP:\n\n  > Local: http://localhost:8080/\n  > Network: http://192.168.0.1:8080/\n\n\nHTTPS:\n\n  > Local: https://localhost:8080/\n  > Network: https://192.168.0.1:8080/\n\n\n# Automatically generate certificates\n\nYou can directly set https to true, Builder will automatically generate the HTTPS certificate based on devcert.\n\nexport default {\n  dev: {\n    https: true,\n  },\n};\n\n\nThe devcert has some limitations, it does not currently support IP addresses yet.\n\nTIP\n\nThe https proxy automatically installs the certificate and needs root authority, please enter the password according to the prompt. The password is only used to trust the certificate, and will not be leaked or be used elsewhere.\n\n# Manually set the certificate\n\nYou can also manually pass in the certificate and the private key required in the dev.https option. This parameter will be directly passed to the createServer method of the https module in Node.js.\n\nFor details, please refer to https.createServer.\n\nimport fs from 'fs';\n\nexport default {\n  dev: {\n    https: {\n      key: fs.readFileSync('certificates/private.pem'),\n      cert: fs.readFileSync('certificates/public.pem'),\n    },\n  },\n};\n\n\n\n# dev.port\n\n * Type: number\n * Default: 8080\n\nSpecify a port number for Dev Server to listen.\n\nBy default, Dev Server listens on port 8080 and automatically increments the port number when the port is occupied.\n\n# Example\n\nSet the port to 3000:\n\nexport default {\n  dev: {\n    port: 3000,\n  },\n};\n\n\n\n# dev.progressBar\n\n * Type:\n\ntype ProgressBar =\n  | boolean\n  | {\n      id?: string;\n    };\n\n\n * Default: true\n\nWhether to display progress bar during compilation.\n\nexport default {\n  dev: {\n    progressBar: false,\n  },\n};\n\n\nIf you need to modify the text displayed on the left side of the progress bar, you can set the id option:\n\nexport default {\n  dev: {\n    progressBar: {\n      id: 'Some Text',\n    },\n  },\n};\n\n\n\n# dev.startUrl\n\n * Type: boolean | string | string[] | undefined\n * Default: undefined\n\ndev.startUrl is used to set the URL of the page that automatically opens in the browser when Dev Server starts.\n\nBy default, no page will be opened.\n\nYou can set it to the following values:\n\nexport default {\n  dev: {\n    // Open the project's default preview page\n    startUrl: true,\n    // Open the specified page\n    startUrl: 'http://localhost:8080',\n    // Open multiple pages\n    startUrl: ['http://localhost:8080', 'http://localhost:8080/about'],\n  },\n};\n",normalizedContent:"# dev config\n\nthis section describes some dev configurations in modern.js builder.\n\n\n# dev.assetprefix\n\n * type: boolean | string\n * default: '/'\n\nset the url prefix of static assets in the development environment, similar to the output.publicpath config of webpack.\n\nassetprefix will affect the urls of most of the static assets, including javascript files, css files, images, videos, etc. if an incorrect value is specified, you'll receive 404 errors while loading these resources.\n\nthis config is only used in the development environment. in the production environment, please use the output.assetprefix to set the url prefix.\n\n# boolean type\n\nif assetprefix is set to true, the url prefix will be //ip:port/:\n\nexport default {\n  dev: {\n    assetprefix: true,\n  },\n};\n\n\nthe script url will be:\n\n<script defer src=\"//${ip}:8080/static/js/main.js\"><\/script>\n\n\nif assetprefix is set to false or not set, / is used as the default value.\n\n# string type\n\nwhen the value of assetprefix is string type, the string will be used as the url prefix:\n\nexport default {\n  dev: {\n    assetprefix: 'http://example.com/assets/',\n  },\n};\n\n\nthe script url will be:\n\n<script defer src=\"http://example.com/assets/static/js/main.js\"><\/script>\n\n\n\n# dev.hmr\n\n * type: boolean\n * default: true\n\nwhether to enable hot module replacement.\n\nif hmr is set to false, the hmr and react-refresh will no longer work.\n\nexport default {\n  dev: {\n    hmr: false,\n  },\n};\n\n\n\n# dev.https\n\n * type: boolean | { key: string; cert: string }\n * default: false\n\nafter configuring this option, you can enable https dev server, and disabling the http dev server.\n\nhttp:\n\n  > local: http://localhost:8080/\n  > network: http://192.168.0.1:8080/\n\n\nhttps:\n\n  > local: https://localhost:8080/\n  > network: https://192.168.0.1:8080/\n\n\n# automatically generate certificates\n\nyou can directly set https to true, builder will automatically generate the https certificate based on devcert.\n\nexport default {\n  dev: {\n    https: true,\n  },\n};\n\n\nthe devcert has some limitations, it does not currently support ip addresses yet.\n\ntip\n\nthe https proxy automatically installs the certificate and needs root authority, please enter the password according to the prompt. the password is only used to trust the certificate, and will not be leaked or be used elsewhere.\n\n# manually set the certificate\n\nyou can also manually pass in the certificate and the private key required in the dev.https option. this parameter will be directly passed to the createserver method of the https module in node.js.\n\nfor details, please refer to https.createserver.\n\nimport fs from 'fs';\n\nexport default {\n  dev: {\n    https: {\n      key: fs.readfilesync('certificates/private.pem'),\n      cert: fs.readfilesync('certificates/public.pem'),\n    },\n  },\n};\n\n\n\n# dev.port\n\n * type: number\n * default: 8080\n\nspecify a port number for dev server to listen.\n\nby default, dev server listens on port 8080 and automatically increments the port number when the port is occupied.\n\n# example\n\nset the port to 3000:\n\nexport default {\n  dev: {\n    port: 3000,\n  },\n};\n\n\n\n# dev.progressbar\n\n * type:\n\ntype progressbar =\n  | boolean\n  | {\n      id?: string;\n    };\n\n\n * default: true\n\nwhether to display progress bar during compilation.\n\nexport default {\n  dev: {\n    progressbar: false,\n  },\n};\n\n\nif you need to modify the text displayed on the left side of the progress bar, you can set the id option:\n\nexport default {\n  dev: {\n    progressbar: {\n      id: 'some text',\n    },\n  },\n};\n\n\n\n# dev.starturl\n\n * type: boolean | string | string[] | undefined\n * default: undefined\n\ndev.starturl is used to set the url of the page that automatically opens in the browser when dev server starts.\n\nby default, no page will be opened.\n\nyou can set it to the following values:\n\nexport default {\n  dev: {\n    // open the project's default preview page\n    starturl: true,\n    // open the specified page\n    starturl: 'http://localhost:8080',\n    // open multiple pages\n    starturl: ['http://localhost:8080', 'http://localhost:8080/about'],\n  },\n};\n",charsets:{cjk:!0}},{title:"Experiments Config",frontmatter:{extractApiHeaders:[2]},regularPath:"/en/api/config-experiments.html",relativePath:"en/api/config-experiments.md",key:"v-2ecbbb6c",path:"/en/api/config-experiments.html",headers:[{level:2,title:"experiments.lazyCompilation",slug:"experiments-lazycompilation",normalizedTitle:"experiments.lazycompilation",charIndex:252}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"experiments.lazyCompilation",content:"# Experiments Config\n\nThis section describes some experimental configs in the Builder, which can enable unstable features in Builder.\n\nIf you meet issues with experimental features, please disable the config first and report through GitHub Issues.\n\n\n# experiments.lazyCompilation\n\n * Type:\n\ntype LazyCompilationOptions =\n  | boolean\n  | {\n      // Whether to enable lazy compilation for entries\n      entries?: boolean;\n      // Whether to enable lazy compilation for dynamic imports\n      imports?: boolean;\n    };\n\n\n * Default: false\n\nUsed to enable the lazy compilation (i.e. compile on demand). When this config is enabled, Builder will compile entrypoints and dynamic imports only when they are used. It will improve the compilation startup time of the project.\n\nLazy compilation only takes effect in the development.\n\n\n# Lazy Compilation for Dynamic Imports\n\nLazy compile async modules introduced by Dynamic Import:\n\nexport default {\n  experiments: {\n    lazyCompilation: {\n      imports: true,\n      entries: false,\n    },\n  },\n};\n\n\nWhen imports option is enabled, all async modules will only be compiled when requested. If your project is a single-page application, and routing is split through Dynamic Import, there will be a significant effect of speeding up compilation.\n\n\n# Lazy Compilation for Entires\n\nIn addition to lazy compilation for async modules, you can also choose to lazily compile both entries and async modules at the same time.\n\nexport default {\n  experiments: {\n    lazyCompilation: {\n      imports: true,\n      entries: true,\n    },\n  },\n};\n\n\nThe above config can also be simplified to:\n\nexport default {\n  experiments: {\n    lazyCompilation: true,\n  },\n};\n\n\nWhen entries option is enabled, all pages will not be compiled when the compilation is started, and the page will be compiled only when you visit it.\n\nWhen using lazy compilation for entries, there are some considerations:\n\n * Only work for multi-page applications, no work for single-page applications.\n * when you visit a page, there will be a white screen for a period of time due to waiting for the page to be compiled.\n\nDisable split chunks\n\nWhen you enable lazy compilation, in order to ensure the compilation results, Builder will disable split chunks in the development. This will not affect the build results in the production, but will cause a difference between the build results of the development and production.",normalizedContent:"# experiments config\n\nthis section describes some experimental configs in the builder, which can enable unstable features in builder.\n\nif you meet issues with experimental features, please disable the config first and report through github issues.\n\n\n# experiments.lazycompilation\n\n * type:\n\ntype lazycompilationoptions =\n  | boolean\n  | {\n      // whether to enable lazy compilation for entries\n      entries?: boolean;\n      // whether to enable lazy compilation for dynamic imports\n      imports?: boolean;\n    };\n\n\n * default: false\n\nused to enable the lazy compilation (i.e. compile on demand). when this config is enabled, builder will compile entrypoints and dynamic imports only when they are used. it will improve the compilation startup time of the project.\n\nlazy compilation only takes effect in the development.\n\n\n# lazy compilation for dynamic imports\n\nlazy compile async modules introduced by dynamic import:\n\nexport default {\n  experiments: {\n    lazycompilation: {\n      imports: true,\n      entries: false,\n    },\n  },\n};\n\n\nwhen imports option is enabled, all async modules will only be compiled when requested. if your project is a single-page application, and routing is split through dynamic import, there will be a significant effect of speeding up compilation.\n\n\n# lazy compilation for entires\n\nin addition to lazy compilation for async modules, you can also choose to lazily compile both entries and async modules at the same time.\n\nexport default {\n  experiments: {\n    lazycompilation: {\n      imports: true,\n      entries: true,\n    },\n  },\n};\n\n\nthe above config can also be simplified to:\n\nexport default {\n  experiments: {\n    lazycompilation: true,\n  },\n};\n\n\nwhen entries option is enabled, all pages will not be compiled when the compilation is started, and the page will be compiled only when you visit it.\n\nwhen using lazy compilation for entries, there are some considerations:\n\n * only work for multi-page applications, no work for single-page applications.\n * when you visit a page, there will be a white screen for a period of time due to waiting for the page to be compiled.\n\ndisable split chunks\n\nwhen you enable lazy compilation, in order to ensure the compilation results, builder will disable split chunks in the development. this will not affect the build results in the production, but will cause a difference between the build results of the development and production.",charsets:{cjk:!0}},{title:"Html Config",frontmatter:{extractApiHeaders:[2]},regularPath:"/en/api/config-html.html",relativePath:"en/api/config-html.md",key:"v-367cff22",path:"/en/api/config-html.html",headers:[{level:2,title:"html.appIcon",slug:"html-appicon",normalizedTitle:"html.appicon",charIndex:89},{level:2,title:"html.crossorigin",slug:"html-crossorigin",normalizedTitle:"html.crossorigin",charIndex:646},{level:2,title:"html.disableHtmlFolder",slug:"html-disablehtmlfolder",normalizedTitle:"html.disablehtmlfolder",charIndex:1070},{level:2,title:"html.favicon",slug:"html-favicon",normalizedTitle:"html.favicon",charIndex:1716},{level:2,title:"html.faviconByEntries",slug:"html-faviconbyentries",normalizedTitle:"html.faviconbyentries",charIndex:2189},{level:2,title:"html.inject",slug:"html-inject",normalizedTitle:"html.inject",charIndex:2782},{level:2,title:"html.injectByEntries",slug:"html-injectbyentries",normalizedTitle:"html.injectbyentries",charIndex:4032},{level:2,title:"html.meta",slug:"html-meta",normalizedTitle:"html.meta",charIndex:4643},{level:2,title:"html.metaByEntries",slug:"html-metabyentries",normalizedTitle:"html.metabyentries",charIndex:5897},{level:2,title:"html.mountId",slug:"html-mountid",normalizedTitle:"html.mountid",charIndex:6545},{level:2,title:"html.template",slug:"html-template",normalizedTitle:"html.template",charIndex:7090},{level:2,title:"html.templateByEntries",slug:"html-templatebyentries",normalizedTitle:"html.templatebyentries",charIndex:7419},{level:2,title:"html.templateParameters",slug:"html-templateparameters",normalizedTitle:"html.templateparameters",charIndex:7904},{level:2,title:"html.templateParametersByEntries",slug:"html-templateparametersbyentries",normalizedTitle:"html.templateparametersbyentries",charIndex:9882},{level:2,title:"html.title",slug:"html-title",normalizedTitle:"html.title",charIndex:8086},{level:2,title:"html.titleByEntries",slug:"html-titlebyentries",normalizedTitle:"html.titlebyentries",charIndex:10547}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"html.appIcon html.crossorigin html.disableHtmlFolder html.favicon html.faviconByEntries html.inject html.injectByEntries html.meta html.metaByEntries html.mountId html.template html.templateByEntries html.templateParameters html.templateParametersByEntries html.title html.titleByEntries",content:"# Html Config\n\nThis section describes some HTML configurations in Modern.js Builder.\n\n\n# html.appIcon\n\n * Type: string\n * Default: undefined\n\nSet the file path of the app icon, which can be a relative path or an absolute path.\n\nAfter config this option, the icon will be automatically copied to the dist directory during the compilation, and the corresponding link tag will be added to the HTML.\n\n# Example\n\nexport default {\n  html: {\n    appIcon: './src/assets/icon.png',\n  },\n};\n\n\nAfter recompiling, the following tags are automatically generated in the HTML:\n\n<link rel=\"apple-touch-icon\" sizes=\"180*180\" href=\"/static/image/icon.png\" />\n\n\n\n# html.crossorigin\n\n * Type: boolean | 'anonymous' | 'use-credentials'\n * Default: false\n\nSet the crossorigin attribute of the <script> tag.\n\nWhen true is passed, it is automatically set to crossorigin=\"anonymous\".\n\n# Example\n\nexport default {\n  html: {\n    crossorigin: 'anonymous',\n  },\n};\n\n\nAfter compilation, the <script> tag in HTML becomes:\n\n<script defer src=\"/static/js/main.js\" crossorigin=\"anonymous\"><\/script>\n\n\n\n# html.disableHtmlFolder\n\n * Type: boolean\n * Default: false\n\nRemove the folder of the HTML files. When this option is enabled, the generated HTML file path will change from [name]/index.html to [name].html.\n\n# Example\n\nBy default, the structure of HTML files in the dist directory is:\n\n/dist\n└── html\n    └── main\n        └── index.html\n\n\nEnable the html.disableHtmlFolder config:\n\nexport default {\n  html: {\n    disableHtmlFolder: true,\n  },\n};\n\n\nAfter recompiling, the directory structure of the HTML files in dist is:\n\n/dist\n└── html\n    └── main.html\n\n\n> If you want to set the path of the HTML files, use the output.distPath.html config.\n\n\n# html.favicon\n\n * Type: string\n * Default: undefined\n\nSet the favicon icon for all pages.\n\nAfter config this option, the favicon will be automatically copied to the dist directory during the compilation, and the corresponding link tag will be added to the HTML.\n\n# Example\n\nexport default {\n  html: {\n    favicon: './src/assets/icon.png',\n  },\n};\n\n\nAfter recompiling, the following tags are automatically generated in the HTML:\n\n<link rel=\"icon\" href=\"/favicon.ico\" />\n\n\n\n# html.faviconByEntries\n\n * Type: Record<string, string>\n * Default: undefined\n\nSet different favicon for different pages.\n\nThe usage is same as favicon, and you can use the \"entry name\" as the key to set each page individually.\n\nfaviconByEntries will overrides the value set in favicon.\n\n# Example\n\nexport default {\n  html: {\n    favicon: './src/assets/default.png',\n    faviconByEntries: {\n      foo: './src/assets/foo.png',\n    },\n  },\n};\n\n\nAfter recompiling, you will see:\n\n * The favicon for page foo is ./src/assets/foo.png.\n * The favicon for other pages is ./src/assets/default.png.\n\n\n# html.inject\n\n * Type: 'head' | 'body' | 'true' | false\n * Default: 'head'\n\nSet the inject position of the <script> tag.\n\nCan be set to the following values:\n\n * 'head': The script tag will be inject inside the head tag.\n * 'body': The script tag is inject at the end of the body tag.\n * true: The result depends on the scriptLoading config of html-webpack-plugin.\n * false: script tags will not be injected.\n\n# Default inject position\n\nThe script tag is inside the head tag by default:\n\n<html>\n  <head>\n    <title></title>\n    <script defer src=\"/static/js/runtime-main.js\"><\/script>\n    <script defer src=\"/static/js/main.js\"><\/script>\n    <link href=\"/static/css/main.css\" rel=\"stylesheet\" />\n  </head>\n  <body>\n    <div id=\"root\"></div>\n  </body>\n</html>\n\n\n# Inject into body\n\nAdd the following config to inject script into the body tag:\n\nexport default {\n  html: {\n    inject: 'body',\n  },\n};\n\n\nYou will see that the script tag is generated at the end of the body tag:\n\n<html>\n  <head>\n    <title></title>\n    <link href=\"/static/css/main.css\" rel=\"stylesheet\" />\n  </head>\n  <body>\n    <div id=\"root\"></div>\n    <script defer src=\"/static/js/runtime-main.js\"><\/script>\n    <script defer src=\"/static/js/main.js\"><\/script>\n  </body>\n</html>\n\n\n\n# html.injectByEntries\n\n * Type: Record<string, boolean | string>\n * Default: undefined\n\nSet different script tag inject positions for different pages.\n\nThe usage is same as inject, and you can use the \"entry name\" as the key to set each page individually.\n\ninjectByEntries will overrides the value set in inject.\n\n# Example\n\nexport default {\n  html: {\n    inject: 'head',\n    injectByEntries: {\n      foo: 'body',\n    },\n  },\n};\n\n\nAfter recompiling, you will see:\n\n * The script tag of the page foo will be injected inside the body tag.\n * The script tag of other pages will be injected inside the head tag.\n\n\n# html.meta\n\n * Type: Record<string, false | string | Record<string, string | boolean>>\n * Default: undefined\n\nConfigure the <meta> tag of the HTML.\n\n# String Type\n\nWhen the value of a meta object is a string, the key of the object is automatically mapped to name, and the value is mapped to content.\n\nFor example to set description:\n\nexport default {\n  html: {\n    meta: {\n      description: 'a description of the page',\n    },\n  },\n};\n\n\nThe generated meta tag in HTML is:\n\n<meta name=\"description\" content=\"a description of the page\" />\n\n\n# Object Type\n\nWhen the value of a meta object is an object, the key: value of the object is mapped to the attribute of the meta tag.\n\nIn this case, the name and content properties will not be set by default.\n\nFor example to set http-equiv:\n\nexport default {\n  html: {\n    meta: {\n      'http-equiv': {\n        'http-equiv': 'x-ua-compatible',\n        content: 'ie=edge',\n      },\n    },\n  },\n};\n\n\nThe meta tag in HTML is:\n\n<meta http-equiv=\"x-ua-compatible\" content=\"ie=edge\" />\n\n\n\n# Remove Default Value\n\nSetting the value of the meta object to false and the meta tag will not be generated.\n\nFor example to remove the imagemode:\n\nexport default {\n  html: {\n    meta: {\n      imagemode: false,\n    },\n  },\n};\n\n\n\n# html.metaByEntries\n\n * Type: Record<string, Meta>\n * Default: undefined\n\nSet different meta tags for different pages.\n\nThe usage is same as meta, and you can use the \"entry name\" as the key to set each page individually.\n\nmetaByEntries will overrides the value set in meta.\n\n# Example\n\nexport default {\n  html: {\n    meta: {\n      description: 'ByteDance',\n    },\n    metaByEntries: {\n      foo: {\n        description: 'TikTok',\n      },\n    },\n  },\n};\n\n\nAfter compiling, you can see that the meta of the page foo is:\n\n<meta name=\"description\" content=\"TikTok\" />\n\n\nThe meta of other pages is:\n\n<meta name=\"description\" content=\"ByteDance\" />\n\n\n\n# html.mountId\n\n * Type: string\n * Default: 'root'\n\nBy default, the root element is included in the HTML template for component mounting, and the element id can be modified through mountId.\n\n<body>\n  <div id=\"root\"></div>\n</body>\n\n\n# Example\n\nSet the id to app:\n\nexport default {\n  html: {\n    mountId: 'app',\n  },\n};\n\n\nAfter compilation:\n\n<body>\n  <div id=\"app\"></div>\n</body>\n\n\nTIP\n\nIf you customized the HTML template, please make sure that the template contains <div id=\"<%= mountId %>\"></div>, otherwise this config will not take effect.\n\n\n# html.template\n\n * Type: string\n * Default:\n\nDefine the path to the HTML template, corresponding to the template config of html-webpack-plugin.\n\n# Example\n\nReplace the default template with a custom HTML template file，you can add the following config:\n\nexport default {\n  html: {\n    template: './static/index.html',\n  },\n};\n\n\n\n# html.templateByEntries\n\n * Type: Object\n * Default: undefined\n\nSet different template file for different pages.\n\nThe usage is same as template, and you can use the \"entry name\" as the key to set each page individually.\n\ntemplateByEntries will overrides the value set in template.\n\n# Example\n\nexport default {\n  output: {\n    template: './static/index.html',\n    templateByEntries: {\n      foo: './src/pages/foo/index.html',\n      bar: './src/pages/bar/index.html',\n    },\n  },\n};\n\n\n\n# html.templateParameters\n\n * Type: Object | Function\n * Default:\n\ntype DefaultParameters = {\n  meta: string; // corresponding to html.meta config\n  title: string; // corresponding to html.title config\n  mountId: string; // corresponding to html.mountId config\n  entryName: string; // entry name\n  assetPrefix: string; // corresponding to output.assetPrefix config\n  compilation: webpack.Compilation; // Compilation object corresponding to webpack\n  webpackConfig: config; // webpack config\n  // htmlWebpackPlugin built-in parameters\n  // See https://github.com/jantimon/html-webpack-plugin for details\n  htmlWebpackPlugin: {\n    tags: object;\n    files: object;\n    options: object;\n  };\n};\n\n\nDefine the parameters in the HTML template, corresponding to the templateParameters config of html-webpack-plugin. You can use the config as an object or a function.\n\nIf it is an object, it will be merged with the default parameters. For example:\n\nexport default {\n  html: {\n    templateParameters: {\n      title: 'My App',\n    },\n  },\n};\n\n\nIf it is a function, the default parameters will be passed in, and you can return an object to override the default parameters. For example:\n\nexport default {\n  html: {\n    templateParameters: defaultParameters => {\n      console.log(defaultParameters.compilation);\n      console.log(defaultParameters.title);\n      return {\n        title: 'My App',\n      };\n    },\n  },\n};\n\n\n# Example\n\nTo use the foo parameter in the HTML template, you can add the following config:\n\nexport default {\n  html: {\n    templateParameters: {\n      foo: 'bar',\n    },\n  },\n};\n\n\nOr you can use a function to dynamically generate the parameters:\n\nexport default {\n  html: {\n    templateParameters: defaultParameters => {\n      return {\n        foo: 'bar',\n      };\n    },\n  },\n};\n\n\nThen you can use the foo parameter in the HTML template by <%= foo %>:\n\n<script>\n  window.foo = '<%= foo %>';\n<\/script>\n\n\nThe compiled HTML is:\n\n<script>window.foo = 'bar'<\/script>\n\n\n\n# html.templateParametersByEntries\n\n * Type: Object\n * Default: undefined\n\nSet different template parameters for different pages.\n\nThe usage is same as templateParameters, and you can use the \"entry name\" as the key to set each page individually.\n\ntemplateParametersByEntries will overrides the value set in templateParameters.\n\n# Example\n\nexport default {\n  html: {\n    templateParametersByEntries: {\n      foo: {\n        type: 'a',\n      },\n      bar: {\n        type: 'b',\n      },\n    },\n  },\n};\n\n\n\n# html.title\n\n * Type: string\n * Default: undefined\n\nSet the title tag of the HTML page, for example:\n\nexport default {\n  html: {\n    title: 'example',\n  },\n};\n\n\n\n# html.titleByEntries\n\n * Type: Record<string, string>\n * Default: undefined\n\nSet different title for different pages.\n\nThe usage is same as title, and you can use the \"entry name\" as the key to set each page individually.\n\ntitleByEntries will overrides the value set in title.\n\n# Example\n\nexport default {\n  html: {\n    title: 'ByteDance',\n    titleByEntries: {\n      foo: 'TikTok',\n    },\n  },\n};\n\n\nAfter recompiling, you can see:\n\n * The title of the page foo is TikTok.\n * The title of other pages is ByteDance.",normalizedContent:"# html config\n\nthis section describes some html configurations in modern.js builder.\n\n\n# html.appicon\n\n * type: string\n * default: undefined\n\nset the file path of the app icon, which can be a relative path or an absolute path.\n\nafter config this option, the icon will be automatically copied to the dist directory during the compilation, and the corresponding link tag will be added to the html.\n\n# example\n\nexport default {\n  html: {\n    appicon: './src/assets/icon.png',\n  },\n};\n\n\nafter recompiling, the following tags are automatically generated in the html:\n\n<link rel=\"apple-touch-icon\" sizes=\"180*180\" href=\"/static/image/icon.png\" />\n\n\n\n# html.crossorigin\n\n * type: boolean | 'anonymous' | 'use-credentials'\n * default: false\n\nset the crossorigin attribute of the <script> tag.\n\nwhen true is passed, it is automatically set to crossorigin=\"anonymous\".\n\n# example\n\nexport default {\n  html: {\n    crossorigin: 'anonymous',\n  },\n};\n\n\nafter compilation, the <script> tag in html becomes:\n\n<script defer src=\"/static/js/main.js\" crossorigin=\"anonymous\"><\/script>\n\n\n\n# html.disablehtmlfolder\n\n * type: boolean\n * default: false\n\nremove the folder of the html files. when this option is enabled, the generated html file path will change from [name]/index.html to [name].html.\n\n# example\n\nby default, the structure of html files in the dist directory is:\n\n/dist\n└── html\n    └── main\n        └── index.html\n\n\nenable the html.disablehtmlfolder config:\n\nexport default {\n  html: {\n    disablehtmlfolder: true,\n  },\n};\n\n\nafter recompiling, the directory structure of the html files in dist is:\n\n/dist\n└── html\n    └── main.html\n\n\n> if you want to set the path of the html files, use the output.distpath.html config.\n\n\n# html.favicon\n\n * type: string\n * default: undefined\n\nset the favicon icon for all pages.\n\nafter config this option, the favicon will be automatically copied to the dist directory during the compilation, and the corresponding link tag will be added to the html.\n\n# example\n\nexport default {\n  html: {\n    favicon: './src/assets/icon.png',\n  },\n};\n\n\nafter recompiling, the following tags are automatically generated in the html:\n\n<link rel=\"icon\" href=\"/favicon.ico\" />\n\n\n\n# html.faviconbyentries\n\n * type: record<string, string>\n * default: undefined\n\nset different favicon for different pages.\n\nthe usage is same as favicon, and you can use the \"entry name\" as the key to set each page individually.\n\nfaviconbyentries will overrides the value set in favicon.\n\n# example\n\nexport default {\n  html: {\n    favicon: './src/assets/default.png',\n    faviconbyentries: {\n      foo: './src/assets/foo.png',\n    },\n  },\n};\n\n\nafter recompiling, you will see:\n\n * the favicon for page foo is ./src/assets/foo.png.\n * the favicon for other pages is ./src/assets/default.png.\n\n\n# html.inject\n\n * type: 'head' | 'body' | 'true' | false\n * default: 'head'\n\nset the inject position of the <script> tag.\n\ncan be set to the following values:\n\n * 'head': the script tag will be inject inside the head tag.\n * 'body': the script tag is inject at the end of the body tag.\n * true: the result depends on the scriptloading config of html-webpack-plugin.\n * false: script tags will not be injected.\n\n# default inject position\n\nthe script tag is inside the head tag by default:\n\n<html>\n  <head>\n    <title></title>\n    <script defer src=\"/static/js/runtime-main.js\"><\/script>\n    <script defer src=\"/static/js/main.js\"><\/script>\n    <link href=\"/static/css/main.css\" rel=\"stylesheet\" />\n  </head>\n  <body>\n    <div id=\"root\"></div>\n  </body>\n</html>\n\n\n# inject into body\n\nadd the following config to inject script into the body tag:\n\nexport default {\n  html: {\n    inject: 'body',\n  },\n};\n\n\nyou will see that the script tag is generated at the end of the body tag:\n\n<html>\n  <head>\n    <title></title>\n    <link href=\"/static/css/main.css\" rel=\"stylesheet\" />\n  </head>\n  <body>\n    <div id=\"root\"></div>\n    <script defer src=\"/static/js/runtime-main.js\"><\/script>\n    <script defer src=\"/static/js/main.js\"><\/script>\n  </body>\n</html>\n\n\n\n# html.injectbyentries\n\n * type: record<string, boolean | string>\n * default: undefined\n\nset different script tag inject positions for different pages.\n\nthe usage is same as inject, and you can use the \"entry name\" as the key to set each page individually.\n\ninjectbyentries will overrides the value set in inject.\n\n# example\n\nexport default {\n  html: {\n    inject: 'head',\n    injectbyentries: {\n      foo: 'body',\n    },\n  },\n};\n\n\nafter recompiling, you will see:\n\n * the script tag of the page foo will be injected inside the body tag.\n * the script tag of other pages will be injected inside the head tag.\n\n\n# html.meta\n\n * type: record<string, false | string | record<string, string | boolean>>\n * default: undefined\n\nconfigure the <meta> tag of the html.\n\n# string type\n\nwhen the value of a meta object is a string, the key of the object is automatically mapped to name, and the value is mapped to content.\n\nfor example to set description:\n\nexport default {\n  html: {\n    meta: {\n      description: 'a description of the page',\n    },\n  },\n};\n\n\nthe generated meta tag in html is:\n\n<meta name=\"description\" content=\"a description of the page\" />\n\n\n# object type\n\nwhen the value of a meta object is an object, the key: value of the object is mapped to the attribute of the meta tag.\n\nin this case, the name and content properties will not be set by default.\n\nfor example to set http-equiv:\n\nexport default {\n  html: {\n    meta: {\n      'http-equiv': {\n        'http-equiv': 'x-ua-compatible',\n        content: 'ie=edge',\n      },\n    },\n  },\n};\n\n\nthe meta tag in html is:\n\n<meta http-equiv=\"x-ua-compatible\" content=\"ie=edge\" />\n\n\n\n# remove default value\n\nsetting the value of the meta object to false and the meta tag will not be generated.\n\nfor example to remove the imagemode:\n\nexport default {\n  html: {\n    meta: {\n      imagemode: false,\n    },\n  },\n};\n\n\n\n# html.metabyentries\n\n * type: record<string, meta>\n * default: undefined\n\nset different meta tags for different pages.\n\nthe usage is same as meta, and you can use the \"entry name\" as the key to set each page individually.\n\nmetabyentries will overrides the value set in meta.\n\n# example\n\nexport default {\n  html: {\n    meta: {\n      description: 'bytedance',\n    },\n    metabyentries: {\n      foo: {\n        description: 'tiktok',\n      },\n    },\n  },\n};\n\n\nafter compiling, you can see that the meta of the page foo is:\n\n<meta name=\"description\" content=\"tiktok\" />\n\n\nthe meta of other pages is:\n\n<meta name=\"description\" content=\"bytedance\" />\n\n\n\n# html.mountid\n\n * type: string\n * default: 'root'\n\nby default, the root element is included in the html template for component mounting, and the element id can be modified through mountid.\n\n<body>\n  <div id=\"root\"></div>\n</body>\n\n\n# example\n\nset the id to app:\n\nexport default {\n  html: {\n    mountid: 'app',\n  },\n};\n\n\nafter compilation:\n\n<body>\n  <div id=\"app\"></div>\n</body>\n\n\ntip\n\nif you customized the html template, please make sure that the template contains <div id=\"<%= mountid %>\"></div>, otherwise this config will not take effect.\n\n\n# html.template\n\n * type: string\n * default:\n\ndefine the path to the html template, corresponding to the template config of html-webpack-plugin.\n\n# example\n\nreplace the default template with a custom html template file，you can add the following config:\n\nexport default {\n  html: {\n    template: './static/index.html',\n  },\n};\n\n\n\n# html.templatebyentries\n\n * type: object\n * default: undefined\n\nset different template file for different pages.\n\nthe usage is same as template, and you can use the \"entry name\" as the key to set each page individually.\n\ntemplatebyentries will overrides the value set in template.\n\n# example\n\nexport default {\n  output: {\n    template: './static/index.html',\n    templatebyentries: {\n      foo: './src/pages/foo/index.html',\n      bar: './src/pages/bar/index.html',\n    },\n  },\n};\n\n\n\n# html.templateparameters\n\n * type: object | function\n * default:\n\ntype defaultparameters = {\n  meta: string; // corresponding to html.meta config\n  title: string; // corresponding to html.title config\n  mountid: string; // corresponding to html.mountid config\n  entryname: string; // entry name\n  assetprefix: string; // corresponding to output.assetprefix config\n  compilation: webpack.compilation; // compilation object corresponding to webpack\n  webpackconfig: config; // webpack config\n  // htmlwebpackplugin built-in parameters\n  // see https://github.com/jantimon/html-webpack-plugin for details\n  htmlwebpackplugin: {\n    tags: object;\n    files: object;\n    options: object;\n  };\n};\n\n\ndefine the parameters in the html template, corresponding to the templateparameters config of html-webpack-plugin. you can use the config as an object or a function.\n\nif it is an object, it will be merged with the default parameters. for example:\n\nexport default {\n  html: {\n    templateparameters: {\n      title: 'my app',\n    },\n  },\n};\n\n\nif it is a function, the default parameters will be passed in, and you can return an object to override the default parameters. for example:\n\nexport default {\n  html: {\n    templateparameters: defaultparameters => {\n      console.log(defaultparameters.compilation);\n      console.log(defaultparameters.title);\n      return {\n        title: 'my app',\n      };\n    },\n  },\n};\n\n\n# example\n\nto use the foo parameter in the html template, you can add the following config:\n\nexport default {\n  html: {\n    templateparameters: {\n      foo: 'bar',\n    },\n  },\n};\n\n\nor you can use a function to dynamically generate the parameters:\n\nexport default {\n  html: {\n    templateparameters: defaultparameters => {\n      return {\n        foo: 'bar',\n      };\n    },\n  },\n};\n\n\nthen you can use the foo parameter in the html template by <%= foo %>:\n\n<script>\n  window.foo = '<%= foo %>';\n<\/script>\n\n\nthe compiled html is:\n\n<script>window.foo = 'bar'<\/script>\n\n\n\n# html.templateparametersbyentries\n\n * type: object\n * default: undefined\n\nset different template parameters for different pages.\n\nthe usage is same as templateparameters, and you can use the \"entry name\" as the key to set each page individually.\n\ntemplateparametersbyentries will overrides the value set in templateparameters.\n\n# example\n\nexport default {\n  html: {\n    templateparametersbyentries: {\n      foo: {\n        type: 'a',\n      },\n      bar: {\n        type: 'b',\n      },\n    },\n  },\n};\n\n\n\n# html.title\n\n * type: string\n * default: undefined\n\nset the title tag of the html page, for example:\n\nexport default {\n  html: {\n    title: 'example',\n  },\n};\n\n\n\n# html.titlebyentries\n\n * type: record<string, string>\n * default: undefined\n\nset different title for different pages.\n\nthe usage is same as title, and you can use the \"entry name\" as the key to set each page individually.\n\ntitlebyentries will overrides the value set in title.\n\n# example\n\nexport default {\n  html: {\n    title: 'bytedance',\n    titlebyentries: {\n      foo: 'tiktok',\n    },\n  },\n};\n\n\nafter recompiling, you can see:\n\n * the title of the page foo is tiktok.\n * the title of other pages is bytedance.",charsets:{cjk:!0}},{title:"Output Config",frontmatter:{extractApiHeaders:[2]},regularPath:"/en/api/config-output.html",relativePath:"en/api/config-output.md",key:"v-18368a94",path:"/en/api/config-output.html",headers:[{level:2,title:"output.assetPrefix",slug:"output-assetprefix",normalizedTitle:"output.assetprefix",charIndex:101},{level:2,title:"output.assetsRetry",slug:"output-assetsretry",normalizedTitle:"output.assetsretry",charIndex:1060},{level:2,title:"output.charset",slug:"output-charset",normalizedTitle:"output.charset",charIndex:4314},{level:2,title:"output.cleanDistPath",slug:"output-cleandistpath",normalizedTitle:"output.cleandistpath",charIndex:4751},{level:2,title:"output.convertToRem",slug:"output-converttorem",normalizedTitle:"output.converttorem",charIndex:5060},{level:2,title:"output.copy",slug:"output-copy",normalizedTitle:"output.copy",charIndex:7993},{level:2,title:"output.cssModuleLocalIdentName",slug:"output-cssmodulelocalidentname",normalizedTitle:"output.cssmodulelocalidentname",charIndex:8380},{level:2,title:"output.dataUriLimit",slug:"output-dataurilimit",normalizedTitle:"output.dataurilimit",charIndex:9588},{level:2,title:"output.disableCssExtract",slug:"output-disablecssextract",normalizedTitle:"output.disablecssextract",charIndex:10469},{level:2,title:"output.disableCssModuleExtension",slug:"output-disablecssmoduleextension",normalizedTitle:"output.disablecssmoduleextension",charIndex:10910},{level:2,title:"output.distPath",slug:"output-distpath",normalizedTitle:"output.distpath",charIndex:12340},{level:2,title:"output.disableMinimize",slug:"output-disableminimize",normalizedTitle:"output.disableminimize",charIndex:13709},{level:2,title:"output.disableSourceMap",slug:"output-disablesourcemap",normalizedTitle:"output.disablesourcemap",charIndex:14045},{level:2,title:"output.disableTsChecker",slug:"output-disabletschecker",normalizedTitle:"output.disabletschecker",charIndex:15545},{level:2,title:"output.disableFilenameHash",slug:"output-disablefilenamehash",normalizedTitle:"output.disablefilenamehash",charIndex:16704},{level:2,title:"output.disableInlineRuntimeChunk",slug:"output-disableinlineruntimechunk",normalizedTitle:"output.disableinlineruntimechunk",charIndex:17545},{level:2,title:"output.enableAssetManifest",slug:"output-enableassetmanifest",normalizedTitle:"output.enableassetmanifest",charIndex:17971},{level:2,title:"output.enableAssetFallback",slug:"output-enableassetfallback",normalizedTitle:"output.enableassetfallback",charIndex:18530},{level:2,title:"output.enableLatestDecorators",slug:"output-enablelatestdecorators",normalizedTitle:"output.enablelatestdecorators",charIndex:19237},{level:2,title:"output.enableCssModuleTSDeclaration",slug:"output-enablecssmoduletsdeclaration",normalizedTitle:"output.enablecssmoduletsdeclaration",charIndex:19635},{level:2,title:"output.enableInlineScripts",slug:"output-enableinlinescripts",normalizedTitle:"output.enableinlinescripts",charIndex:20102},{level:2,title:"output.enableInlineStyles",slug:"output-enableinlinestyles",normalizedTitle:"output.enableinlinestyles",charIndex:20924},{level:2,title:"output.externals",slug:"output-externals",normalizedTitle:"output.externals",charIndex:21762},{level:2,title:"output.filename",slug:"output-filename",normalizedTitle:"output.filename",charIndex:19066},{level:2,title:"output.legalComments",slug:"output-legalcomments",normalizedTitle:"output.legalcomments",charIndex:23869},{level:2,title:"output.overrideBrowserslist",slug:"output-overridebrowserslist",normalizedTitle:"output.overridebrowserslist",charIndex:24659},{level:2,title:"output.polyfill",slug:"output-polyfill",normalizedTitle:"output.polyfill",charIndex:26414},{level:2,title:"output.svgDefaultExport",slug:"output-svgdefaultexport",normalizedTitle:"output.svgdefaultexport",charIndex:27107}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"output.assetPrefix output.assetsRetry output.charset output.cleanDistPath output.convertToRem output.copy output.cssModuleLocalIdentName output.dataUriLimit output.disableCssExtract output.disableCssModuleExtension output.distPath output.disableMinimize output.disableSourceMap output.disableTsChecker output.disableFilenameHash output.disableInlineRuntimeChunk output.enableAssetManifest output.enableAssetFallback output.enableLatestDecorators output.enableCssModuleTSDeclaration output.enableInlineScripts output.enableInlineStyles output.externals output.filename output.legalComments output.overrideBrowserslist output.polyfill output.svgDefaultExport",content:"# Output Config\n\nThis section describes some output related configurations in Modern.js Builder.\n\n\n# output.assetPrefix\n\n * Type: boolean | string\n * Default: '/'\n\nWhen using CDN in the production environment, you can use this option to set the URL prefix of static assets, similar to the output.publicPath config of webpack.\n\nassetPrefix will affect the URLs of most of the static assets, including JavaScript files, CSS files, images, videos, etc. If an incorrect value is specified, you'll receive 404 errors while loading these resources.\n\nThis config is only used in the production environment. In the development environment, please use the dev.assetPrefix to set the URL prefix.\n\nAfter setting, the URLs of JavaScript, CSS and other static files will be prefixed with output.assetPrefix:\n\n# Example\n\nexport default {\n  output: {\n    assetPrefix: 'https://cdn.example.com/assets/',\n  },\n};\n\n\nAfter building, you can see that the JS files are loaded from:\n\n<script\n  defer\n  src=\"https://cdn.example.com/assets/static/js/main.ebc4ff4f.js\"\n><\/script>\n\n\n\n# output.assetsRetry\n\n * Type: Object\n\noutput.assetsRetry is used to configure the retry of assets.The type of AssetsRetryOptions is as follows:\n\nexport type AssetsRetryHookContext = {\n  times: number;\n  domain: string;\n  url: string;\n  tagName: string;\n};\n\nexport type AssetsRetryOptions = {\n  type?: string[];\n  domain?: string[];\n  max?: number;\n  test?: string | ((url: string) => boolean);\n  crossOrigin?: boolean;\n  onRetry?: (options: AssetsRetryHookContext) => void;\n  onSuccess?: (options: AssetsRetryHookContext) => void;\n  onFail?: (options: AssetsRetryHookContext) => void;\n};\n\n\nThe default value is as follows:\n\nexport const defaultAssetsRetryOptions: AssetsRetryOptions = {\n  type: ['script', 'link', 'img'],\n  domain: [],\n  max: 3,\n  test: '',\n  crossOrigin: false,\n  onRetry: () => {},\n  onSuccess: () => {},\n  onFail: () => {},\n};\n\n\n\n# assetsRetry.max\n\n * Type: number\n * Default: 3\n\nThe maximum number of retries for a single asset. For example:\n\nexport default {\n  output: {\n    assetsRetry: {\n      max: 3,\n    },\n  },\n};\n\n\n\n# assetsRetry.domain\n\n * Type: string[]\n * Default: []\n\nThe domain of the asset to be retried. For example:\n\nexport default {\n  output: {\n    assetsRetry: {\n      domain: ['https://cdn1.example.com', 'https://cdn2.example.com'],\n    },\n  },\n};\n\n\n\n# assetsRetry.type\n\n * Type: string[]\n * Default: ['script', 'link', 'img']\n\nThe type of the asset to be retried. For example:\n\nexport default {\n  output: {\n    assetsRetry: {\n      type: ['script', 'link'],\n    },\n  },\n};\n\n\n\n# assetsRetry.test\n\n * Type: string | ((url: string) => boolean) | undefined\n * Default: undefined\n\nThe test function of the asset to be retried. For example:\n\nexport default {\n  output: {\n    assetsRetry: {\n      test: /cdn\\.example\\.com/,\n    },\n  },\n};\n\n\n\n# assetsRetry.crossOrigin\n\n * Type: undefined | boolean\n * Default: false\n\nWhether to add the crossOrigin attribute to the asset to be retried. For example:\n\nexport default {\n  output: {\n    assetsRetry: {\n      crossOrigin: true,\n    },\n  },\n};\n\n\n\n# assetsRetry.onRetry\n\n * Type: undefined | (options: AssetsRetryHookContext) => void\n\nThe callback function when the asset is being retried. For example:\n\nexport default {\n  output: {\n    assetsRetry: {\n      onRetry: ({ times, domain, url, tagName }) => {\n        console.log(\n          `Retry ${times} times, domain: ${domain}, url: ${url}, tagName: ${tagName}`,\n        );\n      },\n    },\n  },\n};\n\n\n\n# assetsRetry.onSuccess\n\n * Type: undefined | (options: AssetsRetryHookContext) => void\n\nThe callback function when the asset is successfully retried. For example:\n\nexport default {\n  output: {\n    assetsRetry: {\n      onSuccess: ({ times, domain, url, tagName }) => {\n        console.log(\n          `Retry ${times} times, domain: ${domain}, url: ${url}, tagName: ${tagName}`,\n        );\n      },\n    },\n  },\n};\n\n\n\n# assetsRetry.onFail\n\n * Type: undefined | (options: AssetsRetryHookContext) => void\n\nThe callback function when the asset is failed to be retried. For example:\n\nexport default {\n  output: {\n    assetsRetry: {\n      onFail: ({ times, domain, url, tagName }) => {\n        console.log(\n          `Retry ${times} times, domain: ${domain}, url: ${url}, tagName: ${tagName}`,\n        );\n      },\n    },\n  },\n};\n\n\n\n# output.charset\n\n * Type: 'ascii' | 'utf8'\n * Default: 'ascii'\n\nBy default, Builder's output is ASCII-only and will escape all non-ASCII characters.\n\nIf you want to output the original characters without using escape sequences, you can set output.charset to utf8.\n\nexport default {\n  output: {\n    charset: 'utf8',\n  },\n};\n\n\nBuilder will automatically add <meta charset=\"utf-8\"> to the generated HTML files if output.charset is utf8.\n\n\n# output.cleanDistPath\n\n * Type: boolean\n * Default: true\n\nWhether to clean all files in the dist path before starting compilation.\n\nBy default, Builder clean up the dist file, you can disable this behavior by setting cleanDistPath to false.\n\nexport default {\n  output: {\n    cleanDistPath: false,\n  },\n};\n\n\n\n# output.convertToRem\n\n * Type: boolean | object\n * Default: false\n\nBy setting output.convertToRem, the Builder can do the following things:\n\n * Convert px to rem in CSS.\n * Insert runtime code into the HTML template to set the fontSize of the root element.\n\n# Boolean Type\n\nIf output.convertToRem is set to true, Rem processing capability will be turned on.\n\nexport default {\n  output: {\n    convertToRem: true,\n  },\n};\n\n\nAt this point, the rem configuration defaults as follows:\n\n{\n  enableRuntime: true,\n  rootFontSize: 50,\n  screenWidth: 375,\n  rootFontSize: 50,\n  maxRootFontSize: 64,\n  widthQueryKey: '',\n  excludeEntries: [],\n  supportLandscape: false,\n  useRootFontSizeBeyondMax: false,\n  pxtorem: {\n    rootValue: 50,\n    unitPrecision: 5,\n    propList: ['*'],\n  }\n}\n\n\n# Object Type\n\nWhen the value of output.convertToRem is object type, The Builder will perform Rem processing based on the current configuration.\n\noptions:\n\nNAME                       TYPE       DEFAULT                                              DESCRIPTION\nenableRuntime              boolean    true                                                 Whether to inject runtime code into html templates, to\n                                                                                           support dynamic calculation of the font size of the root\n                                                                                           element\nrootFontSize               number     50                                                   The root element font size\nmaxRootFontSize            number     64                                                   The root element max font size\nwidthQueryKey              string     ''                                                   Get clientWidth from the url query based on widthQueryKey\nscreenWidth                number     375                                                  The screen width for UI design drawings（Usually, fontSize =\n                                                                                           (clientWidth * rootFontSize) / screenWidth）\nexcludeEntries             string[]   []                                                   The entries to ignore\nsupportLandscape           boolean    false                                                Use height to calculate rem in landscape\nuseRootFontSizeBeyondMax   boolean    false                                                Whether to use rootFontSize when large than maxRootFontSize\npxtorem                    object      * rootValue (Default is the same as rootFontSize)   postcss-pxtorem options\n                                       * unitPrecision: 5\n                                       * propList: ['*']\n\n# Example\n\nexport default {\n  output: {\n    convertToRem: {\n      rootFontSize: 30,\n      excludeEntries: ['404', 'page2'],\n      pxtorem: {\n        propList: ['font-size'],\n      },\n    },\n  },\n};\n\n\n\n# output.copy\n\n * Type: CopyPluginOptions | CopyPluginOptions['patterns']\n * Default: undefined\n\nCopies the specified file or directory to the dist directory.\n\nFor example, copy the files under src/assets to the dist directory:\n\nexport default {\n  output: {\n    copy: [{ from: './src/assets', to: '' }],\n  },\n};\n\n\nFor more detailed configuration, please refer to: copy-webpack-plugin.\n\n\n# output.cssModuleLocalIdentName\n\n * Type: string\n * Default:\n\n// isProd indicates that the production build\nconst localIdentName = isProd\n  ? '[hash:base64:5]'\n  : '[path][name]__[local]--[hash:base64:5]';\n\n\nSets the format of the className generated by CSS Modules after compilation.\n\n\n# Default Value\n\ncssModuleLocalIdentName has different default values in development and production.\n\nIn a production, Builder will generate shorter class names to reduce the bundle size.\n\nimport styles from './index.module.scss';\n\n// In development, the value is `.src-index-module__header--xxxxx`\n// In production, the value is `.xxxxx`\nconsole.log(styles.header);\n\n\n\n# Template String\n\nYou can use the following template strings in cssModuleLocalIdentName:\n\n * [name] - the basename of the asset.\n * [local] - original class.\n * [hash] - the hash of the string.\n * [folder] - the folder relative path.\n * [path] - the relative path.\n * [file] - filename and path.\n * [ext] - extension with leading dot.\n * [hash:<hashDigest>:<hashDigestLength>]: hash with hash settings.\n\n\n# Example\n\nSet cssModuleLocalIdentName to other value:\n\nexport default {\n  output: {\n    cssModuleLocalIdentName: '[hash:base64:4]',\n  },\n};\n\n\n\n# output.dataUriLimit\n\n * Type\n\ntype DataUriLimitConfig = {\n  svg?: number;\n  font?: number;\n  image?: number;\n  media?: number;\n};\n\n\n * Default\n\nconst defaultDatUriLimit = {\n  svg: 10000,\n  font: 10000,\n  image: 10000,\n  media: 10000,\n};\n\n\nSet the size threshold to inline static assets such as images and fonts.\n\nBy default, static assets will be Base64 encoded and inline into the page if the size is less than 10KB.\n\nYou can adjust the threshold by setting the dataUriLimit config.\n\nDetail:\n\n * svg: The threshold of the SVG image.\n * font: The threshold of the font file.\n * image: The threshold of non-SVG images.\n * media: The threshold of media assets such as videos.\n\n# Example\n\nSet the threshold of images to 5000 Bytes, and set media assets not to be inlined:\n\nexport default {\n  output: {\n    dataUriLimit: {\n      image: 5000,\n      media: Infinite,\n    },\n  },\n};\n\n\n\n# output.disableCssExtract\n\n * Type: boolean\n * Default: false\n\nWhether to disable CSS extract and inline CSS files into JS files.\n\nBy default, Builder will extract CSS into a separate .css file and output it to the dist directory. When this option is set to true, CSS files will be inlined into JS files and inserted on the page at runtime via <style> tags.\n\n\n# Example\n\nexport default {\n  output: {\n    disableCssExtract: true,\n  },\n};\n\n\n\n# output.disableCssModuleExtension\n\n * Type: boolean\n * Default: false\n\nWhether to treat all .css files in the source directory as CSS Modules.\n\nBy default, only the *.module.css files are treated as CSS Modules. After enabling this config, all *.css style files in the source directory will be regarded as CSS Modules.\n\n.sass, .scss and .less files are also affected by disableCssModuleExtension.\n\nTIP\n\nWe do not recommend enabling this config, because after enabling disableCssModuleExtension, CSS Modules files and ordinary CSS files cannot be clearly distinguished, which is not conducive to long-term maintenance.\n\n\n# Example\n\nexport default {\n  output: {\n    disableCssModuleExtension: true,\n  },\n};\n\n\n\n# Detailed\n\nThe following is a detailed explanation of the CSS Modules rules:\n\n# disableCssModuleExtension is false (default)\n\nThe following files are treated as CSS Modules:\n\n * all *.module.css files\n\nThe following files are treated as normal CSS:\n\n * all *.css files (excluding .module)\n * all *.global.css files\n\n# disableCssModuleExtension is true\n\nThe following files are treated as CSS Modules:\n\n * *.css and *.module.css files in the source directory\n * *.module.css files under node_modules\n\nThe following files are treated as normal CSS:\n\n * all *.global.css files\n * *.css files under node_modules (without .module)\n\nTIP\n\nFor CSS Modules files inside node_modules, please always use the *.module.css suffix.\n\n\n# output.distPath\n\n * Type\n\ntype DistPathConfig = {\n  root?: string;\n  js?: string;\n  css?: string;\n  svg?: string;\n  font?: string;\n  html?: string;\n  image?: string;\n  media?: string;\n  server?: string;\n};\n\n\n * Default\n\nconst defaultDistPath = {\n  root: 'dist',\n  html: 'html',\n  js: 'static/js',\n  css: 'static/css',\n  svg: 'static/svg',\n  font: 'static/font',\n  image: 'static/image',\n  media: 'static/media',\n  server: 'bundles',\n};\n\n\nSet the directory of the dist files. Builder will output files to the corresponding subdirectory according to the file type.\n\nDetail:\n\n * root: The root directory of all files.\n * html: The output directory of HTML files.\n * js: The output directory of JavaScript files.\n * css: The output directory of CSS style files.\n * svg: The output directory of SVG images.\n * font: The output directory of font files.\n * image: The output directory of non-SVG images.\n * media: The output directory of media assets, such as videos.\n * server: The output directory of server bundles when target is node.\n\n# Example\n\nThe JavaScript files will be output to the distPath.root + distPath.js directory, which is dist/static/js.\n\nIf you need to output JavaScript files to the build/resource/js directory, you can add following config:\n\nexport default {\n  output: {\n    distPath: {\n      root: 'build',\n      js: 'resource/js',\n    },\n  },\n};\n\n\n\n# output.disableMinimize\n\n * Type: boolean\n * Default: false\n\nWhether to disable code minification in production build.\n\nBy default, JS code and CSS code are minified during production build. If you do not want to minify the code, you can set disableMinimize to true.\n\nexport default {\n  output: {\n    disableMinimize: true,\n  },\n};\n\n\n\n# output.disableSourceMap\n\n * Type:\n\ntype DisableSourceMap =\n  | boolean\n  | {\n      js?: boolean;\n      css?: boolean;\n    };\n\n\n * Default:\n\nconst defaultDisableSourceMap = {\n  js: false,\n  css: process.env.NODE_ENV === 'production',\n};\n\n\nWhether to disable Source Map generation.\n\nWhat is a Source Map\n\nSource Map is an information file that saves the source code mapping relationship. It records each location of the compiled code and the corresponding pre-compilation location. With Source Map, you can directly view the source code when debugging the compiled code.\n\nBy default, Builder's Source Map generation rules are:\n\n * In development build, SourceMap of JS files and CSS files will be generated, which is convenient for debugging.\n * In production build, the Source Map of JS files will be generated for debugging and troubleshooting online problems; the Source Map of CSS files will not be generated.\n\nIf the project does not need Source Map, you can turned off it to speed up the compile speed.\n\nexport default {\n  output: {\n    disableSourceMap: true,\n  },\n};\n\n\nIf you want to enable Source Map in development and disable it in the production, you can set to:\n\nexport default {\n  output: {\n    disableSourceMap: process.env.NODE_ENV === 'production',\n  },\n};\n\n\nIf you need to individually control the Source Map of JS files or CSS files, you can refer to the following settings:\n\nexport default {\n  output: {\n    disableSourceMap: {\n      js: false,\n      css: true,\n    },\n  },\n};\n\n\n\n# output.disableTsChecker\n\n * Type: boolean\n * Default: false\n\nWhether to disable TypeScript type checker during compilation.\n\nBy default, Builder will run the TypeScript type checker in a separate process during the build process. Its checking logic is consistent with TypeScript's native tsc command. You can use tsconfig.json or Builder's tools.tsChecker config to customize the checking behavior.\n\n\n# Blocking Compilation\n\n * In development build, type errors will not block the compilation process.\n * In production build, type errors will cause the build to fail to ensure the stability of the production code.\n\n\n# Example\n\nDisable TypeScript type checker:\n\nexport default {\n  output: {\n    disableTsChecker: true,\n  },\n};\n\n\nDisable type checker in development:\n\nexport default {\n  output: {\n    disableTsChecker: process.env.NODE_ENV === 'development',\n  },\n};\n\n\nDisable type checker in production:\n\nexport default {\n  output: {\n    disableTsChecker: process.env.NODE_ENV === 'production',\n  },\n};\n\n\nTIP\n\nIt is not recommended to disable type checker in production, which will reduce the stability of the production code, please use it with caution.\n\n\n# output.disableFilenameHash\n\n * Type: boolean\n * Default: false\n\nRemove the hash from the name of static files after production build.\n\nAfter the production build, there will be a hash in the middle of the filename by default. You can disable this behavior through the output.disableFilenameHash config.\n\n# Example\n\nBy default, the filename is:\n\nFile                                     Size         Gzipped\ndist/static/css/187.7879e19d.css         126.99 KB    9.17 KB\ndist/static/js/main.18a568e5.js          2.24 KB      922 B\n\n\nAdd output.disableFilenameHash config:\n\nexport default {\n  output: {\n    disableFilenameHash: true,\n  },\n};\n\n\nAfter rebuild, the filenames become:\n\nFile                            Size         Gzipped\ndist/static/css/187.css         126.99 KB    9.17 KB\ndist/static/js/main.js          2.24 KB      922 B\n\n\n\n# output.disableInlineRuntimeChunk\n\n * Type: boolean\n * Default: false\n\nControls whether to the inline the runtime chunk to HTML.\n\nIn production mode, the runtime chunk file will be inlined into HTML by default rather than written into dist directory, this can reduce the HTTP request number.\n\nThis option is used to disable that default behavior.\n\nexport default {\n  output: {\n    disableInlineRuntimeChunk: true,\n  },\n};\n\n\n\n# output.enableAssetManifest\n\n * Type: boolean\n * Default: false\n\nWhether to generate a manifest file that contains information of all assets.\n\n# Example\n\nEnable asset manifest:\n\nexport default {\n  output: {\n    enableAssetManifest: true,\n  },\n};\n\n\nAfter compiler, there will be a dist/manifest.json file:\n\n{\n  \"files\": {\n    \"main.css\": \"/static/css/main.45b01211.css\",\n    \"main.js\": \"/static/js/main.52fd298f.js\",\n    \"html/main/index.html\": \"/html/main/index.html\"\n  },\n  \"entrypoints\": [\"static/css/main.45b01211.css\", \"static/js/main.52fd298f.js\"]\n}\n\n\n\n# output.enableAssetFallback\n\n * Type: boolean\n * Default: false\n\nIf this option is enabled, all unrecognized files will be emitted to the dist directory; otherwise, an exception will be thrown.\n\n# Example\n\nEnable the config:\n\nexport default {\n  output: {\n    enableAssetFallback: true,\n  },\n};\n\n\nImport a module of unknown type in code:\n\nimport './foo.xxx';\n\n\nAfter compilation, foo.xxx will be output to the dist/static/media directory.\n\nYou can control the output path and filename after fallback through the output.distPath.media and output.filename.media configs.\n\nTIP\n\nEnabling this config will change the rules structure in the webpack config. In most cases, we do not recommend using this config.\n\n\n# output.enableLatestDecorators\n\n * Type: boolean\n * Default: false\n\nWhether to use the new decorator proposal.\n\nBy default, Builder uses the legacy decorator proposal when compiling decorators.\n\nWhen output.enableLatestDecorators is set to true, the Builder will compile with the new decorator proposal (version 2018-09).\n\nexport default {\n  output: {\n    enableLatestDecorators: true,\n  },\n};\n\n\n\n# output.enableCssModuleTSDeclaration\n\n * Type: boolean\n * Default: false\n\nWhether to generate a TypeScript declaration file for CSS modules.\n\n# Example\n\nEnable CSS module TypeScript declaration:\n\nexport default {\n  output: {\n    enableCssModuleTSDeclaration: true,\n  },\n};\n\n\nAfter building, there will be a .d.ts file for each CSS module file. For example\n\ninterface CssExports {\n  title: string;\n}\nexport const cssExports: CssExports;\nexport default cssExports;\n\n\n\n# output.enableInlineScripts\n\n * Type: boolean\n * Default: false\n\nWhether to inline output scripts files (.js files) into HTML with <script> tags in production mode.\n\nNote that, with this option on, the scripts files will no longer be written in dist directory, they will only exist inside the HTML file instead.\n\n# Example\n\nBy default, we have following output files:\n\ndist/html/main/index.html\ndist/static/css/style.css\ndist/static/js/main.js\n\n\nAfter turn on the output.enableInlineScripts option:\n\nexport default {\n  output: {\n    enableInlineScripts: true,\n  },\n};\n\n\nThe output files will become:\n\ndist/html/main/index.html\ndist/static/css/style.css\n\n\nAnd dist/static/js/main.js will be inlined in index.html:\n\n<html>\n  <body>\n    <script>\n      // content of dist/static/js/main.js\n    <\/script>\n  </body>\n</html>\n\n\n\n# output.enableInlineStyles\n\n * Type: boolean\n * Default: false\n\nWhether to inline output style files (.css files) into HTML with <style> tags in production mode.\n\nNote that, with this option on, the style files will no longer be written in dist directory, they will only exist inside the HTML file instead.\n\n# Example\n\nBy default, we have following output files:\n\ndist/html/main/index.html\ndist/static/css/style.css\ndist/static/js/main.js\n\n\nAfter turn on the output.enableInlineStyles option:\n\nexport default {\n  output: {\n    enableInlineStyles: true,\n  },\n};\n\n\nThe output files will become:\n\ndist/html/main/index.html\ndist/static/js/main.js\n\n\nAnd dist/static/css/style.css will be inlined in index.html:\n\n<html>\n  <head>\n    <style>\n      /* content of dist/static/css/style.css */\n    </style>\n  </head>\n  <body>\n  </body>\n</html>\n\n\n\n# output.externals\n\n * Type: string | object | function | RegExp\n\n * Default: undefined\n\nAt build time, prevent some import dependencies from being packed into bundles in your code, and instead fetch them externally at runtime.\n\nFor more information, please see: webpack Externals\n\n# Example\n\nExclude the react-dom dependency from the build product. To get this module at runtime, the value of react-dom will globally retrieve the ReactDOM variable.\n\nexport default {\n  output: {\n    externals: {\n      'react-dom': 'ReactDOM',\n    },\n  },\n};\n\n\nTIP\n\nWhen the build target is Web Worker, externals will not take effect. This is because the Worker environment can not access global variables.\n\n\n# output.filename\n\n * Type\n\ntype FilenameConfig = {\n  js?: string;\n  css?: string;\n  svg?: string;\n  font?: string;\n  image?: string;\n  media?: string;\n};\n\n\n * Default\n\n// Development\nconst devDefaultFilename = {\n  js: '[name].js',\n  css: '[name].css',\n  svg: '[name].[contenthash:8].svg',\n  font: '[name].[contenthash:8][ext]',\n  image: '[name].[contenthash:8][ext]',\n  media: '[name].[contenthash:8][ext]',\n};\n\n// Production\nconst prodDefaultFilename = {\n  js: '[name].[contenthash:8].js',\n  css: '[name].[contenthash:8].css',\n  svg: '[name].[contenthash:8].svg',\n  font: '[name].[contenthash:8][ext]',\n  image: '[name].[contenthash:8][ext]',\n  media: '[name].[contenthash:8][ext]',\n};\n\n\nSets the filename of dist files.\n\nAfter the production build, there will be a hash in the middle of the filename by default. You can disable this behavior through the output.disableFilenameHash config.\n\nDetail:\n\n * js: The name of the JavaScript file.\n * css: The name of the CSS style file.\n * svg: The name of the SVG image.\n * font: The name of the font file.\n * image: The name of a non-SVG image.\n * media: The name of a media asset, such as a video.\n\n# Example\n\nSet the name of the JavaScript file to [name]_script.js:\n\nexport default {\n  output: {\n    filename: {\n      js:\n        process.env.NODE_ENV === 'production'\n          ? '[name]_script.[contenthash:8].js'\n          : '[name]_script.js',\n    },\n  },\n};\n\n\n\n# output.legalComments\n\n * Type : 'linked' | 'inline' | 'none'\n * Default: 'linked'\n\nConfigure how to handle the legal comment.\n\nA \"legal comment\" is considered to be any statement-level comment in JS or rule-level comment in CSS that contains @license or @preserve or that starts with //! or /*!. These comments are preserved in output files by default since that follows the intent of the original authors of the code.\n\nThis behavior can be configured by using one of the following options:\n\n * linked: Extract all legal comments to a .LEGAL.txt file and link to them with a comment.\n * inline: Preserve all legal comments in original position.\n * none: Remove all legal comments.\n\n# Example\n\nRemove all legal comments:\n\nexport default {\n  output: {\n    legalComments: 'none',\n  },\n};\n\n\n\n# output.overrideBrowserslist\n\n * Type: string[] | Record<BuilderTarget, string[]\n * Default: undefined\n\nSpecifies the range of target browsers that the project is compatible with. This value will be used by @babel/preset-env and autoprefixer to identify the JavaScript syntax that need to be transformed and the CSS browser prefixes that need to be added.\n\n# Priority\n\nThe overrideBrowserslist config will override the .browserslistrc config file in the project and the browserslist field in package.json.\n\nIn most cases, it is recommended to use the .browserslistrc file rather than the overrideBrowserslist config. Because the .browserslistrc file is the official config file, it is more general and can be recognized by other libraries in the community.\n\n# Default Value\n\nIf there is no browserslist configs defined in the project, nor overrideBrowserslist defined, then Builder will set the default browserslist to:\n\n['> 0.01%', 'not dead', 'not op_mini all'];\n\n\n# Example\n\nAn example compatible with mobile scenarios:\n\nexport default {\n  output: {\n    overrideBrowserslist: [\n      'iOS 9',\n      'Android 4.4',\n      'last 2 versions',\n      '> 0.2%',\n      'not dead',\n    ],\n  },\n};\n\n\nCheck out the browserslist documentation to learn more about browserslist.\n\n# Set according to Targets\n\nWhen you build multiple targets at the same time, you can set different browser ranges for different targets. At this point, you need to set overrideBrowserslist to an object whose key is the corresponding build target.\n\nFor example to set different ranges for web and node:\n\nexport default {\n  output: {\n    overrideBrowserslist: {\n      web: ['iOS 9', 'Android 4.4', 'last 2 versions', '> 0.2%', 'not dead'],\n      node: ['node >= 14'],\n    },\n  },\n};\n\n\n\n# output.polyfill\n\n * Type: 'entry' | 'usage' | 'ua' | 'off'\n * Default: 'entry'\n\nVia output.polyfill you can configure how the polyfill is injected.\n\n\n# Config\n\n# entry\n\nPolyfill is injected in every entry file when output.polyfill is configured as 'entry'.\n\nEquivalent to useBuiltIns: 'entry' configuration in @babel/preset-env.\n\n# usage\n\nPolyfill is injected in each file based on the API used in the code.\n\nEquivalent to useBuiltIns: 'usage' configuration in @babel/preset-env.\n\n# ua\n\nThe Polyfill code is dynamically delivered according to the currently requested UA information.\n\n# off\n\nPolyfill is not injected. When using this option, you need to ensure code compatibility yourself.\n\n\n# output.svgDefaultExport\n\n * Type: url | component\n * Default: url\n\noutput.svgDefaultExport is used to configure the default export type of SVG files.\n\nWhen output.svgDefaultExport is set to url , the default export of SVG files is the URL of the file. For example:\n\nimport logo from './logo.svg';\n\nconsole.log(logo); // => asset url\n\n\nWhen output.svgDefaultExport is set to component , the default export of SVG files is the React component of the file. For example:\n\nimport Logo from './logo.svg';\n\nconsole.log(Logo); // => React Component\n\n\nAt this time, you can also specify the ?url query to import the URL, for example:\n\nimport logo from './logo.svg?url';\n\nconsole.log(logo); // => asset url\n",normalizedContent:"# output config\n\nthis section describes some output related configurations in modern.js builder.\n\n\n# output.assetprefix\n\n * type: boolean | string\n * default: '/'\n\nwhen using cdn in the production environment, you can use this option to set the url prefix of static assets, similar to the output.publicpath config of webpack.\n\nassetprefix will affect the urls of most of the static assets, including javascript files, css files, images, videos, etc. if an incorrect value is specified, you'll receive 404 errors while loading these resources.\n\nthis config is only used in the production environment. in the development environment, please use the dev.assetprefix to set the url prefix.\n\nafter setting, the urls of javascript, css and other static files will be prefixed with output.assetprefix:\n\n# example\n\nexport default {\n  output: {\n    assetprefix: 'https://cdn.example.com/assets/',\n  },\n};\n\n\nafter building, you can see that the js files are loaded from:\n\n<script\n  defer\n  src=\"https://cdn.example.com/assets/static/js/main.ebc4ff4f.js\"\n><\/script>\n\n\n\n# output.assetsretry\n\n * type: object\n\noutput.assetsretry is used to configure the retry of assets.the type of assetsretryoptions is as follows:\n\nexport type assetsretryhookcontext = {\n  times: number;\n  domain: string;\n  url: string;\n  tagname: string;\n};\n\nexport type assetsretryoptions = {\n  type?: string[];\n  domain?: string[];\n  max?: number;\n  test?: string | ((url: string) => boolean);\n  crossorigin?: boolean;\n  onretry?: (options: assetsretryhookcontext) => void;\n  onsuccess?: (options: assetsretryhookcontext) => void;\n  onfail?: (options: assetsretryhookcontext) => void;\n};\n\n\nthe default value is as follows:\n\nexport const defaultassetsretryoptions: assetsretryoptions = {\n  type: ['script', 'link', 'img'],\n  domain: [],\n  max: 3,\n  test: '',\n  crossorigin: false,\n  onretry: () => {},\n  onsuccess: () => {},\n  onfail: () => {},\n};\n\n\n\n# assetsretry.max\n\n * type: number\n * default: 3\n\nthe maximum number of retries for a single asset. for example:\n\nexport default {\n  output: {\n    assetsretry: {\n      max: 3,\n    },\n  },\n};\n\n\n\n# assetsretry.domain\n\n * type: string[]\n * default: []\n\nthe domain of the asset to be retried. for example:\n\nexport default {\n  output: {\n    assetsretry: {\n      domain: ['https://cdn1.example.com', 'https://cdn2.example.com'],\n    },\n  },\n};\n\n\n\n# assetsretry.type\n\n * type: string[]\n * default: ['script', 'link', 'img']\n\nthe type of the asset to be retried. for example:\n\nexport default {\n  output: {\n    assetsretry: {\n      type: ['script', 'link'],\n    },\n  },\n};\n\n\n\n# assetsretry.test\n\n * type: string | ((url: string) => boolean) | undefined\n * default: undefined\n\nthe test function of the asset to be retried. for example:\n\nexport default {\n  output: {\n    assetsretry: {\n      test: /cdn\\.example\\.com/,\n    },\n  },\n};\n\n\n\n# assetsretry.crossorigin\n\n * type: undefined | boolean\n * default: false\n\nwhether to add the crossorigin attribute to the asset to be retried. for example:\n\nexport default {\n  output: {\n    assetsretry: {\n      crossorigin: true,\n    },\n  },\n};\n\n\n\n# assetsretry.onretry\n\n * type: undefined | (options: assetsretryhookcontext) => void\n\nthe callback function when the asset is being retried. for example:\n\nexport default {\n  output: {\n    assetsretry: {\n      onretry: ({ times, domain, url, tagname }) => {\n        console.log(\n          `retry ${times} times, domain: ${domain}, url: ${url}, tagname: ${tagname}`,\n        );\n      },\n    },\n  },\n};\n\n\n\n# assetsretry.onsuccess\n\n * type: undefined | (options: assetsretryhookcontext) => void\n\nthe callback function when the asset is successfully retried. for example:\n\nexport default {\n  output: {\n    assetsretry: {\n      onsuccess: ({ times, domain, url, tagname }) => {\n        console.log(\n          `retry ${times} times, domain: ${domain}, url: ${url}, tagname: ${tagname}`,\n        );\n      },\n    },\n  },\n};\n\n\n\n# assetsretry.onfail\n\n * type: undefined | (options: assetsretryhookcontext) => void\n\nthe callback function when the asset is failed to be retried. for example:\n\nexport default {\n  output: {\n    assetsretry: {\n      onfail: ({ times, domain, url, tagname }) => {\n        console.log(\n          `retry ${times} times, domain: ${domain}, url: ${url}, tagname: ${tagname}`,\n        );\n      },\n    },\n  },\n};\n\n\n\n# output.charset\n\n * type: 'ascii' | 'utf8'\n * default: 'ascii'\n\nby default, builder's output is ascii-only and will escape all non-ascii characters.\n\nif you want to output the original characters without using escape sequences, you can set output.charset to utf8.\n\nexport default {\n  output: {\n    charset: 'utf8',\n  },\n};\n\n\nbuilder will automatically add <meta charset=\"utf-8\"> to the generated html files if output.charset is utf8.\n\n\n# output.cleandistpath\n\n * type: boolean\n * default: true\n\nwhether to clean all files in the dist path before starting compilation.\n\nby default, builder clean up the dist file, you can disable this behavior by setting cleandistpath to false.\n\nexport default {\n  output: {\n    cleandistpath: false,\n  },\n};\n\n\n\n# output.converttorem\n\n * type: boolean | object\n * default: false\n\nby setting output.converttorem, the builder can do the following things:\n\n * convert px to rem in css.\n * insert runtime code into the html template to set the fontsize of the root element.\n\n# boolean type\n\nif output.converttorem is set to true, rem processing capability will be turned on.\n\nexport default {\n  output: {\n    converttorem: true,\n  },\n};\n\n\nat this point, the rem configuration defaults as follows:\n\n{\n  enableruntime: true,\n  rootfontsize: 50,\n  screenwidth: 375,\n  rootfontsize: 50,\n  maxrootfontsize: 64,\n  widthquerykey: '',\n  excludeentries: [],\n  supportlandscape: false,\n  userootfontsizebeyondmax: false,\n  pxtorem: {\n    rootvalue: 50,\n    unitprecision: 5,\n    proplist: ['*'],\n  }\n}\n\n\n# object type\n\nwhen the value of output.converttorem is object type, the builder will perform rem processing based on the current configuration.\n\noptions:\n\nname                       type       default                                              description\nenableruntime              boolean    true                                                 whether to inject runtime code into html templates, to\n                                                                                           support dynamic calculation of the font size of the root\n                                                                                           element\nrootfontsize               number     50                                                   the root element font size\nmaxrootfontsize            number     64                                                   the root element max font size\nwidthquerykey              string     ''                                                   get clientwidth from the url query based on widthquerykey\nscreenwidth                number     375                                                  the screen width for ui design drawings（usually, fontsize =\n                                                                                           (clientwidth * rootfontsize) / screenwidth）\nexcludeentries             string[]   []                                                   the entries to ignore\nsupportlandscape           boolean    false                                                use height to calculate rem in landscape\nuserootfontsizebeyondmax   boolean    false                                                whether to use rootfontsize when large than maxrootfontsize\npxtorem                    object      * rootvalue (default is the same as rootfontsize)   postcss-pxtorem options\n                                       * unitprecision: 5\n                                       * proplist: ['*']\n\n# example\n\nexport default {\n  output: {\n    converttorem: {\n      rootfontsize: 30,\n      excludeentries: ['404', 'page2'],\n      pxtorem: {\n        proplist: ['font-size'],\n      },\n    },\n  },\n};\n\n\n\n# output.copy\n\n * type: copypluginoptions | copypluginoptions['patterns']\n * default: undefined\n\ncopies the specified file or directory to the dist directory.\n\nfor example, copy the files under src/assets to the dist directory:\n\nexport default {\n  output: {\n    copy: [{ from: './src/assets', to: '' }],\n  },\n};\n\n\nfor more detailed configuration, please refer to: copy-webpack-plugin.\n\n\n# output.cssmodulelocalidentname\n\n * type: string\n * default:\n\n// isprod indicates that the production build\nconst localidentname = isprod\n  ? '[hash:base64:5]'\n  : '[path][name]__[local]--[hash:base64:5]';\n\n\nsets the format of the classname generated by css modules after compilation.\n\n\n# default value\n\ncssmodulelocalidentname has different default values in development and production.\n\nin a production, builder will generate shorter class names to reduce the bundle size.\n\nimport styles from './index.module.scss';\n\n// in development, the value is `.src-index-module__header--xxxxx`\n// in production, the value is `.xxxxx`\nconsole.log(styles.header);\n\n\n\n# template string\n\nyou can use the following template strings in cssmodulelocalidentname:\n\n * [name] - the basename of the asset.\n * [local] - original class.\n * [hash] - the hash of the string.\n * [folder] - the folder relative path.\n * [path] - the relative path.\n * [file] - filename and path.\n * [ext] - extension with leading dot.\n * [hash:<hashdigest>:<hashdigestlength>]: hash with hash settings.\n\n\n# example\n\nset cssmodulelocalidentname to other value:\n\nexport default {\n  output: {\n    cssmodulelocalidentname: '[hash:base64:4]',\n  },\n};\n\n\n\n# output.dataurilimit\n\n * type\n\ntype dataurilimitconfig = {\n  svg?: number;\n  font?: number;\n  image?: number;\n  media?: number;\n};\n\n\n * default\n\nconst defaultdaturilimit = {\n  svg: 10000,\n  font: 10000,\n  image: 10000,\n  media: 10000,\n};\n\n\nset the size threshold to inline static assets such as images and fonts.\n\nby default, static assets will be base64 encoded and inline into the page if the size is less than 10kb.\n\nyou can adjust the threshold by setting the dataurilimit config.\n\ndetail:\n\n * svg: the threshold of the svg image.\n * font: the threshold of the font file.\n * image: the threshold of non-svg images.\n * media: the threshold of media assets such as videos.\n\n# example\n\nset the threshold of images to 5000 bytes, and set media assets not to be inlined:\n\nexport default {\n  output: {\n    dataurilimit: {\n      image: 5000,\n      media: infinite,\n    },\n  },\n};\n\n\n\n# output.disablecssextract\n\n * type: boolean\n * default: false\n\nwhether to disable css extract and inline css files into js files.\n\nby default, builder will extract css into a separate .css file and output it to the dist directory. when this option is set to true, css files will be inlined into js files and inserted on the page at runtime via <style> tags.\n\n\n# example\n\nexport default {\n  output: {\n    disablecssextract: true,\n  },\n};\n\n\n\n# output.disablecssmoduleextension\n\n * type: boolean\n * default: false\n\nwhether to treat all .css files in the source directory as css modules.\n\nby default, only the *.module.css files are treated as css modules. after enabling this config, all *.css style files in the source directory will be regarded as css modules.\n\n.sass, .scss and .less files are also affected by disablecssmoduleextension.\n\ntip\n\nwe do not recommend enabling this config, because after enabling disablecssmoduleextension, css modules files and ordinary css files cannot be clearly distinguished, which is not conducive to long-term maintenance.\n\n\n# example\n\nexport default {\n  output: {\n    disablecssmoduleextension: true,\n  },\n};\n\n\n\n# detailed\n\nthe following is a detailed explanation of the css modules rules:\n\n# disablecssmoduleextension is false (default)\n\nthe following files are treated as css modules:\n\n * all *.module.css files\n\nthe following files are treated as normal css:\n\n * all *.css files (excluding .module)\n * all *.global.css files\n\n# disablecssmoduleextension is true\n\nthe following files are treated as css modules:\n\n * *.css and *.module.css files in the source directory\n * *.module.css files under node_modules\n\nthe following files are treated as normal css:\n\n * all *.global.css files\n * *.css files under node_modules (without .module)\n\ntip\n\nfor css modules files inside node_modules, please always use the *.module.css suffix.\n\n\n# output.distpath\n\n * type\n\ntype distpathconfig = {\n  root?: string;\n  js?: string;\n  css?: string;\n  svg?: string;\n  font?: string;\n  html?: string;\n  image?: string;\n  media?: string;\n  server?: string;\n};\n\n\n * default\n\nconst defaultdistpath = {\n  root: 'dist',\n  html: 'html',\n  js: 'static/js',\n  css: 'static/css',\n  svg: 'static/svg',\n  font: 'static/font',\n  image: 'static/image',\n  media: 'static/media',\n  server: 'bundles',\n};\n\n\nset the directory of the dist files. builder will output files to the corresponding subdirectory according to the file type.\n\ndetail:\n\n * root: the root directory of all files.\n * html: the output directory of html files.\n * js: the output directory of javascript files.\n * css: the output directory of css style files.\n * svg: the output directory of svg images.\n * font: the output directory of font files.\n * image: the output directory of non-svg images.\n * media: the output directory of media assets, such as videos.\n * server: the output directory of server bundles when target is node.\n\n# example\n\nthe javascript files will be output to the distpath.root + distpath.js directory, which is dist/static/js.\n\nif you need to output javascript files to the build/resource/js directory, you can add following config:\n\nexport default {\n  output: {\n    distpath: {\n      root: 'build',\n      js: 'resource/js',\n    },\n  },\n};\n\n\n\n# output.disableminimize\n\n * type: boolean\n * default: false\n\nwhether to disable code minification in production build.\n\nby default, js code and css code are minified during production build. if you do not want to minify the code, you can set disableminimize to true.\n\nexport default {\n  output: {\n    disableminimize: true,\n  },\n};\n\n\n\n# output.disablesourcemap\n\n * type:\n\ntype disablesourcemap =\n  | boolean\n  | {\n      js?: boolean;\n      css?: boolean;\n    };\n\n\n * default:\n\nconst defaultdisablesourcemap = {\n  js: false,\n  css: process.env.node_env === 'production',\n};\n\n\nwhether to disable source map generation.\n\nwhat is a source map\n\nsource map is an information file that saves the source code mapping relationship. it records each location of the compiled code and the corresponding pre-compilation location. with source map, you can directly view the source code when debugging the compiled code.\n\nby default, builder's source map generation rules are:\n\n * in development build, sourcemap of js files and css files will be generated, which is convenient for debugging.\n * in production build, the source map of js files will be generated for debugging and troubleshooting online problems; the source map of css files will not be generated.\n\nif the project does not need source map, you can turned off it to speed up the compile speed.\n\nexport default {\n  output: {\n    disablesourcemap: true,\n  },\n};\n\n\nif you want to enable source map in development and disable it in the production, you can set to:\n\nexport default {\n  output: {\n    disablesourcemap: process.env.node_env === 'production',\n  },\n};\n\n\nif you need to individually control the source map of js files or css files, you can refer to the following settings:\n\nexport default {\n  output: {\n    disablesourcemap: {\n      js: false,\n      css: true,\n    },\n  },\n};\n\n\n\n# output.disabletschecker\n\n * type: boolean\n * default: false\n\nwhether to disable typescript type checker during compilation.\n\nby default, builder will run the typescript type checker in a separate process during the build process. its checking logic is consistent with typescript's native tsc command. you can use tsconfig.json or builder's tools.tschecker config to customize the checking behavior.\n\n\n# blocking compilation\n\n * in development build, type errors will not block the compilation process.\n * in production build, type errors will cause the build to fail to ensure the stability of the production code.\n\n\n# example\n\ndisable typescript type checker:\n\nexport default {\n  output: {\n    disabletschecker: true,\n  },\n};\n\n\ndisable type checker in development:\n\nexport default {\n  output: {\n    disabletschecker: process.env.node_env === 'development',\n  },\n};\n\n\ndisable type checker in production:\n\nexport default {\n  output: {\n    disabletschecker: process.env.node_env === 'production',\n  },\n};\n\n\ntip\n\nit is not recommended to disable type checker in production, which will reduce the stability of the production code, please use it with caution.\n\n\n# output.disablefilenamehash\n\n * type: boolean\n * default: false\n\nremove the hash from the name of static files after production build.\n\nafter the production build, there will be a hash in the middle of the filename by default. you can disable this behavior through the output.disablefilenamehash config.\n\n# example\n\nby default, the filename is:\n\nfile                                     size         gzipped\ndist/static/css/187.7879e19d.css         126.99 kb    9.17 kb\ndist/static/js/main.18a568e5.js          2.24 kb      922 b\n\n\nadd output.disablefilenamehash config:\n\nexport default {\n  output: {\n    disablefilenamehash: true,\n  },\n};\n\n\nafter rebuild, the filenames become:\n\nfile                            size         gzipped\ndist/static/css/187.css         126.99 kb    9.17 kb\ndist/static/js/main.js          2.24 kb      922 b\n\n\n\n# output.disableinlineruntimechunk\n\n * type: boolean\n * default: false\n\ncontrols whether to the inline the runtime chunk to html.\n\nin production mode, the runtime chunk file will be inlined into html by default rather than written into dist directory, this can reduce the http request number.\n\nthis option is used to disable that default behavior.\n\nexport default {\n  output: {\n    disableinlineruntimechunk: true,\n  },\n};\n\n\n\n# output.enableassetmanifest\n\n * type: boolean\n * default: false\n\nwhether to generate a manifest file that contains information of all assets.\n\n# example\n\nenable asset manifest:\n\nexport default {\n  output: {\n    enableassetmanifest: true,\n  },\n};\n\n\nafter compiler, there will be a dist/manifest.json file:\n\n{\n  \"files\": {\n    \"main.css\": \"/static/css/main.45b01211.css\",\n    \"main.js\": \"/static/js/main.52fd298f.js\",\n    \"html/main/index.html\": \"/html/main/index.html\"\n  },\n  \"entrypoints\": [\"static/css/main.45b01211.css\", \"static/js/main.52fd298f.js\"]\n}\n\n\n\n# output.enableassetfallback\n\n * type: boolean\n * default: false\n\nif this option is enabled, all unrecognized files will be emitted to the dist directory; otherwise, an exception will be thrown.\n\n# example\n\nenable the config:\n\nexport default {\n  output: {\n    enableassetfallback: true,\n  },\n};\n\n\nimport a module of unknown type in code:\n\nimport './foo.xxx';\n\n\nafter compilation, foo.xxx will be output to the dist/static/media directory.\n\nyou can control the output path and filename after fallback through the output.distpath.media and output.filename.media configs.\n\ntip\n\nenabling this config will change the rules structure in the webpack config. in most cases, we do not recommend using this config.\n\n\n# output.enablelatestdecorators\n\n * type: boolean\n * default: false\n\nwhether to use the new decorator proposal.\n\nby default, builder uses the legacy decorator proposal when compiling decorators.\n\nwhen output.enablelatestdecorators is set to true, the builder will compile with the new decorator proposal (version 2018-09).\n\nexport default {\n  output: {\n    enablelatestdecorators: true,\n  },\n};\n\n\n\n# output.enablecssmoduletsdeclaration\n\n * type: boolean\n * default: false\n\nwhether to generate a typescript declaration file for css modules.\n\n# example\n\nenable css module typescript declaration:\n\nexport default {\n  output: {\n    enablecssmoduletsdeclaration: true,\n  },\n};\n\n\nafter building, there will be a .d.ts file for each css module file. for example\n\ninterface cssexports {\n  title: string;\n}\nexport const cssexports: cssexports;\nexport default cssexports;\n\n\n\n# output.enableinlinescripts\n\n * type: boolean\n * default: false\n\nwhether to inline output scripts files (.js files) into html with <script> tags in production mode.\n\nnote that, with this option on, the scripts files will no longer be written in dist directory, they will only exist inside the html file instead.\n\n# example\n\nby default, we have following output files:\n\ndist/html/main/index.html\ndist/static/css/style.css\ndist/static/js/main.js\n\n\nafter turn on the output.enableinlinescripts option:\n\nexport default {\n  output: {\n    enableinlinescripts: true,\n  },\n};\n\n\nthe output files will become:\n\ndist/html/main/index.html\ndist/static/css/style.css\n\n\nand dist/static/js/main.js will be inlined in index.html:\n\n<html>\n  <body>\n    <script>\n      // content of dist/static/js/main.js\n    <\/script>\n  </body>\n</html>\n\n\n\n# output.enableinlinestyles\n\n * type: boolean\n * default: false\n\nwhether to inline output style files (.css files) into html with <style> tags in production mode.\n\nnote that, with this option on, the style files will no longer be written in dist directory, they will only exist inside the html file instead.\n\n# example\n\nby default, we have following output files:\n\ndist/html/main/index.html\ndist/static/css/style.css\ndist/static/js/main.js\n\n\nafter turn on the output.enableinlinestyles option:\n\nexport default {\n  output: {\n    enableinlinestyles: true,\n  },\n};\n\n\nthe output files will become:\n\ndist/html/main/index.html\ndist/static/js/main.js\n\n\nand dist/static/css/style.css will be inlined in index.html:\n\n<html>\n  <head>\n    <style>\n      /* content of dist/static/css/style.css */\n    </style>\n  </head>\n  <body>\n  </body>\n</html>\n\n\n\n# output.externals\n\n * type: string | object | function | regexp\n\n * default: undefined\n\nat build time, prevent some import dependencies from being packed into bundles in your code, and instead fetch them externally at runtime.\n\nfor more information, please see: webpack externals\n\n# example\n\nexclude the react-dom dependency from the build product. to get this module at runtime, the value of react-dom will globally retrieve the reactdom variable.\n\nexport default {\n  output: {\n    externals: {\n      'react-dom': 'reactdom',\n    },\n  },\n};\n\n\ntip\n\nwhen the build target is web worker, externals will not take effect. this is because the worker environment can not access global variables.\n\n\n# output.filename\n\n * type\n\ntype filenameconfig = {\n  js?: string;\n  css?: string;\n  svg?: string;\n  font?: string;\n  image?: string;\n  media?: string;\n};\n\n\n * default\n\n// development\nconst devdefaultfilename = {\n  js: '[name].js',\n  css: '[name].css',\n  svg: '[name].[contenthash:8].svg',\n  font: '[name].[contenthash:8][ext]',\n  image: '[name].[contenthash:8][ext]',\n  media: '[name].[contenthash:8][ext]',\n};\n\n// production\nconst proddefaultfilename = {\n  js: '[name].[contenthash:8].js',\n  css: '[name].[contenthash:8].css',\n  svg: '[name].[contenthash:8].svg',\n  font: '[name].[contenthash:8][ext]',\n  image: '[name].[contenthash:8][ext]',\n  media: '[name].[contenthash:8][ext]',\n};\n\n\nsets the filename of dist files.\n\nafter the production build, there will be a hash in the middle of the filename by default. you can disable this behavior through the output.disablefilenamehash config.\n\ndetail:\n\n * js: the name of the javascript file.\n * css: the name of the css style file.\n * svg: the name of the svg image.\n * font: the name of the font file.\n * image: the name of a non-svg image.\n * media: the name of a media asset, such as a video.\n\n# example\n\nset the name of the javascript file to [name]_script.js:\n\nexport default {\n  output: {\n    filename: {\n      js:\n        process.env.node_env === 'production'\n          ? '[name]_script.[contenthash:8].js'\n          : '[name]_script.js',\n    },\n  },\n};\n\n\n\n# output.legalcomments\n\n * type : 'linked' | 'inline' | 'none'\n * default: 'linked'\n\nconfigure how to handle the legal comment.\n\na \"legal comment\" is considered to be any statement-level comment in js or rule-level comment in css that contains @license or @preserve or that starts with //! or /*!. these comments are preserved in output files by default since that follows the intent of the original authors of the code.\n\nthis behavior can be configured by using one of the following options:\n\n * linked: extract all legal comments to a .legal.txt file and link to them with a comment.\n * inline: preserve all legal comments in original position.\n * none: remove all legal comments.\n\n# example\n\nremove all legal comments:\n\nexport default {\n  output: {\n    legalcomments: 'none',\n  },\n};\n\n\n\n# output.overridebrowserslist\n\n * type: string[] | record<buildertarget, string[]\n * default: undefined\n\nspecifies the range of target browsers that the project is compatible with. this value will be used by @babel/preset-env and autoprefixer to identify the javascript syntax that need to be transformed and the css browser prefixes that need to be added.\n\n# priority\n\nthe overridebrowserslist config will override the .browserslistrc config file in the project and the browserslist field in package.json.\n\nin most cases, it is recommended to use the .browserslistrc file rather than the overridebrowserslist config. because the .browserslistrc file is the official config file, it is more general and can be recognized by other libraries in the community.\n\n# default value\n\nif there is no browserslist configs defined in the project, nor overridebrowserslist defined, then builder will set the default browserslist to:\n\n['> 0.01%', 'not dead', 'not op_mini all'];\n\n\n# example\n\nan example compatible with mobile scenarios:\n\nexport default {\n  output: {\n    overridebrowserslist: [\n      'ios 9',\n      'android 4.4',\n      'last 2 versions',\n      '> 0.2%',\n      'not dead',\n    ],\n  },\n};\n\n\ncheck out the browserslist documentation to learn more about browserslist.\n\n# set according to targets\n\nwhen you build multiple targets at the same time, you can set different browser ranges for different targets. at this point, you need to set overridebrowserslist to an object whose key is the corresponding build target.\n\nfor example to set different ranges for web and node:\n\nexport default {\n  output: {\n    overridebrowserslist: {\n      web: ['ios 9', 'android 4.4', 'last 2 versions', '> 0.2%', 'not dead'],\n      node: ['node >= 14'],\n    },\n  },\n};\n\n\n\n# output.polyfill\n\n * type: 'entry' | 'usage' | 'ua' | 'off'\n * default: 'entry'\n\nvia output.polyfill you can configure how the polyfill is injected.\n\n\n# config\n\n# entry\n\npolyfill is injected in every entry file when output.polyfill is configured as 'entry'.\n\nequivalent to usebuiltins: 'entry' configuration in @babel/preset-env.\n\n# usage\n\npolyfill is injected in each file based on the api used in the code.\n\nequivalent to usebuiltins: 'usage' configuration in @babel/preset-env.\n\n# ua\n\nthe polyfill code is dynamically delivered according to the currently requested ua information.\n\n# off\n\npolyfill is not injected. when using this option, you need to ensure code compatibility yourself.\n\n\n# output.svgdefaultexport\n\n * type: url | component\n * default: url\n\noutput.svgdefaultexport is used to configure the default export type of svg files.\n\nwhen output.svgdefaultexport is set to url , the default export of svg files is the url of the file. for example:\n\nimport logo from './logo.svg';\n\nconsole.log(logo); // => asset url\n\n\nwhen output.svgdefaultexport is set to component , the default export of svg files is the react component of the file. for example:\n\nimport logo from './logo.svg';\n\nconsole.log(logo); // => react component\n\n\nat this time, you can also specify the ?url query to import the url, for example:\n\nimport logo from './logo.svg?url';\n\nconsole.log(logo); // => asset url\n",charsets:{cjk:!0}},{title:"Performance Config",frontmatter:{extractApiHeaders:[2]},regularPath:"/en/api/config-performance.html",relativePath:"en/api/config-performance.md",key:"v-a85495a8",path:"/en/api/config-performance.html",headers:[{level:2,title:"performance.buildCache",slug:"performance-buildcache",normalizedTitle:"performance.buildcache",charIndex:111},{level:2,title:"performance.bundleAnalyze",slug:"performance-bundleanalyze",normalizedTitle:"performance.bundleanalyze",charIndex:954},{level:2,title:"performance.chunkSplit",slug:"performance-chunksplit",normalizedTitle:"performance.chunksplit",charIndex:1674},{level:2,title:"performance.printFileSize",slug:"performance-printfilesize",normalizedTitle:"performance.printfilesize",charIndex:5901},{level:2,title:"performance.profile",slug:"performance-profile",normalizedTitle:"performance.profile",charIndex:6551},{level:2,title:"performance.removeConsole",slug:"performance-removeconsole",normalizedTitle:"performance.removeconsole",charIndex:6930},{level:2,title:"performance.removeMomentLocale",slug:"performance-removemomentlocale",normalizedTitle:"performance.removemomentlocale",charIndex:7572}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"performance.buildCache performance.bundleAnalyze performance.chunkSplit performance.printFileSize performance.profile performance.removeConsole performance.removeMomentLocale",content:"# Performance Config\n\nThis section describes some performance related configurations in Modern.js Builder.\n\n\n# performance.buildCache\n\n * Type\n\ntype BuildCacheConfig =\n  | {\n      /**\n       * Base directory for the filesystem cache.\n       */\n      cacheDirectory?: string;\n    }\n  | boolean;\n\n\n * Default:\n\nconst defaultBuildCacheConfig = {\n  cacheDirectory: './node_modules/.cache/webpack',\n};\n\n\nControls the Builder's caching behavior during the build process.\n\nBuilder will enable build cache by default to improve the compile speed, the generated cache files are write to the ./node_modules/.cache/webpack directory by default.\n\nYou can configure the cache path with buildCache, e.g.\n\nexport default {\n  performance: {\n    buildCache: {\n      cacheDirectory: './node_modules/.custom_cache/webpack',\n    },\n  },\n};\n\n\nYou can also disable the build cache by setting it to false:\n\nexport default {\n  performance: {\n    buildCache: false,\n  },\n};\n\n\n\n# performance.bundleAnalyze\n\n * Type: Object | undefined\n\nYou have two ways to enable webpack-bundle-analyzer to analyze the size of output files:\n\n * Add environment variable BUNDLE_ANALYZE=true.\n * Add performance.bundleAnalyze config.\n\nBy default, webpack-bundle-analyzer is not enabled. When enabled, its configuration is as follows:\n\n{\n  analyzerMode: 'static',\n  openAnalyzer: false,\n  // `target` is the compilation target, such as `web`, `node`, etc.\n  reportFilename: `report-${target}.html`,\n}\n\n\nYou can override the default config through performance.bundleAnalyze, for example:\n\nexport default {\n  performance: {\n    bundleAnalyze: {\n      analyzerMode: 'server',\n      openAnalyzer: true,\n    },\n  },\n};\n\n\n\n# performance.chunkSplit\n\n * Type: Object\n * Default: { strategy: 'split-by-experience' }\n\nperformance.chunkSplit is used to configure the chunk splitting strategy. The type of ChunkSplit is as follows:\n\ninterface BaseChunkSplit {\n  strategy?:\n    | 'split-by-module'\n    | 'split-by-experience'\n    | 'all-in-one'\n    | 'single-vendor';\n  override?: SplitChunks;\n  forceSplitting?: Array<RegExp>;\n}\n\ninterface SplitBySize {\n  strategy?: 'split-by-size';\n  minSize?: number;\n  maxSize?: number;\n  override?: SplitChunks;\n  forceSplitting?: Array<RegExp>;\n}\n\ninterface SplitCustom {\n  strategy?: 'custom';\n  splitChunks?: SplitChunks;\n  forceSplitting?: Array<RegExp>;\n}\n\nexport type ChunkSplit = BaseChunkSplit | SplitBySize | SplitCustom;\n\n\n\n# chunkSplit.strategy\n\nBuilder provides the following chunk splitting strategies:\n\n * split-by-experience: split by experience, the default strategy\n * split-by-module: split a chunk per npm package\n * split-by-size: split by chunk size\n * all-in-one: all code is bundled into a single chunk\n * single-vendor: The code in node_modules is bundled into a single chunk\n * custom: custom chunk splitting strategy\n\nBuilder use split-by-experience strategy by default, in which the following npm package group will be split into a single chunk:\n\n * react and react-dom\n * react-router、history and react-router-dom\n * antd component library\n * semi component library\n * arco component library\n * @babel/runtime (including @babel/runtime-corejs2、 @babel/runtime-corejs3)\n * lodash、lodash-es\n * core-js\n\nIf you want to use other splitting strategies, you can specify it via performance.chunkSplit.strategy.\n\n\n# chunkSplit.minSize\n\n * Type: number\n * Default: 10000\n\nWhen performance.chunkSplit.strategy is split-by-size, you can specify the minimum size of a chunk via performance.chunkSplit.minSize, the unit is bytes. The default value is 10000. For example:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-size',\n      minSize: 20000,\n    },\n  },\n};\n\n\n\n# chunkSplit.maxSize\n\n * Type: number\n * Default: Infinity\n\nWhen performance.chunkSplit.strategy is split-by-size, you can specify the maximum size of a chunk via performance.chunkSplit.maxSize, the unit is bytes. The default value is Infinity. For example:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-size',\n      maxSize: 50000,\n    },\n  },\n};\n\n\n\n# chunkSplit.forceSplitting\n\n * Type: Array<RegExp>\n * Default: []\n\nVia performance.chunkSplit.forceSplitting, you can specify the NPM packages that need to be forced to split. For example:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      forceSplitting: [/^@arco-design\\/web-react/],\n    },\n  },\n};\n\n\nThis is an easier way than configuring webpack's splitChunks directly.\n\n\n# chunkSplit.splitChunks\n\nWhen performance.chunkSplit.strategy is custom, you can specify the custom webpack chunk splitting config via performance.chunkSplit.splitChunks. This config will be merged with the webpack splitChunks config (the cacheGroups config will also be merged). For example:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'custom',\n      splitChunks: {\n        cacheGroups: {\n          react: {\n            test: /[\\\\/]node_modules[\\\\/](react|react-dom)[\\\\/]/,\n            name: 'react',\n            chunks: 'all',\n          },\n        },\n      },\n    },\n  },\n};\n\n\n\n# chunkSplit.override\n\nWhen performance.chunkSplit.strategy is split-by-experience, split-by-module, split-by-size or single-vendor, you can specify the custom webpack chunk splitting config via performance.chunkSplit.override. This config will be merged with the webpack splitChunks config (the cacheGroups config will also be merged). For example:\n\nexport default {\n  performance: {\n    strategy: 'split-by-experience',\n    chunkSplit: {\n      override: {\n        cacheGroups: {\n          react: {\n            test: /[\\\\/]node_modules[\\\\/](react|react-dom)[\\\\/]/,\n            name: 'react',\n            chunks: 'all',\n          },\n        },\n      },\n    },\n  },\n};\n\n\n> When the Builder target is \"node\", since Node Bundles do not need to be splitted to optimize loading performance, the chunkSplit rule will not take effect.\n\n\n# performance.printFileSize\n\n * Type: boolean\n * Default: true\n\nWhether to print the file sizes after production build.\n\ninfo    File sizes after production build:\n\n  File                                     Size         Gzipped\n  dist/static/js/lib-corejs.1c836fe7.js    212.89 kB    66.57 kB\n  dist/static/js/lib-react.fcafbc5c.js     134.65 kB    43.45 kB\n  dist/static/js/main.6ff06f70.js          8.93 kB      3.73 kB\n  dist/static/css/main.9f48031b.css        2.64 kB      927 B\n  dist/html/main/index.html                1.64 kB      874 B\n\n\n# Example\n\nDisable the logs:\n\nexport default {\n  performance: {\n    printFileSize: false,\n  },\n};\n\n\n\n# performance.profile\n\n * Type: boolean\n * Default: false\n\nWhether capture timing information for each module, same as the profile config of webpack.\n\n# Example\n\nexport default {\n  performance: {\n    profile: true,\n  },\n};\n\n\nWhen turned on, webpack generates a JSON file with some statistics about the module that includes information about timing information for each module.\n\n\n# performance.removeConsole\n\n * Type: boolean | ConsoleType[]\n * Default: false\n\nWhether to remove console.xx in production build.\n\n# Remove all consoles\n\nWhen removeConsole is set to true, all types of console.xx are removed:\n\nexport default {\n  performance: {\n    removeConsole: true,\n  },\n};\n\n\n# Remove specific console\n\nYou can also specify to remove only certain types of console.xx, such as console.log and console.warn:\n\nexport default {\n  performance: {\n    removeConsole: ['log', 'warn'],\n  },\n};\n\n\nThe following types of console are currently supported:\n\ntype ConsoleType = 'log' | 'info' | 'warn' | 'error' | 'table' | 'group';\n\n\n\n# performance.removeMomentLocale\n\n * Type: boolean\n * Default: false\n\nWhether to remove the locales of moment.js.\n\nmoment.js contains a lot of locales by default, which will increase the bundle size.\n\nWhen moment.js is used in the project, it is recommended to enable this option to automatically exclude all locales:\n\nexport default {\n  performance: {\n    removeMomentLocale: true,\n  },\n};\n\n\nOnce enabled, you can load a specific locale via:\n\nimport moment from 'moment';\nimport 'moment/locale/zh-cn';\n\nmoment.locale('zh-cn');\n",normalizedContent:"# performance config\n\nthis section describes some performance related configurations in modern.js builder.\n\n\n# performance.buildcache\n\n * type\n\ntype buildcacheconfig =\n  | {\n      /**\n       * base directory for the filesystem cache.\n       */\n      cachedirectory?: string;\n    }\n  | boolean;\n\n\n * default:\n\nconst defaultbuildcacheconfig = {\n  cachedirectory: './node_modules/.cache/webpack',\n};\n\n\ncontrols the builder's caching behavior during the build process.\n\nbuilder will enable build cache by default to improve the compile speed, the generated cache files are write to the ./node_modules/.cache/webpack directory by default.\n\nyou can configure the cache path with buildcache, e.g.\n\nexport default {\n  performance: {\n    buildcache: {\n      cachedirectory: './node_modules/.custom_cache/webpack',\n    },\n  },\n};\n\n\nyou can also disable the build cache by setting it to false:\n\nexport default {\n  performance: {\n    buildcache: false,\n  },\n};\n\n\n\n# performance.bundleanalyze\n\n * type: object | undefined\n\nyou have two ways to enable webpack-bundle-analyzer to analyze the size of output files:\n\n * add environment variable bundle_analyze=true.\n * add performance.bundleanalyze config.\n\nby default, webpack-bundle-analyzer is not enabled. when enabled, its configuration is as follows:\n\n{\n  analyzermode: 'static',\n  openanalyzer: false,\n  // `target` is the compilation target, such as `web`, `node`, etc.\n  reportfilename: `report-${target}.html`,\n}\n\n\nyou can override the default config through performance.bundleanalyze, for example:\n\nexport default {\n  performance: {\n    bundleanalyze: {\n      analyzermode: 'server',\n      openanalyzer: true,\n    },\n  },\n};\n\n\n\n# performance.chunksplit\n\n * type: object\n * default: { strategy: 'split-by-experience' }\n\nperformance.chunksplit is used to configure the chunk splitting strategy. the type of chunksplit is as follows:\n\ninterface basechunksplit {\n  strategy?:\n    | 'split-by-module'\n    | 'split-by-experience'\n    | 'all-in-one'\n    | 'single-vendor';\n  override?: splitchunks;\n  forcesplitting?: array<regexp>;\n}\n\ninterface splitbysize {\n  strategy?: 'split-by-size';\n  minsize?: number;\n  maxsize?: number;\n  override?: splitchunks;\n  forcesplitting?: array<regexp>;\n}\n\ninterface splitcustom {\n  strategy?: 'custom';\n  splitchunks?: splitchunks;\n  forcesplitting?: array<regexp>;\n}\n\nexport type chunksplit = basechunksplit | splitbysize | splitcustom;\n\n\n\n# chunksplit.strategy\n\nbuilder provides the following chunk splitting strategies:\n\n * split-by-experience: split by experience, the default strategy\n * split-by-module: split a chunk per npm package\n * split-by-size: split by chunk size\n * all-in-one: all code is bundled into a single chunk\n * single-vendor: the code in node_modules is bundled into a single chunk\n * custom: custom chunk splitting strategy\n\nbuilder use split-by-experience strategy by default, in which the following npm package group will be split into a single chunk:\n\n * react and react-dom\n * react-router、history and react-router-dom\n * antd component library\n * semi component library\n * arco component library\n * @babel/runtime (including @babel/runtime-corejs2、 @babel/runtime-corejs3)\n * lodash、lodash-es\n * core-js\n\nif you want to use other splitting strategies, you can specify it via performance.chunksplit.strategy.\n\n\n# chunksplit.minsize\n\n * type: number\n * default: 10000\n\nwhen performance.chunksplit.strategy is split-by-size, you can specify the minimum size of a chunk via performance.chunksplit.minsize, the unit is bytes. the default value is 10000. for example:\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'split-by-size',\n      minsize: 20000,\n    },\n  },\n};\n\n\n\n# chunksplit.maxsize\n\n * type: number\n * default: infinity\n\nwhen performance.chunksplit.strategy is split-by-size, you can specify the maximum size of a chunk via performance.chunksplit.maxsize, the unit is bytes. the default value is infinity. for example:\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'split-by-size',\n      maxsize: 50000,\n    },\n  },\n};\n\n\n\n# chunksplit.forcesplitting\n\n * type: array<regexp>\n * default: []\n\nvia performance.chunksplit.forcesplitting, you can specify the npm packages that need to be forced to split. for example:\n\nexport default {\n  performance: {\n    chunksplit: {\n      forcesplitting: [/^@arco-design\\/web-react/],\n    },\n  },\n};\n\n\nthis is an easier way than configuring webpack's splitchunks directly.\n\n\n# chunksplit.splitchunks\n\nwhen performance.chunksplit.strategy is custom, you can specify the custom webpack chunk splitting config via performance.chunksplit.splitchunks. this config will be merged with the webpack splitchunks config (the cachegroups config will also be merged). for example:\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'custom',\n      splitchunks: {\n        cachegroups: {\n          react: {\n            test: /[\\\\/]node_modules[\\\\/](react|react-dom)[\\\\/]/,\n            name: 'react',\n            chunks: 'all',\n          },\n        },\n      },\n    },\n  },\n};\n\n\n\n# chunksplit.override\n\nwhen performance.chunksplit.strategy is split-by-experience, split-by-module, split-by-size or single-vendor, you can specify the custom webpack chunk splitting config via performance.chunksplit.override. this config will be merged with the webpack splitchunks config (the cachegroups config will also be merged). for example:\n\nexport default {\n  performance: {\n    strategy: 'split-by-experience',\n    chunksplit: {\n      override: {\n        cachegroups: {\n          react: {\n            test: /[\\\\/]node_modules[\\\\/](react|react-dom)[\\\\/]/,\n            name: 'react',\n            chunks: 'all',\n          },\n        },\n      },\n    },\n  },\n};\n\n\n> when the builder target is \"node\", since node bundles do not need to be splitted to optimize loading performance, the chunksplit rule will not take effect.\n\n\n# performance.printfilesize\n\n * type: boolean\n * default: true\n\nwhether to print the file sizes after production build.\n\ninfo    file sizes after production build:\n\n  file                                     size         gzipped\n  dist/static/js/lib-corejs.1c836fe7.js    212.89 kb    66.57 kb\n  dist/static/js/lib-react.fcafbc5c.js     134.65 kb    43.45 kb\n  dist/static/js/main.6ff06f70.js          8.93 kb      3.73 kb\n  dist/static/css/main.9f48031b.css        2.64 kb      927 b\n  dist/html/main/index.html                1.64 kb      874 b\n\n\n# example\n\ndisable the logs:\n\nexport default {\n  performance: {\n    printfilesize: false,\n  },\n};\n\n\n\n# performance.profile\n\n * type: boolean\n * default: false\n\nwhether capture timing information for each module, same as the profile config of webpack.\n\n# example\n\nexport default {\n  performance: {\n    profile: true,\n  },\n};\n\n\nwhen turned on, webpack generates a json file with some statistics about the module that includes information about timing information for each module.\n\n\n# performance.removeconsole\n\n * type: boolean | consoletype[]\n * default: false\n\nwhether to remove console.xx in production build.\n\n# remove all consoles\n\nwhen removeconsole is set to true, all types of console.xx are removed:\n\nexport default {\n  performance: {\n    removeconsole: true,\n  },\n};\n\n\n# remove specific console\n\nyou can also specify to remove only certain types of console.xx, such as console.log and console.warn:\n\nexport default {\n  performance: {\n    removeconsole: ['log', 'warn'],\n  },\n};\n\n\nthe following types of console are currently supported:\n\ntype consoletype = 'log' | 'info' | 'warn' | 'error' | 'table' | 'group';\n\n\n\n# performance.removemomentlocale\n\n * type: boolean\n * default: false\n\nwhether to remove the locales of moment.js.\n\nmoment.js contains a lot of locales by default, which will increase the bundle size.\n\nwhen moment.js is used in the project, it is recommended to enable this option to automatically exclude all locales:\n\nexport default {\n  performance: {\n    removemomentlocale: true,\n  },\n};\n\n\nonce enabled, you can load a specific locale via:\n\nimport moment from 'moment';\nimport 'moment/locale/zh-cn';\n\nmoment.locale('zh-cn');\n",charsets:{cjk:!0}},{title:"Security Config",frontmatter:{extractApiHeaders:[2]},regularPath:"/en/api/config-security.html",relativePath:"en/api/config-security.md",key:"v-0bcd9810",path:"/en/api/config-security.html",headers:[{level:2,title:"security.sri",slug:"security-sri",normalizedTitle:"security.sri",charIndex:105}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"security.sri",content:'# Security Config\n\nThis section describes some security related configurations in Modern.js Builder.\n\n\n# security.sri\n\n * Type:\n\ntype SRIOptions = {\n  hashFuncNames?: []string;\n  enabled?: "auto" | true | false;\n  hashLoading?: "eager" | "lazy";\n} | boolean;\n\n\n * Default: undefined\n\nAdding an integrity attribute (integrity) to sub-resources introduced by HTML allows the browser to verify the integrity of the introduced resource, thus preventing tampering with the downloaded resource.\n\nEnabling this option will set the webpack output.crossOriginLoading configuration item to anonymous.\n\n# Introduce SRI\n\nSubresource Integrity (SRI) is a security feature that enables browsers to verify that resources they fetch (for example, from a CDN) are delivered without unexpected manipulation. It works by allowing you to provide a cryptographic hash that a fetched resource must match.\n\nFor script tags, the result is to refuse to execute the code; for CSS links, the result is not to load the styles.\n\nFor more on subresource integrity, see Subresource Integrity - MDN.\n\n# Example\n\nBy default, SRI is not turned on, and when it is, its default configuration is as follows:\n\n{\n  hashFuncNames: [\'sha384\'];\n  enabled: "auto",\n  hashLoading: "eager",\n}\n\n\nYou can customize the configuration items according to your own needs:\n\nexport default {\n  security: {\n    sri: {\n      hashFuncNames: [\'sha-256\'],\n      enabled: true,\n      hashLoading: \'lazy\',\n    },\n  },\n};\n',normalizedContent:'# security config\n\nthis section describes some security related configurations in modern.js builder.\n\n\n# security.sri\n\n * type:\n\ntype srioptions = {\n  hashfuncnames?: []string;\n  enabled?: "auto" | true | false;\n  hashloading?: "eager" | "lazy";\n} | boolean;\n\n\n * default: undefined\n\nadding an integrity attribute (integrity) to sub-resources introduced by html allows the browser to verify the integrity of the introduced resource, thus preventing tampering with the downloaded resource.\n\nenabling this option will set the webpack output.crossoriginloading configuration item to anonymous.\n\n# introduce sri\n\nsubresource integrity (sri) is a security feature that enables browsers to verify that resources they fetch (for example, from a cdn) are delivered without unexpected manipulation. it works by allowing you to provide a cryptographic hash that a fetched resource must match.\n\nfor script tags, the result is to refuse to execute the code; for css links, the result is not to load the styles.\n\nfor more on subresource integrity, see subresource integrity - mdn.\n\n# example\n\nby default, sri is not turned on, and when it is, its default configuration is as follows:\n\n{\n  hashfuncnames: [\'sha384\'];\n  enabled: "auto",\n  hashloading: "eager",\n}\n\n\nyou can customize the configuration items according to your own needs:\n\nexport default {\n  security: {\n    sri: {\n      hashfuncnames: [\'sha-256\'],\n      enabled: true,\n      hashloading: \'lazy\',\n    },\n  },\n};\n',charsets:{cjk:!0}},{title:"Source Config",frontmatter:{extractApiHeaders:[2]},regularPath:"/en/api/config-source.html",relativePath:"en/api/config-source.md",key:"v-585d4b02",path:"/en/api/config-source.html",headers:[{level:2,title:"source.alias",slug:"source-alias",normalizedTitle:"source.alias",charIndex:106},{level:2,title:"source.include",slug:"source-include",normalizedTitle:"source.include",charIndex:1299},{level:2,title:"source.exclude",slug:"source-exclude",normalizedTitle:"source.exclude",charIndex:4109},{level:2,title:"source.compileJsDataURI",slug:"source-compilejsdatauri",normalizedTitle:"source.compilejsdatauri",charIndex:4537},{level:2,title:"source.define",slug:"source-define",normalizedTitle:"source.define",charIndex:4930},{level:2,title:"source.globalVars",slug:"source-globalvars",normalizedTitle:"source.globalvars",charIndex:6128},{level:2,title:"source.moduleScopes",slug:"source-modulescopes",normalizedTitle:"source.modulescopes",charIndex:7670},{level:2,title:"source.preEntry",slug:"source-preentry",normalizedTitle:"source.preentry",charIndex:8792},{level:2,title:"source.resolveExtensionPrefix",slug:"source-resolveextensionprefix",normalizedTitle:"source.resolveextensionprefix",charIndex:9600},{level:2,title:"source.resolveMainFields",slug:"source-resolvemainfields",normalizedTitle:"source.resolvemainfields",charIndex:10890}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"source.alias source.include source.exclude source.compileJsDataURI source.define source.globalVars source.moduleScopes source.preEntry source.resolveExtensionPrefix source.resolveMainFields",content:"# Source Config\n\nThis section describes some source code related configurations in Modern.js Builder.\n\n\n# source.alias\n\n * Type: Record<string, string | string[]> | Function\n * Default: undefined\n\nCreate aliases to import or require certain modules, same as the resolve.alias config of webpack.\n\nTIP\n\nFor TypeScript projects, you only need to configure compilerOptions.paths in tsconfig.json, Builder will automatically recognize the aliases in tsconfig.json, so the alias config is unnecessary.\n\n# Object Type\n\nThe alias can be an Object, and the relative path will be automatically converted to absolute path.\n\nexport default {\n  source: {\n    alias: {\n      '@common': './src/common',\n    },\n  },\n};\n\n\nWith above configuration, if @common/Foo.tsx is import in the code, it will be mapped to the <root>/src/common/Foo.tsx path.\n\n# Function Type\n\nThe alias can be a function, it will accept the previous alias object, and you can modify it.\n\nexport default {\n  source: {\n    alias: alias => {\n      alias['@common'] = './src/common';\n    },\n  },\n};\n\n\nYou can also return a new object as the final result in the function, which will replace the previous alias object.\n\nexport default {\n  source: {\n    alias: alias => {\n      return {\n        '@common': './src/common',\n      };\n    },\n  },\n};\n\n\n\n# source.include\n\n * Type: Array<string | RegExp>\n * Default: []\n\nIn order to maintain faster compilation speed, Builder will not compile JavaScript/TypeScript files under node_modules through babel-loader or ts-loader by default, as will as the JavaScript/TypeScript files outside the current project directory.\n\nThrough the source.include config, you can specify directories or modules that need additional compilation. The usage is consistent with Rule.include in webpack, which supports passing in strings or regular expressions to match the module path.\n\nFor example:\n\nimport path from 'path';\n\nexport default {\n  source: {\n    include: [path.resolve(__dirname, '../other-dir')],\n  },\n};\n\n\n\n# Typical Example\n\nA typical usage scenario is to compile files under node_modules, because some third-party dependencies have ES6+ syntax, which may cause them to fail to run on low-version browsers. You can solve the problem by using this config to specify the dependencies that need to be compiled. Take query-string as an example, you can add the following config:\n\nimport path from 'path';\n\nexport default {\n  source: {\n    include: [\n      // Method 1:\n      // First get the path of the module by require.resolve\n      // Then pass path.dirname to point to the corresponding directory\n      path.dirname(require.resolve('query-string')),\n      // Method 2:\n      // Match by regular expression\n      // All paths containing `/query-string/` will be matched\n      /\\/query-string\\//,\n    ],\n  },\n};\n\n\n> Note that this config will only compile the code of query-string itself, not the sub-dependencies of query-string. If you need to compile a sub-dependency of query-string, you need to add the corresponding npm package to source.include.\n\n\n# Monorepo Project\n\nWhen using Monorepo, if you need to refer to the source code of other libraries in Monorepo, you can add the corresponding library to source.include:\n\nimport path from 'path';\n\nexport default {\n  source: {\n    include: [\n      // Method 1:\n      // Compile all files in Monorepo's package directory\n      path.resolve(__dirname, '../../packages'),\n\n      // Method 2:\n      // Compile the source code of a package in Monorepo's package directory\n      // This way of writing matches the range more accurately and has less impact on the overall build performance.\n      path.resolve(__dirname, '../../packages/xxx/src'),\n    ],\n  },\n};\n\n\n\n# Precautions\n\nNote that Babel cannot compile CommonJS modules by default. When you use source.include to compile CommonJS modules, you need to set Babel's sourceType config to unambiguous:\n\nexport default {\n  tools: {\n    babel(config) {\n      config.sourceType = 'unambiguous';\n    },\n  },\n};\n\n\nSetting sourceType to unambiguous may have some other effects, please refer to Babel official documentation.\n\n\n# source.exclude\n\n * Type: Array<string | RegExp>\n * Default: []\n\nSpecifies JavaScript/TypeScript files that do not need to be compiled. The usage is consistent with Rule.exclude in webpack, which supports passing in strings or regular expressions to match the module path.\n\nFor example:\n\nimport path from 'path';\n\nexport default {\n  source: {\n    exclude: [path.resolve(__dirname, 'src/module-a'), /src\\/module-b/],\n  },\n};\n\n\n\n# source.compileJsDataURI\n\n * Type: boolean\n * Default: true\n\nWhether to compile JavaScript code imported via Data URI.\n\nSuch as:\n\nimport x from 'data:text/javascript,export default 1;';\n\nimport 'data:text/javascript;charset=utf-8;base64,Y29uc29sZS5sb2coJ2lubGluZSAxJyk7';\n\n\n# Example\n\nAdd the following config to disable:\n\nexport default {\n  source: {\n    compileJsDataURI: false,\n  },\n};\n\n\n\n# source.define\n\n * Type: Record<string, unknown>\n * Default: {}\n\nReplaces variables in your code with other values or expressions at compile time. This can be useful for allowing different behavior between development builds and production builds.\n\nEach key passed into options is an identifier or multiple identifiers joined with ..\n\n * If the value is a string it will be used as a code fragment.\n * If the value isn't a string, it will be stringified (including functions).\n * If the value is an object all keys are defined the same way.\n * If you prefix typeof to the key, it's only defined for typeof calls.\n\nFor more information please visit https://webpack.js.org/plugins/define-plugin/.\n\n# Example\n\nexport default {\n  source: {\n    define: {\n      PRODUCTION: JSON.stringify(true),\n      VERSION: JSON.stringify('5fa3b9'),\n      BROWSER_SUPPORTS_HTML5: true,\n      TWO: '1 + 1',\n      'typeof window': JSON.stringify('object'),\n      'process.env.NODE_ENV': JSON.stringify(process.env.NODE_ENV),\n      'import.meta': { test: undefined },\n    },\n  },\n};\n\n\nExpressions will be replaced with the corresponding code fragments:\n\nconst foo = TWO;\n\n// ⬇️ Turn into being...\nconst foo = 1 + 1;\n\n\n\n# source.globalVars\n\n * Type: Record<string, JSONValue>\n * Default:\n\nconst defaultGlobalVars = {\n  // The environment variable `process.env.NODE_ENV` will be added by default,\n  // so you don't need to set it in manually.\n  'process.env.NODE_ENV': JSON.stringify(process.env.NODE_ENV),\n};\n\n\nDefine global variables. It can replace expressions like process.env.FOO in your code after compile. Such as:\n\nconsole.log(process.env.NODE_ENV);\n\n// ⬇️ Turn into being...\nconsole.log('development');\n\n\nDoesn't works with destructuring assignment, because builder does not know if NODE_ENV and process.env.NODE_ENV are associated:\n\nconst { NODE_ENV } = process.env;\nconsole.log(NODE_ENV);\n// ❌ Won't get a string.\n\n\nYou can take source.globalVars as the syntax sugar of source.define, the only difference is that source.globalVars will automatically stringify the value, which makes it easier to set the value of global variables. The values of globalVars should be JSON-safe to ensure it can be serialized.\n\nexport default {\n  source: {\n    globalVars: {\n      'process.env.BUILD_VERSION': '0.0.1',\n      'import.meta.foo': { bar: 42 },\n      'import.meta.baz': false,\n    },\n    define: {\n      'process.env.BUILD_VERSION': JSON.stringify('0.0.1'),\n      'import.meta': {\n        foo: JSON.stringify({ bar: 42 }),\n        baz: JSON.stringify(false),\n      },\n    },\n  },\n};\n\n\n# Example\n\nAdd the following config to use:\n\nexport default {\n  source: {\n    globalVars: {\n      ENABLE_VCONSOLE: true,\n      APP_CONTEXT: { answer: 42 },\n    },\n  },\n};\n\n\n\n# source.moduleScopes\n\n * Type: Array<string | Regexp> | Function\n * Default: undefined\n\nRestrict importing paths. After configuring this option, all source files can only import code from the specific paths, and import code from other paths is not allowed.\n\n# Example\n\nFirst, we configure moduleScopes to only include the src directory:\n\nexport default {\n  source: {\n    moduleScopes: ['./src'],\n  },\n};\n\n\nThen we import the utils/a module outside the src directory in src/App.tsx:\n\nimport a from '../utils/a';\n\n\nAfter compiling, there will be a reference path error:\n\n\n\nIf we configure the utils directory in moduleScopes, the error will disappear.\n\nexport default {\n  source: {\n    moduleScopes: ['./src', './utils'],\n  },\n};\n\n\n# Array Type\n\nYou can directly set several paths like this:\n\nexport default {\n  source: {\n    moduleScopes: ['./src', './shared', './utils'],\n  },\n};\n\n\n# Function Type\n\nmoduleScopes also supports setting as a function, which can be modified instead of overriding the default value:\n\nexport default {\n  source: {\n    moduleScopes: scopes => {\n      scopes.push('./shared');\n    },\n  },\n};\n\n\n\n# source.preEntry\n\n * Type: string | string[]\n * Default: undefined\n\nAdd a script before the entry file of each page. This script will be executed before the page code. It can be used to execute global logics, such as polyfill injection.\n\n# Add a single script\n\nFirst create a src/polyfill.ts file:\n\nconsole.log('I am a polyfill');\n\n\nThen configure src/polyfill.ts to source.preEntry:\n\nexport default {\n  source: {\n    preEntry: './src/polyfill.ts',\n  },\n};\n\n\nRe-run the compilation and visit any page, you can see that the code in src/polyfill.ts has been executed, and the I am a polyfill is logged in the console.\n\n# Add multiple scripts\n\nMultiple scripts can be added by setting preEntry to an array:\n\nexport default {\n  source: {\n    preEntry: ['./src/polyfill-a.ts', './src/polyfill-b.ts'],\n  },\n};\n\n\n\n# source.resolveExtensionPrefix\n\n * Type: string | Record<BuilderTarget, string>\n * Default: undefined\n\nAdd a prefix to resolve.extensions.\n\nIf multiple files share the same name but have different extensions, Builder will resolve the one with the extension listed first in the array and skip the rest.\n\n# Example\n\nexport default {\n  source: {\n    resolveExtensionPrefix: '.web',\n  },\n};\n\n\nWith the configuration above, the extensions array will become:\n\n// before\nconst extensions = ['.js', '.ts', ...];\n\n// after\nconst extensions = ['.web.js', '.js', '.web.ts' , '.ts', ...];\n\n\nWhen import './foo' in the code, the foo.web.js file will be resolved first, then the foo.js file.\n\n# Set according to Targets\n\nWhen you build multiple targets at the same time, you can set different extension prefix for different targets. At this point, you need to set resolveExtensionPrefix to an object whose key is the corresponding build target.\n\nFor example to set different extension prefix for web and node:\n\nexport default {\n  output: {\n    source: {\n      resolveExtensionPrefix: {\n        web: '.web',\n        node: '.node',\n      },\n    },\n  },\n};\n\n\nWhen import './foo' in the code, the foo.node.js file will be resolved for node target, and the foo.web.js file will be resolved for web target.\n\n\n# source.resolveMainFields\n\n * Type:\n\ntype Fields = (string | string[])[];\n\ntype ResolveMainFields = Fields | Record<BuilderTarget, Fields>;\n\n\n * Default: undefined\n\nThis config will determine which field of package.json you use to import the npm module. Same as the resolve.mainFields config of webpack.\n\n# Example\n\nexport default {\n  source: {\n    resolveMainFields: ['main', 'browser', 'exports'],\n  },\n};\n\n\n# Set according to Targets\n\nWhen you build multiple targets at the same time, you can set different mainFields for different targets. At this point, you need to set resolveMainFields to an object whose key is the corresponding build target.\n\nFor example to set different mainFields for web and node:\n\nexport default {\n  output: {\n    source: {\n      resolveMainFields: {\n        web: ['main', 'browser', 'exports'],\n        node: ['main', 'node', 'exports'],\n      },\n    },\n  },\n};\n",normalizedContent:"# source config\n\nthis section describes some source code related configurations in modern.js builder.\n\n\n# source.alias\n\n * type: record<string, string | string[]> | function\n * default: undefined\n\ncreate aliases to import or require certain modules, same as the resolve.alias config of webpack.\n\ntip\n\nfor typescript projects, you only need to configure compileroptions.paths in tsconfig.json, builder will automatically recognize the aliases in tsconfig.json, so the alias config is unnecessary.\n\n# object type\n\nthe alias can be an object, and the relative path will be automatically converted to absolute path.\n\nexport default {\n  source: {\n    alias: {\n      '@common': './src/common',\n    },\n  },\n};\n\n\nwith above configuration, if @common/foo.tsx is import in the code, it will be mapped to the <root>/src/common/foo.tsx path.\n\n# function type\n\nthe alias can be a function, it will accept the previous alias object, and you can modify it.\n\nexport default {\n  source: {\n    alias: alias => {\n      alias['@common'] = './src/common';\n    },\n  },\n};\n\n\nyou can also return a new object as the final result in the function, which will replace the previous alias object.\n\nexport default {\n  source: {\n    alias: alias => {\n      return {\n        '@common': './src/common',\n      };\n    },\n  },\n};\n\n\n\n# source.include\n\n * type: array<string | regexp>\n * default: []\n\nin order to maintain faster compilation speed, builder will not compile javascript/typescript files under node_modules through babel-loader or ts-loader by default, as will as the javascript/typescript files outside the current project directory.\n\nthrough the source.include config, you can specify directories or modules that need additional compilation. the usage is consistent with rule.include in webpack, which supports passing in strings or regular expressions to match the module path.\n\nfor example:\n\nimport path from 'path';\n\nexport default {\n  source: {\n    include: [path.resolve(__dirname, '../other-dir')],\n  },\n};\n\n\n\n# typical example\n\na typical usage scenario is to compile files under node_modules, because some third-party dependencies have es6+ syntax, which may cause them to fail to run on low-version browsers. you can solve the problem by using this config to specify the dependencies that need to be compiled. take query-string as an example, you can add the following config:\n\nimport path from 'path';\n\nexport default {\n  source: {\n    include: [\n      // method 1:\n      // first get the path of the module by require.resolve\n      // then pass path.dirname to point to the corresponding directory\n      path.dirname(require.resolve('query-string')),\n      // method 2:\n      // match by regular expression\n      // all paths containing `/query-string/` will be matched\n      /\\/query-string\\//,\n    ],\n  },\n};\n\n\n> note that this config will only compile the code of query-string itself, not the sub-dependencies of query-string. if you need to compile a sub-dependency of query-string, you need to add the corresponding npm package to source.include.\n\n\n# monorepo project\n\nwhen using monorepo, if you need to refer to the source code of other libraries in monorepo, you can add the corresponding library to source.include:\n\nimport path from 'path';\n\nexport default {\n  source: {\n    include: [\n      // method 1:\n      // compile all files in monorepo's package directory\n      path.resolve(__dirname, '../../packages'),\n\n      // method 2:\n      // compile the source code of a package in monorepo's package directory\n      // this way of writing matches the range more accurately and has less impact on the overall build performance.\n      path.resolve(__dirname, '../../packages/xxx/src'),\n    ],\n  },\n};\n\n\n\n# precautions\n\nnote that babel cannot compile commonjs modules by default. when you use source.include to compile commonjs modules, you need to set babel's sourcetype config to unambiguous:\n\nexport default {\n  tools: {\n    babel(config) {\n      config.sourcetype = 'unambiguous';\n    },\n  },\n};\n\n\nsetting sourcetype to unambiguous may have some other effects, please refer to babel official documentation.\n\n\n# source.exclude\n\n * type: array<string | regexp>\n * default: []\n\nspecifies javascript/typescript files that do not need to be compiled. the usage is consistent with rule.exclude in webpack, which supports passing in strings or regular expressions to match the module path.\n\nfor example:\n\nimport path from 'path';\n\nexport default {\n  source: {\n    exclude: [path.resolve(__dirname, 'src/module-a'), /src\\/module-b/],\n  },\n};\n\n\n\n# source.compilejsdatauri\n\n * type: boolean\n * default: true\n\nwhether to compile javascript code imported via data uri.\n\nsuch as:\n\nimport x from 'data:text/javascript,export default 1;';\n\nimport 'data:text/javascript;charset=utf-8;base64,y29uc29szs5sb2coj2lubgluzsaxjyk7';\n\n\n# example\n\nadd the following config to disable:\n\nexport default {\n  source: {\n    compilejsdatauri: false,\n  },\n};\n\n\n\n# source.define\n\n * type: record<string, unknown>\n * default: {}\n\nreplaces variables in your code with other values or expressions at compile time. this can be useful for allowing different behavior between development builds and production builds.\n\neach key passed into options is an identifier or multiple identifiers joined with ..\n\n * if the value is a string it will be used as a code fragment.\n * if the value isn't a string, it will be stringified (including functions).\n * if the value is an object all keys are defined the same way.\n * if you prefix typeof to the key, it's only defined for typeof calls.\n\nfor more information please visit https://webpack.js.org/plugins/define-plugin/.\n\n# example\n\nexport default {\n  source: {\n    define: {\n      production: json.stringify(true),\n      version: json.stringify('5fa3b9'),\n      browser_supports_html5: true,\n      two: '1 + 1',\n      'typeof window': json.stringify('object'),\n      'process.env.node_env': json.stringify(process.env.node_env),\n      'import.meta': { test: undefined },\n    },\n  },\n};\n\n\nexpressions will be replaced with the corresponding code fragments:\n\nconst foo = two;\n\n// ⬇️ turn into being...\nconst foo = 1 + 1;\n\n\n\n# source.globalvars\n\n * type: record<string, jsonvalue>\n * default:\n\nconst defaultglobalvars = {\n  // the environment variable `process.env.node_env` will be added by default,\n  // so you don't need to set it in manually.\n  'process.env.node_env': json.stringify(process.env.node_env),\n};\n\n\ndefine global variables. it can replace expressions like process.env.foo in your code after compile. such as:\n\nconsole.log(process.env.node_env);\n\n// ⬇️ turn into being...\nconsole.log('development');\n\n\ndoesn't works with destructuring assignment, because builder does not know if node_env and process.env.node_env are associated:\n\nconst { node_env } = process.env;\nconsole.log(node_env);\n// ❌ won't get a string.\n\n\nyou can take source.globalvars as the syntax sugar of source.define, the only difference is that source.globalvars will automatically stringify the value, which makes it easier to set the value of global variables. the values of globalvars should be json-safe to ensure it can be serialized.\n\nexport default {\n  source: {\n    globalvars: {\n      'process.env.build_version': '0.0.1',\n      'import.meta.foo': { bar: 42 },\n      'import.meta.baz': false,\n    },\n    define: {\n      'process.env.build_version': json.stringify('0.0.1'),\n      'import.meta': {\n        foo: json.stringify({ bar: 42 }),\n        baz: json.stringify(false),\n      },\n    },\n  },\n};\n\n\n# example\n\nadd the following config to use:\n\nexport default {\n  source: {\n    globalvars: {\n      enable_vconsole: true,\n      app_context: { answer: 42 },\n    },\n  },\n};\n\n\n\n# source.modulescopes\n\n * type: array<string | regexp> | function\n * default: undefined\n\nrestrict importing paths. after configuring this option, all source files can only import code from the specific paths, and import code from other paths is not allowed.\n\n# example\n\nfirst, we configure modulescopes to only include the src directory:\n\nexport default {\n  source: {\n    modulescopes: ['./src'],\n  },\n};\n\n\nthen we import the utils/a module outside the src directory in src/app.tsx:\n\nimport a from '../utils/a';\n\n\nafter compiling, there will be a reference path error:\n\n\n\nif we configure the utils directory in modulescopes, the error will disappear.\n\nexport default {\n  source: {\n    modulescopes: ['./src', './utils'],\n  },\n};\n\n\n# array type\n\nyou can directly set several paths like this:\n\nexport default {\n  source: {\n    modulescopes: ['./src', './shared', './utils'],\n  },\n};\n\n\n# function type\n\nmodulescopes also supports setting as a function, which can be modified instead of overriding the default value:\n\nexport default {\n  source: {\n    modulescopes: scopes => {\n      scopes.push('./shared');\n    },\n  },\n};\n\n\n\n# source.preentry\n\n * type: string | string[]\n * default: undefined\n\nadd a script before the entry file of each page. this script will be executed before the page code. it can be used to execute global logics, such as polyfill injection.\n\n# add a single script\n\nfirst create a src/polyfill.ts file:\n\nconsole.log('i am a polyfill');\n\n\nthen configure src/polyfill.ts to source.preentry:\n\nexport default {\n  source: {\n    preentry: './src/polyfill.ts',\n  },\n};\n\n\nre-run the compilation and visit any page, you can see that the code in src/polyfill.ts has been executed, and the i am a polyfill is logged in the console.\n\n# add multiple scripts\n\nmultiple scripts can be added by setting preentry to an array:\n\nexport default {\n  source: {\n    preentry: ['./src/polyfill-a.ts', './src/polyfill-b.ts'],\n  },\n};\n\n\n\n# source.resolveextensionprefix\n\n * type: string | record<buildertarget, string>\n * default: undefined\n\nadd a prefix to resolve.extensions.\n\nif multiple files share the same name but have different extensions, builder will resolve the one with the extension listed first in the array and skip the rest.\n\n# example\n\nexport default {\n  source: {\n    resolveextensionprefix: '.web',\n  },\n};\n\n\nwith the configuration above, the extensions array will become:\n\n// before\nconst extensions = ['.js', '.ts', ...];\n\n// after\nconst extensions = ['.web.js', '.js', '.web.ts' , '.ts', ...];\n\n\nwhen import './foo' in the code, the foo.web.js file will be resolved first, then the foo.js file.\n\n# set according to targets\n\nwhen you build multiple targets at the same time, you can set different extension prefix for different targets. at this point, you need to set resolveextensionprefix to an object whose key is the corresponding build target.\n\nfor example to set different extension prefix for web and node:\n\nexport default {\n  output: {\n    source: {\n      resolveextensionprefix: {\n        web: '.web',\n        node: '.node',\n      },\n    },\n  },\n};\n\n\nwhen import './foo' in the code, the foo.node.js file will be resolved for node target, and the foo.web.js file will be resolved for web target.\n\n\n# source.resolvemainfields\n\n * type:\n\ntype fields = (string | string[])[];\n\ntype resolvemainfields = fields | record<buildertarget, fields>;\n\n\n * default: undefined\n\nthis config will determine which field of package.json you use to import the npm module. same as the resolve.mainfields config of webpack.\n\n# example\n\nexport default {\n  source: {\n    resolvemainfields: ['main', 'browser', 'exports'],\n  },\n};\n\n\n# set according to targets\n\nwhen you build multiple targets at the same time, you can set different mainfields for different targets. at this point, you need to set resolvemainfields to an object whose key is the corresponding build target.\n\nfor example to set different mainfields for web and node:\n\nexport default {\n  output: {\n    source: {\n      resolvemainfields: {\n        web: ['main', 'browser', 'exports'],\n        node: ['main', 'node', 'exports'],\n      },\n    },\n  },\n};\n",charsets:{cjk:!0}},{title:"Tools Config",frontmatter:{extractApiHeaders:[2]},regularPath:"/en/api/config-tools.html",relativePath:"en/api/config-tools.md",key:"v-f69b32e8",path:"/en/api/config-tools.html",headers:[{level:2,title:"tools.autoprefixer",slug:"tools-autoprefixer",normalizedTitle:"tools.autoprefixer",charIndex:101},{level:2,title:"tools.babel",slug:"tools-babel",normalizedTitle:"tools.babel",charIndex:975},{level:2,title:"tools.cssExtract",slug:"tools-cssextract",normalizedTitle:"tools.cssextract",charIndex:5801},{level:2,title:"tools.cssLoader",slug:"tools-cssloader",normalizedTitle:"tools.cssloader",charIndex:7025},{level:2,title:"tools.devServer",slug:"tools-devserver",normalizedTitle:"tools.devserver",charIndex:8152},{level:2,title:"tools.htmlPlugin",slug:"tools-htmlplugin",normalizedTitle:"tools.htmlplugin",charIndex:15075},{level:2,title:"tools.inspector",slug:"tools-inspector",normalizedTitle:"tools.inspector",charIndex:16690},{level:2,title:"tools.less",slug:"tools-less",normalizedTitle:"tools.less",charIndex:17537},{level:2,title:"tools.minifyCss",slug:"tools-minifycss",normalizedTitle:"tools.minifycss",charIndex:18960},{level:2,title:"tools.postcss",slug:"tools-postcss",normalizedTitle:"tools.postcss",charIndex:20059},{level:2,title:"tools.pug",slug:"tools-pug",normalizedTitle:"tools.pug",charIndex:23086},{level:2,title:"tools.sass",slug:"tools-sass",normalizedTitle:"tools.sass",charIndex:23977},{level:2,title:"tools.styleLoader",slug:"tools-styleloader",normalizedTitle:"tools.styleloader",charIndex:25290},{level:2,title:"tools.styledComponents",slug:"tools-styledcomponents",normalizedTitle:"tools.styledcomponents",charIndex:26130},{level:2,title:"tools.terser",slug:"tools-terser",normalizedTitle:"tools.terser",charIndex:23468},{level:2,title:"tools.tsLoader",slug:"tools-tsloader",normalizedTitle:"tools.tsloader",charIndex:27776},{level:2,title:"tools.tsChecker",slug:"tools-tschecker",normalizedTitle:"tools.tschecker",charIndex:29811},{level:2,title:"tools.webpack",slug:"tools-webpack",normalizedTitle:"tools.webpack",charIndex:30870},{level:2,title:"tools.webpackChain",slug:"tools-webpackchain",normalizedTitle:"tools.webpackchain",charIndex:30994}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"tools.autoprefixer tools.babel tools.cssExtract tools.cssLoader tools.devServer tools.htmlPlugin tools.inspector tools.less tools.minifyCss tools.postcss tools.pug tools.sass tools.styleLoader tools.styledComponents tools.terser tools.tsLoader tools.tsChecker tools.webpack tools.webpackChain",content:"# Tools Config\n\nThis section describes some low-level tools configurations in Modern.js Builder.\n\n\n# tools.autoprefixer\n\n * Type: Object | Function\n * Default\n\n{\n  flexbox: 'no-2009',\n  // Depends on the browserslist config in the project\n  // and the `output.overrideBrowserslist` (higher priority) config\n  overrideBrowserslist: browserslist,\n}\n\n\nYou can modify the config of autoprefixer by tools.autoprefixer.\n\n\n# Object Type\n\nWhen tools.autoprefixer is configured as Object type, it is merged with the default config through Object.assign. For example:\n\nexport default {\n  tools: {\n    autoprefixer: {\n      flexbox: 'no-2009',\n    },\n  },\n};\n\n\n\n# Function Type\n\nWhen tools.autoprefixer is a Function, the default config is passed as the first parameter and can be directly modified or returned as the final result. For example:\n\nexport default {\n  tools: {\n    autoprefixer(config) {\n      // modify flexbox config\n      config.flexbox = 'no-2009';\n    },\n  },\n};\n\n\n\n# tools.babel\n\n * Type: Object | Function\n * Default: undefined\n\nBy tools.babel you can modify the options of babel-loader.\n\n\n# Function Type\n\nWhen tools.babel's type is Function，the default babel config will be passed in as the first parameter, the config object can be modified directly, or a value can be returned as the final result. The second parameter provides some util functions that can be called directly:\n\nexport default {\n  tools: {\n    babel(config) {\n      // Add a babel plugin\n      // note: the plugin have been added to the default config to support antd load on demand\n      config.plugins.push([\n        'babel-plugin-import',\n        {\n          libraryName: 'xxx-components',\n          libraryDirectory: 'es',\n          style: true,\n        },\n      ]);\n    },\n  },\n};\n\n\n\n# Object Type\n\nWhen tools.babel's type is Object, the config will be merged with default config by Object.assign. Note that Object.assign is a shallow copy and will completely overwrite the built-in presets or plugins array, please use it with caution.\n\nexport default {\n  tools: {\n    babel: {\n      plugins: [\n        [\n          'babel-plugin-import',\n          {\n            libraryName: 'xxx-components',\n            libraryDirectory: 'es',\n            style: true,\n          },\n        ],\n      ],\n    },\n  },\n};\n\n\n\n# Util Functions\n\nWhen tools.babel is a Function, the tool functions available for the second parameter are as follows:\n\n# addPlugins\n\n * Type: (plugins: BabelPlugin[]) => void\n\nAdd some Babel plugins. For example:\n\nexport default {\n  tools: {\n    babel(config, { addPlugins }) {\n      addPlugins([\n        [\n          'babel-plugin-import',\n          {\n            libraryName: 'xxx-components',\n            libraryDirectory: 'es',\n            style: true,\n          },\n        ],\n      ]);\n    },\n  },\n};\n\n\n# addPresets\n\n * Type: (presets: BabelPlugin[]) => void\n\nAdd Babel preset configuration. (No need to add presets in most cases)\n\nexport default {\n  tools: {\n    babel(config, { addPresets }) {\n      addPresets(['@babel/preset-env']);\n    },\n  },\n};\n\n\n# removePlugins\n\n * Type: (plugins: string | string[]) => void\n\nTo remove the Babel plugin, just pass in the name of the plugin to be removed, you can pass in a single string or an array of strings.\n\nexport default {\n  tools: {\n    babel(config, { removePlugins }) {\n      removePlugins('babel-plugin-import');\n    },\n  },\n};\n\n\n# removePresets\n\n * Type: (presets: string | string[]) => void\n\nTo remove the Babel preset configuration, pass in the name of the preset to be removed, you can pass in a single string or an array of strings.\n\nexport default {\n  tools: {\n    babel(config, { removePresets }) {\n      removePresets('@babel/preset-env');\n    },\n  },\n};\n\n\n# addIncludes\n\n * Type: (includes: string | RegExp | (string | RegExp)[]) => void\n\nBy default, Babel will only compile the application code in the src directory. With addIncludes you can specify that Babel compile some files in node_modules. For example:\n\nexport default {\n  tools: {\n    babel(config, { addIncludes }) {\n      addIncludes('node_modules/xxx-components');\n    },\n  },\n};\n\n\nNote that Babel cannot compile CommonJS modules by default. When you use source.include to compile CommonJS modules, you need to set Babel's sourceType config to unambiguous:\n\nexport default {\n  tools: {\n    babel(config) {\n      config.sourceType = 'unambiguous';\n    },\n  },\n};\n\n\nSetting sourceType to unambiguous may have some other effects, please refer to Babel official documentation.\n\nTIP\n\nBuilder provides a more general source.include config than addIncludes, and it is recommended to use this configuration item first.\n\n# addExcludes\n\n * Type: (excludes: string | RegExp | (string | RegExp)[]) => void\n\nContrary to addIncludes, specifies that certain files are excluded from Babel's compilation.\n\nFor example, without compiling files in the src/example directory:\n\nexport default {\n  tools: {\n    babel(config, { addExcludes }) {\n      addExcludes('src/example');\n    },\n  },\n};\n\n\n# modifyPresetEnvOptions\n\n * Type: (options: PresetEnvOptions) => void\n\nModify the configuration of @babel/preset-env, the configuration you pass in will be shallowly merged with default config. For example:\n\nexport default {\n  tools: {\n    babel(config, { modifyPresetEnvOptions }) {\n      modifyPresetEnvOptions({\n        targets: {\n          browsers: ['last 2 versions'],\n        },\n      });\n    },\n  },\n};\n\n\n# modifyPresetReactOptions\n\n * Type: (options: PresetReactOptions) => void\n\nModify the configuration of @babel/preset-react, the configuration you pass in will be shallowly merged with default config. For example:\n\nexport default {\n  tools: {\n    babel(config, { modifyPresetReactOptions }) {\n      modifyPresetReactOptions({\n        pragma: 'React.createElement',\n      });\n    },\n  },\n};\n\n\n\n# tools.cssExtract\n\n * Type: Object | Function\n * Default:\n\nconst defaultOptions = {\n  // The loader options\n  loaderOptions: {},\n  // The plugin options\n  pluginOptions: {\n    // The default value of cssPath is `static/css`\n    // while the default value of cssFilename is `[name].[contenthash:8].css`\n    filename: `${cssPath}/${cssFilename}`,\n    chunkFilename: `${cssPath}/async/${cssFilename}`,\n    ignoreOrder: true,\n  },\n};\n\n\nThe config of mini-css-extract-plugin can be modified through tools.cssExtract.\n\n\n# Object Type\n\nWhen this value is an Object, it is merged with the default config via Object.assign. For example:\n\nexport default {\n  tools: {\n    cssExtract: {\n      pluginOptions: {\n        filename: 'static/css/[name].[contenthash:8].css',\n      },\n    },\n  },\n};\n\n\n\n# Function Type\n\nWhen the value a Function, the default config is passed in as the first parameter. You can modify the config object directly, or return an object as the final config. For example:\n\nexport default {\n  tools: {\n    cssExtract: config => {\n      config.pluginOptions.filename = 'static/css/[name].[contenthash:8].css';\n      return config;\n    },\n  },\n};\n\n\nFor more config details, please refer to mini-css-extract-plugin.\n\n\n# tools.cssLoader\n\n * Type: Object | Function\n * Default: undefined\n\nThe config of css-loader can be modified through tools.cssLoader. The default config is as follows:\n\n{\n  importLoaders: 1,\n  modules: {\n    auto: true,\n    exportLocalsConvention: 'camelCase',\n    localIdentName: config.output.cssModuleLocalIdentName,\n    // isServer indicates node (SSR) build\n    // isWebWorker indicates web worker build\n    exportOnlyLocals: isServer || isWebWorker,\n  },\n  // CSS Source Map enabled by default in development environment\n  sourceMap: isDev,\n}\n\n\n\n# Object Type\n\nWhen this value is an Object, it is merged with the default config via deep merge. For example:\n\nexport default {\n  tools: {\n    cssLoader: {\n      modules: {\n        exportOnlyLocals: true,\n      },\n    },\n  },\n};\n\n\n\n# Function Type\n\nWhen the value is a Function, the default config is passed in as the first parameter. You can modify the config object directly, or return an object as the final config. For example:\n\nexport default {\n  tools: {\n    cssLoader: config => {\n      config.modules.exportOnlyLocals = true;\n      return config;\n    },\n  },\n};\n\n\n\n# tools.devServer\n\n * Type: Object\n * Default: {}\n\nThe config of DevServer can be modified through tools.devServer.\n\n\n# Options\n\n# after\n\n * Type: Array\n * Default: []\n\nProvides the ability to execute custom middleware after all other middleware internally within the server.\n\nexport default {\n  tools: {\n    devServer: {\n      after: [\n        async (req, res, next) => {\n          console.log('after dev middleware');\n          next();\n        },\n      ],\n    },\n  },\n};\n\n\n# before\n\n * Type: Array\n * Default: []\n\nProvides the ability to execute custom middleware prior to all other middleware internally within the server.\n\nexport default {\n  tools: {\n    devServer: {\n      before: [\n        async (req, res, next) => {\n          console.log('before dev middleware');\n          next();\n        },\n      ],\n    },\n  },\n};\n\n\n# client\n\n * Type:\n\n{\n    /** The path which the middleware is serving the event stream on */\n    path?: string;\n    /** Specify a port number to listen for requests on */\n    port?: string;\n    /** Specify a host to use */\n    host?: string;\n}\n\n\n * Default:\n\n{\n    path: '/webpack-hmr',\n    port: '8080',\n    host: networkAddress || 'localhost',\n}\n\n\nThe config of hmr client.\n\n# devMiddleware\n\n * Type:\n\n{\n  writeToDisk: boolean | ((filename: string) => boolean);\n}\n\n\n * Default:\n\n{\n  writeToDisk: (file: string) => !file.includes('.hot-update.'),\n}\n\n\nThe config of devMiddleware. Current options is the subset of webpack-dev-middleware.\n\n# headers\n\n * Type: Record<string, string>\n * Default: undefined\n\nAdds headers to all responses.\n\nexport default {\n  tools: {\n    devServer: {\n      headers: {\n        'X-Custom-Foo': 'bar',\n      },\n    },\n  },\n};\n\n\n# historyApiFallback\n\n * Type: boolean | ConnectHistoryApiFallbackOptions\n * Default: false\n\nThe index.html page will likely have to be served in place of any 404 responses. Enable devServer.historyApiFallback by setting it to true:\n\nexport default {\n  tools: {\n    devServer: {\n      historyApiFallback: true,\n    },\n  },\n};\n\n\nFor more options and information, see the connect-history-api-fallback documentation.\n\n# hot\n\n * Type: boolean\n * Default: true\n\nEnable Hot Module Replacement feature.\n\n# https\n\n * Type: boolean | { key: string; cert: string }\n * Default: false\n\nBy default, DevServer will be served over HTTP. It can optionally be served over HTTPS by setting devServer.https to true, and will disable the HTTP server.\n\nYou can also manually pass in the certificate and corresponding private key required by the HTTPS server:\n\nexport default {\n  tools: {\n    devServer: {\n      https: {\n        key: fs.readFileSync('certificates/private.pem'),\n        cert: fs.readFileSync('certificates/public.pem'),\n      },\n    },\n  },\n};\n\n\n# liveReload\n\n * Type: boolean\n * Default: true\n\nBy default, the DevServer will reload/refresh the page when file changes are detected（devServer.hot option must be disabled in order for liveReload to take effect）. Disable devServer.liveReload by setting it to false.\n\n# setupMiddlewares\n\n * Type:\n\nArray<\n  (\n    middlewares: {\n      unshift: (...handlers: RequestHandler[]) => void;\n      push: (...handlers: RequestHandler[]) => void;\n    },\n    server: {\n      sockWrite: (\n        type: string,\n        data?: string | boolean | Record<string, any>,\n      ) => void;\n    },\n  ) => void\n>;\n\n\n * Default: undefined\n\nProvides the ability to execute a custom function and apply custom middlewares.\n\nThe order among several different types of middleware is: devServer.before => unshift => internal middlewares => push => devServer.after.\n\nexport default {\n  tools: {\n    devServer: {\n      setupMiddlewares: [\n        (middlewares, server) => {\n          middlewares.unshift((req, res, next) => {\n            next();\n          });\n\n          middlewares.push((req, res, next) => {\n            next();\n          });\n        },\n      ],\n    },\n  },\n};\n\n\nIt is possible to use some server api to meet special scenario requirements:\n\n * sockWrite. Allow send some message to hmr client, and then the hmr client will take different actions depending on the message type. If you send a \"content changed\" message, the page will reload.\n\nexport default {\n  tools: {\n    devServer: {\n      setupMiddlewares: [\n        (middlewares, server) => {\n          // add custom watch & trigger page reload when change\n          watcher.on('change', changed => {\n            server.sockWrite('content-changed');\n          });\n        },\n      ],\n    },\n  },\n};\n\n\n# proxy\n\n * Type: Record<string, string> | Record<string, ProxyDetail>\n * Default: undefined\n\nProxying some URLs.\n\nexport default {\n  tools: {\n    devServer: {\n      proxy: {\n        '/api': 'http://localhost:3000',\n      },\n    },\n  },\n};\n\n\nA request to /api/users will now proxy the request to http://localhost:3000/api/users.\n\nIf you don't want /api to be passed along, we need to rewrite the path:\n\nexport default {\n  tools: {\n    devServer: {\n      proxy: {\n        '/api': {\n          target: 'http://localhost:3000',\n          pathRewrite: { '^/api': '' },\n        },\n      },\n    },\n  },\n};\n\n\nThe DevServer Proxy makes use of the http-proxy-middleware package. Check out its documentation for more advanced usages.\n\nThe full type definition of DevServer Proxy is:\n\nimport type { Options as HttpProxyOptions } from 'http-proxy-middleware';\n\ntype ProxyDetail = HttpProxyOptions & {\n  bypass?: (\n    req: IncomingMessage,\n    res: ServerResponse,\n    proxyOptions: ProxyOptions,\n  ) => string | undefined | null | false;\n  context?: string | string[];\n};\n\ntype ProxyOptions =\n  | Record<string, string>\n  | Record<string, ProxyDetail>\n  | ProxyDetail[]\n  | ProxyDetail;\n\n\nIn addition to the http-proxy-middleware option, we also support the bypass and context configuration:\n\n * bypass：bypass the proxy based on the return value of a function.\n   * Return null or undefined to continue processing the request with proxy.\n   * Return false to produce a 404 error for the request.\n   * Return a path to serve from, instead of continuing to proxy the request.\n * context：If you want to proxy multiple, specific paths to the same target, you can use an array of one or more objects with a context property.\n\n// custom bypass\nexport default {\n  tools: {\n    devServer: {\n      proxy: {\n        '/api': {\n          target: 'http://localhost:3000',\n          bypass: function (req, res, proxyOptions) {\n            if (req.headers.accept.indexOf('html') !== -1) {\n              console.log('Skipping proxy for browser request.');\n              return '/index.html';\n            }\n          },\n        },\n      },\n    },\n  },\n};\n\n\n// proxy multiple\nexport default {\n  tools: {\n    devServer: {\n      proxy: [\n        {\n          context: ['/auth', '/api'],\n          target: 'http://localhost:3000',\n        },\n      ],\n    },\n  },\n};\n\n\n# watch\n\n * Type: boolean\n * Default: true\n\nWhether to watch files change in directories such as mock/, server/, api/.\n\n\n# tools.htmlPlugin\n\n * Type: false | Object | Function\n * Default:\n\nconst defaultHtmlPluginOptions = {\n  inject, // corresponding to the html.inject config\n  favicon, // corresponding to html.favicon config\n  filename, // generated based on output.distPath and entryName\n  template, // defaults to the built-in HTML template path\n  templateParameters, // corresponding to the html.templateParameters config\n  chunks: [entryName],\n  minify: {\n    removeComments: true,\n    useShortDoctype: true,\n    keepClosingSlash: true,\n    collapseWhitespace: true,\n    removeRedundantAttributes: true,\n    removeScriptTypeAttributes: true,\n    removeStyleLinkTypeAttributes: true,\n  },\n};\n\n\nThe configs of html-webpack-plugin can be modified through tools.htmlPlugin.\n\n\n# Object Type\n\nWhen tools.htmlPlugin is Object type, the value will be merged with the default config via Object.assign.\n\nexport default {\n  tools: {\n    htmlPlugin: {\n      scriptLoading: 'blocking',\n    },\n  },\n};\n\n\n\n# Function Type\n\nWhen tools.htmlPlugin is a Function:\n\n * The first parameter is the default config, which can be modified directly.\n * The second parameter is also an object, containing the entry name and the entry value.\n * The Function can return a new object as the final config.\n\nexport default {\n  tools: {\n    htmlPlugin(config, { entryName, entryValue }) {\n      if (entryName === 'main') {\n        config.scriptLoading = 'blocking';\n      }\n    },\n  },\n};\n\n\n\n# Boolean Type\n\nThe built-in html-webpack-plugin plugins can be disabled by set tools.htmlPlugin to false.\n\nexport default {\n  tools: {\n    htmlPlugin: false,\n  },\n};\n\n\n\n# tools.inspector\n\n * Type: Object | Function | undefined\n * Default: undefined\n\nYou can enable or configure the webpack inspector through tools.inspector.\n\nWhen the configuration is not undefined, it means that webpack-inspector is enabled, and the type of tools.inspector can be Object or Function.\n\n\n# Object Type\n\nWhen tools.inspector is configured with type Object, it is merged with the default configuration via Object.assign. For example:\n\nexport default {\n  tools: {\n    inspector: {\n      // The default port is 3333\n      port: 3334,\n    },\n  },\n};\n\n\n\n# Function Type\n\nWhen tools.inspector is a Function, the default configuration is passed as the first parameter and can be directly modified or returned as the final result. For example:\n\nexport default {\n  tools: {\n    inspector(config) {\n      config.port = 3334;\n    },\n  },\n};\n\n\n\n# tools.less\n\n * Type: Object | Function\n * Default:\n\nconst defaultOptions = {\n  lessOptions: {\n    javascriptEnabled: true,\n  },\n  // CSS Source Map enabled by default in development environment\n  sourceMap: isDev,\n};\n\n\nYou can modify the config of less-loader via tools.less.\n\n\n# Object Type\n\nWhen tools.less is configured as Object type, it is merged with the default config through Object.assign in a shallow way. It should be noted that lessOptions is merged through deepMerge in a deep way. For example:\n\nexport default {\n  tools: {\n    less: {\n      lessOptions: {\n        javascriptEnabled: false,\n      },\n    },\n  },\n};\n\n\n\n# Function Type\n\nWhen tools.less is a Function, the default config is passed as the first parameter, which can be directly modified or returned as the final result. The second parameter provides some utility functions that can be called directly. For example:\n\nexport default {\n  tools: {\n    less(config) {\n      // Modify the config of lessOptions\n      config.lessOptions = {\n        javascriptEnabled: false,\n      };\n    },\n  },\n};\n\n\n\n# Util Function\n\n# addExcludes\n\n * Type: (excludes: RegExp | RegExp[]) => void\n\nUsed to specify which files less-loader does not compile, You can pass in one or more regular expressions to match the path of less files, for example:\n\nexport default {\n  tools: {\n    less(config, { addExcludes }) {\n      addExcludes(/node_modules/);\n    },\n  },\n};\n\n\n\n# tools.minifyCss\n\n * Type: Object | Function | undefined\n * Default:\n\nconst defaultOptions = {\n  minimizerOptions: {\n    preset: [\n      'default',\n      {\n        mergeLonghand: false,\n      },\n    ],\n  },\n};\n\n\nWhen building for production, Builder will minimize the CSS code through css-minimizer-webpack-plugin. The config of css-minimizer-webpack-plugin can be modified via tools.minifyCss.\n\n\n# Object Type\n\nWhen tools.minifyCss is Object type, it will be merged with the default config via Object.assign.\n\nFor example, modify the preset config of cssnano:\n\nexport default {\n  tools: {\n    minifyCss: {\n      minimizerOptions: {\n        preset: require.resolve('cssnano-preset-simple'),\n      },\n    },\n  },\n};\n\n\n\n# Function Type\n\nWhen tools.minifyCss is Function type, the default config is passed in as the first parameter, the config object can be modified directly, or a value can be returned as the final result.\n\nexport default {\n   tools: {\n    minifyCss: options => {\n      options.minimizerOptions = {\n        preset: require.resolve('cssnano-preset-simple'),\n      },\n    }\n  }\n};\n\n\n\n# tools.postcss\n\n * Type: Object | Function\n * Default:\n\nconst defaultOptions = {\n  postcssOptions: {\n    plugins: [\n      require('postcss-flexbugs-fixes'),\n      require('postcss-custom-properties'),\n      require('postcss-initial'),\n      require('postcss-page-break'),\n      require('postcss-font-variant'),\n      require('postcss-media-minmax'),\n      require('postcss-nesting'),\n      require('autoprefixer')({\n        flexbox: 'no-2009',\n      }),\n    ],\n    // CSS Source Map enabled by default in development environment\n    sourceMap: isDev,\n  },\n};\n\n\nBuilder integrates PostCSS by default, you can configure postcss-loader through tools.postcss.\n\n\n# Function Type\n\nWhen the value is a Function, the internal default config is passed as the first parameter, and the config object can be modified directly without returning, or an object can be returned as the final result; the second parameter is a set of tool functions for modifying the postcss-loader config.\n\nFor example, you need to add a PostCSS plugin on the basis of the original plugin, and push a new plugin to the postcssOptions.plugins array:\n\nexport default {\n  tools: {\n    postcss: opts => {\n      opts.postcssOptions.plugins.push(require('postcss-px-to-viewport'));\n    },\n  },\n};\n\n\nWhen you need to pass parameters to the PostCSS plugin, you can pass them in by function parameters:\n\nexport default {\n  tools: {\n    postcss: opts => {\n      const viewportPlugin = require('postcss-px-to-viewport')({\n        viewportWidth: 375,\n      });\n      opts.postcssOptions.plugins.push(viewportPlugin);\n    },\n  },\n};\n\n\ntools.postcss can return a config object and completely replace the default config:\n\nexport default {\n  tools: {\n    postcss: () => {\n      return {\n        postcssOptions: {\n          plugins: [require('postcss-px-to-viewport')],\n        },\n      };\n    },\n  },\n};\n\n\n\n# Object Type\n\nWhen this value is an Object, it is merged with the default config via Object.assign. Note that Object.assign is a shallow copy and will completely overwrite the built-in presets or plugins array, please use it with caution.\n\nexport default {\n  tools: {\n    postcss: {\n      // Because `Object.assign` is used, the default postcssOptions will be overwritten.\n      postcssOptions: {\n        plugins: [require('postcss-px-to-viewport')],\n      },\n    },\n  },\n};\n\n\n\n# Util Functions\n\n# addPlugins\n\n * Type: (plugins: PostCSSPlugin | PostCSSPlugin[]) => void\n\nFor adding additional PostCSS plugins, You can pass in a single PostCSS plugin, or an array of PostCSS plugins.\n\nexport default {\n  tools: {\n    postcss: (config, { addPlugins }) => {\n      // Add a PostCSS Plugin\n      addPlugins(require('postcss-preset-env'));\n      // Add multiple PostCSS Plugins\n      addPlugins([require('postcss-preset-env'), require('postcss-import')]);\n    },\n  },\n};\n\n\nTIP\n\nBuilder uses the PostCSS v8 version. When you use third-party PostCSS plugins, please pay attention to whether the PostCSS version is compatible. Some legacy plugins may not work in PostCSS v8.\n\n\n# tools.pug\n\n * Type: true | Object | Function | undefined\n * Default: false\n\nConfigure the Pug template engine.\n\n\n# Boolean Type\n\nPug template engine is not enabled by default, you can enable it by setting tools.pug to true.\n\nexport default {\n  tools: {\n    pug: true,\n  },\n};\n\n\nWhen enabled, you can use index.pug as the template file in html.template config.\n\n\n# Object Type\n\nWhen tools.terser is Object type, you can passing the Pug options:\n\nexport default {\n  tools: {\n    pug: {\n      doctype: 'xml',\n    },\n  },\n};\n\n\nFor detailed options, please refer to Pug API Reference.\n\n\n# Function Type\n\nWhen tools.pug is Function type, the default configuration is passed in as the first parameter, the configuration object can be modified directly, or a value can be returned as the final result.\n\nexport default {\n  tools: {\n    pug(config) {\n      config.doctype = 'xml';\n    },\n  },\n};\n\n\n\n# tools.sass\n\n * Type: Object | Function\n * Default:\n\nconst defaultOptions = {\n  // CSS Source Map enabled by default in development environment\n  sourceMap: isDev,\n};\n\n\nYou can modify the config of sass-loader via tools.sass.\n\n\n# Object Type\n\nWhen tools.sass is Object type, it is merged with the default config through Object.assign. It should be noted that sassOptions is merged through deepMerge in a deep way.\n\nFor example:\n\nexport default {\n  tools: {\n    sass: {\n      sourceMap: true,\n    },\n  },\n};\n\n\n\n# Function Type\n\nWhen tools.sass is a Function, the default config is passed as the first parameter, which can be directly modified or returned as the final result. The second parameter provides some utility functions that can be called directly. For Example:\n\nexport default {\n  tools: {\n    sass(config) {\n      // Modify sourceMap config\n      config.additionalData = async (content, loaderContext) => {\n        // ...\n      };\n    },\n  },\n};\n\n\n\n# Utility Function\n\n# addExcludes\n\n * Type: (excludes: RegExp | RegExp[]) => void\n\nUsed to specify which files sass-loader does not compile, You can pass in one or more regular expressions to match the path of sass files, for example:\n\nexport default {\n  tools: {\n    sass(config, { addExcludes }) {\n      addExcludes(/node_modules/);\n    },\n  },\n};\n\n\n\n# tools.styleLoader\n\n * Type: Object | Function\n * Default: {}\n\nThe config of style-loader can be set through tools.styleLoader.\n\nIt is worth noting that Builder does not enable style-loader by default. You can use output.disableCssExtract config to enable it。\n\n\n# Object Type\n\nWhen this value is an Object, it is merged with the default config via Object.assign. For example:\n\nexport default {\n  tools: {\n    styleLoader: {\n      loaderOptions: {\n        insert: 'head',\n      },\n    },\n  },\n};\n\n\n\n# Function Type\n\nWhen the value is a Function, the default config is passed in as the first parameter. You can modify the config object directly, or return an object as the final config. For example:\n\nexport default {\n  tools: {\n    styleLoader: config => {\n      config.loaderOptions.insert = 'head';\n      return config;\n    },\n  },\n};\n\n\n\n# tools.styledComponents\n\n * Type: Object | Function\n * Default\n\n{\n  pure: true,\n  displayName: true,\n  // `isSSR` is true in SSR build\n  ssr: isSSR,\n  transpileTemplateLiterals: true,\n}\n\n\ntools.styledComponents config is corresponding to babel-plugin-styled-components.\n\nWhen the value is an Object, use the Object.assign function to merge with the default config. For example:\n\nexport default {\n  tools: {\n    styledComponents: {\n      pure: false,\n    },\n  },\n};\n\n\nWhen the config is a Function, the first parameter is the default configuration, and the second parameter provides some utility functions that can be called directly:\n\nexport default {\n  tools: {\n    styledComponents(config) {\n      config.pure = false;\n    },\n  },\n};\n\n\n\n# tools.terser\n\n * Type: Object | Function | undefined\n * Default:\n\nconst defaultTerserOptions = {\n  terserOptions: {\n    mangle: {\n      safari10: true,\n    },\n  },\n};\n\n\nWhen building for production, Builder will minimize the JavaScript code through terser-webpack-plugin. The config of terser-webpack-plugin can be modified via tools.terser.\n\n\n# Object Type\n\nWhen tools.terser is Object type, it will be merged with the default config via Object.assign.\n\nFor example, to exclude some files from minification:\n\nexport default {\n  tools: {\n    terser: {\n      exclude: /\\/excludes/,\n    },\n  },\n};\n\n\n\n# Function Type\n\nWhen tools.terser is Function type, the default config is passed in as the first parameter, the config object can be modified directly, or a value can be returned as the final result.\n\nexport default {\n  tools: {\n    terser: opts => {\n      opts.exclude = /\\/excludes/;\n    },\n  },\n};\n\n\n\n# tools.tsLoader\n\n * Type： Object | Function | undefined\n * Default:undefined\n\nts-loader is not enabled by default in the project. When tools.tsLoader is not undefined, builder will use ts-loader instead of babel-loader to compile TypeScript code.\n\n\n# Object Type\n\nWhen this value is an Object, it is merged with the default configuration via Object.assign.\n\nThe default configuration is as follows:\n\n{\n  \"compilerOptions\": {\n    \"target\": \"es5\",\n    \"module\": \"ESNext\"\n  },\n  \"transpileOnly\": true,\n  \"allowTsInNodeModules\": true\n}\n\n\nYou can override the default configuration via the tools.tsLoader configuration item:\n\nexport default {\n  tools: {\n    tsLoader: {\n      allowTsInNodeModules: false,\n    },\n  },\n};\n\n\n\n# Function Type\n\nWhen this value is a Function, the default configuration is passed in as the first parameter, the configuration object can be modified directly, or an object can be returned as the final configuration.The second parameter is the util functions to modify the ts-loader configuration. For example:\n\nexport default {\n  tools: {\n    tsLoader: opts => {\n      opts.allowTsInNodeModules = false;\n    },\n  },\n};\n\n\n\n# Util Functions\n\nWhen the value of tools.tsLoader is a Function, the utils functions available for the second parameter are as follows:\n\n# addIncludes\n\nType: (includes: string | RegExp | Array<string | RegExp>) => void\n\nBy default, only the application code in the src directory will be compiled. Use addIncludes to specify ts-loader to compile some files under node_modules. For example:\n\nexport default {\n  tools: {\n    tsLoader: (config, { addIncludes }) => {\n      addIncludes([/node_modules\\/react/]);\n    },\n  },\n};\n\n\n# addExcludes\n\nType: (excludes: string | RegExp | Array<string | RegExp>) => void\n\nContrary to addIncludes, specify ts-loader to exclude certain files when compiling.\n\nFor example, without compiling files in the src/example directory:\n\nexport default {\n  tools: {\n    tsLoader: (config, { addExcludes }) => {\n      addExcludes([/src\\/example\\//]);\n    },\n  },\n};\n\n\n\n# tools.tsChecker\n\n * Type: Object | Function\n * Default:\n\nconst defaultOptions = {\n  typescript: {\n    // avoid OOM issue\n    memoryLimit: 8192,\n    // use tsconfig of user project\n    configFile: tsconfigPath,\n    // use typescript of user project\n    typescriptPath: require.resolve('typescript'),\n  },\n  issue: {\n    exclude: [\n      { file: '**/*.(spec|test).ts' },\n      { file: '**/node_modules/**/*' },\n    ],\n  },\n  logger: {\n    log() {\n      // do nothing\n      // we only want to display error messages\n    },\n    error(message: string) {\n      console.error(message.replace(/ERROR/g, 'Type Error'));\n    },\n  },\n},\n\n\nBy default, the fork-ts-checker-webpack-plugin is enabled for type checking. You can use output.disableTsChecker config to disable it.\n\n\n# Object Type\n\nWhen this value is an Object, it is merged with the default config via Object.assign.\n\n\n# Function Type\n\nWhen the value is a Function, the default config is passed in as the first parameter. You can modify the config object directly, or return an object as the final config.\n\n\n# tools.webpack\n\n * Type: Object | Function | undefined\n * Default: undefined\n\ntools.webpack is used to configure webpack。\n\n> tools.webpackChain is also used to modify the webpack configuration, and the function is more powerful. It is recommended to use tools.webpackChain first.\n\n\n# Object Type\n\nYou can configure it as an object, which will be merged with the original webpack configuration through webpack-merge. For example:\n\nexport default {\n  tools: {\n    webpack: {\n      resolve: {\n        alias: {\n          '@util': 'src/util',\n        },\n      },\n    },\n  },\n};\n\n\n\n# Function Type\n\nYou can also configure it as a function, which accepts one parameter, the original webpack configuration, you can modify this configuration, and then return a new configuration. For example:\n\nexport default {\n  tools: {\n    webpack: config => {\n      config.resolve.alias['@util'] = 'src/util';\n      return config;\n    },\n  },\n};\n\n\nThe second parameter of this function is an object that contains some information about the tool collection. Details are as follows:\n\n\n# Utils\n\n# env\n\n * Type: 'development' | 'production' | 'test'\n\nThe env parameter can be used to determine whether the current environment is development, production or test. For example:\n\nexport default {\n  tools: {\n    webpack: (config, { env }) => {\n      if (env === 'development') {\n        config.devtool = 'cheap-module-eval-source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\n# isProd\n\n * Type: boolean\n\nThe isProd parameter can be used to determine whether the current environment is production. For example:\n\nexport default {\n  tools: {\n    webpack: (config, { isProd }) => {\n      if (isProd) {\n        config.devtool = 'source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\n# target\n\n * Type: 'web' | 'node' | 'modern-web' | 'web-worker'\n\nThe target parameter can be used to determine the current target. For example:\n\nexport default {\n  tools: {\n    webpack: (config, { target }) => {\n      if (target === 'node') {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\n# isServer\n\n * Type: boolean\n\nDetermines whether the target environment is node, equivalent to target === 'node'.\n\nexport default {\n  tools: {\n    webpack: (config, { isServer }) => {\n      if (isServer) {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\n# isWebWorker\n\n * Type: boolean\n\nDetermines whether the target environment is web-worker, equivalent to target === 'web-worker'.\n\nexport default {\n  tools: {\n    webpack: (config, { isWebWorker }) => {\n      if (isWebWorker) {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\n# webpack\n\n * Type: typeof import('webpack')\n\nThe webpack instance. For example:\n\nexport default {\n  tools: {\n    webpack: (config, { webpack }) => {\n      config.plugins.push(new webpack.ProgressPlugin());\n      return config;\n    },\n  },\n};\n\n\n\n# HtmlWebpackPlugin\n\n * Type: typeof import('html-webpack-plugin')\n\nThe HtmlWebpackPlugin instance:\n\nexport default {\n  tools: {\n    webpackChain: (chain, { HtmlWebpackPlugin }) => {\n      console.log(HtmlWebpackPlugin);\n    },\n  },\n};\n\n\n\n# addRules\n\n * Type: (rules: RuleSetRule | RuleSetRule[]) => void\n\nAdd additional webpack rules.\n\nFor example:\n\nexport default {\n  tools: {\n    webpack: (config, { addRules }) => {\n      // add a single rule\n      addRules({\n        test: /\\.foo/,\n        loader: require.resolve('foo-loader'),\n      });\n\n      // Add multiple rules as an array\n      addRules([\n        {\n          test: /\\.foo/,\n          loader: require.resolve('foo-loader'),\n        },\n        {\n          test: /\\.bar/,\n          loader: require.resolve('bar-loader'),\n        },\n      ]);\n    },\n  },\n};\n\n\n\n# prependPlugins\n\n * Type: (plugins: WebpackPluginInstance | WebpackPluginInstance[]) => void\n\nAdd additional plugins to the head of the internal webpack plugins array, and the plugin will be executed first.\n\nexport default {\n  tools: {\n    webpack: (config, { prependPlugins, webpack }) => {\n      // add a single plugin\n      prependPlugins(\n        new webpack.BannerPlugin({\n          banner: 'hello world!',\n        }),\n      );\n\n      // Add multiple plugins\n      prependPlugins([new PluginA(), new PluginB()]);\n    },\n  },\n};\n\n\n\n# appendPlugins\n\n * Type: (plugins: WebpackPluginInstance | WebpackPluginInstance[]) => void\n\nAdd additional plugins at the end of the internal webpack plugins array, the plugin will be executed last.\n\nexport default {\n  tools: {\n    webpack: (config, { appendPlugins, webpack }) => {\n      // add a single plugin\n      appendPlugins([\n        new webpack.BannerPlugin({\n          banner: 'hello world!',\n        }),\n      ]);\n\n      // Add multiple plugins\n      appendPlugins([new PluginA(), new PluginB()]);\n    },\n  },\n};\n\n\n\n# removePlugin\n\n * Type: (name: string) => void\n\nRemove the internal webpack plugin, the parameter is the constructor.name of the plugin.\n\nFor example, remove the internal fork-ts-checker-webpack-plugin:\n\nexport default {\n  tools: {\n    webpack: (config, { removePlugin }) => {\n      removePlugin('ForkTsCheckerWebpackPlugin');\n    },\n  },\n};\n\n\n\n# tools.webpackChain\n\n * Type: Function | undefined\n * Default: undefined\n\nYou can modify the webpack configuration by configuring tools.webpackChain which is type of Function. The function receives two parameters, the first is the original webpack chain object, and the second is an object containing some utils.\n\nCompared with tools.webpack, webpack-chain not only supports chained calls, but also can locate built-in Rule or Plugin based on aliases, so as to achieve precise config modification. We recommend using tools.webpackChain instead of tools.webpack.\n\n> tools.webpackChain is executed earlier than tools.webpack and thus will be overridden by changes in tools.webpack.\n\n\n# Utils\n\n# env\n\n * Type: 'development' | 'production' | 'test'\n\nThe env parameter can be used to determine whether the current environment is development, production or test. For example:\n\nexport default {\n  tools: {\n    webpackChain: (chain, { env }) => {\n      if (env === 'development') {\n        chain.devtool('cheap-module-eval-source-map');\n      }\n    },\n  },\n};\n\n\n# isProd\n\n * Type: boolean\n\nThe isProd parameter can be used to determine whether the current environment is production. For example:\n\nexport default {\n  tools: {\n    webpackChain: (chain, { isProd }) => {\n      if (isProd) {\n        chain.devtool('source-map');\n      }\n    },\n  },\n};\n\n\n# target\n\n * Type: 'web' | 'node' | 'modern-web' | 'web-worker'\n\nThe target parameter can be used to determine the current environment. For example:\n\nexport default {\n  tools: {\n    webpackChain: (chain, { target }) => {\n      if (target === 'node') {\n        // ...\n      }\n    },\n  },\n};\n\n\n# isServer\n\n * Type: boolean\n\nDetermines whether the target environment is node, equivalent to target === 'node'.\n\nexport default {\n  tools: {\n    webpackChain: (chain, { isServer }) => {\n      if (isServer) {\n        // ...\n      }\n    },\n  },\n};\n\n\n# isWebWorker\n\n * Type: boolean\n\nDetermines whether the target environment is web-worker, equivalent to target === 'web-worker'.\n\nexport default {\n  tools: {\n    webpackChain: (chain, { isWebWorker }) => {\n      if (isWebWorker) {\n        // ...\n      }\n    },\n  },\n};\n\n\n# webpack\n\n * Type: typeof import('webpack')\n\nThe webpack instance. For example:\n\nexport default {\n  tools: {\n    webpackChain: (chain, { webpack }) => {\n      chain.plugin('my-progress').use(webpack.ProgressPlugin);\n    },\n  },\n};\n\n\n\n# HtmlWebpackPlugin\n\n * Type: typeof import('html-webpack-plugin')\n\nThe HtmlWebpackPlugin instance:\n\nexport default {\n  tools: {\n    webpackChain: (chain, { HtmlWebpackPlugin }) => {\n      console.log(HtmlWebpackPlugin);\n    },\n  },\n};\n\n\n# CHAIN_ID\n\nSome common Chain IDs are predefined in the Builder, and you can use these IDs to locate the built-in Rule or Plugin.\n\n# CHAIN_ID.RULE\n\nID           DESCRIPTION\nRULE.MJS     Rule for mjs\nRULE.JS      Rule for js\nRULE.TS      Rule for ts\nRULE.CSS     Rule for css\nRULE.LESS    Rule for less\nRULE.SASS    Rule for sass\nRULE.PUG     Rule for pug\nRULE.TOML    Rule for toml\nRULE.YAML    Rule for yaml\nRULE.FONT    Rule for font\nRULE.IMAGE   Rule for image\nRULE.MEDIA   Rule for media\n\n\n# CHAIN_ID.ONE_OF\n\nONE_OF.XXX can match a certain type of rule in the rule array.\n\nID                  DESCRIPTION\nONE_OF.SVG          Rules for SVG, automatic choice between data URI and\n                    separate file\nONE_OF.SVG_URL      Rules for SVG, output as a separate file\nONE_OF.SVG_INLINE   Rules for SVG, inlined into bundles as data URIs\nONE_OF.SVG_ASSETS   Rules for SVG, automatic choice between data URI and\n                    separate file\n\n\n# CHAIN_ID.USE\n\nUSE.XXX can match a certain loader.\n\nID                     DESCRIPTION\nUSE.TS                 correspond to ts-loader\nUSE.CSS                correspond to css-loader\nUSE.LESS               correspond to less-loader\nUSE.SASS               correspond to sass-loader\nUSE.PUG                correspond to pug-loader\nUSE.TOML               correspond to toml-loader\nUSE.YAML               correspond to yaml-loader\nUSE.FILE               correspond to file-loader\nUSE.URL                correspond to url-loader\nUSE.SVGR               correspond to @svgr/webpack\nUSE.BABEL              correspond to babel-loader\nUSE.STYLE              correspond to style-loader\nUSE.POSTCSS            correspond to postcss-loader\nUSE.MARKDOWN           correspond to markdown-loader\nUSE.CSS_MODULES_TS     correspond to css-modules-typescript-loader\nUSE.MINI_CSS_EXTRACT   correspond to mini-css-extract-plugin.loader\n\n\n# CHAIN_ID.PLUGIN\n\nPLUGIN.XXX can match a certain webpack plugin.\n\nID                             DESCRIPTION\nPLUGIN.HMR                     correspond to HotModuleReplacementPlugin\nPLUGIN.COPY                    correspond to CopyWebpackPlugin\nPLUGIN.HTML                    correspond to HtmlWebpackPlugin, you need to splice the\n                               entry name when using: ${PLUGIN.HTML}-${entryName}\nPLUGIN.DEFINE                  correspond to DefinePlugin\nPLUGIN.IGNORE                  correspond to IgnorePlugin\nPLUGIN.BANNER                  correspond to BannerPlugin\nPLUGIN.PROGRESS                correspond to Webpackbar\nPLUGIN.APP_ICON                correspond to AppIconPlugin\nPLUGIN.LOADABLE                correspond to LoadableWebpackPlugin\nPLUGIN.MANIFEST                correspond to WebpackManifestPlugin\nPLUGIN.TS_CHECKER              correspond to ForkTsCheckerWebpackPlugin\nPLUGIN.INLINE_HTML             correspond to InlineChunkHtmlPlugin\nPLUGIN.BUNDLE_ANALYZER         correspond to WebpackBundleAnalyzer\nPLUGIN.BOTTOM_TEMPLATE         correspond to BottomTemplatePlugin\nPLUGIN.MINI_CSS_EXTRACT        correspond to MiniCssExtractPlugin\nPLUGIN.REACT_FAST_REFRESH      correspond to ReactFastRefreshPlugin\nPLUGIN.NODE_POLYFILL_PROVIDE   correspond to ProvidePlugin for node polyfills\nPLUGIN.INSPECTOR               correspond to @modern-js/inspector-webpack-plugin\nPLUGIN.SUBRESOURCE_INTEGRITY   correspond to webpack-subresource-integrity\nPLUGIN.ASSETS_RETRY            correspond to webpack static asset retry plugin in Builder\nPLUGIN.AUTO_SET_ROOT_SIZE      correspond to automatically set root font size plugin in\n                               Builder\n\n\n# CHAIN_ID.MINIMIZER\n\nMINIMIZER.XXX can match a certain minimizer.\n\nID                  DESCRIPTION\nMINIMIZER.JS        correspond to TerserWebpackPlugin\nMINIMIZER.CSS       correspond to CssMinimizerWebpackPlugin\nMINIMIZER.ESBUILD   correspond to ESBuildPlugin\nMINIMIZER.SWC       correspond to SwcWebpackPlugin\n\n\n# Examples\n\nThe following are some common configuration examples, see the full webpack-chain API webpack-chain documentation.\n\n# Add/Modify/Delete loader\n\nexport default {\n  tools: {\n    webpackChain: (chain, { CHAIN_ID }) => {\n      // Add loader\n      chain.module\n        .rule('md')\n        .test(/\\.md$/)\n        .use('md-loader')\n        .loader('md-loader');\n\n      // Modify loader\n      chain.module\n        .rule(CHAIN_ID.RULE.JS)\n        .use(CHAIN_ID.USE.BABEL)\n        .tap(options => {\n          options.plugins.push('babel-plugin-xxx');\n          return options;\n        });\n\n      // Delete loader\n      chain.module.rule(CHAIN_ID.RULE.JS).uses.delete(CHAIN_ID.USE.BABEL);\n    },\n  },\n};\n\n\n# Add/Modify/Delete plugin\n\nexport default {\n  tools: {\n    webpackChain: (chain, { webpack, CHAIN_ID }) => {\n      // Add plugin\n      chain.plugin('define').use(webpack.DefinePlugin, [\n        {\n          'process.env': {\n            NODE_ENV: JSON.stringify(process.env.NODE_ENV),\n          },\n        },\n      ]);\n\n      // Modify plugin\n      chain.plugin(CHAIN_ID.PLUGIN.HMR).tap(options => {\n        options[0].fullBuildTimeout = 200;\n        return options;\n      });\n\n      // Delete plugin\n      chain.plugins.delete(CHAIN_ID.PLUGIN.HMR);\n    },\n  },\n};\n",normalizedContent:"# tools config\n\nthis section describes some low-level tools configurations in modern.js builder.\n\n\n# tools.autoprefixer\n\n * type: object | function\n * default\n\n{\n  flexbox: 'no-2009',\n  // depends on the browserslist config in the project\n  // and the `output.overridebrowserslist` (higher priority) config\n  overridebrowserslist: browserslist,\n}\n\n\nyou can modify the config of autoprefixer by tools.autoprefixer.\n\n\n# object type\n\nwhen tools.autoprefixer is configured as object type, it is merged with the default config through object.assign. for example:\n\nexport default {\n  tools: {\n    autoprefixer: {\n      flexbox: 'no-2009',\n    },\n  },\n};\n\n\n\n# function type\n\nwhen tools.autoprefixer is a function, the default config is passed as the first parameter and can be directly modified or returned as the final result. for example:\n\nexport default {\n  tools: {\n    autoprefixer(config) {\n      // modify flexbox config\n      config.flexbox = 'no-2009';\n    },\n  },\n};\n\n\n\n# tools.babel\n\n * type: object | function\n * default: undefined\n\nby tools.babel you can modify the options of babel-loader.\n\n\n# function type\n\nwhen tools.babel's type is function，the default babel config will be passed in as the first parameter, the config object can be modified directly, or a value can be returned as the final result. the second parameter provides some util functions that can be called directly:\n\nexport default {\n  tools: {\n    babel(config) {\n      // add a babel plugin\n      // note: the plugin have been added to the default config to support antd load on demand\n      config.plugins.push([\n        'babel-plugin-import',\n        {\n          libraryname: 'xxx-components',\n          librarydirectory: 'es',\n          style: true,\n        },\n      ]);\n    },\n  },\n};\n\n\n\n# object type\n\nwhen tools.babel's type is object, the config will be merged with default config by object.assign. note that object.assign is a shallow copy and will completely overwrite the built-in presets or plugins array, please use it with caution.\n\nexport default {\n  tools: {\n    babel: {\n      plugins: [\n        [\n          'babel-plugin-import',\n          {\n            libraryname: 'xxx-components',\n            librarydirectory: 'es',\n            style: true,\n          },\n        ],\n      ],\n    },\n  },\n};\n\n\n\n# util functions\n\nwhen tools.babel is a function, the tool functions available for the second parameter are as follows:\n\n# addplugins\n\n * type: (plugins: babelplugin[]) => void\n\nadd some babel plugins. for example:\n\nexport default {\n  tools: {\n    babel(config, { addplugins }) {\n      addplugins([\n        [\n          'babel-plugin-import',\n          {\n            libraryname: 'xxx-components',\n            librarydirectory: 'es',\n            style: true,\n          },\n        ],\n      ]);\n    },\n  },\n};\n\n\n# addpresets\n\n * type: (presets: babelplugin[]) => void\n\nadd babel preset configuration. (no need to add presets in most cases)\n\nexport default {\n  tools: {\n    babel(config, { addpresets }) {\n      addpresets(['@babel/preset-env']);\n    },\n  },\n};\n\n\n# removeplugins\n\n * type: (plugins: string | string[]) => void\n\nto remove the babel plugin, just pass in the name of the plugin to be removed, you can pass in a single string or an array of strings.\n\nexport default {\n  tools: {\n    babel(config, { removeplugins }) {\n      removeplugins('babel-plugin-import');\n    },\n  },\n};\n\n\n# removepresets\n\n * type: (presets: string | string[]) => void\n\nto remove the babel preset configuration, pass in the name of the preset to be removed, you can pass in a single string or an array of strings.\n\nexport default {\n  tools: {\n    babel(config, { removepresets }) {\n      removepresets('@babel/preset-env');\n    },\n  },\n};\n\n\n# addincludes\n\n * type: (includes: string | regexp | (string | regexp)[]) => void\n\nby default, babel will only compile the application code in the src directory. with addincludes you can specify that babel compile some files in node_modules. for example:\n\nexport default {\n  tools: {\n    babel(config, { addincludes }) {\n      addincludes('node_modules/xxx-components');\n    },\n  },\n};\n\n\nnote that babel cannot compile commonjs modules by default. when you use source.include to compile commonjs modules, you need to set babel's sourcetype config to unambiguous:\n\nexport default {\n  tools: {\n    babel(config) {\n      config.sourcetype = 'unambiguous';\n    },\n  },\n};\n\n\nsetting sourcetype to unambiguous may have some other effects, please refer to babel official documentation.\n\ntip\n\nbuilder provides a more general source.include config than addincludes, and it is recommended to use this configuration item first.\n\n# addexcludes\n\n * type: (excludes: string | regexp | (string | regexp)[]) => void\n\ncontrary to addincludes, specifies that certain files are excluded from babel's compilation.\n\nfor example, without compiling files in the src/example directory:\n\nexport default {\n  tools: {\n    babel(config, { addexcludes }) {\n      addexcludes('src/example');\n    },\n  },\n};\n\n\n# modifypresetenvoptions\n\n * type: (options: presetenvoptions) => void\n\nmodify the configuration of @babel/preset-env, the configuration you pass in will be shallowly merged with default config. for example:\n\nexport default {\n  tools: {\n    babel(config, { modifypresetenvoptions }) {\n      modifypresetenvoptions({\n        targets: {\n          browsers: ['last 2 versions'],\n        },\n      });\n    },\n  },\n};\n\n\n# modifypresetreactoptions\n\n * type: (options: presetreactoptions) => void\n\nmodify the configuration of @babel/preset-react, the configuration you pass in will be shallowly merged with default config. for example:\n\nexport default {\n  tools: {\n    babel(config, { modifypresetreactoptions }) {\n      modifypresetreactoptions({\n        pragma: 'react.createelement',\n      });\n    },\n  },\n};\n\n\n\n# tools.cssextract\n\n * type: object | function\n * default:\n\nconst defaultoptions = {\n  // the loader options\n  loaderoptions: {},\n  // the plugin options\n  pluginoptions: {\n    // the default value of csspath is `static/css`\n    // while the default value of cssfilename is `[name].[contenthash:8].css`\n    filename: `${csspath}/${cssfilename}`,\n    chunkfilename: `${csspath}/async/${cssfilename}`,\n    ignoreorder: true,\n  },\n};\n\n\nthe config of mini-css-extract-plugin can be modified through tools.cssextract.\n\n\n# object type\n\nwhen this value is an object, it is merged with the default config via object.assign. for example:\n\nexport default {\n  tools: {\n    cssextract: {\n      pluginoptions: {\n        filename: 'static/css/[name].[contenthash:8].css',\n      },\n    },\n  },\n};\n\n\n\n# function type\n\nwhen the value a function, the default config is passed in as the first parameter. you can modify the config object directly, or return an object as the final config. for example:\n\nexport default {\n  tools: {\n    cssextract: config => {\n      config.pluginoptions.filename = 'static/css/[name].[contenthash:8].css';\n      return config;\n    },\n  },\n};\n\n\nfor more config details, please refer to mini-css-extract-plugin.\n\n\n# tools.cssloader\n\n * type: object | function\n * default: undefined\n\nthe config of css-loader can be modified through tools.cssloader. the default config is as follows:\n\n{\n  importloaders: 1,\n  modules: {\n    auto: true,\n    exportlocalsconvention: 'camelcase',\n    localidentname: config.output.cssmodulelocalidentname,\n    // isserver indicates node (ssr) build\n    // iswebworker indicates web worker build\n    exportonlylocals: isserver || iswebworker,\n  },\n  // css source map enabled by default in development environment\n  sourcemap: isdev,\n}\n\n\n\n# object type\n\nwhen this value is an object, it is merged with the default config via deep merge. for example:\n\nexport default {\n  tools: {\n    cssloader: {\n      modules: {\n        exportonlylocals: true,\n      },\n    },\n  },\n};\n\n\n\n# function type\n\nwhen the value is a function, the default config is passed in as the first parameter. you can modify the config object directly, or return an object as the final config. for example:\n\nexport default {\n  tools: {\n    cssloader: config => {\n      config.modules.exportonlylocals = true;\n      return config;\n    },\n  },\n};\n\n\n\n# tools.devserver\n\n * type: object\n * default: {}\n\nthe config of devserver can be modified through tools.devserver.\n\n\n# options\n\n# after\n\n * type: array\n * default: []\n\nprovides the ability to execute custom middleware after all other middleware internally within the server.\n\nexport default {\n  tools: {\n    devserver: {\n      after: [\n        async (req, res, next) => {\n          console.log('after dev middleware');\n          next();\n        },\n      ],\n    },\n  },\n};\n\n\n# before\n\n * type: array\n * default: []\n\nprovides the ability to execute custom middleware prior to all other middleware internally within the server.\n\nexport default {\n  tools: {\n    devserver: {\n      before: [\n        async (req, res, next) => {\n          console.log('before dev middleware');\n          next();\n        },\n      ],\n    },\n  },\n};\n\n\n# client\n\n * type:\n\n{\n    /** the path which the middleware is serving the event stream on */\n    path?: string;\n    /** specify a port number to listen for requests on */\n    port?: string;\n    /** specify a host to use */\n    host?: string;\n}\n\n\n * default:\n\n{\n    path: '/webpack-hmr',\n    port: '8080',\n    host: networkaddress || 'localhost',\n}\n\n\nthe config of hmr client.\n\n# devmiddleware\n\n * type:\n\n{\n  writetodisk: boolean | ((filename: string) => boolean);\n}\n\n\n * default:\n\n{\n  writetodisk: (file: string) => !file.includes('.hot-update.'),\n}\n\n\nthe config of devmiddleware. current options is the subset of webpack-dev-middleware.\n\n# headers\n\n * type: record<string, string>\n * default: undefined\n\nadds headers to all responses.\n\nexport default {\n  tools: {\n    devserver: {\n      headers: {\n        'x-custom-foo': 'bar',\n      },\n    },\n  },\n};\n\n\n# historyapifallback\n\n * type: boolean | connecthistoryapifallbackoptions\n * default: false\n\nthe index.html page will likely have to be served in place of any 404 responses. enable devserver.historyapifallback by setting it to true:\n\nexport default {\n  tools: {\n    devserver: {\n      historyapifallback: true,\n    },\n  },\n};\n\n\nfor more options and information, see the connect-history-api-fallback documentation.\n\n# hot\n\n * type: boolean\n * default: true\n\nenable hot module replacement feature.\n\n# https\n\n * type: boolean | { key: string; cert: string }\n * default: false\n\nby default, devserver will be served over http. it can optionally be served over https by setting devserver.https to true, and will disable the http server.\n\nyou can also manually pass in the certificate and corresponding private key required by the https server:\n\nexport default {\n  tools: {\n    devserver: {\n      https: {\n        key: fs.readfilesync('certificates/private.pem'),\n        cert: fs.readfilesync('certificates/public.pem'),\n      },\n    },\n  },\n};\n\n\n# livereload\n\n * type: boolean\n * default: true\n\nby default, the devserver will reload/refresh the page when file changes are detected（devserver.hot option must be disabled in order for livereload to take effect）. disable devserver.livereload by setting it to false.\n\n# setupmiddlewares\n\n * type:\n\narray<\n  (\n    middlewares: {\n      unshift: (...handlers: requesthandler[]) => void;\n      push: (...handlers: requesthandler[]) => void;\n    },\n    server: {\n      sockwrite: (\n        type: string,\n        data?: string | boolean | record<string, any>,\n      ) => void;\n    },\n  ) => void\n>;\n\n\n * default: undefined\n\nprovides the ability to execute a custom function and apply custom middlewares.\n\nthe order among several different types of middleware is: devserver.before => unshift => internal middlewares => push => devserver.after.\n\nexport default {\n  tools: {\n    devserver: {\n      setupmiddlewares: [\n        (middlewares, server) => {\n          middlewares.unshift((req, res, next) => {\n            next();\n          });\n\n          middlewares.push((req, res, next) => {\n            next();\n          });\n        },\n      ],\n    },\n  },\n};\n\n\nit is possible to use some server api to meet special scenario requirements:\n\n * sockwrite. allow send some message to hmr client, and then the hmr client will take different actions depending on the message type. if you send a \"content changed\" message, the page will reload.\n\nexport default {\n  tools: {\n    devserver: {\n      setupmiddlewares: [\n        (middlewares, server) => {\n          // add custom watch & trigger page reload when change\n          watcher.on('change', changed => {\n            server.sockwrite('content-changed');\n          });\n        },\n      ],\n    },\n  },\n};\n\n\n# proxy\n\n * type: record<string, string> | record<string, proxydetail>\n * default: undefined\n\nproxying some urls.\n\nexport default {\n  tools: {\n    devserver: {\n      proxy: {\n        '/api': 'http://localhost:3000',\n      },\n    },\n  },\n};\n\n\na request to /api/users will now proxy the request to http://localhost:3000/api/users.\n\nif you don't want /api to be passed along, we need to rewrite the path:\n\nexport default {\n  tools: {\n    devserver: {\n      proxy: {\n        '/api': {\n          target: 'http://localhost:3000',\n          pathrewrite: { '^/api': '' },\n        },\n      },\n    },\n  },\n};\n\n\nthe devserver proxy makes use of the http-proxy-middleware package. check out its documentation for more advanced usages.\n\nthe full type definition of devserver proxy is:\n\nimport type { options as httpproxyoptions } from 'http-proxy-middleware';\n\ntype proxydetail = httpproxyoptions & {\n  bypass?: (\n    req: incomingmessage,\n    res: serverresponse,\n    proxyoptions: proxyoptions,\n  ) => string | undefined | null | false;\n  context?: string | string[];\n};\n\ntype proxyoptions =\n  | record<string, string>\n  | record<string, proxydetail>\n  | proxydetail[]\n  | proxydetail;\n\n\nin addition to the http-proxy-middleware option, we also support the bypass and context configuration:\n\n * bypass：bypass the proxy based on the return value of a function.\n   * return null or undefined to continue processing the request with proxy.\n   * return false to produce a 404 error for the request.\n   * return a path to serve from, instead of continuing to proxy the request.\n * context：if you want to proxy multiple, specific paths to the same target, you can use an array of one or more objects with a context property.\n\n// custom bypass\nexport default {\n  tools: {\n    devserver: {\n      proxy: {\n        '/api': {\n          target: 'http://localhost:3000',\n          bypass: function (req, res, proxyoptions) {\n            if (req.headers.accept.indexof('html') !== -1) {\n              console.log('skipping proxy for browser request.');\n              return '/index.html';\n            }\n          },\n        },\n      },\n    },\n  },\n};\n\n\n// proxy multiple\nexport default {\n  tools: {\n    devserver: {\n      proxy: [\n        {\n          context: ['/auth', '/api'],\n          target: 'http://localhost:3000',\n        },\n      ],\n    },\n  },\n};\n\n\n# watch\n\n * type: boolean\n * default: true\n\nwhether to watch files change in directories such as mock/, server/, api/.\n\n\n# tools.htmlplugin\n\n * type: false | object | function\n * default:\n\nconst defaulthtmlpluginoptions = {\n  inject, // corresponding to the html.inject config\n  favicon, // corresponding to html.favicon config\n  filename, // generated based on output.distpath and entryname\n  template, // defaults to the built-in html template path\n  templateparameters, // corresponding to the html.templateparameters config\n  chunks: [entryname],\n  minify: {\n    removecomments: true,\n    useshortdoctype: true,\n    keepclosingslash: true,\n    collapsewhitespace: true,\n    removeredundantattributes: true,\n    removescripttypeattributes: true,\n    removestylelinktypeattributes: true,\n  },\n};\n\n\nthe configs of html-webpack-plugin can be modified through tools.htmlplugin.\n\n\n# object type\n\nwhen tools.htmlplugin is object type, the value will be merged with the default config via object.assign.\n\nexport default {\n  tools: {\n    htmlplugin: {\n      scriptloading: 'blocking',\n    },\n  },\n};\n\n\n\n# function type\n\nwhen tools.htmlplugin is a function:\n\n * the first parameter is the default config, which can be modified directly.\n * the second parameter is also an object, containing the entry name and the entry value.\n * the function can return a new object as the final config.\n\nexport default {\n  tools: {\n    htmlplugin(config, { entryname, entryvalue }) {\n      if (entryname === 'main') {\n        config.scriptloading = 'blocking';\n      }\n    },\n  },\n};\n\n\n\n# boolean type\n\nthe built-in html-webpack-plugin plugins can be disabled by set tools.htmlplugin to false.\n\nexport default {\n  tools: {\n    htmlplugin: false,\n  },\n};\n\n\n\n# tools.inspector\n\n * type: object | function | undefined\n * default: undefined\n\nyou can enable or configure the webpack inspector through tools.inspector.\n\nwhen the configuration is not undefined, it means that webpack-inspector is enabled, and the type of tools.inspector can be object or function.\n\n\n# object type\n\nwhen tools.inspector is configured with type object, it is merged with the default configuration via object.assign. for example:\n\nexport default {\n  tools: {\n    inspector: {\n      // the default port is 3333\n      port: 3334,\n    },\n  },\n};\n\n\n\n# function type\n\nwhen tools.inspector is a function, the default configuration is passed as the first parameter and can be directly modified or returned as the final result. for example:\n\nexport default {\n  tools: {\n    inspector(config) {\n      config.port = 3334;\n    },\n  },\n};\n\n\n\n# tools.less\n\n * type: object | function\n * default:\n\nconst defaultoptions = {\n  lessoptions: {\n    javascriptenabled: true,\n  },\n  // css source map enabled by default in development environment\n  sourcemap: isdev,\n};\n\n\nyou can modify the config of less-loader via tools.less.\n\n\n# object type\n\nwhen tools.less is configured as object type, it is merged with the default config through object.assign in a shallow way. it should be noted that lessoptions is merged through deepmerge in a deep way. for example:\n\nexport default {\n  tools: {\n    less: {\n      lessoptions: {\n        javascriptenabled: false,\n      },\n    },\n  },\n};\n\n\n\n# function type\n\nwhen tools.less is a function, the default config is passed as the first parameter, which can be directly modified or returned as the final result. the second parameter provides some utility functions that can be called directly. for example:\n\nexport default {\n  tools: {\n    less(config) {\n      // modify the config of lessoptions\n      config.lessoptions = {\n        javascriptenabled: false,\n      };\n    },\n  },\n};\n\n\n\n# util function\n\n# addexcludes\n\n * type: (excludes: regexp | regexp[]) => void\n\nused to specify which files less-loader does not compile, you can pass in one or more regular expressions to match the path of less files, for example:\n\nexport default {\n  tools: {\n    less(config, { addexcludes }) {\n      addexcludes(/node_modules/);\n    },\n  },\n};\n\n\n\n# tools.minifycss\n\n * type: object | function | undefined\n * default:\n\nconst defaultoptions = {\n  minimizeroptions: {\n    preset: [\n      'default',\n      {\n        mergelonghand: false,\n      },\n    ],\n  },\n};\n\n\nwhen building for production, builder will minimize the css code through css-minimizer-webpack-plugin. the config of css-minimizer-webpack-plugin can be modified via tools.minifycss.\n\n\n# object type\n\nwhen tools.minifycss is object type, it will be merged with the default config via object.assign.\n\nfor example, modify the preset config of cssnano:\n\nexport default {\n  tools: {\n    minifycss: {\n      minimizeroptions: {\n        preset: require.resolve('cssnano-preset-simple'),\n      },\n    },\n  },\n};\n\n\n\n# function type\n\nwhen tools.minifycss is function type, the default config is passed in as the first parameter, the config object can be modified directly, or a value can be returned as the final result.\n\nexport default {\n   tools: {\n    minifycss: options => {\n      options.minimizeroptions = {\n        preset: require.resolve('cssnano-preset-simple'),\n      },\n    }\n  }\n};\n\n\n\n# tools.postcss\n\n * type: object | function\n * default:\n\nconst defaultoptions = {\n  postcssoptions: {\n    plugins: [\n      require('postcss-flexbugs-fixes'),\n      require('postcss-custom-properties'),\n      require('postcss-initial'),\n      require('postcss-page-break'),\n      require('postcss-font-variant'),\n      require('postcss-media-minmax'),\n      require('postcss-nesting'),\n      require('autoprefixer')({\n        flexbox: 'no-2009',\n      }),\n    ],\n    // css source map enabled by default in development environment\n    sourcemap: isdev,\n  },\n};\n\n\nbuilder integrates postcss by default, you can configure postcss-loader through tools.postcss.\n\n\n# function type\n\nwhen the value is a function, the internal default config is passed as the first parameter, and the config object can be modified directly without returning, or an object can be returned as the final result; the second parameter is a set of tool functions for modifying the postcss-loader config.\n\nfor example, you need to add a postcss plugin on the basis of the original plugin, and push a new plugin to the postcssoptions.plugins array:\n\nexport default {\n  tools: {\n    postcss: opts => {\n      opts.postcssoptions.plugins.push(require('postcss-px-to-viewport'));\n    },\n  },\n};\n\n\nwhen you need to pass parameters to the postcss plugin, you can pass them in by function parameters:\n\nexport default {\n  tools: {\n    postcss: opts => {\n      const viewportplugin = require('postcss-px-to-viewport')({\n        viewportwidth: 375,\n      });\n      opts.postcssoptions.plugins.push(viewportplugin);\n    },\n  },\n};\n\n\ntools.postcss can return a config object and completely replace the default config:\n\nexport default {\n  tools: {\n    postcss: () => {\n      return {\n        postcssoptions: {\n          plugins: [require('postcss-px-to-viewport')],\n        },\n      };\n    },\n  },\n};\n\n\n\n# object type\n\nwhen this value is an object, it is merged with the default config via object.assign. note that object.assign is a shallow copy and will completely overwrite the built-in presets or plugins array, please use it with caution.\n\nexport default {\n  tools: {\n    postcss: {\n      // because `object.assign` is used, the default postcssoptions will be overwritten.\n      postcssoptions: {\n        plugins: [require('postcss-px-to-viewport')],\n      },\n    },\n  },\n};\n\n\n\n# util functions\n\n# addplugins\n\n * type: (plugins: postcssplugin | postcssplugin[]) => void\n\nfor adding additional postcss plugins, you can pass in a single postcss plugin, or an array of postcss plugins.\n\nexport default {\n  tools: {\n    postcss: (config, { addplugins }) => {\n      // add a postcss plugin\n      addplugins(require('postcss-preset-env'));\n      // add multiple postcss plugins\n      addplugins([require('postcss-preset-env'), require('postcss-import')]);\n    },\n  },\n};\n\n\ntip\n\nbuilder uses the postcss v8 version. when you use third-party postcss plugins, please pay attention to whether the postcss version is compatible. some legacy plugins may not work in postcss v8.\n\n\n# tools.pug\n\n * type: true | object | function | undefined\n * default: false\n\nconfigure the pug template engine.\n\n\n# boolean type\n\npug template engine is not enabled by default, you can enable it by setting tools.pug to true.\n\nexport default {\n  tools: {\n    pug: true,\n  },\n};\n\n\nwhen enabled, you can use index.pug as the template file in html.template config.\n\n\n# object type\n\nwhen tools.terser is object type, you can passing the pug options:\n\nexport default {\n  tools: {\n    pug: {\n      doctype: 'xml',\n    },\n  },\n};\n\n\nfor detailed options, please refer to pug api reference.\n\n\n# function type\n\nwhen tools.pug is function type, the default configuration is passed in as the first parameter, the configuration object can be modified directly, or a value can be returned as the final result.\n\nexport default {\n  tools: {\n    pug(config) {\n      config.doctype = 'xml';\n    },\n  },\n};\n\n\n\n# tools.sass\n\n * type: object | function\n * default:\n\nconst defaultoptions = {\n  // css source map enabled by default in development environment\n  sourcemap: isdev,\n};\n\n\nyou can modify the config of sass-loader via tools.sass.\n\n\n# object type\n\nwhen tools.sass is object type, it is merged with the default config through object.assign. it should be noted that sassoptions is merged through deepmerge in a deep way.\n\nfor example:\n\nexport default {\n  tools: {\n    sass: {\n      sourcemap: true,\n    },\n  },\n};\n\n\n\n# function type\n\nwhen tools.sass is a function, the default config is passed as the first parameter, which can be directly modified or returned as the final result. the second parameter provides some utility functions that can be called directly. for example:\n\nexport default {\n  tools: {\n    sass(config) {\n      // modify sourcemap config\n      config.additionaldata = async (content, loadercontext) => {\n        // ...\n      };\n    },\n  },\n};\n\n\n\n# utility function\n\n# addexcludes\n\n * type: (excludes: regexp | regexp[]) => void\n\nused to specify which files sass-loader does not compile, you can pass in one or more regular expressions to match the path of sass files, for example:\n\nexport default {\n  tools: {\n    sass(config, { addexcludes }) {\n      addexcludes(/node_modules/);\n    },\n  },\n};\n\n\n\n# tools.styleloader\n\n * type: object | function\n * default: {}\n\nthe config of style-loader can be set through tools.styleloader.\n\nit is worth noting that builder does not enable style-loader by default. you can use output.disablecssextract config to enable it。\n\n\n# object type\n\nwhen this value is an object, it is merged with the default config via object.assign. for example:\n\nexport default {\n  tools: {\n    styleloader: {\n      loaderoptions: {\n        insert: 'head',\n      },\n    },\n  },\n};\n\n\n\n# function type\n\nwhen the value is a function, the default config is passed in as the first parameter. you can modify the config object directly, or return an object as the final config. for example:\n\nexport default {\n  tools: {\n    styleloader: config => {\n      config.loaderoptions.insert = 'head';\n      return config;\n    },\n  },\n};\n\n\n\n# tools.styledcomponents\n\n * type: object | function\n * default\n\n{\n  pure: true,\n  displayname: true,\n  // `isssr` is true in ssr build\n  ssr: isssr,\n  transpiletemplateliterals: true,\n}\n\n\ntools.styledcomponents config is corresponding to babel-plugin-styled-components.\n\nwhen the value is an object, use the object.assign function to merge with the default config. for example:\n\nexport default {\n  tools: {\n    styledcomponents: {\n      pure: false,\n    },\n  },\n};\n\n\nwhen the config is a function, the first parameter is the default configuration, and the second parameter provides some utility functions that can be called directly:\n\nexport default {\n  tools: {\n    styledcomponents(config) {\n      config.pure = false;\n    },\n  },\n};\n\n\n\n# tools.terser\n\n * type: object | function | undefined\n * default:\n\nconst defaultterseroptions = {\n  terseroptions: {\n    mangle: {\n      safari10: true,\n    },\n  },\n};\n\n\nwhen building for production, builder will minimize the javascript code through terser-webpack-plugin. the config of terser-webpack-plugin can be modified via tools.terser.\n\n\n# object type\n\nwhen tools.terser is object type, it will be merged with the default config via object.assign.\n\nfor example, to exclude some files from minification:\n\nexport default {\n  tools: {\n    terser: {\n      exclude: /\\/excludes/,\n    },\n  },\n};\n\n\n\n# function type\n\nwhen tools.terser is function type, the default config is passed in as the first parameter, the config object can be modified directly, or a value can be returned as the final result.\n\nexport default {\n  tools: {\n    terser: opts => {\n      opts.exclude = /\\/excludes/;\n    },\n  },\n};\n\n\n\n# tools.tsloader\n\n * type： object | function | undefined\n * default:undefined\n\nts-loader is not enabled by default in the project. when tools.tsloader is not undefined, builder will use ts-loader instead of babel-loader to compile typescript code.\n\n\n# object type\n\nwhen this value is an object, it is merged with the default configuration via object.assign.\n\nthe default configuration is as follows:\n\n{\n  \"compileroptions\": {\n    \"target\": \"es5\",\n    \"module\": \"esnext\"\n  },\n  \"transpileonly\": true,\n  \"allowtsinnodemodules\": true\n}\n\n\nyou can override the default configuration via the tools.tsloader configuration item:\n\nexport default {\n  tools: {\n    tsloader: {\n      allowtsinnodemodules: false,\n    },\n  },\n};\n\n\n\n# function type\n\nwhen this value is a function, the default configuration is passed in as the first parameter, the configuration object can be modified directly, or an object can be returned as the final configuration.the second parameter is the util functions to modify the ts-loader configuration. for example:\n\nexport default {\n  tools: {\n    tsloader: opts => {\n      opts.allowtsinnodemodules = false;\n    },\n  },\n};\n\n\n\n# util functions\n\nwhen the value of tools.tsloader is a function, the utils functions available for the second parameter are as follows:\n\n# addincludes\n\ntype: (includes: string | regexp | array<string | regexp>) => void\n\nby default, only the application code in the src directory will be compiled. use addincludes to specify ts-loader to compile some files under node_modules. for example:\n\nexport default {\n  tools: {\n    tsloader: (config, { addincludes }) => {\n      addincludes([/node_modules\\/react/]);\n    },\n  },\n};\n\n\n# addexcludes\n\ntype: (excludes: string | regexp | array<string | regexp>) => void\n\ncontrary to addincludes, specify ts-loader to exclude certain files when compiling.\n\nfor example, without compiling files in the src/example directory:\n\nexport default {\n  tools: {\n    tsloader: (config, { addexcludes }) => {\n      addexcludes([/src\\/example\\//]);\n    },\n  },\n};\n\n\n\n# tools.tschecker\n\n * type: object | function\n * default:\n\nconst defaultoptions = {\n  typescript: {\n    // avoid oom issue\n    memorylimit: 8192,\n    // use tsconfig of user project\n    configfile: tsconfigpath,\n    // use typescript of user project\n    typescriptpath: require.resolve('typescript'),\n  },\n  issue: {\n    exclude: [\n      { file: '**/*.(spec|test).ts' },\n      { file: '**/node_modules/**/*' },\n    ],\n  },\n  logger: {\n    log() {\n      // do nothing\n      // we only want to display error messages\n    },\n    error(message: string) {\n      console.error(message.replace(/error/g, 'type error'));\n    },\n  },\n},\n\n\nby default, the fork-ts-checker-webpack-plugin is enabled for type checking. you can use output.disabletschecker config to disable it.\n\n\n# object type\n\nwhen this value is an object, it is merged with the default config via object.assign.\n\n\n# function type\n\nwhen the value is a function, the default config is passed in as the first parameter. you can modify the config object directly, or return an object as the final config.\n\n\n# tools.webpack\n\n * type: object | function | undefined\n * default: undefined\n\ntools.webpack is used to configure webpack。\n\n> tools.webpackchain is also used to modify the webpack configuration, and the function is more powerful. it is recommended to use tools.webpackchain first.\n\n\n# object type\n\nyou can configure it as an object, which will be merged with the original webpack configuration through webpack-merge. for example:\n\nexport default {\n  tools: {\n    webpack: {\n      resolve: {\n        alias: {\n          '@util': 'src/util',\n        },\n      },\n    },\n  },\n};\n\n\n\n# function type\n\nyou can also configure it as a function, which accepts one parameter, the original webpack configuration, you can modify this configuration, and then return a new configuration. for example:\n\nexport default {\n  tools: {\n    webpack: config => {\n      config.resolve.alias['@util'] = 'src/util';\n      return config;\n    },\n  },\n};\n\n\nthe second parameter of this function is an object that contains some information about the tool collection. details are as follows:\n\n\n# utils\n\n# env\n\n * type: 'development' | 'production' | 'test'\n\nthe env parameter can be used to determine whether the current environment is development, production or test. for example:\n\nexport default {\n  tools: {\n    webpack: (config, { env }) => {\n      if (env === 'development') {\n        config.devtool = 'cheap-module-eval-source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\n# isprod\n\n * type: boolean\n\nthe isprod parameter can be used to determine whether the current environment is production. for example:\n\nexport default {\n  tools: {\n    webpack: (config, { isprod }) => {\n      if (isprod) {\n        config.devtool = 'source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\n# target\n\n * type: 'web' | 'node' | 'modern-web' | 'web-worker'\n\nthe target parameter can be used to determine the current target. for example:\n\nexport default {\n  tools: {\n    webpack: (config, { target }) => {\n      if (target === 'node') {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\n# isserver\n\n * type: boolean\n\ndetermines whether the target environment is node, equivalent to target === 'node'.\n\nexport default {\n  tools: {\n    webpack: (config, { isserver }) => {\n      if (isserver) {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\n# iswebworker\n\n * type: boolean\n\ndetermines whether the target environment is web-worker, equivalent to target === 'web-worker'.\n\nexport default {\n  tools: {\n    webpack: (config, { iswebworker }) => {\n      if (iswebworker) {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\n# webpack\n\n * type: typeof import('webpack')\n\nthe webpack instance. for example:\n\nexport default {\n  tools: {\n    webpack: (config, { webpack }) => {\n      config.plugins.push(new webpack.progressplugin());\n      return config;\n    },\n  },\n};\n\n\n\n# htmlwebpackplugin\n\n * type: typeof import('html-webpack-plugin')\n\nthe htmlwebpackplugin instance:\n\nexport default {\n  tools: {\n    webpackchain: (chain, { htmlwebpackplugin }) => {\n      console.log(htmlwebpackplugin);\n    },\n  },\n};\n\n\n\n# addrules\n\n * type: (rules: rulesetrule | rulesetrule[]) => void\n\nadd additional webpack rules.\n\nfor example:\n\nexport default {\n  tools: {\n    webpack: (config, { addrules }) => {\n      // add a single rule\n      addrules({\n        test: /\\.foo/,\n        loader: require.resolve('foo-loader'),\n      });\n\n      // add multiple rules as an array\n      addrules([\n        {\n          test: /\\.foo/,\n          loader: require.resolve('foo-loader'),\n        },\n        {\n          test: /\\.bar/,\n          loader: require.resolve('bar-loader'),\n        },\n      ]);\n    },\n  },\n};\n\n\n\n# prependplugins\n\n * type: (plugins: webpackplugininstance | webpackplugininstance[]) => void\n\nadd additional plugins to the head of the internal webpack plugins array, and the plugin will be executed first.\n\nexport default {\n  tools: {\n    webpack: (config, { prependplugins, webpack }) => {\n      // add a single plugin\n      prependplugins(\n        new webpack.bannerplugin({\n          banner: 'hello world!',\n        }),\n      );\n\n      // add multiple plugins\n      prependplugins([new plugina(), new pluginb()]);\n    },\n  },\n};\n\n\n\n# appendplugins\n\n * type: (plugins: webpackplugininstance | webpackplugininstance[]) => void\n\nadd additional plugins at the end of the internal webpack plugins array, the plugin will be executed last.\n\nexport default {\n  tools: {\n    webpack: (config, { appendplugins, webpack }) => {\n      // add a single plugin\n      appendplugins([\n        new webpack.bannerplugin({\n          banner: 'hello world!',\n        }),\n      ]);\n\n      // add multiple plugins\n      appendplugins([new plugina(), new pluginb()]);\n    },\n  },\n};\n\n\n\n# removeplugin\n\n * type: (name: string) => void\n\nremove the internal webpack plugin, the parameter is the constructor.name of the plugin.\n\nfor example, remove the internal fork-ts-checker-webpack-plugin:\n\nexport default {\n  tools: {\n    webpack: (config, { removeplugin }) => {\n      removeplugin('forktscheckerwebpackplugin');\n    },\n  },\n};\n\n\n\n# tools.webpackchain\n\n * type: function | undefined\n * default: undefined\n\nyou can modify the webpack configuration by configuring tools.webpackchain which is type of function. the function receives two parameters, the first is the original webpack chain object, and the second is an object containing some utils.\n\ncompared with tools.webpack, webpack-chain not only supports chained calls, but also can locate built-in rule or plugin based on aliases, so as to achieve precise config modification. we recommend using tools.webpackchain instead of tools.webpack.\n\n> tools.webpackchain is executed earlier than tools.webpack and thus will be overridden by changes in tools.webpack.\n\n\n# utils\n\n# env\n\n * type: 'development' | 'production' | 'test'\n\nthe env parameter can be used to determine whether the current environment is development, production or test. for example:\n\nexport default {\n  tools: {\n    webpackchain: (chain, { env }) => {\n      if (env === 'development') {\n        chain.devtool('cheap-module-eval-source-map');\n      }\n    },\n  },\n};\n\n\n# isprod\n\n * type: boolean\n\nthe isprod parameter can be used to determine whether the current environment is production. for example:\n\nexport default {\n  tools: {\n    webpackchain: (chain, { isprod }) => {\n      if (isprod) {\n        chain.devtool('source-map');\n      }\n    },\n  },\n};\n\n\n# target\n\n * type: 'web' | 'node' | 'modern-web' | 'web-worker'\n\nthe target parameter can be used to determine the current environment. for example:\n\nexport default {\n  tools: {\n    webpackchain: (chain, { target }) => {\n      if (target === 'node') {\n        // ...\n      }\n    },\n  },\n};\n\n\n# isserver\n\n * type: boolean\n\ndetermines whether the target environment is node, equivalent to target === 'node'.\n\nexport default {\n  tools: {\n    webpackchain: (chain, { isserver }) => {\n      if (isserver) {\n        // ...\n      }\n    },\n  },\n};\n\n\n# iswebworker\n\n * type: boolean\n\ndetermines whether the target environment is web-worker, equivalent to target === 'web-worker'.\n\nexport default {\n  tools: {\n    webpackchain: (chain, { iswebworker }) => {\n      if (iswebworker) {\n        // ...\n      }\n    },\n  },\n};\n\n\n# webpack\n\n * type: typeof import('webpack')\n\nthe webpack instance. for example:\n\nexport default {\n  tools: {\n    webpackchain: (chain, { webpack }) => {\n      chain.plugin('my-progress').use(webpack.progressplugin);\n    },\n  },\n};\n\n\n\n# htmlwebpackplugin\n\n * type: typeof import('html-webpack-plugin')\n\nthe htmlwebpackplugin instance:\n\nexport default {\n  tools: {\n    webpackchain: (chain, { htmlwebpackplugin }) => {\n      console.log(htmlwebpackplugin);\n    },\n  },\n};\n\n\n# chain_id\n\nsome common chain ids are predefined in the builder, and you can use these ids to locate the built-in rule or plugin.\n\n# chain_id.rule\n\nid           description\nrule.mjs     rule for mjs\nrule.js      rule for js\nrule.ts      rule for ts\nrule.css     rule for css\nrule.less    rule for less\nrule.sass    rule for sass\nrule.pug     rule for pug\nrule.toml    rule for toml\nrule.yaml    rule for yaml\nrule.font    rule for font\nrule.image   rule for image\nrule.media   rule for media\n\n\n# chain_id.one_of\n\none_of.xxx can match a certain type of rule in the rule array.\n\nid                  description\none_of.svg          rules for svg, automatic choice between data uri and\n                    separate file\none_of.svg_url      rules for svg, output as a separate file\none_of.svg_inline   rules for svg, inlined into bundles as data uris\none_of.svg_assets   rules for svg, automatic choice between data uri and\n                    separate file\n\n\n# chain_id.use\n\nuse.xxx can match a certain loader.\n\nid                     description\nuse.ts                 correspond to ts-loader\nuse.css                correspond to css-loader\nuse.less               correspond to less-loader\nuse.sass               correspond to sass-loader\nuse.pug                correspond to pug-loader\nuse.toml               correspond to toml-loader\nuse.yaml               correspond to yaml-loader\nuse.file               correspond to file-loader\nuse.url                correspond to url-loader\nuse.svgr               correspond to @svgr/webpack\nuse.babel              correspond to babel-loader\nuse.style              correspond to style-loader\nuse.postcss            correspond to postcss-loader\nuse.markdown           correspond to markdown-loader\nuse.css_modules_ts     correspond to css-modules-typescript-loader\nuse.mini_css_extract   correspond to mini-css-extract-plugin.loader\n\n\n# chain_id.plugin\n\nplugin.xxx can match a certain webpack plugin.\n\nid                             description\nplugin.hmr                     correspond to hotmodulereplacementplugin\nplugin.copy                    correspond to copywebpackplugin\nplugin.html                    correspond to htmlwebpackplugin, you need to splice the\n                               entry name when using: ${plugin.html}-${entryname}\nplugin.define                  correspond to defineplugin\nplugin.ignore                  correspond to ignoreplugin\nplugin.banner                  correspond to bannerplugin\nplugin.progress                correspond to webpackbar\nplugin.app_icon                correspond to appiconplugin\nplugin.loadable                correspond to loadablewebpackplugin\nplugin.manifest                correspond to webpackmanifestplugin\nplugin.ts_checker              correspond to forktscheckerwebpackplugin\nplugin.inline_html             correspond to inlinechunkhtmlplugin\nplugin.bundle_analyzer         correspond to webpackbundleanalyzer\nplugin.bottom_template         correspond to bottomtemplateplugin\nplugin.mini_css_extract        correspond to minicssextractplugin\nplugin.react_fast_refresh      correspond to reactfastrefreshplugin\nplugin.node_polyfill_provide   correspond to provideplugin for node polyfills\nplugin.inspector               correspond to @modern-js/inspector-webpack-plugin\nplugin.subresource_integrity   correspond to webpack-subresource-integrity\nplugin.assets_retry            correspond to webpack static asset retry plugin in builder\nplugin.auto_set_root_size      correspond to automatically set root font size plugin in\n                               builder\n\n\n# chain_id.minimizer\n\nminimizer.xxx can match a certain minimizer.\n\nid                  description\nminimizer.js        correspond to terserwebpackplugin\nminimizer.css       correspond to cssminimizerwebpackplugin\nminimizer.esbuild   correspond to esbuildplugin\nminimizer.swc       correspond to swcwebpackplugin\n\n\n# examples\n\nthe following are some common configuration examples, see the full webpack-chain api webpack-chain documentation.\n\n# add/modify/delete loader\n\nexport default {\n  tools: {\n    webpackchain: (chain, { chain_id }) => {\n      // add loader\n      chain.module\n        .rule('md')\n        .test(/\\.md$/)\n        .use('md-loader')\n        .loader('md-loader');\n\n      // modify loader\n      chain.module\n        .rule(chain_id.rule.js)\n        .use(chain_id.use.babel)\n        .tap(options => {\n          options.plugins.push('babel-plugin-xxx');\n          return options;\n        });\n\n      // delete loader\n      chain.module.rule(chain_id.rule.js).uses.delete(chain_id.use.babel);\n    },\n  },\n};\n\n\n# add/modify/delete plugin\n\nexport default {\n  tools: {\n    webpackchain: (chain, { webpack, chain_id }) => {\n      // add plugin\n      chain.plugin('define').use(webpack.defineplugin, [\n        {\n          'process.env': {\n            node_env: json.stringify(process.env.node_env),\n          },\n        },\n      ]);\n\n      // modify plugin\n      chain.plugin(chain_id.plugin.hmr).tap(options => {\n        options[0].fullbuildtimeout = 200;\n        return options;\n      });\n\n      // delete plugin\n      chain.plugins.delete(chain_id.plugin.hmr);\n    },\n  },\n};\n",charsets:{cjk:!0}},{frontmatter:{api:!0},regularPath:"/en/api/",relativePath:"en/api/index.md",key:"v-3c8c2c3a",path:"/en/api/",lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"",normalizedContent:"",charsets:{}},{title:"Plugin Core",frontmatter:{extractApiHeaders:[2]},regularPath:"/en/api/plugin-core.html",relativePath:"en/api/plugin-core.md",key:"v-639989dc",path:"/en/api/plugin-core.html",headers:[{level:2,title:"BuilderPlugin",slug:"builderplugin",normalizedTitle:"builderplugin",charIndex:74},{level:2,title:"BuilderPluginAPI",slug:"builderpluginapi",normalizedTitle:"builderpluginapi",charIndex:417},{level:2,title:"api.context",slug:"api-context",normalizedTitle:"api.context",charIndex:2166},{level:2,title:"api.getBuilderConfig",slug:"api-getbuilderconfig",normalizedTitle:"api.getbuilderconfig",charIndex:2463},{level:2,title:"api.getNormalizedConfig",slug:"api-getnormalizedconfig",normalizedTitle:"api.getnormalizedconfig",charIndex:2800},{level:2,title:"api.isPluginExists",slug:"api-ispluginexists",normalizedTitle:"api.ispluginexists",charIndex:3448},{level:2,title:"api.getHTMLPaths",slug:"api-gethtmlpaths",normalizedTitle:"api.gethtmlpaths",charIndex:3710}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"BuilderPlugin BuilderPluginAPI api.context api.getBuilderConfig api.getNormalizedConfig api.isPluginExists api.getHTMLPaths",content:"# Plugin Core\n\nThis section describes the core plugin types and APIs.\n\n\n# BuilderPlugin\n\nThe type of the plugin object. The plugin object contains the following properties:\n\n * name: The name of the plugin, a unique identifier.\n * setup: The setup function of the plugin, which can be an asynchronous function. This function will only be executed once when the plugin is initialized.\n\nexport type BuilderPlugin<API = BuilderPluginAPI> = {\n  name: string;\n  setup: (api: API) => Promise<void> | void;\n};\n\n\nYou can import this type from @modern-js/builder:\n\nimport type { BuilderPlugin } from '@modern-js/builder';\n\nexport default (): BuilderPlugin => ({\n  name: 'builder-plugin-foo',\n\n  setup: api => {\n    api.onAfterBuild(() => {\n      console.log('after build!');\n    });\n  },\n});\n\n\n\n# BuilderPluginAPI\n\nThe type of plugin API. The plugin API provides the context info, utility functions and lifecycle hooks.\n\nFor a complete introduction to lifecycle hooks, please read the Plugin Hooks chapter.\n\nWhen using webpack provider or rspack provider, the type definition of BuilderPluginAPI is somewhat different, and you can introduce the corresponding type according to the usage scenario of the plugin.\n\n\n# Plugin for webpack provider\n\nWhen developing plugins for webpack provider, please import BuilderPluginAPI from @modern-js/builder-webpack-provider.\n\nimport type { BuilderPlugin } from '@modern-js/builder';\nimport type { BuilderPluginAPI } from '@modern-js/builder-webpack-provider';\n\nexport default (): BuilderPlugin<BuilderPluginAPI> => ({\n  name: 'builder-plugin-foo',\n\n  setup: api => {\n    api.modifyWebpackConfig(config => {\n      config.devtool = false;\n    });\n  },\n});\n\n\n\n# Plugins for rspack provider\n\nWhen developing plugins for rspack provider, please import BuilderPluginAPI from @modern-js/builder-rspack-provider.\n\nimport type { BuilderPlugin } from '@modern-js/builder';\nimport type { BuilderPluginAPI } from '@modern-js/builder-rspack-provider';\n\nexport default (): BuilderPlugin<BuilderPluginAPI> => ({\n  name: 'builder-plugin-foo',\n\n  setup: api => {\n    api.modifyRspackConfig(config => {\n      config.devtool = false;\n    });\n  },\n});\n\n\n\n# api.context\n\napi.context is a read-only object that provides some context information.\n\nThe content of api.context is exactly the same as builder.context, please refer to builder.context.\n\n * Example\n\nconst PluginFoo = () => ({\n   setup(api) {\n     console.log(api.context.distPath);\n   }\n);\n\n\n\n# api.getBuilderConfig\n\nGet the Builder config, this method must be called after the modifyBuilderConfig hook is executed.\n\n * Type\n\nfunction GetBuilderConfig(): Readonly<BuilderConfig>;\n\n\n * Example\n\nconst PluginFoo = () => ({\n   setup(api) {\n     const config = api.getBuilderConfig();\n     console.log(config.html?.title);\n   }\n);\n\n\n\n# api.getNormalizedConfig\n\nGet the normalized Builder config, this method must be called after the modifyBuilderConfig hook is executed.\n\nCompared with the api.getBuilderConfig method, the config returned by this method has been normalized, and the type definition of the config will be narrowed. For example, the undefined type of config.html will be removed.\n\nIt is recommended to use this method to get the Builder config.\n\n * Type\n\nfunction GetNormalizedConfig(): Readonly<NormalizedConfig>;\n\n\n * Example\n\nconst PluginFoo = () => ({\n   setup(api) {\n     const config = api.getNormalizedConfig();\n     console.log(config.html.title);\n   }\n);\n\n\n\n# api.isPluginExists\n\nDetermines whether a plugin has been registered.\n\n * Type\n\nfunction IsPluginExists(pluginName: string): boolean;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    console.log(api.isPluginExists('builder-plugin-foo'));\n  },\n});\n\n\n\n# api.getHTMLPaths\n\nGet path information for all HTML assets.\n\nThis method will return an object, the key is the entry name and the value is the relative path of the HTML file in the dist directory.\n\n * Type\n\nfunction GetHTMLPaths(): Record<string, string>;\n\n\n * Example\n\nconst PluginFoo = () => ({\n   setup(api) {\n     api.modifyWebpackChain(() => {\n       const htmlPaths = api.getHTMLPaths();\n       console.log(htmlPaths); // { main: 'html/main/index.html' };\n     });\n   }\n);\n",normalizedContent:"# plugin core\n\nthis section describes the core plugin types and apis.\n\n\n# builderplugin\n\nthe type of the plugin object. the plugin object contains the following properties:\n\n * name: the name of the plugin, a unique identifier.\n * setup: the setup function of the plugin, which can be an asynchronous function. this function will only be executed once when the plugin is initialized.\n\nexport type builderplugin<api = builderpluginapi> = {\n  name: string;\n  setup: (api: api) => promise<void> | void;\n};\n\n\nyou can import this type from @modern-js/builder:\n\nimport type { builderplugin } from '@modern-js/builder';\n\nexport default (): builderplugin => ({\n  name: 'builder-plugin-foo',\n\n  setup: api => {\n    api.onafterbuild(() => {\n      console.log('after build!');\n    });\n  },\n});\n\n\n\n# builderpluginapi\n\nthe type of plugin api. the plugin api provides the context info, utility functions and lifecycle hooks.\n\nfor a complete introduction to lifecycle hooks, please read the plugin hooks chapter.\n\nwhen using webpack provider or rspack provider, the type definition of builderpluginapi is somewhat different, and you can introduce the corresponding type according to the usage scenario of the plugin.\n\n\n# plugin for webpack provider\n\nwhen developing plugins for webpack provider, please import builderpluginapi from @modern-js/builder-webpack-provider.\n\nimport type { builderplugin } from '@modern-js/builder';\nimport type { builderpluginapi } from '@modern-js/builder-webpack-provider';\n\nexport default (): builderplugin<builderpluginapi> => ({\n  name: 'builder-plugin-foo',\n\n  setup: api => {\n    api.modifywebpackconfig(config => {\n      config.devtool = false;\n    });\n  },\n});\n\n\n\n# plugins for rspack provider\n\nwhen developing plugins for rspack provider, please import builderpluginapi from @modern-js/builder-rspack-provider.\n\nimport type { builderplugin } from '@modern-js/builder';\nimport type { builderpluginapi } from '@modern-js/builder-rspack-provider';\n\nexport default (): builderplugin<builderpluginapi> => ({\n  name: 'builder-plugin-foo',\n\n  setup: api => {\n    api.modifyrspackconfig(config => {\n      config.devtool = false;\n    });\n  },\n});\n\n\n\n# api.context\n\napi.context is a read-only object that provides some context information.\n\nthe content of api.context is exactly the same as builder.context, please refer to builder.context.\n\n * example\n\nconst pluginfoo = () => ({\n   setup(api) {\n     console.log(api.context.distpath);\n   }\n);\n\n\n\n# api.getbuilderconfig\n\nget the builder config, this method must be called after the modifybuilderconfig hook is executed.\n\n * type\n\nfunction getbuilderconfig(): readonly<builderconfig>;\n\n\n * example\n\nconst pluginfoo = () => ({\n   setup(api) {\n     const config = api.getbuilderconfig();\n     console.log(config.html?.title);\n   }\n);\n\n\n\n# api.getnormalizedconfig\n\nget the normalized builder config, this method must be called after the modifybuilderconfig hook is executed.\n\ncompared with the api.getbuilderconfig method, the config returned by this method has been normalized, and the type definition of the config will be narrowed. for example, the undefined type of config.html will be removed.\n\nit is recommended to use this method to get the builder config.\n\n * type\n\nfunction getnormalizedconfig(): readonly<normalizedconfig>;\n\n\n * example\n\nconst pluginfoo = () => ({\n   setup(api) {\n     const config = api.getnormalizedconfig();\n     console.log(config.html.title);\n   }\n);\n\n\n\n# api.ispluginexists\n\ndetermines whether a plugin has been registered.\n\n * type\n\nfunction ispluginexists(pluginname: string): boolean;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    console.log(api.ispluginexists('builder-plugin-foo'));\n  },\n});\n\n\n\n# api.gethtmlpaths\n\nget path information for all html assets.\n\nthis method will return an object, the key is the entry name and the value is the relative path of the html file in the dist directory.\n\n * type\n\nfunction gethtmlpaths(): record<string, string>;\n\n\n * example\n\nconst pluginfoo = () => ({\n   setup(api) {\n     api.modifywebpackchain(() => {\n       const htmlpaths = api.gethtmlpaths();\n       console.log(htmlpaths); // { main: 'html/main/index.html' };\n     });\n   }\n);\n",charsets:{cjk:!0}},{title:"Plugin Hooks",frontmatter:{extractApiHeaders:[2]},regularPath:"/en/api/plugin-hooks.html",relativePath:"en/api/plugin-hooks.md",key:"v-d6e21568",path:"/en/api/plugin-hooks.html",headers:[{level:2,title:"Overview",slug:"overview",normalizedTitle:"overview",charIndex:90},{level:2,title:"Common Hooks",slug:"common-hooks",normalizedTitle:"common hooks",charIndex:100},{level:2,title:"Build Hooks",slug:"build-hooks",normalizedTitle:"build hooks",charIndex:494},{level:2,title:"Dev Server Hooks",slug:"dev-server-hooks",normalizedTitle:"dev server hooks",charIndex:744},{level:2,title:"Other Hooks",slug:"other-hooks",normalizedTitle:"other hooks",charIndex:1056}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Overview Common Hooks Build Hooks Dev Server Hooks Other Hooks",content:"# Plugin Hooks\n\nThis section describes the lifetime hooks provided by Builder plugin.\n\n\n# Overview\n\nCommon Hooks\n\n * modifyBuilderConfig: Modify raw config of Builder.\n * modifyWebpackChain: Modify webpack-chain.\n * modifyWebpackConfig: Modify raw config of webpack.\n * modifyRspackConfig: Modify raw config of rspack.\n * onBeforeCreateCompiler: Called before creating compiler instance.\n * onAfterCreateCompiler: Called after the compiler object is created, but before the build is executed.\n\nBuild Hooks：Called only when the build method is executed to build the production outputs.\n\n * onBeforeBuild: Called before the production build is executed.\n * onAfterBuild: Called after executing the production build, you can get the build stats.\n\nDev Server Hooks: Called only when the startDevServer method is executed to run the development server.\n\n * onBeforeStartDevServer: Called before starting the development server.\n * onAfterStartDevServer: Called after starting the development server.\n * onDevCompileDone: Called after each development compile.\n\nOther Hooks\n\n * onExit: Called when the process is going to exit.\n\n\n# Common Hooks\n\n\n# modifyBuilderConfig\n\nModify the config passed to the Builder, you can directly modify the config object, or return a new object to replace the previous object.\n\n * Type\n\nfunction ModifyBuilderConfig(\n  callback: (\n    config: BuilderConfig,\n  ) => Promise<BuilderConfig | void> | BuilderConfig | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.modifyBuilderConfig(config => {\n      config.html = config.html || {};\n      config.html.title = 'Hello World!';\n    });\n  },\n});\n\n\n\n# modifyWebpackChain\n\nModify the webpack config through the webpack chain. This method is only called when using webpack provider.\n\n * Type\n\ntype ModifyWebpackChainUtils = {\n  env: NodeEnv;\n  isProd: boolean;\n  target: BuilderTarget;\n  webpack: typeof import('webpack');\n  isServer: boolean;\n  isWebWorker: boolean;\n  CHAIN_ID: ChainIdentifier;\n  getCompiledPath: (name: string) => string;\n  HtmlWebpackPlugin: typeof import('html-webpack-plugin');\n};\n\nfunction ModifyWebpackChain(\n  callback: (\n    chain: WebpackChain,\n    utils: ModifyWebpackChainUtils,\n  ) => Promise<void> | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.modifyWebpackChain((chain, utils) => {\n      if (utils.env === 'development') {\n        chain.devtool('eval');\n      }\n    });\n  },\n});\n\n\n\n# modifyWebpackConfig\n\nTo modify the final webpack config object, you can directly modify the config object, or return a new object to replace the previous object. This method is only called when using webpack provider.\n\nThis method is called later than the modifyWebpackChain hook.\n\n * Type\n\ntype ModifyWebpackConfigUtils = {\n  env: NodeEnv;\n  isProd: boolean;\n  target: BuilderTarget;\n  webpack: typeof import('webpack');\n  isServer: boolean;\n  isWebWorker: boolean;\n  CHAIN_ID: ChainIdentifier;\n  getCompiledPath: (name: string) => string;\n  HtmlWebpackPlugin: typeof import('html-webpack-plugin');\n  addRules: (rules: RuleSetRule | RuleSetRule[]) => void;\n  prependPlugins: (\n    plugins: WebpackPluginInstance | WebpackPluginInstance[],\n  ) => void;\n  appendPlugins: (\n    plugins: WebpackPluginInstance | WebpackPluginInstance[],\n  ) => void;\n  removePlugin: (pluginName: string) => void;\n};\n\nfunction ModifyWebpackConfig(\n  callback: (\n    config: WebpackConfig,\n    utils: ModifyWebpackConfigUtils,\n  ) => Promise<WebpackConfig | void> | WebpackConfig | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.modifyWebpackConfig((config, utils) => {\n      if (utils.env === 'development') {\n        config.devtool = 'eval';\n      }\n    });\n  },\n});\n\n\n\n# modifyRspackConfig\n\nTo modify the final rspack config object, you can directly modify the config object, or return a new object to replace the previous object. This method is only called when using rspack provider.\n\n * Type\n\ntype ModifyRspackConfigUtils = {\n  env: NodeEnv;\n  isProd: boolean;\n  target: BuilderTarget;\n  isServer: boolean;\n  isWebWorker: boolean;\n  getCompiledPath: (name: string) => string;\n};\n\nfunction ModifyRspackConfig(\n  callback: (\n    config: RspackConfig,\n    utils: ModifyRspackConfigUtils,\n  ) => Promise<RspackConfig | void> | RspackConfig | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.modifyRspackConfig((config, utils) => {\n      if (utils.env === 'development') {\n        config.devtool = 'eval';\n      }\n    });\n  },\n});\n\n\n\n# onBeforeCreateCompiler\n\nCalled before creating the compiler instance, when you execute builder.startDevServer, builder.build or builder.createCompiler, this hook will be called. You can get the final config object of the bundler through the bundlerConfigs parameter.\n\n * Type\n\nfunction OnBeforeCreateCompiler(\n  callback: (params: {\n    bundlerConfigs: WebpackConfig[] | RspackConfig[];\n  }) => Promise<void> | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onBeforeCreateCompiler(({ bundlerConfigs }) => {\n      console.log('the bundler config is ', bundlerConfigs);\n    });\n  },\n});\n\n\n\n# onAfterCreateCompiler\n\nCalled after creating a compiler instance, before executing a build, when you execute builder.startDevServer, builder.build or builder.createCompiler, this hook will be called. You can get the compiler instance through the compiler parameter.\n\n * Type\n\nfunction OnAfterCreateCompiler(callback: (params: {\n  compiler: Compiler | MultiCompiler;\n}) => Promise<void> | void;): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onAfterCreateCompiler(({ compiler }) => {\n      console.log('the compiler is ', compiler);\n    });\n  },\n});\n\n\n\n# Build Hooks\n\n\n# onBeforeBuild\n\nCalled before executing the production environment build, you can get the final config object of the bundler through the bundlerConfigs parameter.\n\n * Type\n\nfunction OnBeforeBuild(\n  callback: (params: {\n    bundlerConfigs?: WebpackConfig[] | RspackConfig[];\n  }) => Promise<void> | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onBeforeBuild(({ bundlerConfigs }) => {\n      console.log('the bundler config is ', bundlerConfigs);\n    });\n  },\n});\n\n\n\n# onAfterBuild\n\nCalled after executing the production build, you can get the build result information through the stats parameter.\n\n * Type\n\nfunction OnAfterBuild(\n  callback: (params: { stats?: Stats | MultiStats }) => Promise<void> | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onAfterBuild(({ stats }) => {\n      console.log(stats?.toJson());\n    });\n  },\n});\n\n\n\n# Dev Server Hooks\n\n\n# onBeforeStartDevServer\n\nCalled before starting the development server.\n\n * Type\n\nfunction OnBeforeStartDevServer(callback: () => Promise<void> | void): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onBeforeStartDevServer(() => {\n      console.log('before start!');\n    });\n  },\n});\n\n\n\n# onAfterStartDevServer\n\nCalled after starting the development server, you can get the port number through the port parameter.\n\n * Type\n\nfunction OnAfterStartDevServer(\n  callback: (params: { port: number }) => Promise<void> | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onAfterStartDevServer(({ port }) => {\n      console.log('this port is: ', port);\n    });\n  },\n});\n\n\n\n# onDevCompileDone\n\nCalled after each development environment build, you can use isFirstCompile to determine whether it is the first build.\n\n * Type\n\nfunction OnDevCompileDone(\n  callback: (params: { isFirstCompile: boolean }) => Promise<void> | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onDevCompileDone(({ isFirstCompile }) => {\n      if (isFirstCompile) {\n        console.log('first compile!');\n      } else {\n        console.log('re-compile!');\n      }\n    });\n  },\n});\n\n\n\n# Other Hooks\n\n\n# onExit\n\nCalled when the process is going to exit, this hook can only execute synchronous code.\n\n * Type\n\nfunction OnExit(callback: () => void): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onExit(() => {\n      console.log('exit!');\n    });\n  },\n});\n",normalizedContent:"# plugin hooks\n\nthis section describes the lifetime hooks provided by builder plugin.\n\n\n# overview\n\ncommon hooks\n\n * modifybuilderconfig: modify raw config of builder.\n * modifywebpackchain: modify webpack-chain.\n * modifywebpackconfig: modify raw config of webpack.\n * modifyrspackconfig: modify raw config of rspack.\n * onbeforecreatecompiler: called before creating compiler instance.\n * onaftercreatecompiler: called after the compiler object is created, but before the build is executed.\n\nbuild hooks：called only when the build method is executed to build the production outputs.\n\n * onbeforebuild: called before the production build is executed.\n * onafterbuild: called after executing the production build, you can get the build stats.\n\ndev server hooks: called only when the startdevserver method is executed to run the development server.\n\n * onbeforestartdevserver: called before starting the development server.\n * onafterstartdevserver: called after starting the development server.\n * ondevcompiledone: called after each development compile.\n\nother hooks\n\n * onexit: called when the process is going to exit.\n\n\n# common hooks\n\n\n# modifybuilderconfig\n\nmodify the config passed to the builder, you can directly modify the config object, or return a new object to replace the previous object.\n\n * type\n\nfunction modifybuilderconfig(\n  callback: (\n    config: builderconfig,\n  ) => promise<builderconfig | void> | builderconfig | void,\n): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.modifybuilderconfig(config => {\n      config.html = config.html || {};\n      config.html.title = 'hello world!';\n    });\n  },\n});\n\n\n\n# modifywebpackchain\n\nmodify the webpack config through the webpack chain. this method is only called when using webpack provider.\n\n * type\n\ntype modifywebpackchainutils = {\n  env: nodeenv;\n  isprod: boolean;\n  target: buildertarget;\n  webpack: typeof import('webpack');\n  isserver: boolean;\n  iswebworker: boolean;\n  chain_id: chainidentifier;\n  getcompiledpath: (name: string) => string;\n  htmlwebpackplugin: typeof import('html-webpack-plugin');\n};\n\nfunction modifywebpackchain(\n  callback: (\n    chain: webpackchain,\n    utils: modifywebpackchainutils,\n  ) => promise<void> | void,\n): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.modifywebpackchain((chain, utils) => {\n      if (utils.env === 'development') {\n        chain.devtool('eval');\n      }\n    });\n  },\n});\n\n\n\n# modifywebpackconfig\n\nto modify the final webpack config object, you can directly modify the config object, or return a new object to replace the previous object. this method is only called when using webpack provider.\n\nthis method is called later than the modifywebpackchain hook.\n\n * type\n\ntype modifywebpackconfigutils = {\n  env: nodeenv;\n  isprod: boolean;\n  target: buildertarget;\n  webpack: typeof import('webpack');\n  isserver: boolean;\n  iswebworker: boolean;\n  chain_id: chainidentifier;\n  getcompiledpath: (name: string) => string;\n  htmlwebpackplugin: typeof import('html-webpack-plugin');\n  addrules: (rules: rulesetrule | rulesetrule[]) => void;\n  prependplugins: (\n    plugins: webpackplugininstance | webpackplugininstance[],\n  ) => void;\n  appendplugins: (\n    plugins: webpackplugininstance | webpackplugininstance[],\n  ) => void;\n  removeplugin: (pluginname: string) => void;\n};\n\nfunction modifywebpackconfig(\n  callback: (\n    config: webpackconfig,\n    utils: modifywebpackconfigutils,\n  ) => promise<webpackconfig | void> | webpackconfig | void,\n): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.modifywebpackconfig((config, utils) => {\n      if (utils.env === 'development') {\n        config.devtool = 'eval';\n      }\n    });\n  },\n});\n\n\n\n# modifyrspackconfig\n\nto modify the final rspack config object, you can directly modify the config object, or return a new object to replace the previous object. this method is only called when using rspack provider.\n\n * type\n\ntype modifyrspackconfigutils = {\n  env: nodeenv;\n  isprod: boolean;\n  target: buildertarget;\n  isserver: boolean;\n  iswebworker: boolean;\n  getcompiledpath: (name: string) => string;\n};\n\nfunction modifyrspackconfig(\n  callback: (\n    config: rspackconfig,\n    utils: modifyrspackconfigutils,\n  ) => promise<rspackconfig | void> | rspackconfig | void,\n): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.modifyrspackconfig((config, utils) => {\n      if (utils.env === 'development') {\n        config.devtool = 'eval';\n      }\n    });\n  },\n});\n\n\n\n# onbeforecreatecompiler\n\ncalled before creating the compiler instance, when you execute builder.startdevserver, builder.build or builder.createcompiler, this hook will be called. you can get the final config object of the bundler through the bundlerconfigs parameter.\n\n * type\n\nfunction onbeforecreatecompiler(\n  callback: (params: {\n    bundlerconfigs: webpackconfig[] | rspackconfig[];\n  }) => promise<void> | void,\n): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.onbeforecreatecompiler(({ bundlerconfigs }) => {\n      console.log('the bundler config is ', bundlerconfigs);\n    });\n  },\n});\n\n\n\n# onaftercreatecompiler\n\ncalled after creating a compiler instance, before executing a build, when you execute builder.startdevserver, builder.build or builder.createcompiler, this hook will be called. you can get the compiler instance through the compiler parameter.\n\n * type\n\nfunction onaftercreatecompiler(callback: (params: {\n  compiler: compiler | multicompiler;\n}) => promise<void> | void;): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.onaftercreatecompiler(({ compiler }) => {\n      console.log('the compiler is ', compiler);\n    });\n  },\n});\n\n\n\n# build hooks\n\n\n# onbeforebuild\n\ncalled before executing the production environment build, you can get the final config object of the bundler through the bundlerconfigs parameter.\n\n * type\n\nfunction onbeforebuild(\n  callback: (params: {\n    bundlerconfigs?: webpackconfig[] | rspackconfig[];\n  }) => promise<void> | void,\n): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.onbeforebuild(({ bundlerconfigs }) => {\n      console.log('the bundler config is ', bundlerconfigs);\n    });\n  },\n});\n\n\n\n# onafterbuild\n\ncalled after executing the production build, you can get the build result information through the stats parameter.\n\n * type\n\nfunction onafterbuild(\n  callback: (params: { stats?: stats | multistats }) => promise<void> | void,\n): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.onafterbuild(({ stats }) => {\n      console.log(stats?.tojson());\n    });\n  },\n});\n\n\n\n# dev server hooks\n\n\n# onbeforestartdevserver\n\ncalled before starting the development server.\n\n * type\n\nfunction onbeforestartdevserver(callback: () => promise<void> | void): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.onbeforestartdevserver(() => {\n      console.log('before start!');\n    });\n  },\n});\n\n\n\n# onafterstartdevserver\n\ncalled after starting the development server, you can get the port number through the port parameter.\n\n * type\n\nfunction onafterstartdevserver(\n  callback: (params: { port: number }) => promise<void> | void,\n): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.onafterstartdevserver(({ port }) => {\n      console.log('this port is: ', port);\n    });\n  },\n});\n\n\n\n# ondevcompiledone\n\ncalled after each development environment build, you can use isfirstcompile to determine whether it is the first build.\n\n * type\n\nfunction ondevcompiledone(\n  callback: (params: { isfirstcompile: boolean }) => promise<void> | void,\n): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.ondevcompiledone(({ isfirstcompile }) => {\n      if (isfirstcompile) {\n        console.log('first compile!');\n      } else {\n        console.log('re-compile!');\n      }\n    });\n  },\n});\n\n\n\n# other hooks\n\n\n# onexit\n\ncalled when the process is going to exit, this hook can only execute synchronous code.\n\n * type\n\nfunction onexit(callback: () => void): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.onexit(() => {\n      console.log('exit!');\n    });\n  },\n});\n",charsets:{cjk:!0}},{title:"Alias",frontmatter:{},regularPath:"/en/guide/advanced/alias.html",relativePath:"en/guide/advanced/alias.md",key:"v-ef49e4a8",path:"/en/guide/advanced/alias.html",headers:[{level:2,title:"Using source.alias config",slug:"using-source-alias-config",normalizedTitle:"using source.alias config",charIndex:669},{level:2,title:"Using paths config in tsconfig.json",slug:"using-paths-config-in-tsconfig-json",normalizedTitle:"using paths config in tsconfig.json",charIndex:1265}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Using source.alias config Using paths config in tsconfig.json",content:"# Alias\n\nAlias is a way to specify a short name for a module or a path to a directory or file. This can be useful when you want to use a short, easy-to-remember name for a module instead of a long, complex path.\n\nFor example, if you have a file at src/common/request.ts, you could create an alias called @request for it, so you could import the file like this: import request from '@request'. This makes it easier to reference the file in your code, and also allows you to move the file to a different location without having to update all the import statements in your code.\n\nIn Builder, you can set aliases in two ways:\n\n * source.alias\n * paths in tsconfig.json\n\n\n# Using source.alias config\n\nsource.alias corresponds to webpack's native resolve.alias config, you can configure it as an object or a function.\n\nFirst, you can configure it as an object, for example:\n\nexport default {\n  source: {\n    alias: {\n      '@common': './src/common',\n    },\n  },\n};\n\n\nThe relative path in it will be parsed as an absolute path in Builder.\n\nYou can also configure it as a function to get the preset alias object and modify it, for example:\n\nexport default {\n  source: {\n    alias: alias => {\n      alias['@common'] = './src/common';\n      return alias;\n    },\n  },\n};\n\n\n\n# Using paths config in tsconfig.json\n\nIn addition to source.alias, you can also configure it by paths in tsconfig.json. We recommend to use this way in TypeScript projects, because it can solve type problem of alias path.\n\nFor example:\n\n{\n  \"compilerOptions\": {\n    \"paths\": {\n      \"@common/*\": [\"./src/common/*\"]\n    }\n  }\n}\n\n\nPriority\n\nThe paths config has higher priority than source.alias.",normalizedContent:"# alias\n\nalias is a way to specify a short name for a module or a path to a directory or file. this can be useful when you want to use a short, easy-to-remember name for a module instead of a long, complex path.\n\nfor example, if you have a file at src/common/request.ts, you could create an alias called @request for it, so you could import the file like this: import request from '@request'. this makes it easier to reference the file in your code, and also allows you to move the file to a different location without having to update all the import statements in your code.\n\nin builder, you can set aliases in two ways:\n\n * source.alias\n * paths in tsconfig.json\n\n\n# using source.alias config\n\nsource.alias corresponds to webpack's native resolve.alias config, you can configure it as an object or a function.\n\nfirst, you can configure it as an object, for example:\n\nexport default {\n  source: {\n    alias: {\n      '@common': './src/common',\n    },\n  },\n};\n\n\nthe relative path in it will be parsed as an absolute path in builder.\n\nyou can also configure it as a function to get the preset alias object and modify it, for example:\n\nexport default {\n  source: {\n    alias: alias => {\n      alias['@common'] = './src/common';\n      return alias;\n    },\n  },\n};\n\n\n\n# using paths config in tsconfig.json\n\nin addition to source.alias, you can also configure it by paths in tsconfig.json. we recommend to use this way in typescript projects, because it can solve type problem of alias path.\n\nfor example:\n\n{\n  \"compileroptions\": {\n    \"paths\": {\n      \"@common/*\": [\"./src/common/*\"]\n    }\n  }\n}\n\n\npriority\n\nthe paths config has higher priority than source.alias.",charsets:{}},{title:"Browser Compatibility",frontmatter:{},regularPath:"/en/guide/advanced/browser-compatibility.html",relativePath:"en/guide/advanced/browser-compatibility.md",key:"v-37d5e88c",path:"/en/guide/advanced/browser-compatibility.html",headers:[{level:2,title:"Set browserslist",slug:"set-browserslist",normalizedTitle:"set browserslist",charIndex:144},{level:2,title:"Background knowledge",slug:"background-knowledge",normalizedTitle:"background knowledge",charIndex:840},{level:2,title:"Downgrade method",slug:"downgrade-method",normalizedTitle:"downgrade method",charIndex:6112},{level:2,title:"Polyfill mode",slug:"polyfill-mode",normalizedTitle:"polyfill mode",charIndex:8990}],lastUpdated:"12/21/2022, 9:20:25 AM",lastUpdatedTimestamp:1671614425e3,headersStr:"Set browserslist Background knowledge Downgrade method Polyfill mode",content:"# Browser Compatibility\n\nThis chapter introduces how to use the capabilities provided by Builder to deal with browser compatibility issues.\n\n\n# Set browserslist\n\nBefore dealing with compatibility issues, you first need to clarify which browsers your project needs to support, and add the corresponding browserslist config.\n\n * If you haven't set browserslist yet, please read the Browserslist chapter first.\n\n * If you have set a browserslist, Builder will automatically compile according to that scope, downgrade JavaScript syntax and CSS syntax, and inject the required polyfill. In most cases, you can safely use modern ECMAScript features without worrying about compatibility issues.\n\nAfter setting the browserslist, if you still encountered some compatibility issues, please continue reading below contents to find some solutions.\n\n\n# Background knowledge\n\nBefore dealing with compatibility issues, it is recommended that you understand the following background knowledge to better handle related issues.\n\n\n# Syntax downgrade and API downgrade\n\nWhen you use higher-version syntax and API in your project, in order to make the compiled code run stably in lower-version browsers, we need to downgrade two parts: syntax downgrade and API downgrade.\n\nBuilder downgrades syntax through syntax transpilation, and downgrades API through inject polyfill.\n\n> Grammar and API are not strongly bound. When browser manufacturers implement the engine, they will support some syntax or implement some APIs in advance according to the specification or their own needs. Therefore, browsers from different manufacturers in the same period are not necessarily compatible with syntax and API. So in general practice, syntax and API are handled in two parts.\n\n\n# Syntax transpilation\n\nSyntax is a series of rules for how a programming language organizes code, and code that does not follow these rules cannot be correctly recognized by the programming language's engine and therefore cannot be run. In JavaScript, the following examples are syntax rules:\n\n * In const foo = 1, const means to declare an immutable constant.\n * In foo?.bar?.baz, ?. indicates optional chaining of access properties.\n * In async function () {}, async means to declare an asynchronous function.\n\nBecause the parsers of different browsers can support different syntax, especially the old version of the browser engine can support less grammar, so when some syntax are run in the lower version of the browser engine, an error will be reported at the stage of parsing the AST .\n\nFor example, the following code will report an error in IE browser or a lower version of Node.js:\n\nconst foo = {};\nfoo?.bar();\n\n\nWhen we run this code in a low version of Node.js, the following error message will appear:\n\nSyntaxError: Unexpected token.\n   at Object.exports.runInThisContext (vm.js:73:16)\n   at Object.<anonymous> ([eval]-wrapper:6:22)\n   at Module._compile (module.js:460:26)\n   at evalScript (node.js:431:25)\n   at startup (node.js:90:7)\n   at node.js:814:3\n\n\nIt is obvious from the error message that this is a syntax error. This means that this syntax is not supported in lower versions of the engine.\n\nSyntax can not be supported by polyfill or shim. If you want to run some syntax that it does not originally support in a low-version browser, you need to transpile the code into a syntax that the low-version engine can support.\n\nTranspile the above code into the following code to run in lower version engines:\n\nvar foo = {};\nfoo === null || foo === void 0 ? void 0 : foo.bar();\n\n\nAfter transpilation, the syntax of the code has changed, and some syntax that the engine of the lower version cannot understand has been replaced with the syntax it can understand, but the meaning of the code itself has not changed.\n\nIf the engine encounters an unrecognized syntax when converting to AST, it will report a syntax error and abort the code execution process. In this case, if your project does not use capabilities such as SSR or SSG, the page will be blank, making the page unavailable.\n\nIf the code is successfully converted to AST, the engine will convert the AST into executable code and execute it normally inside the engine.\n\n\n# API Polyfill\n\nJavaScript is an interpreted scripting language, unlike compiled languages like Rust. Rust will check the calls in the code during the compilation phase, and JavaScript does not know whether the function called by this line of code exists before it actually runs to a certain line of code, so some errors will only appear at runtime.\n\nFor example:\n\nvar str = 'Hello world!';\nconsole.log(str.notExistedMethod());\n\n\nThe above code has correct syntax and can be converted to AST correctly in the first stage of the engine runtime, but when it is actually running, because the method notExistedMethod does not exist on String.prototype, an error will be reported:\n\nUncaught TypeError: str.notExistedMethod is not a function\n   at <anonymous>:2:17\n\n\nWith the iteration of ECMAScript, some new methods will be added to be built-in objects. For example, String.prototype.replaceAll was introduced in ES2021, then the replaceAll method does not exist in the built-in object String.prototype of most browser engines before 2021, so the following code works in the latest Chrome, but not in earlier versions:\n\n'abc'.replaceAll('abc', 'xyz');\n\n\nIn order to solve the problem that String.prototype lacks replaceAll in older browsers, we can extend the String.prototype object in older browsers and add the replaceAll method to it, for example:\n\n// The implementation of this polyfill does not necessarily conform to the standard, it is only used as an example.\nif (!String.prototype.replaceAll) {\n  String.prototype.replaceAll = function (str, newStr) {\n    // If a regex pattern\n    if (\n      Object.prototype.toString.call(str).toLowerCase() === '[object regexp]'\n    ) {\n      return this.replace(str, newStr);\n    }\n    // If a string\n    return this.replace(new RegExp(str, 'g'), newStr);\n  };\n}\n\n\n> This technique of providing implementations for legacy environments to align new APIs is called polyfill.\n\n\n# Downgrade method\n\nIn Builder, we divide code into three categories:\n\n * The first category is the source code in the current project.\n * The second category is third-party dependencies installed through npm.\n * The third category is the code out of the current project, such as the code in other directories in the monorepo.\n\nBy default, Builder will only compile and downgrade the first category, other categories will not be downgraded by default.\n\nThere are several considerations for this approach:\n\n * Downgrading all third-party party dependencies will significantly reduce build performance.\n * Most third-party dependencies have been downgraded before release, and the second downgrade may introduce new problems.\n * The code out of the current project may have been compiled, or the compilation config may be different.\n\n\n# Downgrade the current project code\n\nThe code of the current project will be downgraded by default, so you don't need to add additional config, just make sure that the browserslist config is set correctly.\n\n\n# Downgrade third-party dependencies\n\nWhen you find that a third-party dependencies causes compatibility issues, you can add this dependency to Builder's source.include config, Make Builder do extra compilation for this dependency.\n\nTaking the npm package query-string as an example, you can add the following config:\n\nimport path from 'path';\n\nexport default {\n  source: {\n    include: [\n      // Method 1:\n      // First get the path of the module by require.resolve\n      // Then pass path.dirname to point to the corresponding directory\n      path.dirname(require.resolve('query-string')),\n      // Method 2:\n      // Match by regular expression\n      // All paths containing `/query-string/` will be matched\n      /\\/query-string\\//,\n    ],\n  },\n};\n\n\nNote that this config will only compile the code of query-string itself, not the sub-dependencies of query-string. If you need to compile a sub-dependency of query-string, you need to add the corresponding npm package to source.include.\n\n\n# Downgrade the code out of the current project\n\nWhen you import the code out of the current project, if the code has not been compiled, then you also need to configure source.include to it to compile.\n\nFor example, if you need to reference a module under the packages directory in the monorepo, you can add the following config:\n\nimport path from 'path';\n\nexport default {\n  source: {\n    include: [\n      // method one:\n      // Compile all files in the package directory of Monorepo\n      path.resolve(__dirname, '../../packages'),\n\n      // Method Two:\n      // Compile the source code of a package in the Monorepo's package directory\n      // The matching range of this writing method is more precise, and has less impact on the overall compilation performance\n      path.resolve(__dirname, '../../packages/xxx/src'),\n    ],\n  },\n};\n\n\n\n# Polyfill mode\n\nBuilder compiles JavaScript code through babel or SWC, and injects polyfill libraries like core-js, @babel/runtime and @swc/helpers.\n\nIn different usage scenarios, you may need different polyfill solutions. Builder provides output.polyfill config to switch between different polyfill modes.\n\n\n# entry mode\n\nentry is the default mode and does not need to be set manually.\n\nWhen using the entry mode, Builder will analyze which core-js methods need to be injected according to the browserslist set by the current project, and inject them to the entry file of each page. The polyfill injected in this way is more comprehensive, and there is no need to worry about the project source code and third-party dependencies polyfill issues. However, because some unused polyfill codes are included, the bundle size may increase.\n\nThe config of entry mode is:\n\nexport default {\n  output: {\n    polyfill: 'entry',\n  },\n};\n\n\n\n# usage mode\n\nThe usage mode allows more precise control over which core-js polyfills need to be injected.\n\nWhen you enable the usage mode, Builder will analyze the source code in the project and determine which polyfills need to be injected.\n\nFor example, the code uses the Map object:\n\nvar b = new Map();\n\n\nAfter compilation, only the polyfills for Map will be injected into this file:\n\nimport 'core-js/modules/es.map';\nvar b = new Map();\n\n\nThe advantage of this method is that the size of the injected polyfill is smaller, which is suitable for projects with higher requirements on bundle size. The disadvantage is that polyfill may not be fully injected, because third-party dependencies will not be compiled and downgraded by default, so the polyfill required by third-party dependencies will not be analyzed. If you need to analyze a third-party dependency, you also need to add it to source.include config.\n\nThe config of usage mode is:\n\nexport default {\n  output: {\n    polyfill: 'usage',\n  },\n};\n\n\n\n# Disable Polyfill\n\nYou can disable polyfill injection behavior by setting output.polyfill to 'off'.\n\nexport default {\n  output: {\n    polyfill: 'off',\n  },\n};\n\n\nWhen using this config, you need to ensure compatibility by yourself, such as manually import the required polyfill code through source.preEntry.",normalizedContent:"# browser compatibility\n\nthis chapter introduces how to use the capabilities provided by builder to deal with browser compatibility issues.\n\n\n# set browserslist\n\nbefore dealing with compatibility issues, you first need to clarify which browsers your project needs to support, and add the corresponding browserslist config.\n\n * if you haven't set browserslist yet, please read the browserslist chapter first.\n\n * if you have set a browserslist, builder will automatically compile according to that scope, downgrade javascript syntax and css syntax, and inject the required polyfill. in most cases, you can safely use modern ecmascript features without worrying about compatibility issues.\n\nafter setting the browserslist, if you still encountered some compatibility issues, please continue reading below contents to find some solutions.\n\n\n# background knowledge\n\nbefore dealing with compatibility issues, it is recommended that you understand the following background knowledge to better handle related issues.\n\n\n# syntax downgrade and api downgrade\n\nwhen you use higher-version syntax and api in your project, in order to make the compiled code run stably in lower-version browsers, we need to downgrade two parts: syntax downgrade and api downgrade.\n\nbuilder downgrades syntax through syntax transpilation, and downgrades api through inject polyfill.\n\n> grammar and api are not strongly bound. when browser manufacturers implement the engine, they will support some syntax or implement some apis in advance according to the specification or their own needs. therefore, browsers from different manufacturers in the same period are not necessarily compatible with syntax and api. so in general practice, syntax and api are handled in two parts.\n\n\n# syntax transpilation\n\nsyntax is a series of rules for how a programming language organizes code, and code that does not follow these rules cannot be correctly recognized by the programming language's engine and therefore cannot be run. in javascript, the following examples are syntax rules:\n\n * in const foo = 1, const means to declare an immutable constant.\n * in foo?.bar?.baz, ?. indicates optional chaining of access properties.\n * in async function () {}, async means to declare an asynchronous function.\n\nbecause the parsers of different browsers can support different syntax, especially the old version of the browser engine can support less grammar, so when some syntax are run in the lower version of the browser engine, an error will be reported at the stage of parsing the ast .\n\nfor example, the following code will report an error in ie browser or a lower version of node.js:\n\nconst foo = {};\nfoo?.bar();\n\n\nwhen we run this code in a low version of node.js, the following error message will appear:\n\nsyntaxerror: unexpected token.\n   at object.exports.runinthiscontext (vm.js:73:16)\n   at object.<anonymous> ([eval]-wrapper:6:22)\n   at module._compile (module.js:460:26)\n   at evalscript (node.js:431:25)\n   at startup (node.js:90:7)\n   at node.js:814:3\n\n\nit is obvious from the error message that this is a syntax error. this means that this syntax is not supported in lower versions of the engine.\n\nsyntax can not be supported by polyfill or shim. if you want to run some syntax that it does not originally support in a low-version browser, you need to transpile the code into a syntax that the low-version engine can support.\n\ntranspile the above code into the following code to run in lower version engines:\n\nvar foo = {};\nfoo === null || foo === void 0 ? void 0 : foo.bar();\n\n\nafter transpilation, the syntax of the code has changed, and some syntax that the engine of the lower version cannot understand has been replaced with the syntax it can understand, but the meaning of the code itself has not changed.\n\nif the engine encounters an unrecognized syntax when converting to ast, it will report a syntax error and abort the code execution process. in this case, if your project does not use capabilities such as ssr or ssg, the page will be blank, making the page unavailable.\n\nif the code is successfully converted to ast, the engine will convert the ast into executable code and execute it normally inside the engine.\n\n\n# api polyfill\n\njavascript is an interpreted scripting language, unlike compiled languages like rust. rust will check the calls in the code during the compilation phase, and javascript does not know whether the function called by this line of code exists before it actually runs to a certain line of code, so some errors will only appear at runtime.\n\nfor example:\n\nvar str = 'hello world!';\nconsole.log(str.notexistedmethod());\n\n\nthe above code has correct syntax and can be converted to ast correctly in the first stage of the engine runtime, but when it is actually running, because the method notexistedmethod does not exist on string.prototype, an error will be reported:\n\nuncaught typeerror: str.notexistedmethod is not a function\n   at <anonymous>:2:17\n\n\nwith the iteration of ecmascript, some new methods will be added to be built-in objects. for example, string.prototype.replaceall was introduced in es2021, then the replaceall method does not exist in the built-in object string.prototype of most browser engines before 2021, so the following code works in the latest chrome, but not in earlier versions:\n\n'abc'.replaceall('abc', 'xyz');\n\n\nin order to solve the problem that string.prototype lacks replaceall in older browsers, we can extend the string.prototype object in older browsers and add the replaceall method to it, for example:\n\n// the implementation of this polyfill does not necessarily conform to the standard, it is only used as an example.\nif (!string.prototype.replaceall) {\n  string.prototype.replaceall = function (str, newstr) {\n    // if a regex pattern\n    if (\n      object.prototype.tostring.call(str).tolowercase() === '[object regexp]'\n    ) {\n      return this.replace(str, newstr);\n    }\n    // if a string\n    return this.replace(new regexp(str, 'g'), newstr);\n  };\n}\n\n\n> this technique of providing implementations for legacy environments to align new apis is called polyfill.\n\n\n# downgrade method\n\nin builder, we divide code into three categories:\n\n * the first category is the source code in the current project.\n * the second category is third-party dependencies installed through npm.\n * the third category is the code out of the current project, such as the code in other directories in the monorepo.\n\nby default, builder will only compile and downgrade the first category, other categories will not be downgraded by default.\n\nthere are several considerations for this approach:\n\n * downgrading all third-party party dependencies will significantly reduce build performance.\n * most third-party dependencies have been downgraded before release, and the second downgrade may introduce new problems.\n * the code out of the current project may have been compiled, or the compilation config may be different.\n\n\n# downgrade the current project code\n\nthe code of the current project will be downgraded by default, so you don't need to add additional config, just make sure that the browserslist config is set correctly.\n\n\n# downgrade third-party dependencies\n\nwhen you find that a third-party dependencies causes compatibility issues, you can add this dependency to builder's source.include config, make builder do extra compilation for this dependency.\n\ntaking the npm package query-string as an example, you can add the following config:\n\nimport path from 'path';\n\nexport default {\n  source: {\n    include: [\n      // method 1:\n      // first get the path of the module by require.resolve\n      // then pass path.dirname to point to the corresponding directory\n      path.dirname(require.resolve('query-string')),\n      // method 2:\n      // match by regular expression\n      // all paths containing `/query-string/` will be matched\n      /\\/query-string\\//,\n    ],\n  },\n};\n\n\nnote that this config will only compile the code of query-string itself, not the sub-dependencies of query-string. if you need to compile a sub-dependency of query-string, you need to add the corresponding npm package to source.include.\n\n\n# downgrade the code out of the current project\n\nwhen you import the code out of the current project, if the code has not been compiled, then you also need to configure source.include to it to compile.\n\nfor example, if you need to reference a module under the packages directory in the monorepo, you can add the following config:\n\nimport path from 'path';\n\nexport default {\n  source: {\n    include: [\n      // method one:\n      // compile all files in the package directory of monorepo\n      path.resolve(__dirname, '../../packages'),\n\n      // method two:\n      // compile the source code of a package in the monorepo's package directory\n      // the matching range of this writing method is more precise, and has less impact on the overall compilation performance\n      path.resolve(__dirname, '../../packages/xxx/src'),\n    ],\n  },\n};\n\n\n\n# polyfill mode\n\nbuilder compiles javascript code through babel or swc, and injects polyfill libraries like core-js, @babel/runtime and @swc/helpers.\n\nin different usage scenarios, you may need different polyfill solutions. builder provides output.polyfill config to switch between different polyfill modes.\n\n\n# entry mode\n\nentry is the default mode and does not need to be set manually.\n\nwhen using the entry mode, builder will analyze which core-js methods need to be injected according to the browserslist set by the current project, and inject them to the entry file of each page. the polyfill injected in this way is more comprehensive, and there is no need to worry about the project source code and third-party dependencies polyfill issues. however, because some unused polyfill codes are included, the bundle size may increase.\n\nthe config of entry mode is:\n\nexport default {\n  output: {\n    polyfill: 'entry',\n  },\n};\n\n\n\n# usage mode\n\nthe usage mode allows more precise control over which core-js polyfills need to be injected.\n\nwhen you enable the usage mode, builder will analyze the source code in the project and determine which polyfills need to be injected.\n\nfor example, the code uses the map object:\n\nvar b = new map();\n\n\nafter compilation, only the polyfills for map will be injected into this file:\n\nimport 'core-js/modules/es.map';\nvar b = new map();\n\n\nthe advantage of this method is that the size of the injected polyfill is smaller, which is suitable for projects with higher requirements on bundle size. the disadvantage is that polyfill may not be fully injected, because third-party dependencies will not be compiled and downgraded by default, so the polyfill required by third-party dependencies will not be analyzed. if you need to analyze a third-party dependency, you also need to add it to source.include config.\n\nthe config of usage mode is:\n\nexport default {\n  output: {\n    polyfill: 'usage',\n  },\n};\n\n\n\n# disable polyfill\n\nyou can disable polyfill injection behavior by setting output.polyfill to 'off'.\n\nexport default {\n  output: {\n    polyfill: 'off',\n  },\n};\n\n\nwhen using this config, you need to ensure compatibility by yourself, such as manually import the required polyfill code through source.preentry.",charsets:{cjk:!0}},{title:"Browserslist",frontmatter:{},regularPath:"/en/guide/advanced/browserslist.html",relativePath:"en/guide/advanced/browserslist.md",key:"v-18a6139e",path:"/en/guide/advanced/browserslist.html",headers:[{level:2,title:"What is Browserslist",slug:"what-is-browserslist",normalizedTitle:"what is browserslist",charIndex:127},{level:2,title:"Set Browserslist",slug:"set-browserslist",normalizedTitle:"set browserslist",charIndex:1757},{level:2,title:"Commonly used Browserslist",slug:"commonly-used-browserslist",normalizedTitle:"commonly used browserslist",charIndex:3228},{level:2,title:"Default Browserslist",slug:"default-browserslist",normalizedTitle:"default browserslist",charIndex:4493},{level:2,title:"Query browser support",slug:"query-browser-support",normalizedTitle:"query browser support",charIndex:5327}],lastUpdated:"12/22/2022, 2:47:08 AM",lastUpdatedTimestamp:1671677228e3,headersStr:"What is Browserslist Set Browserslist Commonly used Browserslist Default Browserslist Query browser support",content:"# Browserslist\n\nBuilder supports using Browserslist to specify which browsers should be supported in your Web application.\n\n\n# What is Browserslist\n\nSince different browsers support ECMAScript and CSS differently, developers need to set the correct browser range for web applications.\n\nBrowserslist can specify which browsers your web application can run in, it provides a configuration for specifying browsers range. Browserslist has become a standard in the industry, it is used by libraries such as Autoprefixer, Babel, ESLint, PostCSS, SWC and Webpack.\n\nWhen you specify a browser range through Browserslist, Builder will compile JavaScript and CSS code to the specified syntax, and inject the corresponding polyfill code. When you only need to be compatible with modern browsers, the compilation process will introduce less compatible code and polyfills, and the performance of the page will be better.\n\nFor example, when you need to be compatible with IE11 browser, Builder will compile the code to ES5 and inject the polyfill required by IE11 through core-js.\n\nWhat is polyfill\n\nA polyfill is a piece of code that provides the functionality of a newer feature to older browsers that do not support that feature natively. It is used to fill in the gaps in older browsers' implementations of web standards, allowing developers to use newer features safely without having to worry about whether or not they will work in older browsers. For example, if a browser does not support the Array.map() method, a polyfill can be used to provide that functionality, allowing code that uses Array.prototype.flat() to work in that browser. Polyfills are commonly used to ensure that web applications can work on a wide range of browsers, including older ones.\n\n\n# Set Browserslist\n\nYou can set the Browserslist value in the package.json or .browserslistrc file in the root directory of the current project.\n\n\n# Example\n\nSet via browserslist in package.json:\n\n{\n  \"browserslist\": [\n    \"iOS 9\",\n    \"Android 4.4\",\n    \"last 2 versions\",\n    \"> 0.2%\",\n    \"not dead\"\n  ]\n}\n\n\nSet via a separate .browserslistrc file:\n\niOS 9\nAndroid 4.4\nlast 2 versions\n> 0.2%\nnot dead\n\n\n\n# Use output.overrideBrowserslist config\n\nIn addition to the above standard usage, Builder also provides output.overrideBrowserslist config, which can also set the value of Browserslist.\n\nexport default {\n  output: {\n    overrideBrowserslist: [\n      'iOS 9',\n      'Android 4.4',\n      'last 2 versions',\n      '> 0.2%',\n      'not dead',\n    ],\n  },\n};\n\n\nWhen you build multiple targets at the same time, you can set different browser ranges for different targets. At this point, you need to set overrideBrowserslist to an object whose key is the corresponding build target.\n\nFor example to set different ranges for web and node:\n\nexport default {\n  output: {\n    overrideBrowserslist: {\n      web: ['iOS 9', 'Android 4.4', 'last 2 versions', '> 0.2%', 'not dead'],\n      node: ['node >= 14'],\n    },\n  },\n};\n\n\nIn most cases, it is recommended to use the .browserslistrc file rather than the overrideBrowserslist config. Because the .browserslistrc file is the official config file, it is more general and can be recognized by other libraries in the community.\n\n\n# Commonly used Browserslist\n\nThe following are some commonly used Browserslist, you can choose according to your project type.\n\n\n# Mobile H5 scene\n\nThe mobile H5 scene is mainly compatible with iOS and Android systems, usually we set Browserslist as:\n\niOS 9\nAndroid 4.4\nlast 2 versions\n0.2%\nnot dead\n\n\nThe above Browserslist will compile the code to the ES5 specification, which is compatible with most mobile scenarios on the market. For the detailed browsers list, please check browserslist.dev.\n\n\n\nYou can also choose to use the ES6 specification in the H5 scene, which will make the performance of the page better. The corresponding Browserslist is as follows:\n\niOS 10\nChrome 51\n> 0.2%\nnot dead\nnot op_mini all\n\n\n\n# Desktop PC scene\n\nIn the desktop PC scenario, if you need to be compatible with IE 11 browsers, you can set Browserslist to:\n\n> 0.5%\nnot dead\nInternet Explorer 11\n\n\nThe above Browserslist will compile the code to the ES5 specification. For the specific browser list, please check browserslist.dev.\n\nIf you don't need to be compatible with IE 11 browsers, you can adjust Browserslist to get a more performant output, such as setting it to browsers that supports native ES Modules:\n\nchrome > 61\nedge > 16\nfirefox > 60\nsafari > 11\nios_saf > 11\n\n\n\n# Default Browserslist\n\nBuilder will set different default values of Browserslist according to build target, but we recommend that you explicitly set Browserslist in your project, which will make the compatible scope of the project more clear.\n\n\n# Web Target\n\nThe default values of web target are as follows:\n\n> 0.01%\nnot dead\nnot op_mini all\n\n\nUnder this browser range, JavaScript code will be compiled to ES5 syntax.\n\n\n# Node Target\n\nNode target will be compatible with Node.js 14.0 by default.\n\nnode >= 14\n\n\n\n# Web Worker Target\n\nThe default Browserslist of the Web Worker target is consistent with the Web target.\n\n> 0.01%\nnot dead\nnot op_mini all\n\n\n\n# Modern Web Target\n\nModern Web target will be compatible with browsers that support native ES Modules by default.\n\nchrome > 61\nedge > 16\nfirefox > 60\nsafari > 11\nios_saf > 11\n\n\n\n# Query browser support\n\nWhen developing, we need to know the browser support of certain features or APIs. At this time, we can check on the caniuse website.\n\nFor example, we need to know the browser support of Promise, just enter Promise in caniuse, and you can see the following results:\n\n\n\nAs can be seen from the above table, Promise is natively supported in Chrome 33 and iOS 8, but not in IE 11.",normalizedContent:"# browserslist\n\nbuilder supports using browserslist to specify which browsers should be supported in your web application.\n\n\n# what is browserslist\n\nsince different browsers support ecmascript and css differently, developers need to set the correct browser range for web applications.\n\nbrowserslist can specify which browsers your web application can run in, it provides a configuration for specifying browsers range. browserslist has become a standard in the industry, it is used by libraries such as autoprefixer, babel, eslint, postcss, swc and webpack.\n\nwhen you specify a browser range through browserslist, builder will compile javascript and css code to the specified syntax, and inject the corresponding polyfill code. when you only need to be compatible with modern browsers, the compilation process will introduce less compatible code and polyfills, and the performance of the page will be better.\n\nfor example, when you need to be compatible with ie11 browser, builder will compile the code to es5 and inject the polyfill required by ie11 through core-js.\n\nwhat is polyfill\n\na polyfill is a piece of code that provides the functionality of a newer feature to older browsers that do not support that feature natively. it is used to fill in the gaps in older browsers' implementations of web standards, allowing developers to use newer features safely without having to worry about whether or not they will work in older browsers. for example, if a browser does not support the array.map() method, a polyfill can be used to provide that functionality, allowing code that uses array.prototype.flat() to work in that browser. polyfills are commonly used to ensure that web applications can work on a wide range of browsers, including older ones.\n\n\n# set browserslist\n\nyou can set the browserslist value in the package.json or .browserslistrc file in the root directory of the current project.\n\n\n# example\n\nset via browserslist in package.json:\n\n{\n  \"browserslist\": [\n    \"ios 9\",\n    \"android 4.4\",\n    \"last 2 versions\",\n    \"> 0.2%\",\n    \"not dead\"\n  ]\n}\n\n\nset via a separate .browserslistrc file:\n\nios 9\nandroid 4.4\nlast 2 versions\n> 0.2%\nnot dead\n\n\n\n# use output.overridebrowserslist config\n\nin addition to the above standard usage, builder also provides output.overridebrowserslist config, which can also set the value of browserslist.\n\nexport default {\n  output: {\n    overridebrowserslist: [\n      'ios 9',\n      'android 4.4',\n      'last 2 versions',\n      '> 0.2%',\n      'not dead',\n    ],\n  },\n};\n\n\nwhen you build multiple targets at the same time, you can set different browser ranges for different targets. at this point, you need to set overridebrowserslist to an object whose key is the corresponding build target.\n\nfor example to set different ranges for web and node:\n\nexport default {\n  output: {\n    overridebrowserslist: {\n      web: ['ios 9', 'android 4.4', 'last 2 versions', '> 0.2%', 'not dead'],\n      node: ['node >= 14'],\n    },\n  },\n};\n\n\nin most cases, it is recommended to use the .browserslistrc file rather than the overridebrowserslist config. because the .browserslistrc file is the official config file, it is more general and can be recognized by other libraries in the community.\n\n\n# commonly used browserslist\n\nthe following are some commonly used browserslist, you can choose according to your project type.\n\n\n# mobile h5 scene\n\nthe mobile h5 scene is mainly compatible with ios and android systems, usually we set browserslist as:\n\nios 9\nandroid 4.4\nlast 2 versions\n0.2%\nnot dead\n\n\nthe above browserslist will compile the code to the es5 specification, which is compatible with most mobile scenarios on the market. for the detailed browsers list, please check browserslist.dev.\n\n\n\nyou can also choose to use the es6 specification in the h5 scene, which will make the performance of the page better. the corresponding browserslist is as follows:\n\nios 10\nchrome 51\n> 0.2%\nnot dead\nnot op_mini all\n\n\n\n# desktop pc scene\n\nin the desktop pc scenario, if you need to be compatible with ie 11 browsers, you can set browserslist to:\n\n> 0.5%\nnot dead\ninternet explorer 11\n\n\nthe above browserslist will compile the code to the es5 specification. for the specific browser list, please check browserslist.dev.\n\nif you don't need to be compatible with ie 11 browsers, you can adjust browserslist to get a more performant output, such as setting it to browsers that supports native es modules:\n\nchrome > 61\nedge > 16\nfirefox > 60\nsafari > 11\nios_saf > 11\n\n\n\n# default browserslist\n\nbuilder will set different default values of browserslist according to build target, but we recommend that you explicitly set browserslist in your project, which will make the compatible scope of the project more clear.\n\n\n# web target\n\nthe default values of web target are as follows:\n\n> 0.01%\nnot dead\nnot op_mini all\n\n\nunder this browser range, javascript code will be compiled to es5 syntax.\n\n\n# node target\n\nnode target will be compatible with node.js 14.0 by default.\n\nnode >= 14\n\n\n\n# web worker target\n\nthe default browserslist of the web worker target is consistent with the web target.\n\n> 0.01%\nnot dead\nnot op_mini all\n\n\n\n# modern web target\n\nmodern web target will be compatible with browsers that support native es modules by default.\n\nchrome > 61\nedge > 16\nfirefox > 60\nsafari > 11\nios_saf > 11\n\n\n\n# query browser support\n\nwhen developing, we need to know the browser support of certain features or apis. at this time, we can check on the caniuse website.\n\nfor example, we need to know the browser support of promise, just enter promise in caniuse, and you can see the following results:\n\n\n\nas can be seen from the above table, promise is natively supported in chrome 33 and ios 8, but not in ie 11.",charsets:{}},{title:"Custom webpack config",frontmatter:{},regularPath:"/en/guide/advanced/custom-webpack-config.html",relativePath:"en/guide/advanced/custom-webpack-config.md",key:"v-d370d328",path:"/en/guide/advanced/custom-webpack-config.html",headers:[{level:2,title:"Modify the webpack configuration object",slug:"modify-the-webpack-configuration-object",normalizedTitle:"modify the webpack configuration object",charIndex:181},{level:2,title:"Using webpack-chain",slug:"using-webpack-chain",normalizedTitle:"using webpack-chain",charIndex:728},{level:2,title:"webpack-chain Basics",slug:"webpack-chain-basics",normalizedTitle:"webpack-chain basics",charIndex:1619},{level:2,title:"webpack-chain Demo",slug:"webpack-chain-demo",normalizedTitle:"webpack-chain demo",charIndex:3221}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Modify the webpack configuration object Using webpack-chain webpack-chain Basics webpack-chain Demo",content:"# Custom webpack config\n\nBuilder supports directly modifying webpack configuration objects, and also supports deep customization of webpack configuration through webpack-chain.\n\n\n# Modify the webpack configuration object\n\nYou can use tools.webpack to modify the webpack configuration object.\n\nexport default {\n  tools: {\n    webpack: (config, { env }) => {\n      if (env === 'development') {\n        config.devtool = 'cheap-module-eval-source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\nWhen to use\n\nWhen you only need to modify a small amount of webpack configuration, you can use tools.webpack. But if you need to modify the built-in webpack plugins or loaders of Builder, please use tools.webpackChain to modify.\n\n\n# Using webpack-chain\n\nwebpack-chain is a configuration modification tools that is different from modifying webpack configuration objects. Compared with modifying webpack configuration objects, webpack-chain not only supports chain calls, but also can modify built-in Rule or Plugin based on id.\n\n\n# tools.webpackChain config\n\nBuilder provides tools.webpackChain config to modify webpack-chain.\n\nThe value of tools.webpackChain is Function type, which receives two parameters:\n\n * The first parameter is the webpack-chain instance, you can use this instance to modify the default webpack config.\n * The second parameter is a utils collection, including env, isProd, CHAIN_ID, etc.\n\nHere's a basic example:\n\nexport default {\n  tools: {\n    webpackChain: (chain, { env }) => {\n      if (env === 'development') {\n        chain.devtool('cheap-module-eval-source-map');\n      }\n    },\n  },\n};\n\n\n\n# webpack-chain Basics\n\nBefore you start using webpack-chain to modify your webpack configuration, it is recommended that you understand some basics.\n\n\n# How does webpack-chain locate\n\nSimply put, webpack-chain requires users to set a unique id for each Rule, Loader, Plugin, and Minimizer. Through these ids, you can easily find the desired object from deeply nested webpack configuration object.\n\nBuilder exports all internally defined ids through the CHAIN_ID object, so you can use these exported ids to locate the Loader or Plugin you want to modify, without having to search through complex traversal in the webpack configuration object.\n\nFor example, to delete the built-in HTML plugin via CHAIN_ID.PLUGIN.HTML:\n\nexport default {\n  tools: {\n    webpackChain: (chain, { webpack, CHAIN_ID }) => {\n      //\n      chain.plugins.delete(CHAIN_ID.PLUGIN.HTML);\n    },\n  },\n};\n\n\n\n# webpack-chain id type\n\nThe CHAIN_ID object contains some ids, which have different meanings:\n\nCHAIN_ID FIELD            CORRESPONDING CONFIGURATION   DESCRIPTION\nCHAIN_ID.PLUGIN           plugins[i]                    corresponds to a plugin in the webpack configuration\nCHAIN_ID.RULE             module.rules[i]               corresponds to a Rule in the webpack configuration\nCHAIN_ID.USE              module.rules[i].loader        corresponds to a Loader in the webpack configuration\nCHAIN_ID.MINIMIZER        optimization.minimizer        corresponds to a compression tool in webpack configuration\nCHAIN_ID.RESOLVE_PLUGIN   resolve.plugins[i]            corresponds to a Resolve plugin in the webpack configuration\n\n\n# webpack-chain Demo\n\n\n# Add/Modify/Delete loader\n\nexport default {\n  tools: {\n    webpackChain: (chain, { CHAIN_ID }) => {\n      // Add loader\n      chain.module\n        .rule('md')\n        .test(/\\.md$/)\n        .use('md-loader')\n        .loader('md-loader');\n\n      // Modify loader\n      chain.module\n        .rule(CHAIN_ID.RULE.JS)\n        .use(CHAIN_ID.USE.BABEL)\n        .tap(options => {\n          options.plugins.push('babel-plugin-xxx');\n          return options;\n        });\n\n      // Delete loader\n      chain.module.rule(CHAIN_ID.RULE.JS).uses.delete(CHAIN_ID.USE.BABEL);\n    },\n  },\n};\n\n\n\n# Add/Modify/Delete plugin\n\nexport default {\n  tools: {\n    webpackChain: (chain, { webpack, CHAIN_ID }) => {\n      // Add plugin\n      chain.plugin('define').use(webpack.DefinePlugin, [\n        {\n          'process.env': {\n            NODE_ENV: JSON.stringify(process.env.NODE_ENV),\n          },\n        },\n      ]);\n\n      // Modify plugin\n      chain.plugin(CHAIN_ID.PLUGIN.HMR).tap(options => {\n        options[0].fullBuildTimeout = 200;\n        return options;\n      });\n\n      // Delete plugin\n      chain.plugins.delete(CHAIN_ID.PLUGIN.HMR);\n    },\n  },\n};\n\n\n\n# Modify the config according to environment\n\nIn the tool collection, you can get the flag of various environments, such as development/production/test environment, SSR build, and Web Worker build, so as to modify the config in different environments.\n\nexport default {\n  tools: {\n    webpackChain: (chain, { env, isProd, target, isServer, isWebWorker }) => {\n      if (utils.env === 'development' || utils.env === 'test') {\n        // ...\n      }\n      if (utils.isProd) {\n        // ...\n      }\n      if (utils.target === 'node') {\n        // ...\n      }\n      if (utils.isServer) {\n        // ...\n      }\n      if (utils.isWebWorker) {\n        // ...\n      }\n    },\n  },\n};\n\n\nThe above are some common config examples. For the complete webpack-chain API, please refer to webpack-chain documentation.",normalizedContent:"# custom webpack config\n\nbuilder supports directly modifying webpack configuration objects, and also supports deep customization of webpack configuration through webpack-chain.\n\n\n# modify the webpack configuration object\n\nyou can use tools.webpack to modify the webpack configuration object.\n\nexport default {\n  tools: {\n    webpack: (config, { env }) => {\n      if (env === 'development') {\n        config.devtool = 'cheap-module-eval-source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\nwhen to use\n\nwhen you only need to modify a small amount of webpack configuration, you can use tools.webpack. but if you need to modify the built-in webpack plugins or loaders of builder, please use tools.webpackchain to modify.\n\n\n# using webpack-chain\n\nwebpack-chain is a configuration modification tools that is different from modifying webpack configuration objects. compared with modifying webpack configuration objects, webpack-chain not only supports chain calls, but also can modify built-in rule or plugin based on id.\n\n\n# tools.webpackchain config\n\nbuilder provides tools.webpackchain config to modify webpack-chain.\n\nthe value of tools.webpackchain is function type, which receives two parameters:\n\n * the first parameter is the webpack-chain instance, you can use this instance to modify the default webpack config.\n * the second parameter is a utils collection, including env, isprod, chain_id, etc.\n\nhere's a basic example:\n\nexport default {\n  tools: {\n    webpackchain: (chain, { env }) => {\n      if (env === 'development') {\n        chain.devtool('cheap-module-eval-source-map');\n      }\n    },\n  },\n};\n\n\n\n# webpack-chain basics\n\nbefore you start using webpack-chain to modify your webpack configuration, it is recommended that you understand some basics.\n\n\n# how does webpack-chain locate\n\nsimply put, webpack-chain requires users to set a unique id for each rule, loader, plugin, and minimizer. through these ids, you can easily find the desired object from deeply nested webpack configuration object.\n\nbuilder exports all internally defined ids through the chain_id object, so you can use these exported ids to locate the loader or plugin you want to modify, without having to search through complex traversal in the webpack configuration object.\n\nfor example, to delete the built-in html plugin via chain_id.plugin.html:\n\nexport default {\n  tools: {\n    webpackchain: (chain, { webpack, chain_id }) => {\n      //\n      chain.plugins.delete(chain_id.plugin.html);\n    },\n  },\n};\n\n\n\n# webpack-chain id type\n\nthe chain_id object contains some ids, which have different meanings:\n\nchain_id field            corresponding configuration   description\nchain_id.plugin           plugins[i]                    corresponds to a plugin in the webpack configuration\nchain_id.rule             module.rules[i]               corresponds to a rule in the webpack configuration\nchain_id.use              module.rules[i].loader        corresponds to a loader in the webpack configuration\nchain_id.minimizer        optimization.minimizer        corresponds to a compression tool in webpack configuration\nchain_id.resolve_plugin   resolve.plugins[i]            corresponds to a resolve plugin in the webpack configuration\n\n\n# webpack-chain demo\n\n\n# add/modify/delete loader\n\nexport default {\n  tools: {\n    webpackchain: (chain, { chain_id }) => {\n      // add loader\n      chain.module\n        .rule('md')\n        .test(/\\.md$/)\n        .use('md-loader')\n        .loader('md-loader');\n\n      // modify loader\n      chain.module\n        .rule(chain_id.rule.js)\n        .use(chain_id.use.babel)\n        .tap(options => {\n          options.plugins.push('babel-plugin-xxx');\n          return options;\n        });\n\n      // delete loader\n      chain.module.rule(chain_id.rule.js).uses.delete(chain_id.use.babel);\n    },\n  },\n};\n\n\n\n# add/modify/delete plugin\n\nexport default {\n  tools: {\n    webpackchain: (chain, { webpack, chain_id }) => {\n      // add plugin\n      chain.plugin('define').use(webpack.defineplugin, [\n        {\n          'process.env': {\n            node_env: json.stringify(process.env.node_env),\n          },\n        },\n      ]);\n\n      // modify plugin\n      chain.plugin(chain_id.plugin.hmr).tap(options => {\n        options[0].fullbuildtimeout = 200;\n        return options;\n      });\n\n      // delete plugin\n      chain.plugins.delete(chain_id.plugin.hmr);\n    },\n  },\n};\n\n\n\n# modify the config according to environment\n\nin the tool collection, you can get the flag of various environments, such as development/production/test environment, ssr build, and web worker build, so as to modify the config in different environments.\n\nexport default {\n  tools: {\n    webpackchain: (chain, { env, isprod, target, isserver, iswebworker }) => {\n      if (utils.env === 'development' || utils.env === 'test') {\n        // ...\n      }\n      if (utils.isprod) {\n        // ...\n      }\n      if (utils.target === 'node') {\n        // ...\n      }\n      if (utils.isserver) {\n        // ...\n      }\n      if (utils.iswebworker) {\n        // ...\n      }\n    },\n  },\n};\n\n\nthe above are some common config examples. for the complete webpack-chain api, please refer to webpack-chain documentation.",charsets:{cjk:!0}},{title:"Environment Variables",frontmatter:{},regularPath:"/en/guide/advanced/define.html",relativePath:"en/guide/advanced/define.md",key:"v-2b1edeba",path:"/en/guide/advanced/define.html",headers:[{level:2,title:"Default environment variables",slug:"default-environment-variables",normalizedTitle:"default environment variables",charIndex:275},{level:2,title:"Setup Environment Variables",slug:"setup-environment-variables",normalizedTitle:"setup environment variables",charIndex:2476},{level:2,title:"Declare type of environment variable",slug:"declare-type-of-environment-variable",normalizedTitle:"declare type of environment variable",charIndex:3426},{level:2,title:"Tree Shaking",slug:"tree-shaking",normalizedTitle:"tree shaking",charIndex:3949},{level:2,title:"In-source testing",slug:"in-source-testing",normalizedTitle:"in-source testing",charIndex:5001}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Default environment variables Setup Environment Variables Declare type of environment variable Tree Shaking In-source testing",content:"# Environment Variables\n\nBuilder supports injecting environment variables or expressions into the code during compilation, which is helpful for distinguishing the running environment or injecting constant values. This chapter introduces how to use environment variables.\n\n\n# Default environment variables\n\nBy default, Builder will automatically set the process.env.NODE_ENV environment variable to 'development' in development mode and 'production' in production mode.\n\nYou can use process.env.NODE_ENV directly in configuration files and in front-end code.\n\nif (process.env.NODE_ENV === 'development') {\n  console.log('this is a development log');\n}\n\n\nIn the development environment, the above code will be compiled as:\n\nif (true) {\n  console.log('this is a development log');\n}\n\n\nIn the production environment, the above code will be compiled as:\n\nif (false) {\n  console.log('this is a development log');\n}\n\n\nAfter code minification, if (false) { ... } will be recognized as invalid code and removed automatically.\n\n\n# Using define config\n\nBy configuring the source.define, you can replace expressions with other expressions or values in compile time.\n\nDefine looks like macro definitions in other programming languages. But JavaScript has powerful runtime capabilities, so you don't need to use it as a complicated code generator. You can use it to pass simple data, such as environment variables, from compile time to runtime. Almost there, it can be used to work with Builder to shake trees.\n\n\n# Replace Expressions\n\nThe most basic use case for Define is to replace expressions in compile time.\n\nThe value of the environment variable NODE_ENV will change the behavior of many vendor packages. Usually, we need to set it to production.\n\nexport default {\n  source: {\n    define: {\n      'process.env.NODE_ENV': JSON.stringify(process.env.NODE_ENV),\n    },\n  },\n};\n\n\nNote that the value provided here must be a JSON string, e.g. process.env.NODE_ENV with a value of \"production\" should be passed in as \"\\\"production\\\"\" to be processed correctly.\n\nSimilarly { foo: \"bar\" } should be converted to \"{\\\"foo\\\":\\\"bar\\\"}\", which if passed directly into the original object would mean replacing the expression process.env.NODE_ENV.foo with the identifier bar.\n\nFor more about source.define, just refer to API References。\n\nTIP\n\nThe environment variable NODE_ENV shown in the example above is already injected by the Builder, and you usually do not need to configure it manually.\n\n\n# Setup Environment Variables\n\nYou may often need to set environment variables, in which case you can instead use the source.globalVars configuration to simplify configuration. It is a syntax sugar of source.define, the only difference is that source.globalVars will automatically stringify the value, which makes it easier to set the value of global variables and avoid writing a lot of JSON.stringify(...) stuffs.\n\nexport default {\n  source: {\n    globalVars: {\n      'process.env.NODE_ENV': 'production',\n      'import.meta.foo': { bar: 42 },\n      'import.meta.baz': false,\n    },\n  },\n};\n\n\nNote that either of these methods will only match the full expression; destructing the expression will prevent the Builder from correctly recognizing it.\n\nconsole.log(process.env.NODE_ENV);\n// => production\n\nconst { NODE_ENV } = process.env;\nconsole.log(NODE_ENV);\n// => undefined\n\nconst vars = process.env;\nconsole.log(vars.NODE_ENV);\n// => undefined\n\n\n\n# Declare type of environment variable\n\nWhen you read an environment variable in a TypeScript file, TypeScript may prompt that the variable lacks a type definition, and you need to add the corresponding type declaration.\n\nFor example, if you reference a CUSTOM_VAR variable, the following prompt will appear in the TypeScript file:\n\nTS2304: Cannot find name 'CUSTOM_VAR'.\n\n\nTo fix this, you can create a src/env.d.ts file in your project and add the following content:\n\n// src/env.d.ts\ndeclare const CUSTOM_VAR: string;\n\n\n\n# Tree Shaking\n\nDefine can also be used to mark dead code to assist the Builder with Tree Shaking optimization.\n\nBuilding products for different regions is achieved by replacing process.env.REGION with a specific value, for example.\n\nexport default {\n  source: {\n    define: {\n      'process.env.REGION': JSON.stringify(process.env.REGION),\n    },\n    // or...\n    globalVars: {\n      'process.env.REGION': process.env.REGION,\n    },\n  },\n};\n\n\nFor an internationalized app:\n\nconst App = () => {\n  if (process.env.REGION === 'cn') {\n    return <EntryFoo />;\n  } else if (process.env.REGION === 'sg') {\n    return <EntryBar />;\n  } else {\n    return <EntryBaz />;\n  }\n};\n\n\nSpecifying the environment variable REGION=sg and then executing build will eliminate any dead code.\n\nconst App = () => {\n  if (false) {\n  } else if (true) {\n    return <EntryBar />;\n  } else {\n  }\n};\n\n\nUnused components are not packaged into the product, and their external dependencies can be optimized accordingly, resulting in a destination with better size and performance.\n\n\n# In-source testing\n\nVitest supports writing tests inside source files to test the behavior of private features without exporting them. Set up Define to remove the test code from the production build. Please refer to the Vitest's documentation for detailed guidelines\n\n// the implementation\nfunction add(...args) {\n  return args.reduce((a, b) => a + b, 0);\n}\n\n// in-source test suites\nif (import.meta.vitest) {\n  const { it, expect } = import.meta.vitest;\n  it('add', () => {\n    expect(add()).toBe(0);\n    expect(add(1)).toBe(1);\n    expect(add(1, 2, 3)).toBe(6);\n  });\n}\n",normalizedContent:"# environment variables\n\nbuilder supports injecting environment variables or expressions into the code during compilation, which is helpful for distinguishing the running environment or injecting constant values. this chapter introduces how to use environment variables.\n\n\n# default environment variables\n\nby default, builder will automatically set the process.env.node_env environment variable to 'development' in development mode and 'production' in production mode.\n\nyou can use process.env.node_env directly in configuration files and in front-end code.\n\nif (process.env.node_env === 'development') {\n  console.log('this is a development log');\n}\n\n\nin the development environment, the above code will be compiled as:\n\nif (true) {\n  console.log('this is a development log');\n}\n\n\nin the production environment, the above code will be compiled as:\n\nif (false) {\n  console.log('this is a development log');\n}\n\n\nafter code minification, if (false) { ... } will be recognized as invalid code and removed automatically.\n\n\n# using define config\n\nby configuring the source.define, you can replace expressions with other expressions or values in compile time.\n\ndefine looks like macro definitions in other programming languages. but javascript has powerful runtime capabilities, so you don't need to use it as a complicated code generator. you can use it to pass simple data, such as environment variables, from compile time to runtime. almost there, it can be used to work with builder to shake trees.\n\n\n# replace expressions\n\nthe most basic use case for define is to replace expressions in compile time.\n\nthe value of the environment variable node_env will change the behavior of many vendor packages. usually, we need to set it to production.\n\nexport default {\n  source: {\n    define: {\n      'process.env.node_env': json.stringify(process.env.node_env),\n    },\n  },\n};\n\n\nnote that the value provided here must be a json string, e.g. process.env.node_env with a value of \"production\" should be passed in as \"\\\"production\\\"\" to be processed correctly.\n\nsimilarly { foo: \"bar\" } should be converted to \"{\\\"foo\\\":\\\"bar\\\"}\", which if passed directly into the original object would mean replacing the expression process.env.node_env.foo with the identifier bar.\n\nfor more about source.define, just refer to api references。\n\ntip\n\nthe environment variable node_env shown in the example above is already injected by the builder, and you usually do not need to configure it manually.\n\n\n# setup environment variables\n\nyou may often need to set environment variables, in which case you can instead use the source.globalvars configuration to simplify configuration. it is a syntax sugar of source.define, the only difference is that source.globalvars will automatically stringify the value, which makes it easier to set the value of global variables and avoid writing a lot of json.stringify(...) stuffs.\n\nexport default {\n  source: {\n    globalvars: {\n      'process.env.node_env': 'production',\n      'import.meta.foo': { bar: 42 },\n      'import.meta.baz': false,\n    },\n  },\n};\n\n\nnote that either of these methods will only match the full expression; destructing the expression will prevent the builder from correctly recognizing it.\n\nconsole.log(process.env.node_env);\n// => production\n\nconst { node_env } = process.env;\nconsole.log(node_env);\n// => undefined\n\nconst vars = process.env;\nconsole.log(vars.node_env);\n// => undefined\n\n\n\n# declare type of environment variable\n\nwhen you read an environment variable in a typescript file, typescript may prompt that the variable lacks a type definition, and you need to add the corresponding type declaration.\n\nfor example, if you reference a custom_var variable, the following prompt will appear in the typescript file:\n\nts2304: cannot find name 'custom_var'.\n\n\nto fix this, you can create a src/env.d.ts file in your project and add the following content:\n\n// src/env.d.ts\ndeclare const custom_var: string;\n\n\n\n# tree shaking\n\ndefine can also be used to mark dead code to assist the builder with tree shaking optimization.\n\nbuilding products for different regions is achieved by replacing process.env.region with a specific value, for example.\n\nexport default {\n  source: {\n    define: {\n      'process.env.region': json.stringify(process.env.region),\n    },\n    // or...\n    globalvars: {\n      'process.env.region': process.env.region,\n    },\n  },\n};\n\n\nfor an internationalized app:\n\nconst app = () => {\n  if (process.env.region === 'cn') {\n    return <entryfoo />;\n  } else if (process.env.region === 'sg') {\n    return <entrybar />;\n  } else {\n    return <entrybaz />;\n  }\n};\n\n\nspecifying the environment variable region=sg and then executing build will eliminate any dead code.\n\nconst app = () => {\n  if (false) {\n  } else if (true) {\n    return <entrybar />;\n  } else {\n  }\n};\n\n\nunused components are not packaged into the product, and their external dependencies can be optimized accordingly, resulting in a destination with better size and performance.\n\n\n# in-source testing\n\nvitest supports writing tests inside source files to test the behavior of private features without exporting them. set up define to remove the test code from the production build. please refer to the vitest's documentation for detailed guidelines\n\n// the implementation\nfunction add(...args) {\n  return args.reduce((a, b) => a + b, 0);\n}\n\n// in-source test suites\nif (import.meta.vitest) {\n  const { it, expect } = import.meta.vitest;\n  it('add', () => {\n    expect(add()).tobe(0);\n    expect(add(1)).tobe(1);\n    expect(add(1, 2, 3)).tobe(6);\n  });\n}\n",charsets:{}},{title:"Hot Module Replacement",frontmatter:{},regularPath:"/en/guide/advanced/hmr.html",relativePath:"en/guide/advanced/hmr.md",key:"v-32ec190c",path:"/en/guide/advanced/hmr.html",headers:[{level:2,title:"Enabling HMR",slug:"enabling-hmr",normalizedTitle:"enabling hmr",charIndex:515},{level:2,title:"Specify HMR URL",slug:"specify-hmr-url",normalizedTitle:"specify hmr url",charIndex:770},{level:2,title:"Live reloading vs Hot reloading",slug:"live-reloading-vs-hot-reloading",normalizedTitle:"live reloading vs hot reloading",charIndex:1153},{level:2,title:"FAQ",slug:"faq",normalizedTitle:"faq",charIndex:1826}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Enabling HMR Specify HMR URL Live reloading vs Hot reloading FAQ",content:"# Hot Module Replacement\n\nHot Module Replacement (HMR) exchanges, adds, or removes modules while an application is running, without a full reload. This can significantly speed up development in a few ways:\n\n * Retain application state which is lost during a full reload.\n * Save valuable development time by only updating what's changed.\n * Instantly update the browser when modifications are made to CSS/JS in the source code, which is almost comparable to changing styles directly in the browser's dev tools.\n\n\n# Enabling HMR\n\nBuilder has built-in support for HMR. By default, HMR is enabled in development.\n\nBy setting dev.hmr to false, HMR can be disabled, which the HMR and react-refresh will no longer work.\n\nexport default {\n  dev: {\n    hmr: false,\n  },\n};\n\n\n\n# Specify HMR URL\n\nBy default, builder get HMR client URL by local-ip and current port.\n\nIn the event of a connection failure you can specify an available URL by custom configuration.\n\nFor example, set HMR client and port empty to auto derived from browser:\n\nexport default {\n  tools: {\n    devServer: {\n      client: {\n        host: '',\n        port: '',\n      },\n    },\n  },\n};\n\n\n\n# Live reloading vs Hot reloading\n\n * Live reloading: After modifying the file, webpack recompiles and forces a browser refresh, which is a global (application-wide) refresh, equivalent to window.location.reload().\n * Hot reloading: After modifying the file, webpack recompiles the corresponding module and remembers the state of the application when it is refreshed, thus enabling a partial refresh, i.e. hot update.\n\nDevServer provides two configuration items, hot and liveReload, to control how updates are made. When both hot and liveReload are open, DevServer will attempt to use hot mode (HMR) first, and will degrade to reloading the page if the HMR update fails.\n\n\n# FAQ\n\n\n# HMR not work when external react/reactDom?\n\nHMR work requires the development mode of react & react-dom. The cdn version of react normally used the production mode. You need to switch to development mode or make it not external when development.\n\nIf you're not sure which React mode you're using, you can see: Check React Mode\n\n\n# HMR not work when use https?\n\nWhen https is enabled, the HMR perhaps connection fail due to a certificate issue, and if you open the console, you will get an HMR connect failed error.\n\n\n\nThe solution to this problem is to click on \"Advanced\" -> \"Proceed to xxx (unsafe)\" on the Chrome problem page.\n\n\n\n> Tips: When accessing the page through Localhost, the words \"Your connection is not private\" may not appear and can be handled by visiting the Network domain.\n\n\n# React component state lost after HMR?\n\nBuilder uses React's official Fast Refresh capability for component hot update.\n\nWhen using Fast Refresh, it is required that the component cannot be an anonymous function, otherwise the state of the React component cannot be preserved after hot update.\n\nThe following spellings are incorrect:\n\n// wrong spelling 1\nexport default function () {\n  return <div>Hello World</div>;\n}\n\n// wrong spelling 2\nexport default () => <div>Hello World</div>;\n\n\nThe correct spelling is:\n\n// Correct spelling 1\nexport default function MyComponent() {\n  return <div>Hello World</div>;\n}\n\n// Correct spelling 2\nconst MyComponent = () => <div>Hello World</div>\n\nexport default MyComponent;\n",normalizedContent:"# hot module replacement\n\nhot module replacement (hmr) exchanges, adds, or removes modules while an application is running, without a full reload. this can significantly speed up development in a few ways:\n\n * retain application state which is lost during a full reload.\n * save valuable development time by only updating what's changed.\n * instantly update the browser when modifications are made to css/js in the source code, which is almost comparable to changing styles directly in the browser's dev tools.\n\n\n# enabling hmr\n\nbuilder has built-in support for hmr. by default, hmr is enabled in development.\n\nby setting dev.hmr to false, hmr can be disabled, which the hmr and react-refresh will no longer work.\n\nexport default {\n  dev: {\n    hmr: false,\n  },\n};\n\n\n\n# specify hmr url\n\nby default, builder get hmr client url by local-ip and current port.\n\nin the event of a connection failure you can specify an available url by custom configuration.\n\nfor example, set hmr client and port empty to auto derived from browser:\n\nexport default {\n  tools: {\n    devserver: {\n      client: {\n        host: '',\n        port: '',\n      },\n    },\n  },\n};\n\n\n\n# live reloading vs hot reloading\n\n * live reloading: after modifying the file, webpack recompiles and forces a browser refresh, which is a global (application-wide) refresh, equivalent to window.location.reload().\n * hot reloading: after modifying the file, webpack recompiles the corresponding module and remembers the state of the application when it is refreshed, thus enabling a partial refresh, i.e. hot update.\n\ndevserver provides two configuration items, hot and livereload, to control how updates are made. when both hot and livereload are open, devserver will attempt to use hot mode (hmr) first, and will degrade to reloading the page if the hmr update fails.\n\n\n# faq\n\n\n# hmr not work when external react/reactdom?\n\nhmr work requires the development mode of react & react-dom. the cdn version of react normally used the production mode. you need to switch to development mode or make it not external when development.\n\nif you're not sure which react mode you're using, you can see: check react mode\n\n\n# hmr not work when use https?\n\nwhen https is enabled, the hmr perhaps connection fail due to a certificate issue, and if you open the console, you will get an hmr connect failed error.\n\n\n\nthe solution to this problem is to click on \"advanced\" -> \"proceed to xxx (unsafe)\" on the chrome problem page.\n\n\n\n> tips: when accessing the page through localhost, the words \"your connection is not private\" may not appear and can be handled by visiting the network domain.\n\n\n# react component state lost after hmr?\n\nbuilder uses react's official fast refresh capability for component hot update.\n\nwhen using fast refresh, it is required that the component cannot be an anonymous function, otherwise the state of the react component cannot be preserved after hot update.\n\nthe following spellings are incorrect:\n\n// wrong spelling 1\nexport default function () {\n  return <div>hello world</div>;\n}\n\n// wrong spelling 2\nexport default () => <div>hello world</div>;\n\n\nthe correct spelling is:\n\n// correct spelling 1\nexport default function mycomponent() {\n  return <div>hello world</div>;\n}\n\n// correct spelling 2\nconst mycomponent = () => <div>hello world</div>\n\nexport default mycomponent;\n",charsets:{}},{title:"REM adaptation",frontmatter:{},regularPath:"/en/guide/advanced/rem.html",relativePath:"en/guide/advanced/rem.md",key:"v-5b459728",path:"/en/guide/advanced/rem.html",headers:[{level:2,title:"Enabling REM adaptability",slug:"enabling-rem-adaptability",normalizedTitle:"enabling rem adaptability",charIndex:225},{level:2,title:"CSS conversion properties",slug:"css-conversion-properties",normalizedTitle:"css conversion properties",charIndex:475},{level:2,title:"Setting the page rootFontSize",slug:"setting-the-page-rootfontsize",normalizedTitle:"setting the page rootfontsize",charIndex:1124},{level:2,title:"Customize maxRootFontSize",slug:"customize-maxrootfontsize",normalizedTitle:"customize maxrootfontsize",charIndex:1725}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Enabling REM adaptability CSS conversion properties Setting the page rootFontSize Customize maxRootFontSize",content:"# REM adaptation\n\nBuilder supports REM adaptation via output.convertToRem, which can dynamically adjusts the font size according to the screen size, so that the page will be displayed correctly on different screen sizes.\n\n\n# Enabling REM adaptability\n\nBy setting output.convertToRem, the Builder can do the following things:\n\n * Convert px to rem in CSS.\n * Dynamic setting the fontSize of the root element.\n\nexport default {\n  output: {\n    convertToRem: true,\n  },\n};\n\n\n\n# CSS conversion properties\n\nBy default, rootFontSize is 50. So the CSS styles value are converted according to the ratio of 1rem : 50px.\n\n/* input */\nh1 {\n  margin: 0 0 16px;\n  font-size: 32px;\n  line-height: 1.2;\n  letter-spacing: 1px;\n}\n\n/* output */\nh1 {\n  margin: 0 0 0.32rem;\n  font-size: 0.64rem;\n  line-height: 1.2;\n  letter-spacing: 0.02rem;\n}\n\n\nBy default, builder converts all CSS properties from px to rem. If you want to convert only the font-size property, you can setting pxtorem.propList is ['font-size'].\n\nexport default {\n  output: {\n    convertToRem: {\n      pxtorem: {\n        propList: ['font-size'],\n      },\n    },\n  },\n};\n\n\n\n# Setting the page rootFontSize\n\nThe formula for calculating the font size of the page root element is:\n\npageRootFontSize = clientWidth * rootFontSize / screenWidth\n\n\nIn a mobile browser with a screen width of 390, the default value for rootFontSize is 50 and the screenWidth of the UI design is 375.\n\nThe calculated font size for the root element of the page is 52 (390 * 50 / 375).\n\nAt this point, 1 rem is 52px, 32px（0.64 rem） in the CSS style, the actual size in page is 33.28 px.\n\nexport default {\n  output: {\n    convertToRem: {\n      rootFontSize: 50,\n      screenWidth: 375,\n    },\n  },\n};\n\n\n\n# Customize maxRootFontSize\n\nIn the desktop browser, the page rootFontSize obtained from the calculation formula is often too large. When the calculated result large than the maxRootFontSize, the maxRootFontSize will used as the page rootFontSize.\n\nIn the desktop browser with a screen width of 1920, the calculated rootFontSize is 349, which exceeds the default maxRootFontSize of 64. 64 is used as the current root element font value.\n\nexport default {\n  output: {\n    convertToRem: {\n      maxRootFontSize: 64,\n    },\n  },\n};\n",normalizedContent:"# rem adaptation\n\nbuilder supports rem adaptation via output.converttorem, which can dynamically adjusts the font size according to the screen size, so that the page will be displayed correctly on different screen sizes.\n\n\n# enabling rem adaptability\n\nby setting output.converttorem, the builder can do the following things:\n\n * convert px to rem in css.\n * dynamic setting the fontsize of the root element.\n\nexport default {\n  output: {\n    converttorem: true,\n  },\n};\n\n\n\n# css conversion properties\n\nby default, rootfontsize is 50. so the css styles value are converted according to the ratio of 1rem : 50px.\n\n/* input */\nh1 {\n  margin: 0 0 16px;\n  font-size: 32px;\n  line-height: 1.2;\n  letter-spacing: 1px;\n}\n\n/* output */\nh1 {\n  margin: 0 0 0.32rem;\n  font-size: 0.64rem;\n  line-height: 1.2;\n  letter-spacing: 0.02rem;\n}\n\n\nby default, builder converts all css properties from px to rem. if you want to convert only the font-size property, you can setting pxtorem.proplist is ['font-size'].\n\nexport default {\n  output: {\n    converttorem: {\n      pxtorem: {\n        proplist: ['font-size'],\n      },\n    },\n  },\n};\n\n\n\n# setting the page rootfontsize\n\nthe formula for calculating the font size of the page root element is:\n\npagerootfontsize = clientwidth * rootfontsize / screenwidth\n\n\nin a mobile browser with a screen width of 390, the default value for rootfontsize is 50 and the screenwidth of the ui design is 375.\n\nthe calculated font size for the root element of the page is 52 (390 * 50 / 375).\n\nat this point, 1 rem is 52px, 32px（0.64 rem） in the css style, the actual size in page is 33.28 px.\n\nexport default {\n  output: {\n    converttorem: {\n      rootfontsize: 50,\n      screenwidth: 375,\n    },\n  },\n};\n\n\n\n# customize maxrootfontsize\n\nin the desktop browser, the page rootfontsize obtained from the calculation formula is often too large. when the calculated result large than the maxrootfontsize, the maxrootfontsize will used as the page rootfontsize.\n\nin the desktop browser with a screen width of 1920, the calculated rootfontsize is 349, which exceeds the default maxrootfontsize of 64. 64 is used as the current root element font value.\n\nexport default {\n  output: {\n    converttorem: {\n      maxrootfontsize: 64,\n    },\n  },\n};\n",charsets:{}},{title:"Build Target",frontmatter:{},regularPath:"/en/guide/basic/build-target.html",relativePath:"en/guide/basic/build-target.md",key:"v-2678376c",path:"/en/guide/basic/build-target.html",headers:[{level:2,title:"Default Target",slug:"default-target",normalizedTitle:"default target",charIndex:379},{level:2,title:"Optional Targets",slug:"optional-targets",normalizedTitle:"optional targets",charIndex:591},{level:2,title:"Multiple Targets",slug:"multiple-targets",normalizedTitle:"multiple targets",charIndex:964},{level:2,title:"Node Target",slug:"node-target",normalizedTitle:"node target",charIndex:1255},{level:2,title:"Web Worker Target",slug:"web-worker-target",normalizedTitle:"web worker target",charIndex:2079},{level:2,title:"Modern Web Target",slug:"modern-web-target",normalizedTitle:"modern web target",charIndex:3106}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Default Target Optional Targets Multiple Targets Node Target Web Worker Target Modern Web Target",content:"# Build Target\n\nBuilder supports build multiple target types for running in different target environments. After setting the correct target type, Builder will optimize the build results for the environment, and enable some plugins or configs for the target environment during the build process.\n\nYou can set the type through the target parameter of the createBuilder method.\n\n\n# Default Target\n\nBy default, the build target is 'web', and the build result can run in a browser environment.\n\nthe Builder will read the Browserslist config in the project to determine the range of browsers.\n\n\n# Optional Targets\n\ntarget can also be set to the following values:\n\n * 'node': Build for Node.js environment, usually used in SSR and other scenarios.\n * 'web-worker': Build for Web Worker environment.\n * 'modern-web': Build for modern browsers.\n\nFor example, to build for the Node.js environment:\n\nconst builder = await createBuilder(provider, {\n  target: 'node',\n});\n\n\n\n# Multiple Targets\n\nWhen target is an array containing multiple values, Builder will perform multiple builds at the same time.\n\nFor example, we can build a browser target and an node target at the same time:\n\nconst builder = await createBuilder(provider, {\n  target: ['web', 'node'],\n});\n\n\n\n# Node Target\n\nRefers to the build target running in the Node.js environment, usually used in scenarios such as SSR.\n\nWhen target is set to 'node', Builder will:\n\n * No HTML files will be generated, and HTML-related logic will not be executed, since HTML is not required by the Node.js environment.\n * CSS code will not be bundled or extracted, but the id information of CSS Modules will be included in the bundle.\n * The default code split strategy will be disabled, but dynamic import can still work.\n * Disable the HMR.\n * Adjust the default value of Browserslist to ['node >= 14']。\n\nTIP\n\nIf target is an array, such as building web and node targets at the same time, then the above processing will not affect the web target, The HTML, CSS and other files required for the web target will still be generated correctly.\n\n\n# Web Worker Target\n\nRefers to the build target running in the Web Worker environment.\n\nWeb Worker\n\nA web worker is a type of JavaScript program that runs in the background, independently of other scripts, without affecting the performance of the page. This makes it possible to run long-running scripts, such as ones that handle complex calculations or access remote resources, without blocking the user interface or other scripts. Web workers provide an easy way to run tasks in the background and improve the overall performance of web applications.\n\nWhen target is set to 'web-worker', Builder will:\n\n * No HTML files will be generated, and HTML-related logic will not be executed, since HTML is not required by the Web Worker environment.\n * CSS code will not be bundled or extracted, but the id information of CSS Modules will be included in the bundle.\n * The default code split strategy will be disabled, and dynamic import can not work, because the Web Worker only runs a single JavaScript file.\n * Disable the HMR.\n\n\n# Modern Web Target\n\nRefers to the build target running in the modern browsers.\n\nWhat are modern browsers?\n\nModern browsers are one of our conventions to refer to browsers that support native ES Modules.\n\nWhen target is set to 'modern-web', Builder will:\n\n * Adjust the default value of Browserslist to：\n\nconst browserslist = [\n  'chrome > 61',\n  'edge > 16',\n  'firefox > 60',\n  'safari > 11',\n  'ios_saf > 11',\n];\n",normalizedContent:"# build target\n\nbuilder supports build multiple target types for running in different target environments. after setting the correct target type, builder will optimize the build results for the environment, and enable some plugins or configs for the target environment during the build process.\n\nyou can set the type through the target parameter of the createbuilder method.\n\n\n# default target\n\nby default, the build target is 'web', and the build result can run in a browser environment.\n\nthe builder will read the browserslist config in the project to determine the range of browsers.\n\n\n# optional targets\n\ntarget can also be set to the following values:\n\n * 'node': build for node.js environment, usually used in ssr and other scenarios.\n * 'web-worker': build for web worker environment.\n * 'modern-web': build for modern browsers.\n\nfor example, to build for the node.js environment:\n\nconst builder = await createbuilder(provider, {\n  target: 'node',\n});\n\n\n\n# multiple targets\n\nwhen target is an array containing multiple values, builder will perform multiple builds at the same time.\n\nfor example, we can build a browser target and an node target at the same time:\n\nconst builder = await createbuilder(provider, {\n  target: ['web', 'node'],\n});\n\n\n\n# node target\n\nrefers to the build target running in the node.js environment, usually used in scenarios such as ssr.\n\nwhen target is set to 'node', builder will:\n\n * no html files will be generated, and html-related logic will not be executed, since html is not required by the node.js environment.\n * css code will not be bundled or extracted, but the id information of css modules will be included in the bundle.\n * the default code split strategy will be disabled, but dynamic import can still work.\n * disable the hmr.\n * adjust the default value of browserslist to ['node >= 14']。\n\ntip\n\nif target is an array, such as building web and node targets at the same time, then the above processing will not affect the web target, the html, css and other files required for the web target will still be generated correctly.\n\n\n# web worker target\n\nrefers to the build target running in the web worker environment.\n\nweb worker\n\na web worker is a type of javascript program that runs in the background, independently of other scripts, without affecting the performance of the page. this makes it possible to run long-running scripts, such as ones that handle complex calculations or access remote resources, without blocking the user interface or other scripts. web workers provide an easy way to run tasks in the background and improve the overall performance of web applications.\n\nwhen target is set to 'web-worker', builder will:\n\n * no html files will be generated, and html-related logic will not be executed, since html is not required by the web worker environment.\n * css code will not be bundled or extracted, but the id information of css modules will be included in the bundle.\n * the default code split strategy will be disabled, and dynamic import can not work, because the web worker only runs a single javascript file.\n * disable the hmr.\n\n\n# modern web target\n\nrefers to the build target running in the modern browsers.\n\nwhat are modern browsers?\n\nmodern browsers are one of our conventions to refer to browsers that support native es modules.\n\nwhen target is set to 'modern-web', builder will:\n\n * adjust the default value of browserslist to：\n\nconst browserslist = [\n  'chrome > 61',\n  'edge > 16',\n  'firefox > 60',\n  'safari > 11',\n  'ios_saf > 11',\n];\n",charsets:{}},{title:"Builder Config",frontmatter:{},regularPath:"/en/guide/basic/builder-config.html",relativePath:"en/guide/basic/builder-config.md",key:"v-96bdfd28",path:"/en/guide/basic/builder-config.html",headers:[{level:2,title:"Config Categories",slug:"config-categories",normalizedTitle:"config categories",charIndex:103},{level:2,title:"Default Values",slug:"default-values",normalizedTitle:"default values",charIndex:607},{level:2,title:"Use Config",slug:"use-config",normalizedTitle:"use config",charIndex:968},{level:2,title:"Relationship with Framework Config",slug:"relationship-with-framework-config",normalizedTitle:"relationship with framework config",charIndex:1987},{level:2,title:"Debug the config",slug:"debug-the-config",normalizedTitle:"debug the config",charIndex:2303}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Config Categories Default Values Use Config Relationship with Framework Config Debug the config",content:"# Builder Config\n\nBuilder provides a wealth of configs to help users customize the build behavior.\n\n\n# Config Categories\n\nBuilder Configs are divided into the following categories:\n\n * Dev Config: Config related to local development.\n * Html Config: Config related to HTML.\n * Tools Config: Config related to the low-level tools.\n * Source Config: Config related to source code.\n * Output Config: Config related to output.\n * Security Config: Config related to security.\n * Performance Config: Config related to performance.\n\nYou can find detailed descriptions of all configs on the API Reference page.\n\n\n# Default Values\n\nThe Builder presets a default value for each config, and the default value is suitable for most scenarios. At the same time, the upper-level framework will also override some of the default values based on the requirements of the vertical scene.\n\nIn most cases, you don't need to define any Builder config, just use it right out of the box.\n\n\n# Use Config\n\n\n# In the Upper Framework\n\nWhen you use a Builder-based upper-level framework, you can define the Builder config directly through the framework's config file, and the upper-level framework will pass the config to the Builder.\n\nFor example, in the Modern.js 2.0 framework, you can define the Builder's source.alias config in modern.config.ts file.\n\n// modern.config.ts\nexport default {\n  source: {\n    alias: {\n      '@common': './src/common',\n    },\n  },\n};\n\n\nCommonly used framework config files include:\n\nFRAMEWORK       CONFIG FILE\nModern.js 2.0   modern.config.ts\nEdenX           edenx.config.ts\nPIA             pia.config.ts\n\n\n# Using the Node API\n\nWhen you call the Builder through the Node API, you can pass in the Builder config through the Provider's builderConfig option:\n\nimport { builderWebpackProvider } from '@modern-js/builder-webpack-provider';\n\nconst provider = builderWebpackProvider({\n  builderConfig: {\n    // some configs\n  },\n});\n\n\nPlease refer to API - createBuilder for details.\n\n\n# Relationship with Framework Config\n\nGenerally speaking, the Builder config is a subset of the framework config.\n\nBuilder config only deals with build-related behaviors, while framework config covers a wider range, including runtime, server, deployment, etc., so framework config is extended from Builder config.\n\n\n# Debug the config\n\nYou can enable Builder's debug mode by adding the DEBUG=builder environment variable when executing a build.\n\nDEBUG=builder pnpm dev\n\n\nIn debug mode, Builder will write the Builder config to the dist directory, which is convenient for developers to view and debug.\n\nInspect config succeed, open the following files to view the content:\n\n   - Builder Config: /Project/demo/dist/builder.config.js\n   - Webpack Config (web): /Project/demo/dist/webpack.config.web.js\n\n\nOpen the generated /dist/builder.config.js file to see the complete content of the Builder config.",normalizedContent:"# builder config\n\nbuilder provides a wealth of configs to help users customize the build behavior.\n\n\n# config categories\n\nbuilder configs are divided into the following categories:\n\n * dev config: config related to local development.\n * html config: config related to html.\n * tools config: config related to the low-level tools.\n * source config: config related to source code.\n * output config: config related to output.\n * security config: config related to security.\n * performance config: config related to performance.\n\nyou can find detailed descriptions of all configs on the api reference page.\n\n\n# default values\n\nthe builder presets a default value for each config, and the default value is suitable for most scenarios. at the same time, the upper-level framework will also override some of the default values based on the requirements of the vertical scene.\n\nin most cases, you don't need to define any builder config, just use it right out of the box.\n\n\n# use config\n\n\n# in the upper framework\n\nwhen you use a builder-based upper-level framework, you can define the builder config directly through the framework's config file, and the upper-level framework will pass the config to the builder.\n\nfor example, in the modern.js 2.0 framework, you can define the builder's source.alias config in modern.config.ts file.\n\n// modern.config.ts\nexport default {\n  source: {\n    alias: {\n      '@common': './src/common',\n    },\n  },\n};\n\n\ncommonly used framework config files include:\n\nframework       config file\nmodern.js 2.0   modern.config.ts\nedenx           edenx.config.ts\npia             pia.config.ts\n\n\n# using the node api\n\nwhen you call the builder through the node api, you can pass in the builder config through the provider's builderconfig option:\n\nimport { builderwebpackprovider } from '@modern-js/builder-webpack-provider';\n\nconst provider = builderwebpackprovider({\n  builderconfig: {\n    // some configs\n  },\n});\n\n\nplease refer to api - createbuilder for details.\n\n\n# relationship with framework config\n\ngenerally speaking, the builder config is a subset of the framework config.\n\nbuilder config only deals with build-related behaviors, while framework config covers a wider range, including runtime, server, deployment, etc., so framework config is extended from builder config.\n\n\n# debug the config\n\nyou can enable builder's debug mode by adding the debug=builder environment variable when executing a build.\n\ndebug=builder pnpm dev\n\n\nin debug mode, builder will write the builder config to the dist directory, which is convenient for developers to view and debug.\n\ninspect config succeed, open the following files to view the content:\n\n   - builder config: /project/demo/dist/builder.config.js\n   - webpack config (web): /project/demo/dist/webpack.config.web.js\n\n\nopen the generated /dist/builder.config.js file to see the complete content of the builder config.",charsets:{}},{title:"Use CSS Modules",frontmatter:{},regularPath:"/en/guide/basic/css-modules.html",relativePath:"en/guide/basic/css-modules.md",key:"v-126341d2",path:"/en/guide/basic/css-modules.html",headers:[{level:2,title:"Example",slug:"example",normalizedTitle:"example",charIndex:558},{level:2,title:"Enable CSS Modules for all CSS files",slug:"enable-css-modules-for-all-css-files",normalizedTitle:"enable css modules for all css files",charIndex:874},{level:2,title:"Custom Class Names",slug:"custom-class-names",normalizedTitle:"custom class names",charIndex:1571},{level:2,title:"Add Type Declaration",slug:"add-type-declaration",normalizedTitle:"add type declaration",charIndex:1923},{level:2,title:"Generate exact type definitions",slug:"generate-exact-type-definitions",normalizedTitle:"generate exact type definitions",charIndex:3571}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Example Enable CSS Modules for all CSS files Custom Class Names Add Type Declaration Generate exact type definitions",content:"# Use CSS Modules\n\nCSS Modules allows us to write CSS code in a modular way, and these styles can be imported and used in JavaScript files. Using CSS Modules can automatically generate unique class names, isolate styles between different modules, and avoid class name conflicts.\n\nBuilder supports CSS Modules by default, you don't need to add additional configuration. Our convention is to use the [name].module.css filename to enable CSS Modules.\n\nThe following style files are considered CSS Modules:\n\n * *.module.scss\n * *.module.less\n * *.module.css\n\n\n# Example\n\n * Write style:\n\n/* button.module.css */\n.error {\n  background: red;\n}\n\n\n * Using styles:\n\n// Button.tsx\nimport React, { Component } from 'react';\n// import style file\nimport styles from './button.module.css';\n\nexport default () => {\n  return <button className={styles.error}>Error Button</button>;\n};\n\n\n\n# Enable CSS Modules for all CSS files\n\nBy default, only files ending in *.module.css are treated CSS Modules.\n\nIf you want to treat all CSS files in the source directory as CSS Modules, you can enable the output.disableCssModuleExtension config, for example:\n\nexport default {\n  output: {\n    disableCssModuleExtension: true,\n  },\n};\n\n\nWhen set, the following two files are treated as CSS Modules:\n\nimport styles1 from './foo.module.css';\nimport styles2 from './bar.css';\n\n\nTIP\n\nWe do not recommend enabling this config, because after enabling disableCssModuleExtension, CSS Modules files and ordinary CSS files cannot be clearly distinguished, which is not conducive to long-term maintenance.\n\n\n# Custom Class Names\n\nCustomizing the class names generated by CSS Modules is also a commonly used function, you can use output.cssModuleLocalIdentName to configure it.\n\nexport default {\n  output: {\n    cssModuleLocalIdentName: '[hash:base64:4]',\n  },\n};\n\n\nIf you need to customize other configs of CSS Modules, you can set them via tools.cssLoader.\n\n\n# Add Type Declaration\n\nWhen you import CSS Modules in TypeScript code, TypeScript may prompt that the module is missing a type definition:\n\nTS2307: Cannot find module './index.module.css' or its corresponding type declarations.\n\n\nTo fix this, you need to add a type declaration file for the CSS Modules, please create a src/global.d.ts file, and add the corresponding type declaration:\n\n// src/global.d.ts\ndeclare module '*.module.css' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.module.scss' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.module.sass' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.module.less' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\n\nIf you enabled the disableCssModuleExtension config, you also need to add the following types:\n\n// src/global.d.ts\ndeclare module '*.css' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.scss' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.sass' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.less' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\n\nAfter adding the type declaration, if the type error still exists, you can try to restart the current IDE, or adjust the directory where global.d.ts is located, making sure the TypeScript can correctly identify the type definition.\n\n\n# Generate exact type definitions\n\nAlthough the above method can provide the type of CSS Modules, it cannot accurately prompt which classNames are exported by a certain CSS file.\n\nBuilder supports generating accurate type declarations for CSS Modules, you only need to enable the output.enableCssModuleTSDeclaration config, and then execute the build, Builder will generate type declaration files for all CSS Modules.\n\nexport default {\n  output: {\n    enableCssModuleTSDeclaration: true,\n  },\n};\n\n\n\n# Example\n\nFor example, there are two files src/index.ts and src/index.module.scss under a certain folder:\n\n// src/index.ts\nimport styles from './index.module.scss';\n\nexport default () => {\n  <div>\n    <div className={styles.pageHeader}>Page Header</div>\n  </div>;\n};\n\n\n// src/index.module.scss\n.page-header {\n  color: black;\n}\n\n\nAfter executing the build, the src/index.module.scss.d.ts type declaration file will be automatically generated:\n\n// src/index.module.scss.d.ts\n// This file is automatically generated.\n// Please do not change this file!\ninterface CssExports {\n  'page-header': string;\n  pageHeader: string;\n}\nexport const cssExports: CssExports;\nexport default cssExports;\n\n\nThen open the src/index.ts file again, you will see that the styles object already has a exact type.\n\n\n# Related configuration\n\nIn the above example, src/index.module.scss.d.ts is generated by compilation, you can choose to commit them to the Git repository, or you can choose to ignore them in the .gitignore file:\n\n# Ignore auto generated CSS declarations\n*.module.css.d.ts\n*.module.sass.d.ts\n*.module.scss.d.ts\n*.module.less.d.ts\n\n\nIn addition, if the generated code causes ESLint to report errors, you can also add the above configuration to the .eslintignore file.",normalizedContent:"# use css modules\n\ncss modules allows us to write css code in a modular way, and these styles can be imported and used in javascript files. using css modules can automatically generate unique class names, isolate styles between different modules, and avoid class name conflicts.\n\nbuilder supports css modules by default, you don't need to add additional configuration. our convention is to use the [name].module.css filename to enable css modules.\n\nthe following style files are considered css modules:\n\n * *.module.scss\n * *.module.less\n * *.module.css\n\n\n# example\n\n * write style:\n\n/* button.module.css */\n.error {\n  background: red;\n}\n\n\n * using styles:\n\n// button.tsx\nimport react, { component } from 'react';\n// import style file\nimport styles from './button.module.css';\n\nexport default () => {\n  return <button classname={styles.error}>error button</button>;\n};\n\n\n\n# enable css modules for all css files\n\nby default, only files ending in *.module.css are treated css modules.\n\nif you want to treat all css files in the source directory as css modules, you can enable the output.disablecssmoduleextension config, for example:\n\nexport default {\n  output: {\n    disablecssmoduleextension: true,\n  },\n};\n\n\nwhen set, the following two files are treated as css modules:\n\nimport styles1 from './foo.module.css';\nimport styles2 from './bar.css';\n\n\ntip\n\nwe do not recommend enabling this config, because after enabling disablecssmoduleextension, css modules files and ordinary css files cannot be clearly distinguished, which is not conducive to long-term maintenance.\n\n\n# custom class names\n\ncustomizing the class names generated by css modules is also a commonly used function, you can use output.cssmodulelocalidentname to configure it.\n\nexport default {\n  output: {\n    cssmodulelocalidentname: '[hash:base64:4]',\n  },\n};\n\n\nif you need to customize other configs of css modules, you can set them via tools.cssloader.\n\n\n# add type declaration\n\nwhen you import css modules in typescript code, typescript may prompt that the module is missing a type definition:\n\nts2307: cannot find module './index.module.css' or its corresponding type declarations.\n\n\nto fix this, you need to add a type declaration file for the css modules, please create a src/global.d.ts file, and add the corresponding type declaration:\n\n// src/global.d.ts\ndeclare module '*.module.css' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.module.scss' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.module.sass' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.module.less' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\n\nif you enabled the disablecssmoduleextension config, you also need to add the following types:\n\n// src/global.d.ts\ndeclare module '*.css' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.scss' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.sass' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.less' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\n\nafter adding the type declaration, if the type error still exists, you can try to restart the current ide, or adjust the directory where global.d.ts is located, making sure the typescript can correctly identify the type definition.\n\n\n# generate exact type definitions\n\nalthough the above method can provide the type of css modules, it cannot accurately prompt which classnames are exported by a certain css file.\n\nbuilder supports generating accurate type declarations for css modules, you only need to enable the output.enablecssmoduletsdeclaration config, and then execute the build, builder will generate type declaration files for all css modules.\n\nexport default {\n  output: {\n    enablecssmoduletsdeclaration: true,\n  },\n};\n\n\n\n# example\n\nfor example, there are two files src/index.ts and src/index.module.scss under a certain folder:\n\n// src/index.ts\nimport styles from './index.module.scss';\n\nexport default () => {\n  <div>\n    <div classname={styles.pageheader}>page header</div>\n  </div>;\n};\n\n\n// src/index.module.scss\n.page-header {\n  color: black;\n}\n\n\nafter executing the build, the src/index.module.scss.d.ts type declaration file will be automatically generated:\n\n// src/index.module.scss.d.ts\n// this file is automatically generated.\n// please do not change this file!\ninterface cssexports {\n  'page-header': string;\n  pageheader: string;\n}\nexport const cssexports: cssexports;\nexport default cssexports;\n\n\nthen open the src/index.ts file again, you will see that the styles object already has a exact type.\n\n\n# related configuration\n\nin the above example, src/index.module.scss.d.ts is generated by compilation, you can choose to commit them to the git repository, or you can choose to ignore them in the .gitignore file:\n\n# ignore auto generated css declarations\n*.module.css.d.ts\n*.module.sass.d.ts\n*.module.scss.d.ts\n*.module.less.d.ts\n\n\nin addition, if the generated code causes eslint to report errors, you can also add the above configuration to the .eslintignore file.",charsets:{}},{title:"CSS Usage",frontmatter:{},regularPath:"/en/guide/basic/css-usage.html",relativePath:"en/guide/basic/css-usage.md",key:"v-b6305f44",path:"/en/guide/basic/css-usage.html",headers:[{level:2,title:"Using Less & Sass",slug:"using-less-sass",normalizedTitle:"using less &amp; sass",charIndex:null},{level:2,title:"Using PostCSS",slug:"using-postcss",normalizedTitle:"using postcss",charIndex:457},{level:2,title:"Using CSS Modules",slug:"using-css-modules",normalizedTitle:"using css modules",charIndex:987},{level:2,title:"CSS Minify",slug:"css-minify",normalizedTitle:"css minify",charIndex:1089},{level:2,title:"Inline CSS Files",slug:"inline-css-files",normalizedTitle:"inline css files",charIndex:1737},{level:2,title:"Import CSS in node_modules",slug:"import-css-in-node-modules",normalizedTitle:"import css in node_modules",charIndex:2288}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Using Less & Sass Using PostCSS Using CSS Modules CSS Minify Inline CSS Files Import CSS in node_modules",content:"# CSS Usage\n\nBuilder has built-in multiple style resource processing capabilities, including Less / Sass preprocessor, PostCSS, CSS Modules, CSS inline and CSS compression.\n\nIn addition, Builder also provides multiple configs to customize the compile rules of style resources.\n\n\n# Using Less & Sass\n\nThe Builder has built-in community popular CSS preprocessors such as Less, Sass.\n\nYou can customize the loader by configuring tools.less and tools.sass.\n\n\n# Using PostCSS\n\nBuilder has built-in PostCSS to transform the CSS code. You can configure the postcss-loader via tools.postcss.\n\nexport default {\n  tools: {\n    postcss: opts => {\n      const viewportPlugin = require('postcss-px-to-viewport')({\n        viewportWidth: 375,\n      });\n      opts.postcssOptions.plugins.push(viewportPlugin);\n    },\n  },\n};\n\n\nBy default, we have enabled autoprefixer to add vendor prefixes to CSS rules. If you want to configure the target browser, you can use output.overrideBrowserslist config.\n\n\n# Using CSS Modules\n\nPlease read the Using CSS Modules chapter for a complete usage of CSS Modules.\n\n\n# CSS Minify\n\nUsually, in production environments we compress static resources such as CSS, JS, etc. to achieve better transfer efficiency.\n\nBuilder automatically compresses CSS code at production build time with css-minimizer-webpack-plugin (The compression tool used at the bottom is cssnano).\n\nYou can configure tools.minifyCss to make it more customizable.\n\nAbout cssnano\n\ncssnano is a tool for optimizing and minifying CSS files. It reduces the size of CSS files by removing unused rules, merging similar rules, removing comments and whitespace, and converting length units, among other techniques, to improve the loading speed of websites.\n\n\n# Inline CSS Files\n\nBy default, Builder will extract CSS into a separate .css file and output it to the dist directory.\n\nIf you want to inline styles into your JS file, you can set output.disableCssExtract to true to disable CSS extraction logic.When the JS file is requested by the browser, JS dynamically inserts the <style> tag into the Html to load the CSS styles.\n\nexport default {\n  output: {\n    disableCssExtract: true,\n  },\n};\n\n\nThis will increase the size of your JS Bundle, so it is usually not recommended to disable the CSS extraction.\n\n\n# Import CSS in node_modules\n\nYou can directly import CSS files in node_modules.\n\n * Import in a component:\n\n// src/App.tsx\n// Import the Arco Design style:\nimport '@arco-design/web-react/dist/css/arco.css';\n\n\n * Import in a style file:\n\n/* src/App.css */\n/* reference normalize.css */\n/* https://github.com/necolas/normalize.css */\n@import 'normalize.css';\n\nbody {\n  /* */\n}\n",normalizedContent:"# css usage\n\nbuilder has built-in multiple style resource processing capabilities, including less / sass preprocessor, postcss, css modules, css inline and css compression.\n\nin addition, builder also provides multiple configs to customize the compile rules of style resources.\n\n\n# using less & sass\n\nthe builder has built-in community popular css preprocessors such as less, sass.\n\nyou can customize the loader by configuring tools.less and tools.sass.\n\n\n# using postcss\n\nbuilder has built-in postcss to transform the css code. you can configure the postcss-loader via tools.postcss.\n\nexport default {\n  tools: {\n    postcss: opts => {\n      const viewportplugin = require('postcss-px-to-viewport')({\n        viewportwidth: 375,\n      });\n      opts.postcssoptions.plugins.push(viewportplugin);\n    },\n  },\n};\n\n\nby default, we have enabled autoprefixer to add vendor prefixes to css rules. if you want to configure the target browser, you can use output.overridebrowserslist config.\n\n\n# using css modules\n\nplease read the using css modules chapter for a complete usage of css modules.\n\n\n# css minify\n\nusually, in production environments we compress static resources such as css, js, etc. to achieve better transfer efficiency.\n\nbuilder automatically compresses css code at production build time with css-minimizer-webpack-plugin (the compression tool used at the bottom is cssnano).\n\nyou can configure tools.minifycss to make it more customizable.\n\nabout cssnano\n\ncssnano is a tool for optimizing and minifying css files. it reduces the size of css files by removing unused rules, merging similar rules, removing comments and whitespace, and converting length units, among other techniques, to improve the loading speed of websites.\n\n\n# inline css files\n\nby default, builder will extract css into a separate .css file and output it to the dist directory.\n\nif you want to inline styles into your js file, you can set output.disablecssextract to true to disable css extraction logic.when the js file is requested by the browser, js dynamically inserts the <style> tag into the html to load the css styles.\n\nexport default {\n  output: {\n    disablecssextract: true,\n  },\n};\n\n\nthis will increase the size of your js bundle, so it is usually not recommended to disable the css extraction.\n\n\n# import css in node_modules\n\nyou can directly import css files in node_modules.\n\n * import in a component:\n\n// src/app.tsx\n// import the arco design style:\nimport '@arco-design/web-react/dist/css/arco.css';\n\n\n * import in a style file:\n\n/* src/app.css */\n/* reference normalize.css */\n/* https://github.com/necolas/normalize.css */\n@import 'normalize.css';\n\nbody {\n  /* */\n}\n",charsets:{}},{title:"HTML Template",frontmatter:{},regularPath:"/en/guide/basic/html-template.html",relativePath:"en/guide/basic/html-template.md",key:"v-52f7ed14",path:"/en/guide/basic/html-template.html",headers:[{level:2,title:"Set Template",slug:"set-template",normalizedTitle:"set template",charIndex:278},{level:2,title:"Set Page Title",slug:"set-page-title",normalizedTitle:"set page title",charIndex:771},{level:2,title:"Set Page Icon",slug:"set-page-icon",normalizedTitle:"set page icon",charIndex:1318},{level:2,title:"Set Meta Tags",slug:"set-meta-tags",normalizedTitle:"set meta tags",charIndex:1719},{level:2,title:"Set Template Parameters",slug:"set-template-parameters",normalizedTitle:"set template parameters",charIndex:2061},{level:2,title:"Template Engine",slug:"template-engine",normalizedTitle:"template engine",charIndex:3248}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Set Template Set Page Title Set Page Icon Set Meta Tags Set Template Parameters Template Engine",content:"# HTML Template\n\nDuring the build process, Builder will compile based on the HTML template and template parameters to generate several HTML files.\n\nBuilder provides some configs to set the HTML template. Through this chapter, you can learn the basic usage of these configs.\n\n\n# Set Template\n\nHTML templates are usually predefined by the upper framework.\n\nFor example, in the Modern.js 2.0 framework, the HTML template is preset by default, and users can also customize the content of the template. You can read the \"Modern.js - HTML Templates\" chapter to learn about it.\n\nIn Builder, you can use html.template and html.templateByEntries configs to define the path to the custom HTML template.\n\nexport default {\n  html: {\n    template: './static/index.html',\n  },\n};\n\n\n\n# Set Page Title\n\nYou can set the HTML <title> tag through the html.title and html.titleByEntries configs.\n\nWhen there is only one page in your project, just use the html.title setting directly:\n\nexport default {\n  html: {\n    title: 'example',\n  },\n};\n\n\nWhen there are multiple pages in your project, please use html.titleByEntries to set corresponding titles for different pages. html.titleByEntries uses the page's \"entry name\" as the key.\n\nexport default {\n  html: {\n    titleByEntries: {\n      foo: 'Foo',\n      bar: 'Bar',\n    },\n  },\n};\n\n\n\n# Set Page Icon\n\nBuilder supports setting favicon icon and apple-touch-icon icon.\n\nYou can set the favicon through the html.favicon and html.faviconByEntries configs.\n\nexport default {\n  html: {\n    favicon: './src/assets/icon.png',\n  },\n};\n\n\nYou can also set the apple-touch-icon under iOS through the html.appIcon config.\n\nexport default {\n  html: {\n    appIcon: './src/assets/icon.png',\n  },\n};\n\n\n\n# Set Meta Tags\n\nYou can set the meta tags through the html.meta and html.metaByEntries configs.\n\nFor example to setting description:\n\nexport default {\n  html: {\n    meta: {\n      description: 'a description of the page',\n    },\n  },\n};\n\n\nThe generated meta tag in HTML is:\n\n<meta name=\"description\" content=\"a description of the page\" />\n\n\n\n# Set Template Parameters\n\nIn HTML templates, you can use a variety of template parameters. The template parameters injected by Builder by default include:\n\ntype DefaultParameters = {\n  meta: string; // corresponding to html.meta config\n  title: string; // corresponding to html.title config\n  mountId: string; // corresponding to html.mountId config\n  entryName: string; // entry name\n  assetPrefix: string; // corresponding to output.assetPrefix config\n  compilation: webpack.Compilation; // Compilation object corresponding to webpack\n  webpackConfig: config; // webpack config\n  // htmlWebpackPlugin built-in parameters\n  // See https://github.com/jantimon/html-webpack-plugin for details\n  htmlWebpackPlugin: {\n    tags: object;\n    files: object;\n    options: object;\n  };\n};\n\n\nYou can also use the html.templateParameters and html.templateParametersByEntries configs to pass in custom template parameters.\n\nFor example:\n\nexport default {\n  html: {\n    templateParameters: {\n      text: 'World',\n    },\n  },\n};\n\n\nThen you can read parameters in the HTML template with <%= text %>:\n\n<div>hello <%= text %>!</div>\n\n\nThe generated HTML code is as follows:\n\n<div>hello world!</div>\n\n\n\n# Template Engine\n\nBuilder supports using Lodash Template, EJS, Pug as template engines, the most basic Lodash Template is used as the default template engine.\n\n\n# Lodash Template\n\nWhen the suffix of the template is .html, Builder will use Lodash Template to compile it.\n\nFor example, if you define a text parameter in a template with a value of 'world', Builder will automatically replace <%= text %> with the value.\n\n\x3c!-- input --\x3e\n<div>hello <%= text %>!</div>\n\n\x3c!-- output --\x3e\n<div>hello world!</div>\n\n\nPlease read the Lodash Template documentation for details.\n\n\n# EJS\n\nWhen the suffix of the template is .ejs, Builder will use the EJS template engine to compile it. EJS is a simple templating language that lets you generate HTML markup with plain JavaScript.\n\nFor example, you can first refer to a .ejs template through the html.template config:\n\nexport default {\n  html: {\n    template: './static/index.ejs',\n  },\n};\n\n\nThen define a user parameter in the template with a value of { name: 'Jack' }. Builder will automatically replace <%= user.name %> with the value.\n\n\x3c!-- input --\x3e\n<% if (user) { %>\n<h2><%= user.name %></h2>\n<% } %>\n\n\x3c!-- output --\x3e\n<h2>Jack</h2>\n\n\nPlease read the EJS documentation for details.\n\n\n# Pug\n\nWhen the suffix of the template is .pug, Builder will use the Pug template engine to compile it. Pug is a robust, elegant, feature rich template engine for Node.js.\n\nBefore using the Pug template, you need to enable the tools.pug config, and define the html.template config to reference a .pug template:\n\nexport default {\n  html: {\n    template: './static/index.pug',\n  },\n  tools: {\n    pug: true,\n  },\n};\n\n\nThen you can use Pug syntax in .pug templates:\n\n\x3c!-- input --\x3e\np Hello #{text}!\n\n\x3c!-- output --\x3e\n<p>Hello World!</p>\n\n\nPlease read the Pug documentation for details.",normalizedContent:"# html template\n\nduring the build process, builder will compile based on the html template and template parameters to generate several html files.\n\nbuilder provides some configs to set the html template. through this chapter, you can learn the basic usage of these configs.\n\n\n# set template\n\nhtml templates are usually predefined by the upper framework.\n\nfor example, in the modern.js 2.0 framework, the html template is preset by default, and users can also customize the content of the template. you can read the \"modern.js - html templates\" chapter to learn about it.\n\nin builder, you can use html.template and html.templatebyentries configs to define the path to the custom html template.\n\nexport default {\n  html: {\n    template: './static/index.html',\n  },\n};\n\n\n\n# set page title\n\nyou can set the html <title> tag through the html.title and html.titlebyentries configs.\n\nwhen there is only one page in your project, just use the html.title setting directly:\n\nexport default {\n  html: {\n    title: 'example',\n  },\n};\n\n\nwhen there are multiple pages in your project, please use html.titlebyentries to set corresponding titles for different pages. html.titlebyentries uses the page's \"entry name\" as the key.\n\nexport default {\n  html: {\n    titlebyentries: {\n      foo: 'foo',\n      bar: 'bar',\n    },\n  },\n};\n\n\n\n# set page icon\n\nbuilder supports setting favicon icon and apple-touch-icon icon.\n\nyou can set the favicon through the html.favicon and html.faviconbyentries configs.\n\nexport default {\n  html: {\n    favicon: './src/assets/icon.png',\n  },\n};\n\n\nyou can also set the apple-touch-icon under ios through the html.appicon config.\n\nexport default {\n  html: {\n    appicon: './src/assets/icon.png',\n  },\n};\n\n\n\n# set meta tags\n\nyou can set the meta tags through the html.meta and html.metabyentries configs.\n\nfor example to setting description:\n\nexport default {\n  html: {\n    meta: {\n      description: 'a description of the page',\n    },\n  },\n};\n\n\nthe generated meta tag in html is:\n\n<meta name=\"description\" content=\"a description of the page\" />\n\n\n\n# set template parameters\n\nin html templates, you can use a variety of template parameters. the template parameters injected by builder by default include:\n\ntype defaultparameters = {\n  meta: string; // corresponding to html.meta config\n  title: string; // corresponding to html.title config\n  mountid: string; // corresponding to html.mountid config\n  entryname: string; // entry name\n  assetprefix: string; // corresponding to output.assetprefix config\n  compilation: webpack.compilation; // compilation object corresponding to webpack\n  webpackconfig: config; // webpack config\n  // htmlwebpackplugin built-in parameters\n  // see https://github.com/jantimon/html-webpack-plugin for details\n  htmlwebpackplugin: {\n    tags: object;\n    files: object;\n    options: object;\n  };\n};\n\n\nyou can also use the html.templateparameters and html.templateparametersbyentries configs to pass in custom template parameters.\n\nfor example:\n\nexport default {\n  html: {\n    templateparameters: {\n      text: 'world',\n    },\n  },\n};\n\n\nthen you can read parameters in the html template with <%= text %>:\n\n<div>hello <%= text %>!</div>\n\n\nthe generated html code is as follows:\n\n<div>hello world!</div>\n\n\n\n# template engine\n\nbuilder supports using lodash template, ejs, pug as template engines, the most basic lodash template is used as the default template engine.\n\n\n# lodash template\n\nwhen the suffix of the template is .html, builder will use lodash template to compile it.\n\nfor example, if you define a text parameter in a template with a value of 'world', builder will automatically replace <%= text %> with the value.\n\n\x3c!-- input --\x3e\n<div>hello <%= text %>!</div>\n\n\x3c!-- output --\x3e\n<div>hello world!</div>\n\n\nplease read the lodash template documentation for details.\n\n\n# ejs\n\nwhen the suffix of the template is .ejs, builder will use the ejs template engine to compile it. ejs is a simple templating language that lets you generate html markup with plain javascript.\n\nfor example, you can first refer to a .ejs template through the html.template config:\n\nexport default {\n  html: {\n    template: './static/index.ejs',\n  },\n};\n\n\nthen define a user parameter in the template with a value of { name: 'jack' }. builder will automatically replace <%= user.name %> with the value.\n\n\x3c!-- input --\x3e\n<% if (user) { %>\n<h2><%= user.name %></h2>\n<% } %>\n\n\x3c!-- output --\x3e\n<h2>jack</h2>\n\n\nplease read the ejs documentation for details.\n\n\n# pug\n\nwhen the suffix of the template is .pug, builder will use the pug template engine to compile it. pug is a robust, elegant, feature rich template engine for node.js.\n\nbefore using the pug template, you need to enable the tools.pug config, and define the html.template config to reference a .pug template:\n\nexport default {\n  html: {\n    template: './static/index.pug',\n  },\n  tools: {\n    pug: true,\n  },\n};\n\n\nthen you can use pug syntax in .pug templates:\n\n\x3c!-- input --\x3e\np hello #{text}!\n\n\x3c!-- output --\x3e\n<p>hello world!</p>\n\n\nplease read the pug documentation for details.",charsets:{}},{title:"Import JSON Files",frontmatter:{},regularPath:"/en/guide/basic/json-files.html",relativePath:"en/guide/basic/json-files.md",key:"v-001e1ca8",path:"/en/guide/basic/json-files.html",headers:[{level:2,title:"JSON file",slug:"json-file",normalizedTitle:"json file",charIndex:45},{level:2,title:"YAML file",slug:"yaml-file",normalizedTitle:"yaml file",charIndex:534},{level:2,title:"Add type declaration",slug:"add-type-declaration",normalizedTitle:"add type declaration",charIndex:959},{level:2,title:"Toml file",slug:"toml-file",normalizedTitle:"toml file",charIndex:99},{level:2,title:"Add type declaration",slug:"add-type-declaration-2",normalizedTitle:"add type declaration",charIndex:959}],lastUpdated:"12/22/2022, 8:29:47 AM",lastUpdatedTimestamp:1671697787e3,headersStr:"JSON file YAML file Add type declaration Toml file Add type declaration",content:"# Import JSON Files\n\nBuilder supports import JSON files in code, and also supports import YAML and Toml files and converting them to JSON format.\n\n\n# JSON file\n\nYou can import JSON files directly in JavaScript files.\n\n\n# Example\n\n// example.json\n{\n  \"name\": \"foo\",\n  \"items\": [1, 2]\n}\n\n\nimport example from './example.json';\n\nconsole.log(example.name); // 'foo';\nconsole.log(example.items); // [1, 2];\n\n\n\n# Named Import\n\nBuilder does not support importing JSON files via named import yet:\n\nimport { name } from './example.json';\n\n\n\n# YAML file\n\nYAML is a data serialization language commonly used for writing configuration files.\n\nYou can directly import .yaml or .yml files in JavaScript and they will be automatically converted to JSON format.\n\n\n# Example\n\n# example.yaml\n---\nhello: world\nfoo:\n  bar: baz\n\n\nimport example from './example.yaml';\n\nconsole.log(example.hello); // 'world';\nconsole.log(example.foo); // { bar: 'baz' };\n\n\n\n# Type declaration\n\n\n# Add type declaration\n\nWhen you import a YAML file in your TypeScript code, please create a src/global.d.ts file in your project and add the corresponding type declaration:\n\n// src/global.d.ts\ndeclare module '*.yaml' {\n  const content: Record<string, any>;\n  export default content;\n}\n\ndeclare module '*.yml' {\n  const content: Record<string, any>;\n  export default content;\n}\n\n\n\n# Toml file\n\nToml is a semantically explicit, easy-to-read configuration file format.\n\nYou can directly import .toml files in JavaScript and it will be automatically converted to JSON format.\n\n\n# Example\n\n# example.toml\nhello = \"world\"\n\n[foo]\nbar = \"baz\"\n\n\nimport example from './example.toml';\n\nconsole.log(example.hello); // 'world';\nconsole.log(example.foo); // { bar: 'baz' };\n\n\n\n# Add type declaration\n\nWhen you import Toml files in TypeScript code, please create a src/global.d.ts file in your project and add the corresponding type declarations:\n\n// src/global.d.ts\ndeclare module '*.toml' {\n  const content: Record<string, any>;\n  export default content;\n}\n",normalizedContent:"# import json files\n\nbuilder supports import json files in code, and also supports import yaml and toml files and converting them to json format.\n\n\n# json file\n\nyou can import json files directly in javascript files.\n\n\n# example\n\n// example.json\n{\n  \"name\": \"foo\",\n  \"items\": [1, 2]\n}\n\n\nimport example from './example.json';\n\nconsole.log(example.name); // 'foo';\nconsole.log(example.items); // [1, 2];\n\n\n\n# named import\n\nbuilder does not support importing json files via named import yet:\n\nimport { name } from './example.json';\n\n\n\n# yaml file\n\nyaml is a data serialization language commonly used for writing configuration files.\n\nyou can directly import .yaml or .yml files in javascript and they will be automatically converted to json format.\n\n\n# example\n\n# example.yaml\n---\nhello: world\nfoo:\n  bar: baz\n\n\nimport example from './example.yaml';\n\nconsole.log(example.hello); // 'world';\nconsole.log(example.foo); // { bar: 'baz' };\n\n\n\n# type declaration\n\n\n# add type declaration\n\nwhen you import a yaml file in your typescript code, please create a src/global.d.ts file in your project and add the corresponding type declaration:\n\n// src/global.d.ts\ndeclare module '*.yaml' {\n  const content: record<string, any>;\n  export default content;\n}\n\ndeclare module '*.yml' {\n  const content: record<string, any>;\n  export default content;\n}\n\n\n\n# toml file\n\ntoml is a semantically explicit, easy-to-read configuration file format.\n\nyou can directly import .toml files in javascript and it will be automatically converted to json format.\n\n\n# example\n\n# example.toml\nhello = \"world\"\n\n[foo]\nbar = \"baz\"\n\n\nimport example from './example.toml';\n\nconsole.log(example.hello); // 'world';\nconsole.log(example.foo); // { bar: 'baz' };\n\n\n\n# add type declaration\n\nwhen you import toml files in typescript code, please create a src/global.d.ts file in your project and add the corresponding type declarations:\n\n// src/global.d.ts\ndeclare module '*.toml' {\n  const content: record<string, any>;\n  export default content;\n}\n",charsets:{}},{title:"Output Files",frontmatter:{},regularPath:"/en/guide/basic/output-files.html",relativePath:"en/guide/basic/output-files.md",key:"v-3967f6cc",path:"/en/guide/basic/output-files.html",headers:[{level:2,title:"Default Directory Structure",slug:"default-directory-structure",normalizedTitle:"default directory structure",charIndex:158},{level:2,title:"Modify the Directory",slug:"modify-the-directory",normalizedTitle:"modify the directory",charIndex:1365},{level:2,title:"Static Assets",slug:"static-assets",normalizedTitle:"static assets",charIndex:1771},{level:2,title:"Node.js Output Directory",slug:"node-js-output-directory",normalizedTitle:"node.js output directory",charIndex:2685},{level:2,title:"Flatten the Directory",slug:"flatten-the-directory",normalizedTitle:"flatten the directory",charIndex:3336},{level:2,title:"Not Written to Disk",slug:"not-written-to-disk",normalizedTitle:"not written to disk",charIndex:3852}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Default Directory Structure Modify the Directory Static Assets Node.js Output Directory Flatten the Directory Not Written to Disk",content:"# Output Files\n\nThis chapter will introduces the directory structure of output files and how to control the output directory of different types of files.\n\n\n# Default Directory Structure\n\nThe following is a basic directory for output files. By default, the compiled files will be output in the dist directory of current project.\n\ndist\n├── static\n│   ├── css\n│   │   ├── [name].[hash].css\n│   │   └── [name].[hash].css.map\n│   │\n│   └── js\n│       ├── [name].[hash].js\n│       ├── [name].[hash].js.LICENSE.txt\n│       └── [name].[hash].js.map\n│\n└── html\n    └── [name]\n        └── index.html\n\n\nThe most common output files are HTML files, JS files, and CSS files:\n\n * HTML files: default output to the html directory.\n * JS files: default output to static/js directory,\n * CSS files: default output to the static/css directory.\n\nIn addition, JS files and CSS files sometimes generate some related files:\n\n * License files: contains open source license, which is output to the same level directory of the JS file, and adds .LICENSE.txt suffix.\n * Source Map files: contains the source code mappings, which is output to the same level directory of JS files and CSS files, and adds a .map suffix.\n\nIn the filename, [name] represents the entry name corresponding to this file, such as index, main. [hash] is the hash value generated based on the content of the file.\n\n\n# Modify the Directory\n\nBuilder provides some configs to modify the directory or filename, you can:\n\n * Modify the filename through output.filename.\n * Modify the output path of through output.distPath.\n * Modify the license file through output.legalComments.\n * Remove Source Map file through output.disableSourceMap.\n * Remove the folder corresponding to the HTML files through html.disableHtmlFolder.\n\n\n# Static Assets\n\nWhen you import static assets such as images, SVG, fonts, media, etc. in the code, they will also be output to the dist/static directory, and automatically assigned to the corresponding subdirectories according to the file type:\n\ndist\n└── static\n    ├── image\n    │   └── foo.[hash].png\n    │\n    ├── svg\n    │   └── bar.[hash].svg\n    │\n    ├── font\n    │   └── baz.[hash].woff2\n    │\n    └── media\n        └── qux.[hash].mp4\n\n\nYou can use the output.distPath config to uniformly input these static assets into a directory, for example, output to the assets directory:\n\nexport default {\n  output: {\n    distPath: {\n      image: 'assets',\n      svg: 'assets',\n      font: 'assets',\n      media: 'assets',\n    },\n  },\n};\n\n\nThe above config produces the following directory structure:\n\ndist\n└── assets\n    ├── foo.[hash].png\n    ├── bar.[hash].svg\n    ├── baz.[hash].woff2\n    └── qux.[hash].mp4\n\n\n\n# Node.js Output Directory\n\nWhen the Build Target of Builder contains 'node', or you have enabled server-side features such as SSR in the upper framework, Builder will generate some output files for Node.js and output them to the bundles directory:\n\ndist\n├── bundles\n│   └── [name].js\n├── static\n└── html\n\n\nNode.js files usually only contain JS files, no HTML or CSS. Also, JS file names will not contain hash.\n\nYou can modify the output path of Node.js files through the output.distPath.server config.\n\nFor example, output Node.js files to the server directory:\n\nexport default {\n  output: {\n    distPath: {\n      server: 'server',\n    },\n  },\n};\n\n\n\n# Flatten the Directory\n\nSometimes you don't want the dist directory to have too many levels, you can set the directory to an empty string to flatten the generated directory.\n\nSee the example below:\n\nexport default {\n  output: {\n    distPath: {\n      js: '',\n      css: '',\n      html: '',\n    },\n    disableHtmlFolder: true,\n  },\n};\n\n\nThe above config produces the following directory structure:\n\ndist\n├── [name].[hash].css\n├── [name].[hash].css.map\n├── [name].[hash].js\n├── [name].[hash].js.map\n└── [name].html\n\n\n\n# Not Written to Disk\n\nBy default, Builder will write the generated files to disk, so developers can view the file content or configure proxy rules for static assets.\n\nIn development, you can choose to keep the generated files in the Dev Server's memory to reduce the overhead of file operations.\n\nJust set the dev.writeToDisk config to false:\n\nexport default {\n  dev: {\n    writeToDisk: false,\n  },\n};\n",normalizedContent:"# output files\n\nthis chapter will introduces the directory structure of output files and how to control the output directory of different types of files.\n\n\n# default directory structure\n\nthe following is a basic directory for output files. by default, the compiled files will be output in the dist directory of current project.\n\ndist\n├── static\n│   ├── css\n│   │   ├── [name].[hash].css\n│   │   └── [name].[hash].css.map\n│   │\n│   └── js\n│       ├── [name].[hash].js\n│       ├── [name].[hash].js.license.txt\n│       └── [name].[hash].js.map\n│\n└── html\n    └── [name]\n        └── index.html\n\n\nthe most common output files are html files, js files, and css files:\n\n * html files: default output to the html directory.\n * js files: default output to static/js directory,\n * css files: default output to the static/css directory.\n\nin addition, js files and css files sometimes generate some related files:\n\n * license files: contains open source license, which is output to the same level directory of the js file, and adds .license.txt suffix.\n * source map files: contains the source code mappings, which is output to the same level directory of js files and css files, and adds a .map suffix.\n\nin the filename, [name] represents the entry name corresponding to this file, such as index, main. [hash] is the hash value generated based on the content of the file.\n\n\n# modify the directory\n\nbuilder provides some configs to modify the directory or filename, you can:\n\n * modify the filename through output.filename.\n * modify the output path of through output.distpath.\n * modify the license file through output.legalcomments.\n * remove source map file through output.disablesourcemap.\n * remove the folder corresponding to the html files through html.disablehtmlfolder.\n\n\n# static assets\n\nwhen you import static assets such as images, svg, fonts, media, etc. in the code, they will also be output to the dist/static directory, and automatically assigned to the corresponding subdirectories according to the file type:\n\ndist\n└── static\n    ├── image\n    │   └── foo.[hash].png\n    │\n    ├── svg\n    │   └── bar.[hash].svg\n    │\n    ├── font\n    │   └── baz.[hash].woff2\n    │\n    └── media\n        └── qux.[hash].mp4\n\n\nyou can use the output.distpath config to uniformly input these static assets into a directory, for example, output to the assets directory:\n\nexport default {\n  output: {\n    distpath: {\n      image: 'assets',\n      svg: 'assets',\n      font: 'assets',\n      media: 'assets',\n    },\n  },\n};\n\n\nthe above config produces the following directory structure:\n\ndist\n└── assets\n    ├── foo.[hash].png\n    ├── bar.[hash].svg\n    ├── baz.[hash].woff2\n    └── qux.[hash].mp4\n\n\n\n# node.js output directory\n\nwhen the build target of builder contains 'node', or you have enabled server-side features such as ssr in the upper framework, builder will generate some output files for node.js and output them to the bundles directory:\n\ndist\n├── bundles\n│   └── [name].js\n├── static\n└── html\n\n\nnode.js files usually only contain js files, no html or css. also, js file names will not contain hash.\n\nyou can modify the output path of node.js files through the output.distpath.server config.\n\nfor example, output node.js files to the server directory:\n\nexport default {\n  output: {\n    distpath: {\n      server: 'server',\n    },\n  },\n};\n\n\n\n# flatten the directory\n\nsometimes you don't want the dist directory to have too many levels, you can set the directory to an empty string to flatten the generated directory.\n\nsee the example below:\n\nexport default {\n  output: {\n    distpath: {\n      js: '',\n      css: '',\n      html: '',\n    },\n    disablehtmlfolder: true,\n  },\n};\n\n\nthe above config produces the following directory structure:\n\ndist\n├── [name].[hash].css\n├── [name].[hash].css.map\n├── [name].[hash].js\n├── [name].[hash].js.map\n└── [name].html\n\n\n\n# not written to disk\n\nby default, builder will write the generated files to disk, so developers can view the file content or configure proxy rules for static assets.\n\nin development, you can choose to keep the generated files in the dev server's memory to reduce the overhead of file operations.\n\njust set the dev.writetodisk config to false:\n\nexport default {\n  dev: {\n    writetodisk: false,\n  },\n};\n",charsets:{}},{title:"Import Static Assets",frontmatter:{},regularPath:"/en/guide/basic/static-assets.html",relativePath:"en/guide/basic/static-assets.md",key:"v-4c5cb470",path:"/en/guide/basic/static-assets.html",headers:[{level:2,title:"Assets Format",slug:"assets-format",normalizedTitle:"assets format",charIndex:610},{level:2,title:"Import Assets in JS file",slug:"import-assets-in-js-file",normalizedTitle:"import assets in js file",charIndex:1122},{level:2,title:"Import Assets in CSS file",slug:"import-assets-in-css-file",normalizedTitle:"import assets in css file",charIndex:1482},{level:2,title:"Import Results",slug:"import-results",normalizedTitle:"import results",charIndex:1734},{level:2,title:"Output Files",slug:"output-files",normalizedTitle:"output files",charIndex:2366},{level:2,title:"URL Prefix",slug:"url-prefix",normalizedTitle:"url prefix",charIndex:2615},{level:2,title:"Add Type Declaration",slug:"add-type-declaration",normalizedTitle:"add type declaration",charIndex:3026},{level:2,title:"Image Format",slug:"image-format",normalizedTitle:"image format",charIndex:3820}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Assets Format Import Assets in JS file Import Assets in CSS file Import Results Output Files URL Prefix Add Type Declaration Image Format",content:"# Import Static Assets\n\nBuilder supports import static assets, including images, fonts, and medias.\n\nWhat is Static Assets\n\nStatic assets are files that are part of a web application and do not change, even when the application is being used. Examples of static assets include images, fonts, medias, stylesheets, and JavaScript files. These assets are typically stored on a web server or CDN, and delivered to the user's web browser when the Web application is accessed. Because they do not change, static assets can be cached by the browser, which helps to improve the performance of the Web application.\n\n\n# Assets Format\n\nThe following are the formats supported by Builder by default:\n\n * Image: png, jpg, jpeg, gif, svg, bmp, webp, ico, apng, avif, tiff.\n * Fonts: woff, woff2, eot, ttf, otf, ttc.\n * Media: mp4, webm, ogg, mp3, wav, flac, aac, mov.\n\nIf you need to import static resources in other formats, please provide feedback through GitHub Issues.\n\nSVG images\n\nSVG image is a special case. Builder support convert SVG to React components, so SVG is processed separately. For details, see Import SVG Assets.\n\n\n# Import Assets in JS file\n\nIn JS files, you can directly import static assets in relative paths:\n\n// Import the logo.png image in the static directory\nimport logo from './static/logo.png';\n\nexport default = () => <img src={logo} />;\n\n\nImport with alias are also supported:\n\nimport logo from '@/static/logo.png';\n\nexport default = () => <img src={logo} />;\n\n\n\n# Import Assets in CSS file\n\nIn CSS files, you can reference static assets in relative paths:\n\n.logo {\n  background-image: url('../static/logo.png');\n}\n\n\nImport with alias are also supported:\n\n.logo {\n  background-image: url('@/static/logo.png');\n}\n\n\n\n# Import Results\n\nThe result of importing static assets depends on the file size:\n\n * When the file size is greater than 10KB, a URL will be returned, and the file will be output to the dist directory.\n * When the file size is less than 10KB, it will be automatically inlined to Base64 format.\n\nimport largeImage from './static/largeImage.png';\nimport smallImage from './static/smallImage.png';\n\nconsole.log(largeImage); // \"/static/largeImage.6c12aba3.png\"\nconsole.log(smallImage); // \"data:image/png;base64,iVBORw0KGgo...\"\n\n\nFor a more detailed introduction to asset inlining, please refer to the Static Asset Inlining chapter.\n\n\n# Output Files\n\nWhen static assets are imported, they will be output to the dist directory. You can:\n\n * Modify the output filename through output.filename.\n * Modify the output path through output.distPath.\n\nPlease read Output Files for details.\n\n\n# URL Prefix\n\nThe URL returned after importing a asset will automatically include the path prefix:\n\n * In development, using dev.assetPrefix to set the path prefix.\n * In production, using output.assetPrefix to set the path prefix.\n\nFor example, you can set output.assetPrefix to https://modern.com:\n\nimport logo from './static/logo.png';\n\nconsole.log(logo); // \"https://modern.com/static/logo.6c12aba3.png\"\n\n\n\n# Add Type Declaration\n\nWhen you import static assets in TypeScript code, TypeScript may prompt that the module is missing a type definition:\n\nTS2307: Cannot find module './logo.png' or its corresponding type declarations.\n\n\nTo fix this, you need to add a type declaration file for the static assets, please create a src/global.d.ts file, and add the corresponding type declaration. Taking png images as an example, you need to add the following declarations:\n\n// src/global.d.ts\ndeclare module '*.png' {\n  const content: string;\n  export default content;\n}\n\n\nAfter adding the type declaration, if the type error still exists, you can try to restart the current IDE, or adjust the directory where global.d.ts is located, making sure the TypeScript can correctly identify the type definition.\n\n\n# Image Format\n\nWhen using image assets, you can choose a appropriate image format according to the pros and cons in the table below.\n\nFORMAT   PROS                                                     CONS                                                         SCENARIOS\nPNG      Lossless compression, no loss of picture details, no     Not suitable for pictures with complex color tables          Suitable for pictures with few colors and well-defined\n         distortion, support for translucency                                                                                  borders, suitable for logos, icons, transparent images and\n                                                                                                                               other scenes\nJPG      Rich colors                                              Lossy compression, which will cause image distortion, does   Suitable for pictures with a large number of colors,\n                                                                  not support transparency                                     gradients, and overly complex pictures, suitable for\n                                                                                                                               portrait photos, landscapes and other scenes\nWebP     Supports both lossy and lossless compression, supports   iOS compatibility is not good                                Pixel images of almost any scene, and the hosting\n         transparency, and is much smaller than PNG and JPG                                                                    environment that supports WebP, should prefer WebP image\n                                                                                                                               format\nSVG      Lossless format, no distortion, supports transparency    Not suitable for complex graphics                            Suitable for vector graphics, suitable for icons",normalizedContent:"# import static assets\n\nbuilder supports import static assets, including images, fonts, and medias.\n\nwhat is static assets\n\nstatic assets are files that are part of a web application and do not change, even when the application is being used. examples of static assets include images, fonts, medias, stylesheets, and javascript files. these assets are typically stored on a web server or cdn, and delivered to the user's web browser when the web application is accessed. because they do not change, static assets can be cached by the browser, which helps to improve the performance of the web application.\n\n\n# assets format\n\nthe following are the formats supported by builder by default:\n\n * image: png, jpg, jpeg, gif, svg, bmp, webp, ico, apng, avif, tiff.\n * fonts: woff, woff2, eot, ttf, otf, ttc.\n * media: mp4, webm, ogg, mp3, wav, flac, aac, mov.\n\nif you need to import static resources in other formats, please provide feedback through github issues.\n\nsvg images\n\nsvg image is a special case. builder support convert svg to react components, so svg is processed separately. for details, see import svg assets.\n\n\n# import assets in js file\n\nin js files, you can directly import static assets in relative paths:\n\n// import the logo.png image in the static directory\nimport logo from './static/logo.png';\n\nexport default = () => <img src={logo} />;\n\n\nimport with alias are also supported:\n\nimport logo from '@/static/logo.png';\n\nexport default = () => <img src={logo} />;\n\n\n\n# import assets in css file\n\nin css files, you can reference static assets in relative paths:\n\n.logo {\n  background-image: url('../static/logo.png');\n}\n\n\nimport with alias are also supported:\n\n.logo {\n  background-image: url('@/static/logo.png');\n}\n\n\n\n# import results\n\nthe result of importing static assets depends on the file size:\n\n * when the file size is greater than 10kb, a url will be returned, and the file will be output to the dist directory.\n * when the file size is less than 10kb, it will be automatically inlined to base64 format.\n\nimport largeimage from './static/largeimage.png';\nimport smallimage from './static/smallimage.png';\n\nconsole.log(largeimage); // \"/static/largeimage.6c12aba3.png\"\nconsole.log(smallimage); // \"data:image/png;base64,ivborw0kggo...\"\n\n\nfor a more detailed introduction to asset inlining, please refer to the static asset inlining chapter.\n\n\n# output files\n\nwhen static assets are imported, they will be output to the dist directory. you can:\n\n * modify the output filename through output.filename.\n * modify the output path through output.distpath.\n\nplease read output files for details.\n\n\n# url prefix\n\nthe url returned after importing a asset will automatically include the path prefix:\n\n * in development, using dev.assetprefix to set the path prefix.\n * in production, using output.assetprefix to set the path prefix.\n\nfor example, you can set output.assetprefix to https://modern.com:\n\nimport logo from './static/logo.png';\n\nconsole.log(logo); // \"https://modern.com/static/logo.6c12aba3.png\"\n\n\n\n# add type declaration\n\nwhen you import static assets in typescript code, typescript may prompt that the module is missing a type definition:\n\nts2307: cannot find module './logo.png' or its corresponding type declarations.\n\n\nto fix this, you need to add a type declaration file for the static assets, please create a src/global.d.ts file, and add the corresponding type declaration. taking png images as an example, you need to add the following declarations:\n\n// src/global.d.ts\ndeclare module '*.png' {\n  const content: string;\n  export default content;\n}\n\n\nafter adding the type declaration, if the type error still exists, you can try to restart the current ide, or adjust the directory where global.d.ts is located, making sure the typescript can correctly identify the type definition.\n\n\n# image format\n\nwhen using image assets, you can choose a appropriate image format according to the pros and cons in the table below.\n\nformat   pros                                                     cons                                                         scenarios\npng      lossless compression, no loss of picture details, no     not suitable for pictures with complex color tables          suitable for pictures with few colors and well-defined\n         distortion, support for translucency                                                                                  borders, suitable for logos, icons, transparent images and\n                                                                                                                               other scenes\njpg      rich colors                                              lossy compression, which will cause image distortion, does   suitable for pictures with a large number of colors,\n                                                                  not support transparency                                     gradients, and overly complex pictures, suitable for\n                                                                                                                               portrait photos, landscapes and other scenes\nwebp     supports both lossy and lossless compression, supports   ios compatibility is not good                                pixel images of almost any scene, and the hosting\n         transparency, and is much smaller than png and jpg                                                                    environment that supports webp, should prefer webp image\n                                                                                                                               format\nsvg      lossless format, no distortion, supports transparency    not suitable for complex graphics                            suitable for vector graphics, suitable for icons",charsets:{}},{title:"Import SVG Assets",frontmatter:{},regularPath:"/en/guide/basic/svg-assets.html",relativePath:"en/guide/basic/svg-assets.md",key:"v-a411f128",path:"/en/guide/basic/svg-assets.html",headers:[{level:2,title:"Import SVG in JS file",slug:"import-svg-in-js-file",normalizedTitle:"import svg in js file",charIndex:527},{level:2,title:"Modify the Default Export",slug:"modify-the-default-export",normalizedTitle:"modify the default export",charIndex:1013},{level:2,title:"Import SVG in CSS file",slug:"import-svg-in-css-file",normalizedTitle:"import svg in css file",charIndex:1434},{level:2,title:"Assets Processing",slug:"assets-processing",normalizedTitle:"assets processing",charIndex:1626},{level:2,title:"Add type declaration",slug:"add-type-declaration",normalizedTitle:"add type declaration",charIndex:1961}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Import SVG in JS file Modify the Default Export Import SVG in CSS file Assets Processing Add type declaration",content:"# Import SVG Assets\n\nBuilder supports import SVG assets and transform SVG into React components or URLs.\n\nWhat is SVG\n\nSVG stands for Scalable Vector Graphics. It is a type of image format that uses vector graphics to represent images. Vector graphics are different from raster graphics, which are made up of pixels. Instead, vector graphics use geometric shapes, lines, and curves to represent images. Because vector graphics are not made up of pixels, they can be scaled to any size without losing resolution or quality.\n\n\n# Import SVG in JS file\n\nWhen import an SVG in a JS file, if you import ReactComponent, Builder will call SVGR to convert the SVG into a React component.\n\n// src/component/Logo.tsx\nimport { ReactComponent as Logo } from './static/logo.svg';\n\nexport default () => <Logo />;\n\n\nIf you use the default import, then the SVG will be treated as a normal static asset and you will get a URL:\n\nimport logoURL from './static/logo.svg';\n\nconsole.log(logoURL); // => \"/static/logo.6c12aba3.png\"\n\n\n\n# Modify the Default Export\n\nYou can modify the default export of SVG files through the output.svgDefaultExport config. For example, set the default export as a React component:\n\nexport default {\n  output: {\n    svgDefaultExport: 'component',\n  },\n};\n\n\nThen import the SVG, you'll get a React component instead of a URL:\n\n// src/component/Logo.tsx\nimport Logo from './static/logo.svg';\n\nexport default () => <Logo />;\n\n\n\n# Import SVG in CSS file\n\nWhen import an SVG in a CSS file, the SVG is treated as a normal static resource and you will get a URL:\n\n.logo {\n  background-image: url('../static/logo.svg');\n}\n\n\n\n# Assets Processing\n\nWhen SVG is imported not as a React component but as a normal static resource, it is processed exactly the same as other static assets, and it is also affected by rules such as assets inlining and URL prefixing.\n\nPlease read the Import Static Assets section to understand the processing rules for static assets.\n\n\n# Add type declaration\n\nWhen you reference an SVG asset in TypeScript code, TypeScript may prompt that the module is missing a type definition:\n\nTS2307: Cannot find module './logo.svg' or its corresponding type declarations.\n\n\nTo fix this, you need to add a type declaration file for the SVG asset, please create a src/global.d.ts file, and add the following type declaration:\n\ndeclare module '*.svg' {\n  export const ReactComponent: React.FunctionComponent<\n    React.SVGProps<SVGSVGElement>\n  >;\n\n  const content: string;\n  export default content;\n}\n\n\nIf you set svgDefaultExport to 'component', then change the type declaration to:\n\ndeclare module '*.svg' {\n  export const ReactComponent: React.FunctionComponent<\n    React.SVGProps<SVGSVGElement>\n  >;\n\n  export default ReactComponent;\n}\n\n\nAfter adding the type declaration, if the type error still exists, you can try to restart the current IDE, or adjust the directory where global.d.ts is located, making sure the TypeScript can correctly identify the type definition.",normalizedContent:"# import svg assets\n\nbuilder supports import svg assets and transform svg into react components or urls.\n\nwhat is svg\n\nsvg stands for scalable vector graphics. it is a type of image format that uses vector graphics to represent images. vector graphics are different from raster graphics, which are made up of pixels. instead, vector graphics use geometric shapes, lines, and curves to represent images. because vector graphics are not made up of pixels, they can be scaled to any size without losing resolution or quality.\n\n\n# import svg in js file\n\nwhen import an svg in a js file, if you import reactcomponent, builder will call svgr to convert the svg into a react component.\n\n// src/component/logo.tsx\nimport { reactcomponent as logo } from './static/logo.svg';\n\nexport default () => <logo />;\n\n\nif you use the default import, then the svg will be treated as a normal static asset and you will get a url:\n\nimport logourl from './static/logo.svg';\n\nconsole.log(logourl); // => \"/static/logo.6c12aba3.png\"\n\n\n\n# modify the default export\n\nyou can modify the default export of svg files through the output.svgdefaultexport config. for example, set the default export as a react component:\n\nexport default {\n  output: {\n    svgdefaultexport: 'component',\n  },\n};\n\n\nthen import the svg, you'll get a react component instead of a url:\n\n// src/component/logo.tsx\nimport logo from './static/logo.svg';\n\nexport default () => <logo />;\n\n\n\n# import svg in css file\n\nwhen import an svg in a css file, the svg is treated as a normal static resource and you will get a url:\n\n.logo {\n  background-image: url('../static/logo.svg');\n}\n\n\n\n# assets processing\n\nwhen svg is imported not as a react component but as a normal static resource, it is processed exactly the same as other static assets, and it is also affected by rules such as assets inlining and url prefixing.\n\nplease read the import static assets section to understand the processing rules for static assets.\n\n\n# add type declaration\n\nwhen you reference an svg asset in typescript code, typescript may prompt that the module is missing a type definition:\n\nts2307: cannot find module './logo.svg' or its corresponding type declarations.\n\n\nto fix this, you need to add a type declaration file for the svg asset, please create a src/global.d.ts file, and add the following type declaration:\n\ndeclare module '*.svg' {\n  export const reactcomponent: react.functioncomponent<\n    react.svgprops<svgsvgelement>\n  >;\n\n  const content: string;\n  export default content;\n}\n\n\nif you set svgdefaultexport to 'component', then change the type declaration to:\n\ndeclare module '*.svg' {\n  export const reactcomponent: react.functioncomponent<\n    react.svgprops<svgsvgelement>\n  >;\n\n  export default reactcomponent;\n}\n\n\nafter adding the type declaration, if the type error still exists, you can try to restart the current ide, or adjust the directory where global.d.ts is located, making sure the typescript can correctly identify the type definition.",charsets:{}},{title:"Use TypeScript",frontmatter:{},regularPath:"/en/guide/basic/typescript.html",relativePath:"en/guide/basic/typescript.md",key:"v-918c2668",path:"/en/guide/basic/typescript.html",headers:[{level:2,title:"TypeScript compilation",slug:"typescript-compilation",normalizedTitle:"typescript compilation",charIndex:35},{level:2,title:"Type checking",slug:"type-checking",normalizedTitle:"type checking",charIndex:1832}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"TypeScript compilation Type checking",content:"# Use TypeScript\n\nBuilder supports TypeScript compilation and type checking by default, you can use . ts and `. tsx' files in the project without any configuration.\n\n\n# TypeScript compilation\n\nBuilder has three ways to compile TypeScript files.\n\nBabel\n\nBy default, all TypeScript files are compiled by Babel.\n\nYou may find some old articles pointing out that Babel cannot handle const enum and namespace alias syntax, however since version 7.15 Babel has supported them. Babel compile is enabled by default.\n\nIf you want more Babel plugins\n\nts-loader\n\nThe ts-loader uses TypeScript's official compiler-TSC under the hood. When ts-loader is enabled, TypeScript files will no longer be compiled by Babel, but Babel will still inject polyfill into the TSC output and transform it to the lower version of JavaScript.\n\nEnable ts-loader(with default options):\n\nexport default {\n  tools: {\n    tsLoader: {},\n  },\n};\n\n\nMore configuration can be found at tools.tsLoader.\n\nIf ts-loader is enabled with default configuration, it does not have type checking, we do type checking by fork-ts-checker-webpack-plugin.\n\nSWC\n\nIf you want a super fast compiler, and you don't need some custom Babel plugins, then you can use SWC for compilation and minification.\n\nSWC plugin in Builder supports TypeScript, TSX and legacy decorator, you can check SWC plugin.\n\n\n# Why Babel is the default option\n\nBabel supports TypeScript well. It cannot check types, but we can check types in another process. Babel follows standards more when compiled to lower versions of JavaScript in certain situations. For example, Babel will initialize class members as undefined, and mark class methods as non-enumerable. If TSC is enabled, for better syntax downgrading and Polyfill, the TSC output will still be compiled by Babel, causing unnecessary performance costs.\n\n\n# Type checking\n\nCurrently, the only stable TypeScript type checking tool is TSC, and it usually takes a while to check types in a large project, so Builder by default using tsChecker(fork-ts-checker-webpack-plugin) for asynchronous type checking, it won't block project setup.\n\nSet tsChecker(with default options):\n\nexport default {\n  tools: {\n    tsChecker: {},\n  },\n};\n\n\nMore configurations can be seen at tsChecker configuration。\n\nNote that if ts-loader is enabled and compileOnly: false is set, please disable tsChecker to avoid duplicate type-checking.\n\nSTC\n\nThe author of SWC has announced a new open-source type-checking tool based on Rust, which is called STC, it's super fast but it cannot used for production now, really don't recommend you use that for now, when it's stabled we will use that in Builder SWC plugin as experimental ability.",normalizedContent:"# use typescript\n\nbuilder supports typescript compilation and type checking by default, you can use . ts and `. tsx' files in the project without any configuration.\n\n\n# typescript compilation\n\nbuilder has three ways to compile typescript files.\n\nbabel\n\nby default, all typescript files are compiled by babel.\n\nyou may find some old articles pointing out that babel cannot handle const enum and namespace alias syntax, however since version 7.15 babel has supported them. babel compile is enabled by default.\n\nif you want more babel plugins\n\nts-loader\n\nthe ts-loader uses typescript's official compiler-tsc under the hood. when ts-loader is enabled, typescript files will no longer be compiled by babel, but babel will still inject polyfill into the tsc output and transform it to the lower version of javascript.\n\nenable ts-loader(with default options):\n\nexport default {\n  tools: {\n    tsloader: {},\n  },\n};\n\n\nmore configuration can be found at tools.tsloader.\n\nif ts-loader is enabled with default configuration, it does not have type checking, we do type checking by fork-ts-checker-webpack-plugin.\n\nswc\n\nif you want a super fast compiler, and you don't need some custom babel plugins, then you can use swc for compilation and minification.\n\nswc plugin in builder supports typescript, tsx and legacy decorator, you can check swc plugin.\n\n\n# why babel is the default option\n\nbabel supports typescript well. it cannot check types, but we can check types in another process. babel follows standards more when compiled to lower versions of javascript in certain situations. for example, babel will initialize class members as undefined, and mark class methods as non-enumerable. if tsc is enabled, for better syntax downgrading and polyfill, the tsc output will still be compiled by babel, causing unnecessary performance costs.\n\n\n# type checking\n\ncurrently, the only stable typescript type checking tool is tsc, and it usually takes a while to check types in a large project, so builder by default using tschecker(fork-ts-checker-webpack-plugin) for asynchronous type checking, it won't block project setup.\n\nset tschecker(with default options):\n\nexport default {\n  tools: {\n    tschecker: {},\n  },\n};\n\n\nmore configurations can be seen at tschecker configuration。\n\nnote that if ts-loader is enabled and compileonly: false is set, please disable tschecker to avoid duplicate type-checking.\n\nstc\n\nthe author of swc has announced a new open-source type-checking tool based on rust, which is called stc, it's super fast but it cannot used for production now, really don't recommend you use that for now, when it's stabled we will use that in builder swc plugin as experimental ability.",charsets:{}},{title:"Using Webpack Inspector",frontmatter:{},regularPath:"/en/guide/debug/inspector.html",relativePath:"en/guide/debug/inspector.md",key:"v-5ecee514",path:"/en/guide/debug/inspector.html",headers:[{level:2,title:"Introduce",slug:"introduce",normalizedTitle:"introduce",charIndex:90},{level:2,title:"Enable",slug:"enable",normalizedTitle:"enable",charIndex:714},{level:2,title:"Debug Panel",slug:"debug-panel",normalizedTitle:"debug panel",charIndex:1446}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Introduce Enable Debug Panel",content:"# Using Webpack Inspector\n\nBuilder has a built-in webpack inspector to debug webpack.\n\n\n# Introduce\n\nThe internal workflow of webpack is relatively black box, when using webpack, we often encounter the following problems:\n\n * When using some upper-level frameworks, I don't know what the final generated webpack config contains.\n * Each module will be processed by different loaders, and the compilation results of each loader are difficult to perceive.\n * It is difficult to analyze the time cost of each webpack loader (such as babel-loader, ts-loader).\n\nIn order to make performance analysis, error investigation and loader development more convenient, we provide the webpack inspector tool in the Builder.\n\n\n# Enable\n\nYou can enable webpack inspector through tools.inspector config:\n\nexport default {\n  tools: {\n    inspector: {},\n  },\n};\n\n\nIn order to prevent the inspector from affecting normal development, it is recommended to enable the inspector only in DEBUG mode:\n\nexport default {\n  tools: {\n    inspector: process.env.DEBUG ? {} : undefined,\n  },\n};\n\n\nAfter adding the above config, when you execute DEBUG=true pnpm dev, Builder will start the inspector after the compilation is complete. At this time, you can see the following information in the Shell:\n\ninfo    Starting dev server...\n\n【Webpack Inspector】🔥 started at http://localhost:3333\n\n\nOpen the http://localhost:3333 address to access the debug panel of the inspector.\n\n\n# Debug Panel\n\nThe Inspector's debugging panel provides multiple modes, which you can switch through the buttons in the upper right corner.\n\n\n# Config Preview Mode\n\nThe default mode of the panel is config preview mode. In this mode, you can view all config information inside webpack, and the config object can be expanded or collapsed:\n\n\n\n\n# List Mode\n\nIn this mode, all module information will be displayed:\n\n\n\nClicking on the list item will display the compilation details of the module:\n\n\n\n\n# Loader Statistics\n\nClick the following switch to view loader statistics:\n\n\n\n\n# Dependency Graph Mode\n\nIn this mode, the dependencies of all modules will be displayed:\n\n\n\nClicking on a node in the graph will also display the compilation details of the specific module:\n\n\n\nTIP\n\nFor performance reasons, the dependency graph is not displayed when the number of modules is > 100.",normalizedContent:"# using webpack inspector\n\nbuilder has a built-in webpack inspector to debug webpack.\n\n\n# introduce\n\nthe internal workflow of webpack is relatively black box, when using webpack, we often encounter the following problems:\n\n * when using some upper-level frameworks, i don't know what the final generated webpack config contains.\n * each module will be processed by different loaders, and the compilation results of each loader are difficult to perceive.\n * it is difficult to analyze the time cost of each webpack loader (such as babel-loader, ts-loader).\n\nin order to make performance analysis, error investigation and loader development more convenient, we provide the webpack inspector tool in the builder.\n\n\n# enable\n\nyou can enable webpack inspector through tools.inspector config:\n\nexport default {\n  tools: {\n    inspector: {},\n  },\n};\n\n\nin order to prevent the inspector from affecting normal development, it is recommended to enable the inspector only in debug mode:\n\nexport default {\n  tools: {\n    inspector: process.env.debug ? {} : undefined,\n  },\n};\n\n\nafter adding the above config, when you execute debug=true pnpm dev, builder will start the inspector after the compilation is complete. at this time, you can see the following information in the shell:\n\ninfo    starting dev server...\n\n【webpack inspector】🔥 started at http://localhost:3333\n\n\nopen the http://localhost:3333 address to access the debug panel of the inspector.\n\n\n# debug panel\n\nthe inspector's debugging panel provides multiple modes, which you can switch through the buttons in the upper right corner.\n\n\n# config preview mode\n\nthe default mode of the panel is config preview mode. in this mode, you can view all config information inside webpack, and the config object can be expanded or collapsed:\n\n\n\n\n# list mode\n\nin this mode, all module information will be displayed:\n\n\n\nclicking on the list item will display the compilation details of the module:\n\n\n\n\n# loader statistics\n\nclick the following switch to view loader statistics:\n\n\n\n\n# dependency graph mode\n\nin this mode, the dependencies of all modules will be displayed:\n\n\n\nclicking on a node in the graph will also display the compilation details of the specific module:\n\n\n\ntip\n\nfor performance reasons, the dependency graph is not displayed when the number of modules is > 100.",charsets:{}},{title:"Exceptions",frontmatter:{},regularPath:"/en/guide/faq/exceptions.html",relativePath:"en/guide/faq/exceptions.md",key:"v-65ca61ec",path:"/en/guide/faq/exceptions.html",headers:[{level:2,title:"'compilation' argument error when webpack compiling?",slug:"compilation-argument-error-when-webpack-compiling",normalizedTitle:"'compilation' argument error when webpack compiling?",charIndex:17},{level:2,title:"Find ES6+ code in the compiled files?",slug:"find-es6-code-in-the-compiled-files",normalizedTitle:"find es6+ code in the compiled files?",charIndex:1875},{level:2,title:"Failed import other modules in Monorepo?",slug:"failed-import-other-modules-in-monorepo",normalizedTitle:"failed import other modules in monorepo?",charIndex:2264},{level:2,title:"Compile error You may need additional loader?",slug:"compile-error-you-may-need-additional-loader",normalizedTitle:"compile error you may need additional loader?",charIndex:2690},{level:2,title:"Find exports is not defined runtime error?",slug:"find-exports-is-not-defined-runtime-error",normalizedTitle:"find exports is not defined runtime error?",charIndex:3422},{level:2,title:'Compile error "Error: ES Modules may not assign module.exports or exports.*, Use ESM export syntax"?',slug:"compile-error-error-es-modules-may-not-assign-module-exports-or-exports-use-esm-export-syntax",normalizedTitle:"compile error &quot;error: es modules may not assign module.exports or exports.*, use esm export syntax&quot;?",charIndex:null},{level:2,title:"The compilation progress bar is stuck, but there is no Error log in the terminal?",slug:"the-compilation-progress-bar-is-stuck-but-there-is-no-error-log-in-the-terminal",normalizedTitle:"the compilation progress bar is stuck, but there is no error log in the terminal?",charIndex:4781},{level:2,title:"The webpack cache does not work?",slug:"the-webpack-cache-does-not-work",normalizedTitle:"the webpack cache does not work?",charIndex:6658},{level:2,title:"Tree Shaking does not take effect?",slug:"tree-shaking-does-not-take-effect",normalizedTitle:"tree shaking does not take effect?",charIndex:7612},{level:2,title:"JavaScript heap out of memory when compiling?",slug:"javascript-heap-out-of-memory-when-compiling",normalizedTitle:"javascript heap out of memory when compiling?",charIndex:8206},{level:2,title:"Division in Less file doesn't work?",slug:"division-in-less-file-doesn-t-work",normalizedTitle:"division in less file doesn't work?",charIndex:9106},{level:2,title:"Compile error ‘TypeError: Cannot delete property 'xxx' of #<Object\\>’",slug:"compile-error-typeerror-cannot-delete-property-xxx-of-object",normalizedTitle:"compile error ‘typeerror: cannot delete property 'xxx' of #&lt;object&gt;’",charIndex:null}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"'compilation' argument error when webpack compiling? Find ES6+ code in the compiled files? Failed import other modules in Monorepo? Compile error You may need additional loader? Find exports is not defined runtime error? Compile error \"Error: ES Modules may not assign module.exports or exports.*, Use ESM export syntax\"? The compilation progress bar is stuck, but there is no Error log in the terminal? The webpack cache does not work? Tree Shaking does not take effect? JavaScript heap out of memory when compiling? Division in Less file doesn't work? Compile error ‘TypeError: Cannot delete property 'xxx' of #<Object\\>’",content:"# Exceptions\n\n\n# 'compilation' argument error when webpack compiling?\n\nIf the following error occurs when compiling, it is usually caused by installing the wrong version of webpack in the project, or installing multiple versions of webpack:\n\nTypeError: The 'compilation' argument must be an instance of Compilation\n\n\nThe webpack version problem has the following situations:\n\n 1. The webpack dependency is directly declared in the project's package.json, and the version range of the webpack that the Builder depends on is different and cannot match the same version.\n 2. Multiple npm packages installed in the project all depend on webpack, and the webpack version ranges they depend on are different and cannot match the same version.\n 3. Due to the lock mechanism of the package manager, multiple webpack versions are generated in the lock file.\n\nIn the first case, it is recommended to remove the webpack dependency from the project's package.json. Because Builder encapsulates webpack-related capabilities by default, and will pass in the webpack object in the tools.webpack configuration item. Therefore, in most cases, it is not recommended to install additional webpack dependencies in the project.\n\nIn the second case, it is recommended to see if you can upgrade an npm package so that its dependent webpack version range is consistent with the Builder. It is also possible to manually unify versions through the ability of the package manager, e.g. using yarn resolutions or [pnpm overrides](https 😕/pnpm.io/package_json#pnpmoverrides).\n\nIf it is the third case, you can use the two methods mentioned in the second case, or you can try to delete the lock file and reinstall it to solve it.\n\nTIP\n\nDeleting the lock file will automatically upgrade the dependency version in the project to the latest version under the specified scope, please test it thoroughly.\n\n\n# Find ES6+ code in the compiled files?\n\nBy default, Builder will not compile files under node_modules through babel-loader or ts-loader. If the npm package introduced by the project contains ES6+ syntax, it will be packaged into the product.\n\nWhen this happens, you can specify directories or modules that need to be compiled additionally through the source.include configuration item.\n\n\n# Failed import other modules in Monorepo?\n\nFor the sake of compilation performance, by default, Builder will not compile files under node_modules through babel-loader or ts-loader, nor will it compile files outside the current project directory.\n\nThrough the source.include configuration item, you can specify directories or modules that require additional compilation.\n\nFor details, see source.include usage introduction.\n\n\n# Compile error You may need additional loader?\n\nIf the following error message is encountered during the compilation process, it means that there are individual files that cannot be compiled correctly.\n\nModule parse failed: Unexpected token\nFile was processed with these loaders:\n * some-loader/index.js\n\nYou may need an additional loader to handle the result of these loaders.\n\n\nSolution:\n\n * If the .ts file outside the current project is referenced, or the .ts file under node_modules, please add the source.include configuration Items that specify files that require additional compilation.\n * If you refer to a file format that is not supported by Builder, please configure the corresponding webpack loader for compilation.\n\n\n# Find exports is not defined runtime error?\n\nIf the compilation is succeed, but the exports is not defined error appears after opening the page, it is usually because a CommonJS module is compiled by babel.\n\nUnder normal circumstances, Builder will not use babel to compile CommonJS modules. If the source.include configuration item is used in the project, or the [tools.babel](/en/api/config-tools.html#tools -babel) addIncludes method, some CommonJS modules may be added to the babel compilation.\n\nThere are two workarounds for this problem:\n\n 1. Avoid adding CommonJS modules to babel compilation.\n 2. Set babel's sourceType configuration item to unambiguous, for example:\n\nexport default {\n  tools: {\n    babel(config) {\n      config.sourceType = 'unambiguous';\n    },\n  },\n};\n\n\nSetting sourceType to unambiguous may have some other effects, please refer to babel official documentation.\n\n\n# Compile error \"Error: ES Modules may not assign module.exports or exports.*, Use ESM export syntax\"?\n\nIf the following error occurs during compilation, it is usually because a CommonJS module is compiled with babel in the project, and the solution is same as the above exports is not defined problem.\n\nError: ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: 581\n\n\nFor more information, please refer to issue: babel#12731.\n\n\n# The compilation progress bar is stuck, but there is no Error log in the terminal?\n\nWhen the compilation progress bar is stuck, but there is no Error log on the terminal, it is usually because an exception occurred during the compilation. In some cases, when Error is caught by webpack or other modules, the error log can not be output correctly. The most common scenario is that there is an exception in the Babel config, which is caught by webpack, and webpack swallows the Error in some cases.\n\nSolution:\n\nIf this problem occurs after you modify the Babel config, it is recommended to check for the following incorrect usages:\n\n 1. You have configured a plugin or preset that does not exist, maybe the name is misspelled, or it is not installed correctly.\n\n// wrong example\nexport default {\n  tools: {\n    babel(config, { addPlugins }) {\n      // The plugin has the wrong name or is not installed\n      addPlugins('babel-plugin-not-exists');\n    },\n  },\n};\n\n\n 2. Whether multiple babel-plugin-imports are configured, but the name of each babel-plugin-import is not declared in the third item of the array.\n\n// wrong example\nexport default {\n  tools: {\n    babel(config, { addPlugins }) {\n      addPlugins([\n        [\n          'babel-plugin-import',\n          { libraryName: 'antd', libraryDirectory: 'es' },\n        ],\n        [\n          'babel-plugin-import',\n          { libraryName: 'antd-mobile', libraryDirectory: 'es' },\n        ],\n      ]);\n    },\n  },\n};\n\n\n// correct example\nexport default {\n  tools: {\n    babel(config, { addPlugins }) {\n      addPlugins([\n        [\n          'babel-plugin-import',\n          { libraryName: 'antd', libraryDirectory: 'es' },\n          'antd',\n        ],\n        [\n          'babel-plugin-import',\n          { libraryName: 'antd-mobile', libraryDirectory: 'es' },\n          'antd-mobile',\n        ],\n      ]);\n    },\n  },\n};\n\n\n\n# The webpack cache does not work?\n\nBuilder enables webpack's persistent cache by default.\n\nAfter the first compilation is completed, the cache file will be automatically generated and output to the ./node_modules/.cache/webpack directory. When the second compilation is performed, the cache is hit and the compilation speed is greatly improved.\n\nWhen configuration files such as package.json are modified, the cache is automatically invalidated.\n\nIf the webpack compilation cache in the project has not taken effect, you can add the following configuration for troubleshooting:\n\nexport default {\n  tools: {\n    webpack(config) {\n      config.infrastructureLogging = {\n        ...config.infrastructureLogging,\n        debug: /webpack\\.cache/,\n      };\n    },\n  },\n};\n\n\nAfter adding the above configuration, webpack will output logs for debugging. Please refer to the logs related to PackFileCacheStrategy to understand the cause of cache invalidation.\n\n\n# Tree Shaking does not take effect?\n\nBuilder will enable the Tree Shaking function of webpack by default during production construction. Whether Tree Shaking can take effect depends on whether the business code can meet the Tree Shaking conditions of webpack.\n\nIf you encounter the problem that Tree Shaking does not take effect, you can check whether the sideEffects configuration of the relevant npm package is correct. If you don't know what sideEffects is, you can read the following two documents:\n\n * webpack official documentation - Tree Shaking\n * Tree Shaking Troubleshooting Guide\n\n\n# JavaScript heap out of memory when compiling?\n\nThis error indicates that there is a memory overflow problem during the packaging process. In most cases, it is because the packaged content exceeds the default memory limit of Node.js.\n\nIn case of OOM issues, the easiest way to fix this is by increasing the memory cap, Node.js provides the --max-old-space-size option to set this. You can set this parameter by adding NODE_OPTIONS before the CLI command:\n\nNODE_OPTIONS=--max_old_space_size=16384 modern build\n\n\nThe value of the parameter represents the upper limit of the memory size (MB). Generally, it can be set to 16384 (16GB).\n\nThe following parameters are explained in more detail in the official Node.js documentation:\n\n * NODE_OPTIONS\n * --max-old-space-size\n\nIn addition to increasing the memory limit, it is also a solution to improve efficiency by enabling some compilation strategies.\n\n\n# Division in Less file doesn't work?\n\nCompared with the v3 version, the Less v4 version has some differences in the way of writing division:\n\n// Less v3\n.math {\n  width: 2px / 2; // 1px\n  width: 2px ./ 2; // 1px\n  width: (2px / 2); // 1px\n}\n\n// Less v4\n.math {\n  width: 2px / 2; // 2px / 2\n  width: 2px ./ 2; // 1px\n  width: (2px / 2); // 1px\n}\n\n\nThe built-in Less version of Builder is v4, and the writing method of the lower version will not take effect. Please pay attention to the distinction.\n\nThe writing of division in Less can also be modified through configuration items, see Less - Math.\n\n\n# Compile error ‘TypeError: Cannot delete property 'xxx' of #<Object>’\n\nThis error indicates that a read-only configuration item was deleted during the compilation process. Normally, we do not want any operation to directly modify the incoming configuration when compiling, but it is difficult to restrict the behavior of underlying plugins (such as postcss-loader, etc). If this error occurs, please contact the builder developer and we will need to do something special with that configuration.\n\nThe same type of error is also reported:\n\n * 'TypeError: Cannot add property xxx, object is not extensible'\n * 'TypeError: Cannot assign to read only property 'xxx' of object '#<Object>'",normalizedContent:"# exceptions\n\n\n# 'compilation' argument error when webpack compiling?\n\nif the following error occurs when compiling, it is usually caused by installing the wrong version of webpack in the project, or installing multiple versions of webpack:\n\ntypeerror: the 'compilation' argument must be an instance of compilation\n\n\nthe webpack version problem has the following situations:\n\n 1. the webpack dependency is directly declared in the project's package.json, and the version range of the webpack that the builder depends on is different and cannot match the same version.\n 2. multiple npm packages installed in the project all depend on webpack, and the webpack version ranges they depend on are different and cannot match the same version.\n 3. due to the lock mechanism of the package manager, multiple webpack versions are generated in the lock file.\n\nin the first case, it is recommended to remove the webpack dependency from the project's package.json. because builder encapsulates webpack-related capabilities by default, and will pass in the webpack object in the tools.webpack configuration item. therefore, in most cases, it is not recommended to install additional webpack dependencies in the project.\n\nin the second case, it is recommended to see if you can upgrade an npm package so that its dependent webpack version range is consistent with the builder. it is also possible to manually unify versions through the ability of the package manager, e.g. using yarn resolutions or [pnpm overrides](https 😕/pnpm.io/package_json#pnpmoverrides).\n\nif it is the third case, you can use the two methods mentioned in the second case, or you can try to delete the lock file and reinstall it to solve it.\n\ntip\n\ndeleting the lock file will automatically upgrade the dependency version in the project to the latest version under the specified scope, please test it thoroughly.\n\n\n# find es6+ code in the compiled files?\n\nby default, builder will not compile files under node_modules through babel-loader or ts-loader. if the npm package introduced by the project contains es6+ syntax, it will be packaged into the product.\n\nwhen this happens, you can specify directories or modules that need to be compiled additionally through the source.include configuration item.\n\n\n# failed import other modules in monorepo?\n\nfor the sake of compilation performance, by default, builder will not compile files under node_modules through babel-loader or ts-loader, nor will it compile files outside the current project directory.\n\nthrough the source.include configuration item, you can specify directories or modules that require additional compilation.\n\nfor details, see source.include usage introduction.\n\n\n# compile error you may need additional loader?\n\nif the following error message is encountered during the compilation process, it means that there are individual files that cannot be compiled correctly.\n\nmodule parse failed: unexpected token\nfile was processed with these loaders:\n * some-loader/index.js\n\nyou may need an additional loader to handle the result of these loaders.\n\n\nsolution:\n\n * if the .ts file outside the current project is referenced, or the .ts file under node_modules, please add the source.include configuration items that specify files that require additional compilation.\n * if you refer to a file format that is not supported by builder, please configure the corresponding webpack loader for compilation.\n\n\n# find exports is not defined runtime error?\n\nif the compilation is succeed, but the exports is not defined error appears after opening the page, it is usually because a commonjs module is compiled by babel.\n\nunder normal circumstances, builder will not use babel to compile commonjs modules. if the source.include configuration item is used in the project, or the [tools.babel](/en/api/config-tools.html#tools -babel) addincludes method, some commonjs modules may be added to the babel compilation.\n\nthere are two workarounds for this problem:\n\n 1. avoid adding commonjs modules to babel compilation.\n 2. set babel's sourcetype configuration item to unambiguous, for example:\n\nexport default {\n  tools: {\n    babel(config) {\n      config.sourcetype = 'unambiguous';\n    },\n  },\n};\n\n\nsetting sourcetype to unambiguous may have some other effects, please refer to babel official documentation.\n\n\n# compile error \"error: es modules may not assign module.exports or exports.*, use esm export syntax\"?\n\nif the following error occurs during compilation, it is usually because a commonjs module is compiled with babel in the project, and the solution is same as the above exports is not defined problem.\n\nerror: es modules may not assign module.exports or exports.*, use esm export syntax, instead: 581\n\n\nfor more information, please refer to issue: babel#12731.\n\n\n# the compilation progress bar is stuck, but there is no error log in the terminal?\n\nwhen the compilation progress bar is stuck, but there is no error log on the terminal, it is usually because an exception occurred during the compilation. in some cases, when error is caught by webpack or other modules, the error log can not be output correctly. the most common scenario is that there is an exception in the babel config, which is caught by webpack, and webpack swallows the error in some cases.\n\nsolution:\n\nif this problem occurs after you modify the babel config, it is recommended to check for the following incorrect usages:\n\n 1. you have configured a plugin or preset that does not exist, maybe the name is misspelled, or it is not installed correctly.\n\n// wrong example\nexport default {\n  tools: {\n    babel(config, { addplugins }) {\n      // the plugin has the wrong name or is not installed\n      addplugins('babel-plugin-not-exists');\n    },\n  },\n};\n\n\n 2. whether multiple babel-plugin-imports are configured, but the name of each babel-plugin-import is not declared in the third item of the array.\n\n// wrong example\nexport default {\n  tools: {\n    babel(config, { addplugins }) {\n      addplugins([\n        [\n          'babel-plugin-import',\n          { libraryname: 'antd', librarydirectory: 'es' },\n        ],\n        [\n          'babel-plugin-import',\n          { libraryname: 'antd-mobile', librarydirectory: 'es' },\n        ],\n      ]);\n    },\n  },\n};\n\n\n// correct example\nexport default {\n  tools: {\n    babel(config, { addplugins }) {\n      addplugins([\n        [\n          'babel-plugin-import',\n          { libraryname: 'antd', librarydirectory: 'es' },\n          'antd',\n        ],\n        [\n          'babel-plugin-import',\n          { libraryname: 'antd-mobile', librarydirectory: 'es' },\n          'antd-mobile',\n        ],\n      ]);\n    },\n  },\n};\n\n\n\n# the webpack cache does not work?\n\nbuilder enables webpack's persistent cache by default.\n\nafter the first compilation is completed, the cache file will be automatically generated and output to the ./node_modules/.cache/webpack directory. when the second compilation is performed, the cache is hit and the compilation speed is greatly improved.\n\nwhen configuration files such as package.json are modified, the cache is automatically invalidated.\n\nif the webpack compilation cache in the project has not taken effect, you can add the following configuration for troubleshooting:\n\nexport default {\n  tools: {\n    webpack(config) {\n      config.infrastructurelogging = {\n        ...config.infrastructurelogging,\n        debug: /webpack\\.cache/,\n      };\n    },\n  },\n};\n\n\nafter adding the above configuration, webpack will output logs for debugging. please refer to the logs related to packfilecachestrategy to understand the cause of cache invalidation.\n\n\n# tree shaking does not take effect?\n\nbuilder will enable the tree shaking function of webpack by default during production construction. whether tree shaking can take effect depends on whether the business code can meet the tree shaking conditions of webpack.\n\nif you encounter the problem that tree shaking does not take effect, you can check whether the sideeffects configuration of the relevant npm package is correct. if you don't know what sideeffects is, you can read the following two documents:\n\n * webpack official documentation - tree shaking\n * tree shaking troubleshooting guide\n\n\n# javascript heap out of memory when compiling?\n\nthis error indicates that there is a memory overflow problem during the packaging process. in most cases, it is because the packaged content exceeds the default memory limit of node.js.\n\nin case of oom issues, the easiest way to fix this is by increasing the memory cap, node.js provides the --max-old-space-size option to set this. you can set this parameter by adding node_options before the cli command:\n\nnode_options=--max_old_space_size=16384 modern build\n\n\nthe value of the parameter represents the upper limit of the memory size (mb). generally, it can be set to 16384 (16gb).\n\nthe following parameters are explained in more detail in the official node.js documentation:\n\n * node_options\n * --max-old-space-size\n\nin addition to increasing the memory limit, it is also a solution to improve efficiency by enabling some compilation strategies.\n\n\n# division in less file doesn't work?\n\ncompared with the v3 version, the less v4 version has some differences in the way of writing division:\n\n// less v3\n.math {\n  width: 2px / 2; // 1px\n  width: 2px ./ 2; // 1px\n  width: (2px / 2); // 1px\n}\n\n// less v4\n.math {\n  width: 2px / 2; // 2px / 2\n  width: 2px ./ 2; // 1px\n  width: (2px / 2); // 1px\n}\n\n\nthe built-in less version of builder is v4, and the writing method of the lower version will not take effect. please pay attention to the distinction.\n\nthe writing of division in less can also be modified through configuration items, see less - math.\n\n\n# compile error ‘typeerror: cannot delete property 'xxx' of #<object>’\n\nthis error indicates that a read-only configuration item was deleted during the compilation process. normally, we do not want any operation to directly modify the incoming configuration when compiling, but it is difficult to restrict the behavior of underlying plugins (such as postcss-loader, etc). if this error occurs, please contact the builder developer and we will need to do something special with that configuration.\n\nthe same type of error is also reported:\n\n * 'typeerror: cannot add property xxx, object is not extensible'\n * 'typeerror: cannot assign to read only property 'xxx' of object '#<object>'",charsets:{}},{title:"Features",frontmatter:{},regularPath:"/en/guide/faq/features.html",relativePath:"en/guide/faq/features.md",key:"v-7a63004c",path:"/en/guide/faq/features.html",headers:[{level:2,title:"How to import UI Component library on demand?",slug:"how-to-import-ui-component-library-on-demand",normalizedTitle:"how to import ui component library on demand?",charIndex:15},{level:2,title:"How to run ESLint during compilation?",slug:"how-to-run-eslint-during-compilation",normalizedTitle:"how to run eslint during compilation?",charIndex:549},{level:2,title:"How to configure CDN path for static assets?",slug:"how-to-configure-cdn-path-for-static-assets",normalizedTitle:"how to configure cdn path for static assets?",charIndex:1272},{level:2,title:"How to clear the webpack cache?",slug:"how-to-clear-the-webpack-cache",normalizedTitle:"how to clear the webpack cache?",charIndex:1574},{level:2,title:"How to remove console after production build?",slug:"how-to-remove-console-after-production-build",normalizedTitle:"how to remove console after production build?",charIndex:1825}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"How to import UI Component library on demand? How to run ESLint during compilation? How to configure CDN path for static assets? How to clear the webpack cache? How to remove console after production build?",content:"# Features\n\n\n# How to import UI Component library on demand?\n\nIf you need to configure the on-demand import of component libraries, you can configure [babel-plugin-import](https://github.com/ through tools.babel umijs/babel-plugin-import) plugin.\n\nexport default {\n  tools: {\n    babel: (config, { addPlugins }) => {\n      addPlugins([\n        [\n          'babel-plugin-import',\n          {\n            libraryName: 'xxx-components',\n            libraryDirectory: 'es',\n            style: true,\n          },\n        ],\n      ]);\n    },\n  },\n};\n\n\n\n# How to run ESLint during compilation?\n\nFor the sake of compilation performance, Builder will not perform ESLint verification during the compilation process by default. If you need this function, you can manually install and register the eslint-webpack-plugin in the community -contrib/eslint-webpack-plugin).\n\nThe sample code to register the plugin is as follows:\n\nimport ESLintPlugin from 'eslint-webpack-plugin';\n\nexport default {\n  tools: {\n    webpackChain(chain) {\n      chain.plugin('eslint-plugin').use(ESLintPlugin, [\n        {\n          extensions: ['.js', '.ts', '.jsx', 'tsx', '.mjs'],\n        },\n      ]);\n    },\n  },\n};\n\n\n> For more detailed usage, please refer to the eslint-webpack-plugin documentation.\n\n\n# How to configure CDN path for static assets?\n\nIf you need to upload static assets such as JS and CSS to CDN for use, you can set the URL prefix of static assets through the output.assetPrefix configuration.\n\nexport default {\n  output: {\n    assetPrefix: 'https://cdn.example.com/assets/',\n  },\n};\n\n\n\n# How to clear the webpack cache?\n\nBy default, Builder's webpack cache is generated in the ./node_modules/.cache/webpack directory.\n\nIf you need to clear the local webpack cache, you can execute the following command:\n\nrm -rf ./node_modules/.cache\n\n\n\n# How to remove console after production build?\n\nWhen the production environment is built, we can remove the console from the code, so as to avoid the log of the development environment being output to the production environment.\n\nBuilder provides a configuration item to remove console by default, please see performance.removeConsole.",normalizedContent:"# features\n\n\n# how to import ui component library on demand?\n\nif you need to configure the on-demand import of component libraries, you can configure [babel-plugin-import](https://github.com/ through tools.babel umijs/babel-plugin-import) plugin.\n\nexport default {\n  tools: {\n    babel: (config, { addplugins }) => {\n      addplugins([\n        [\n          'babel-plugin-import',\n          {\n            libraryname: 'xxx-components',\n            librarydirectory: 'es',\n            style: true,\n          },\n        ],\n      ]);\n    },\n  },\n};\n\n\n\n# how to run eslint during compilation?\n\nfor the sake of compilation performance, builder will not perform eslint verification during the compilation process by default. if you need this function, you can manually install and register the eslint-webpack-plugin in the community -contrib/eslint-webpack-plugin).\n\nthe sample code to register the plugin is as follows:\n\nimport eslintplugin from 'eslint-webpack-plugin';\n\nexport default {\n  tools: {\n    webpackchain(chain) {\n      chain.plugin('eslint-plugin').use(eslintplugin, [\n        {\n          extensions: ['.js', '.ts', '.jsx', 'tsx', '.mjs'],\n        },\n      ]);\n    },\n  },\n};\n\n\n> for more detailed usage, please refer to the eslint-webpack-plugin documentation.\n\n\n# how to configure cdn path for static assets?\n\nif you need to upload static assets such as js and css to cdn for use, you can set the url prefix of static assets through the output.assetprefix configuration.\n\nexport default {\n  output: {\n    assetprefix: 'https://cdn.example.com/assets/',\n  },\n};\n\n\n\n# how to clear the webpack cache?\n\nby default, builder's webpack cache is generated in the ./node_modules/.cache/webpack directory.\n\nif you need to clear the local webpack cache, you can execute the following command:\n\nrm -rf ./node_modules/.cache\n\n\n\n# how to remove console after production build?\n\nwhen the production environment is built, we can remove the console from the code, so as to avoid the log of the development environment being output to the production environment.\n\nbuilder provides a configuration item to remove console by default, please see performance.removeconsole.",charsets:{}},{title:"General",frontmatter:{},regularPath:"/en/guide/faq/general.html",relativePath:"en/guide/faq/general.md",key:"v-13197cac",path:"/en/guide/faq/general.html",headers:[{level:2,title:"The relationship between Modern.js Builder and Modern.js?",slug:"the-relationship-between-modern-js-builder-and-modern-js",normalizedTitle:"the relationship between modern.js builder and modern.js?",charIndex:14},{level:2,title:"Can Builder be used to build libraries or UI components?",slug:"can-builder-be-used-to-build-libraries-or-ui-components",normalizedTitle:"can builder be used to build libraries or ui components?",charIndex:415},{level:2,title:"Will Builder support Turbopack?",slug:"will-builder-support-turbopack",normalizedTitle:"will builder support turbopack?",charIndex:721},{level:2,title:"Will Builder support Vite?",slug:"will-builder-support-vite",normalizedTitle:"will builder support vite?",charIndex:1051}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"The relationship between Modern.js Builder and Modern.js? Can Builder be used to build libraries or UI components? Will Builder support Turbopack? Will Builder support Vite?",content:"# General\n\n\n# The relationship between Modern.js Builder and Modern.js?\n\nThe building abilities of Modern.js 2.0 are based on Modern.js Builder.\n\nWhen developing Modern.js 2.0, we designed Builder as an independent module, and clearly divided the responsibilities of Builder and Modern.js. Therefore, Builder can be used independently of the Modern.js framework and be applied to other frameworks or scenarios.\n\n\n# Can Builder be used to build libraries or UI components?\n\nBuilder focuses on solving web application building scenarios. We do not recommend that you use Builder to build libraries or UI components.\n\nIf you need to build a library or UI components, it is recommended to use the Modern.js module tools.\n\n\n# Will Builder support Turbopack?\n\nTurbopack is the rust-powered successor to webpack, we will continue to pay attention to it.\n\nAt present, Turbopack only supports use in Next.js. When Turbopack can be used independently, and the completion and community ecology reach a certain level, we will consider supporting it for sure.\n\n\n# Will Builder support Vite?\n\nVite is a great tool, but the goal of Builder is to replace webpack with Rust Bundler, Rust Builder can provide fast compilation speed, while maintaining the consistent behavior between development and production.\n\nBuilder will focus on the evolution from webpack to Rust Builder, so it will not be support Vite.",normalizedContent:"# general\n\n\n# the relationship between modern.js builder and modern.js?\n\nthe building abilities of modern.js 2.0 are based on modern.js builder.\n\nwhen developing modern.js 2.0, we designed builder as an independent module, and clearly divided the responsibilities of builder and modern.js. therefore, builder can be used independently of the modern.js framework and be applied to other frameworks or scenarios.\n\n\n# can builder be used to build libraries or ui components?\n\nbuilder focuses on solving web application building scenarios. we do not recommend that you use builder to build libraries or ui components.\n\nif you need to build a library or ui components, it is recommended to use the modern.js module tools.\n\n\n# will builder support turbopack?\n\nturbopack is the rust-powered successor to webpack, we will continue to pay attention to it.\n\nat present, turbopack only supports use in next.js. when turbopack can be used independently, and the completion and community ecology reach a certain level, we will consider supporting it for sure.\n\n\n# will builder support vite?\n\nvite is a great tool, but the goal of builder is to replace webpack with rust bundler, rust builder can provide fast compilation speed, while maintaining the consistent behavior between development and production.\n\nbuilder will focus on the evolution from webpack to rust builder, so it will not be support vite.",charsets:{}},{title:"All Features",frontmatter:{},regularPath:"/en/guide/features.html",relativePath:"en/guide/features.md",key:"v-01157b6c",path:"/en/guide/features.html",headers:[{level:2,title:"JavaScript",slug:"javascript",normalizedTitle:"javascript",charIndex:83},{level:2,title:"CSS",slug:"css",normalizedTitle:"css",charIndex:2412},{level:2,title:"HTML",slug:"html",normalizedTitle:"html",charIndex:4336},{level:2,title:"Development and Debugging",slug:"development-and-debugging",normalizedTitle:"development and debugging",charIndex:5997},{level:2,title:"React",slug:"react",normalizedTitle:"react",charIndex:6369},{level:2,title:"Static Assets",slug:"static-assets",normalizedTitle:"static assets",charIndex:5677},{level:2,title:"Performance",slug:"performance",normalizedTitle:"performance",charIndex:7810}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"JavaScript CSS HTML Development and Debugging React Static Assets Performance",content:"# All Features\n\nHere are all the main features supported by Modern.js Builder.\n\n\n# JavaScript\n\nFEATURES                   DESCRIPTION                                                    LINKS\nBabel compilation          Babel compilation is enabled by default, which converts         * tools.babel\n                           JavaScript and TypeScript code to backward compatible\n                           JavaScript syntax\nTS compilation             TS files are compiled by Babel by default, you can also use     * TypeScript compilation\n                           ts-loader                                                       * tools.babel\n                                                                                           * tools.tsLoader\nType Checker               Runs TypeScript type checker by default                         * Type checking\n                                                                                           * tools.tsChecker\nJS minification            JS minification is enabled by default in production build       * tools.terser\nPolyfill                   core-js and other polyfills are injected by default             * output.polyfill\nSourceMap generation       High-quality SourceMap is generated by default in production    * output.disableSourceMap\n                           build\nAlias                      Optional feature, set import alias                              * source.alias\nRestrict importing paths   Optional feature, restrict source code import paths             * source.moduleScopes\nesbuild compilation        Optional feature, transform and minify JavaScript and           * esbuild plugin\n                           TypeScript code with esbuild\nSWC Compilation            Optional feature, transform and minify JavaScript and           * SWC plugin\n                           TypeScript code with SWC\nNode artifacts             Optional feature, support building bundles that run in          * Node Target\n                           Node.js environment\nWeb Worker artifacts       Optional feature, support building bundles that run in a Web    * Web Worker Target\n                           Worker environment\nBrowserslist               Optional feature, using browserslist (opens new window)to       * Browserslist\n                           specify which browsers should be supported in your Web\n                           application.\n\n\n# CSS\n\nFEATURES                  DESCRIPTION                                                    LINKS\nPostCSS compilation       PostCSS compilation is enabled by default, built-in             * CSS Usage\n                          autoprefixer and other plugins                                  * tools.postcss\n                                                                                          * tools.autoprefixer\nSass preprocessing        Compile .scss and .sass files by default                        * CSS Usage\n                                                                                          * tools.sass\nLess preprocessing        Compile .less files by default                                  * CSS Usage\n                                                                                          * tools.less\nCSS Modules Compilation   Support compiling *.module.* files by default                   * Use CSS Modules\n                                                                                          * tools.cssLoader\nCSS Modules Type          Optional feature, automatically generate type definition for    * Use CSS Modules\n                          CSS Modules                                                     * enableCssModuleTSDeclaration\nCSS minification          CSS minification is enabled by default in production build      * CSS Usage\n                                                                                          * tools.minifyCss\nExtract CSS files         CSS will be extracted as separate files by default              * tools.cssExtract\nStyled Components         Support styled components compilation by default                * tools.styledComponents\nInline CSS into JS        Optional feature, inline CSS files to JavaScript files          * CSS Usage\n                                                                                          * tools.styleLoader\n\n\n# HTML\n\nFEATURES                  DESCRIPTION                                    LINKS\nSet title                 Set HTML title tag                              * Set Page Title\n                                                                          * html.title\n                                                                          * html.titleByEntries\nSet meta                  Set HTML meta tag                               * Set Meta Tags\n                                                                          * html.meta\n                                                                          * html.metaByEntries\nSet favicon               Set favicon for page                            * Set Page Icon\n                                                                          * html.favicon\n                                                                          * html.faviconByEntries\nSet app icon              Set apple icon for iOS                          * Set Page Icon\n                                                                          * html.appIcon\nUse EJS template engine   Optional feature, use EJS template engine       * tools.pug\nUse Pug template engine   Optional feature, use pug template engine       * tools.pug\nInline JS files           Optional feature, inline JS files into HTML     * Inline Static Assets\n                                                                          * output.enableInlineScripts\nInline CSS files          Optional feature, inline CSS files into HTML    * Inline Static Assets\n                                                                          * output.enableInlineStyles\n\n\n# Development and Debugging\n\nFEATURES                  DESCRIPTION                                                LINKS\nAutomatically open page   Optional feature, automatically open page URL in browser    * dev.startUrl\n                          when starting Dev Server\nHTTPS Dev Server          Optional feature, enable HTTPS Dev Server                   * dev.https\n\n\n# React\n\nFEATURES                 DESCRIPTION                                     LINKS\nReact Refresh            Support React Refresh by default                 * dev.hmr\nSVG to React component   Support to import SVG as component by default    * Import SVG Assets\n                                                                          * output.svgDefaultExport\n\n\n# Static Assets\n\nFEATURES                 DESCRIPTION                                                  LINKS\nImport image assets      Support for import image assets in code                       * Import Static Assets\nImport font assets       Support for import font assets in code                        * Import Static Assets\nImport video assets      Support for import video assets in code                       * Import Static Assets\nInline static assets     Small assets are inlined into JS by default                   * Inline Static Assets\n                                                                                       * output.dataUriLimit\nClean up static assets   Automatically clean up static assets in the dist directory    * output.cleanDistPath\n                         before each build\nCopy static assets       Optional feature, copy static assets to the dist directory    * output.copy\nGenerate manifest file   Optional feature, generate manifest file containing static    * output.enableAssetManifest\n                         asset information\n\n\n# Performance\n\nFEATURES                         DESCRIPTION                                                    LINKS\nChunk Splitting                  A variety of chunk splitting strategies are built into          * Chunk Splitting Practice\n                                 Builder to automatically split the bundle into files of         * performance.chunkSplit\n                                 moderate size\nPrint File Size                  After the production build, All bundle sizes is displayed by    * performance.printFileSize\n                                 default\nAnalyze bundle size              Optional feature, analyze bundle size through Bundle            * performance.bundleAnalyze\n                                 Analyzer\nRemove console                   Optional feature, remove console.xx in code                     * performance.removeConsole\nOptimize the size of moment.js   Optional feature, remove the redundant locale files of          * performance.removeMomentLocale\n                                 moment.js",normalizedContent:"# all features\n\nhere are all the main features supported by modern.js builder.\n\n\n# javascript\n\nfeatures                   description                                                    links\nbabel compilation          babel compilation is enabled by default, which converts         * tools.babel\n                           javascript and typescript code to backward compatible\n                           javascript syntax\nts compilation             ts files are compiled by babel by default, you can also use     * typescript compilation\n                           ts-loader                                                       * tools.babel\n                                                                                           * tools.tsloader\ntype checker               runs typescript type checker by default                         * type checking\n                                                                                           * tools.tschecker\njs minification            js minification is enabled by default in production build       * tools.terser\npolyfill                   core-js and other polyfills are injected by default             * output.polyfill\nsourcemap generation       high-quality sourcemap is generated by default in production    * output.disablesourcemap\n                           build\nalias                      optional feature, set import alias                              * source.alias\nrestrict importing paths   optional feature, restrict source code import paths             * source.modulescopes\nesbuild compilation        optional feature, transform and minify javascript and           * esbuild plugin\n                           typescript code with esbuild\nswc compilation            optional feature, transform and minify javascript and           * swc plugin\n                           typescript code with swc\nnode artifacts             optional feature, support building bundles that run in          * node target\n                           node.js environment\nweb worker artifacts       optional feature, support building bundles that run in a web    * web worker target\n                           worker environment\nbrowserslist               optional feature, using browserslist (opens new window)to       * browserslist\n                           specify which browsers should be supported in your web\n                           application.\n\n\n# css\n\nfeatures                  description                                                    links\npostcss compilation       postcss compilation is enabled by default, built-in             * css usage\n                          autoprefixer and other plugins                                  * tools.postcss\n                                                                                          * tools.autoprefixer\nsass preprocessing        compile .scss and .sass files by default                        * css usage\n                                                                                          * tools.sass\nless preprocessing        compile .less files by default                                  * css usage\n                                                                                          * tools.less\ncss modules compilation   support compiling *.module.* files by default                   * use css modules\n                                                                                          * tools.cssloader\ncss modules type          optional feature, automatically generate type definition for    * use css modules\n                          css modules                                                     * enablecssmoduletsdeclaration\ncss minification          css minification is enabled by default in production build      * css usage\n                                                                                          * tools.minifycss\nextract css files         css will be extracted as separate files by default              * tools.cssextract\nstyled components         support styled components compilation by default                * tools.styledcomponents\ninline css into js        optional feature, inline css files to javascript files          * css usage\n                                                                                          * tools.styleloader\n\n\n# html\n\nfeatures                  description                                    links\nset title                 set html title tag                              * set page title\n                                                                          * html.title\n                                                                          * html.titlebyentries\nset meta                  set html meta tag                               * set meta tags\n                                                                          * html.meta\n                                                                          * html.metabyentries\nset favicon               set favicon for page                            * set page icon\n                                                                          * html.favicon\n                                                                          * html.faviconbyentries\nset app icon              set apple icon for ios                          * set page icon\n                                                                          * html.appicon\nuse ejs template engine   optional feature, use ejs template engine       * tools.pug\nuse pug template engine   optional feature, use pug template engine       * tools.pug\ninline js files           optional feature, inline js files into html     * inline static assets\n                                                                          * output.enableinlinescripts\ninline css files          optional feature, inline css files into html    * inline static assets\n                                                                          * output.enableinlinestyles\n\n\n# development and debugging\n\nfeatures                  description                                                links\nautomatically open page   optional feature, automatically open page url in browser    * dev.starturl\n                          when starting dev server\nhttps dev server          optional feature, enable https dev server                   * dev.https\n\n\n# react\n\nfeatures                 description                                     links\nreact refresh            support react refresh by default                 * dev.hmr\nsvg to react component   support to import svg as component by default    * import svg assets\n                                                                          * output.svgdefaultexport\n\n\n# static assets\n\nfeatures                 description                                                  links\nimport image assets      support for import image assets in code                       * import static assets\nimport font assets       support for import font assets in code                        * import static assets\nimport video assets      support for import video assets in code                       * import static assets\ninline static assets     small assets are inlined into js by default                   * inline static assets\n                                                                                       * output.dataurilimit\nclean up static assets   automatically clean up static assets in the dist directory    * output.cleandistpath\n                         before each build\ncopy static assets       optional feature, copy static assets to the dist directory    * output.copy\ngenerate manifest file   optional feature, generate manifest file containing static    * output.enableassetmanifest\n                         asset information\n\n\n# performance\n\nfeatures                         description                                                    links\nchunk splitting                  a variety of chunk splitting strategies are built into          * chunk splitting practice\n                                 builder to automatically split the bundle into files of         * performance.chunksplit\n                                 moderate size\nprint file size                  after the production build, all bundle sizes is displayed by    * performance.printfilesize\n                                 default\nanalyze bundle size              optional feature, analyze bundle size through bundle            * performance.bundleanalyze\n                                 analyzer\nremove console                   optional feature, remove console.xx in code                     * performance.removeconsole\noptimize the size of moment.js   optional feature, remove the redundant locale files of          * performance.removemomentlocale\n                                 moment.js",charsets:{}},{title:"Glossary",frontmatter:{},regularPath:"/en/guide/glossary.html",relativePath:"en/guide/glossary.md",key:"v-408b0e68",path:"/en/guide/glossary.html",headers:[{level:2,title:"Bundler",slug:"bundler",normalizedTitle:"bundler",charIndex:15},{level:2,title:"Rspack",slug:"rspack",normalizedTitle:"rspack",charIndex:386},{level:2,title:"Builder",slug:"builder",normalizedTitle:"builder",charIndex:1216},{level:2,title:"Builder Provider",slug:"builder-provider",normalizedTitle:"builder provider",charIndex:1675},{level:2,title:"Modern.js",slug:"modern-js",normalizedTitle:"modern.js",charIndex:1964},{level:2,title:"EdenX",slug:"edenx",normalizedTitle:"edenx",charIndex:2274}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Bundler Rspack Builder Builder Provider Modern.js EdenX",content:'# Glossary\n\n\n# Bundler\n\nRefers to module bundlers such as webpack, turbopack and rspack.\n\nThe main goal of bundlers is to bundle JavaScript, CSS and other files together, and the bundled files can be used in the browser, Node.js or other environments. When bundler processes the Web application, it builds a dependency graph and then combines every module into one or more bundles.\n\n\n# Rspack\n\nA Rust Bundler developed by the ByteDance Web Infra team. The core architecture of rspack is aligned with the implementation of webpack, and provides out-of-the-box support for commonly used build features. In the long run, rspack will align the main APIs of webpack and be compatible with the mainstream webpack loaders and plugins to ensure that developers can smoothly migrate from webpack to rspack.\n\nRspack optimizes compilation performance by:\n\n * Highly LTO optimized Native code.\n * Take full advantage of multi-core, and the entire compilation process is fully optimized for multi-threading.\n * On-demand compilation based on request (Lazy Compilation), reducing the number of modules per compilation to improve the speed of cold start.\n\nTIP\n\nRspack is still in development and has not been open sourced yet.\n\n\n# Builder\n\nBuild Engine. The goal of Builder is to "reuse the best practices of build tools".\n\nBundlers are low-level, if we build a project based on webpack, we need to fully understand the webpack config and many webpack plugins and loaders, then spend a lot of time to combine them.\n\nBuilder is a out-of-box build tools. By using Builder, you can quickly gain the ability to build a modern web application.\n\nThe layers inside the Builder are as follows:\n\n\n# Builder Provider\n\nBuilder Provider is a part of Builder. Providers implements corresponding build feature based on specific bundlers.\n\nCurrently there are two Providers:\n\n * @modern-js/builder-webpack-provider: Based on webpack.\n * @modern-js/builder-rspack-provider: Based on rspack.\n\n\n# Modern.js\n\nModern web engineering system.\n\nModern.js is open sourced by the ByteDance Web Infra team, provides a series of best practices for modern web development, such as integrated development of frontend and backend, conventional routing, building solutions, style solutions, etc.\n\nModern.js Website.\n\n\n# EdenX\n\nByteDance\'s internal web engineering system, implemented based on Modern.js.',normalizedContent:'# glossary\n\n\n# bundler\n\nrefers to module bundlers such as webpack, turbopack and rspack.\n\nthe main goal of bundlers is to bundle javascript, css and other files together, and the bundled files can be used in the browser, node.js or other environments. when bundler processes the web application, it builds a dependency graph and then combines every module into one or more bundles.\n\n\n# rspack\n\na rust bundler developed by the bytedance web infra team. the core architecture of rspack is aligned with the implementation of webpack, and provides out-of-the-box support for commonly used build features. in the long run, rspack will align the main apis of webpack and be compatible with the mainstream webpack loaders and plugins to ensure that developers can smoothly migrate from webpack to rspack.\n\nrspack optimizes compilation performance by:\n\n * highly lto optimized native code.\n * take full advantage of multi-core, and the entire compilation process is fully optimized for multi-threading.\n * on-demand compilation based on request (lazy compilation), reducing the number of modules per compilation to improve the speed of cold start.\n\ntip\n\nrspack is still in development and has not been open sourced yet.\n\n\n# builder\n\nbuild engine. the goal of builder is to "reuse the best practices of build tools".\n\nbundlers are low-level, if we build a project based on webpack, we need to fully understand the webpack config and many webpack plugins and loaders, then spend a lot of time to combine them.\n\nbuilder is a out-of-box build tools. by using builder, you can quickly gain the ability to build a modern web application.\n\nthe layers inside the builder are as follows:\n\n\n# builder provider\n\nbuilder provider is a part of builder. providers implements corresponding build feature based on specific bundlers.\n\ncurrently there are two providers:\n\n * @modern-js/builder-webpack-provider: based on webpack.\n * @modern-js/builder-rspack-provider: based on rspack.\n\n\n# modern.js\n\nmodern web engineering system.\n\nmodern.js is open sourced by the bytedance web infra team, provides a series of best practices for modern web development, such as integrated development of frontend and backend, conventional routing, building solutions, style solutions, etc.\n\nmodern.js website.\n\n\n# edenx\n\nbytedance\'s internal web engineering system, implemented based on modern.js.',charsets:{}},{title:"Introduction",frontmatter:{},regularPath:"/en/guide/introduction.html",relativePath:"en/guide/introduction.md",key:"v-4fede3cc",path:"/en/guide/introduction.html",headers:[{level:2,title:"Rust Tools",slug:"rust-tools",normalizedTitle:"rust tools",charIndex:568},{level:2,title:"Position",slug:"position",normalizedTitle:"position",charIndex:1524},{level:2,title:"Features",slug:"features",normalizedTitle:"features",charIndex:2347},{level:2,title:"npm packages",slug:"npm-packages",normalizedTitle:"npm packages",charIndex:4284},{level:2,title:"Next Step",slug:"next-step",normalizedTitle:"next step",charIndex:5405}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Rust Tools Position Features npm packages Next Step",content:"# Introduction\n\nModern.js Builder is a Build Engine for Modern Web Development.\n\nWith the growing of the front-end ecosystem, more and more build tools and plugins are created. For most developers, the configuration and dependencies required to build a web application have become complex; the cost of finding best practices for developers has also risen.\n\nIn order to reduce the complexity and make it easier to build a project, we abstracted the build abilities based on the practical experience of Modern.js, and created the open source tool Modern.js Builder.\n\n\n# Rust Tools\n\nIn recent years, the trend in front-end toolchain has been to re-implement them with native programming languages like Rust for better performance. Some high-performance tools have created, such as SWC, esbuild, Turbopack, etc., and their use is gradually expanding. However, there are many differences between these Rust tools and JavaScript tools, including functional differences, configuration inconsistencies, which make it difficult for users to migrate.\n\nThe Rust process of the front-end toolchain will continue for a long time, Modern.js Builder is expected to help developers better transition to Rust tools. Whether it's JavaScript tools, Rust tools, or even low-level bundlers like webpack, they're all replaceable components in Modern.js Builder. You can incrementally replace these components by turning on configuration or enabling plugins, and Modern.js Builder will smooth out the major differences and help users migrate.\n\n\n# Position\n\nModern.js Builder is a build engine serving the upper-level front-end frameworks. It focuses on solving problems in web application building, and expects to provide out-of-box building abilities for front-end frameworks.\n\nIf you are developing a front-end framework, or developing a scaffolding for a front-end application, Builder can provide most of the build logics for you, which allowing you to focus on implementing other features of the framework.\n\nIf you are a business developer, in most cases, you do not need to manually install Builder in your projects. We recommend that you use the upper-level frameworks based on Builder.\n\nCurrently, the following front-end frameworks are already using Builder:\n\n * Modern.js 2.0 Framework (Open source).\n * EdenX Framework and PIA Framework inside ByteDance.\n\n\n# Features\n\n\n# Support Multiple Bundlers\n\nBuilder supports using multiple bundlers, users can use different bundlers according the your needs.\n\nBy default, Builder uses webpack 5 as the bundler. Although the compilation speed of webpack is not ideal, it is still the most mature and ecological bundler in the community. Based on webpack, Builder integrates babel, postcss, terser and other tools to transform or minify codes. Builder also supports replacing some compile tools with native tools to improve compilation speed, such as replacing babel/terser with swc or esbuild.\n\nAt the same time, We are integrating rspack to improve compilation speed, rspack is a Rust Bundler developed by ByteDance.\n\nAt present, the webpack provider is stable for production, and the rspack provider is still under development.\n\nAbout Turbopack\n\nTurbopack is the rust-powered successor to webpack, we will continue to pay attention to it. At present, Turbopack only supports use in Next.js. When Turbopack can be used independently, and the completion and community ecology reach a certain level, we will consider supporting it for sure.\n\n\n# Deep optimization\n\nBuilder makes full use of various optimization strategies in the webpack ecosystem to ensure the product performance in the production environment.\n\nTaking the chunk splitting scenario as an example, the webpack's splitChunks config is complex, and Builder makes it as an out-of-the-box performance.chunkSplit config, it will split common third-party libraries into chunks to make page loading faster.\n\n\n# Extensible Plugin System\n\nProvides rich configuration items and a flexible plugin system to support in-depth customization of all features.\n\nFor Builder, all building abilities are achieved through plugins:\n\n * Most of the plugins are lightweight, built in Builder, and developers can enable or disable them through configs.\n * Some plugins are more complex and developed as independent npm packages, developers can install and use them as needed.\n\nBuilder also supports custom plugins, so framework developers can develop custom plugins to meet customized requirements.\n\n\n# npm packages\n\nBelow is the npm package published by Builder.\n\nPACKAGE                                    VERSION   DESCRIPTION\n@modern-js/builder                                   Core package of Builder\n@modern-js/builder-webpack-provider                  Provides webpack build ability\n@modern-js/builder-rspack-provider                   Provides rspack build ability\n@modern-js/builder-plugin-swc                        SWC Plugin\n@modern-js/builder-plugin-esbuild                    Esbuild Plugin\n@modern-js/builder-plugin-node-polyfill              Node Polyfill Plugin\n@modern-js/builder-plugin-image-compress             Image Compress Plugin\n@modern-js/builder-shared                            Shared modules of Builder\n@modern-js/builder-doc                               Documentation snippets of Builder\n\nYou can view the source code of these packages in the packages/builder directory of the modern.js repository.\n\n\n# Next Step\n\nYou may want:",normalizedContent:"# introduction\n\nmodern.js builder is a build engine for modern web development.\n\nwith the growing of the front-end ecosystem, more and more build tools and plugins are created. for most developers, the configuration and dependencies required to build a web application have become complex; the cost of finding best practices for developers has also risen.\n\nin order to reduce the complexity and make it easier to build a project, we abstracted the build abilities based on the practical experience of modern.js, and created the open source tool modern.js builder.\n\n\n# rust tools\n\nin recent years, the trend in front-end toolchain has been to re-implement them with native programming languages like rust for better performance. some high-performance tools have created, such as swc, esbuild, turbopack, etc., and their use is gradually expanding. however, there are many differences between these rust tools and javascript tools, including functional differences, configuration inconsistencies, which make it difficult for users to migrate.\n\nthe rust process of the front-end toolchain will continue for a long time, modern.js builder is expected to help developers better transition to rust tools. whether it's javascript tools, rust tools, or even low-level bundlers like webpack, they're all replaceable components in modern.js builder. you can incrementally replace these components by turning on configuration or enabling plugins, and modern.js builder will smooth out the major differences and help users migrate.\n\n\n# position\n\nmodern.js builder is a build engine serving the upper-level front-end frameworks. it focuses on solving problems in web application building, and expects to provide out-of-box building abilities for front-end frameworks.\n\nif you are developing a front-end framework, or developing a scaffolding for a front-end application, builder can provide most of the build logics for you, which allowing you to focus on implementing other features of the framework.\n\nif you are a business developer, in most cases, you do not need to manually install builder in your projects. we recommend that you use the upper-level frameworks based on builder.\n\ncurrently, the following front-end frameworks are already using builder:\n\n * modern.js 2.0 framework (open source).\n * edenx framework and pia framework inside bytedance.\n\n\n# features\n\n\n# support multiple bundlers\n\nbuilder supports using multiple bundlers, users can use different bundlers according the your needs.\n\nby default, builder uses webpack 5 as the bundler. although the compilation speed of webpack is not ideal, it is still the most mature and ecological bundler in the community. based on webpack, builder integrates babel, postcss, terser and other tools to transform or minify codes. builder also supports replacing some compile tools with native tools to improve compilation speed, such as replacing babel/terser with swc or esbuild.\n\nat the same time, we are integrating rspack to improve compilation speed, rspack is a rust bundler developed by bytedance.\n\nat present, the webpack provider is stable for production, and the rspack provider is still under development.\n\nabout turbopack\n\nturbopack is the rust-powered successor to webpack, we will continue to pay attention to it. at present, turbopack only supports use in next.js. when turbopack can be used independently, and the completion and community ecology reach a certain level, we will consider supporting it for sure.\n\n\n# deep optimization\n\nbuilder makes full use of various optimization strategies in the webpack ecosystem to ensure the product performance in the production environment.\n\ntaking the chunk splitting scenario as an example, the webpack's splitchunks config is complex, and builder makes it as an out-of-the-box performance.chunksplit config, it will split common third-party libraries into chunks to make page loading faster.\n\n\n# extensible plugin system\n\nprovides rich configuration items and a flexible plugin system to support in-depth customization of all features.\n\nfor builder, all building abilities are achieved through plugins:\n\n * most of the plugins are lightweight, built in builder, and developers can enable or disable them through configs.\n * some plugins are more complex and developed as independent npm packages, developers can install and use them as needed.\n\nbuilder also supports custom plugins, so framework developers can develop custom plugins to meet customized requirements.\n\n\n# npm packages\n\nbelow is the npm package published by builder.\n\npackage                                    version   description\n@modern-js/builder                                   core package of builder\n@modern-js/builder-webpack-provider                  provides webpack build ability\n@modern-js/builder-rspack-provider                   provides rspack build ability\n@modern-js/builder-plugin-swc                        swc plugin\n@modern-js/builder-plugin-esbuild                    esbuild plugin\n@modern-js/builder-plugin-node-polyfill              node polyfill plugin\n@modern-js/builder-plugin-image-compress             image compress plugin\n@modern-js/builder-shared                            shared modules of builder\n@modern-js/builder-doc                               documentation snippets of builder\n\nyou can view the source code of these packages in the packages/builder directory of the modern.js repository.\n\n\n# next step\n\nyou may want:",charsets:{}},{title:"Improve Build Performance",frontmatter:{},regularPath:"/en/guide/optimization/build-performance.html",relativePath:"en/guide/optimization/build-performance.md",key:"v-1f2ac5a8",path:"/en/guide/optimization/build-performance.html",headers:[{level:2,title:"General optimization strategy",slug:"general-optimization-strategy",normalizedTitle:"general optimization strategy",charIndex:437},{level:2,title:"Development optimization strategies",slug:"development-optimization-strategies",normalizedTitle:"development optimization strategies",charIndex:2678},{level:2,title:"Production optimization strategies",slug:"production-optimization-strategies",normalizedTitle:"production optimization strategies",charIndex:4883}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"General optimization strategy Development optimization strategies Production optimization strategies",content:'# Improve Build Performance\n\nModern.js Builder optimizes build performance by default, but as the project becomes larger, you may encounter some build performance problems.\n\nThis document provides some optional speed-up strategies, developers can choose some of them to improve the build performance.\n\n📢 Notice\n\nThe strategies in Bundle Size Optimization can also be used to improve build performance, so we won\'t repeat them here.\n\n\n# General optimization strategy\n\nThe following are some general optimization strategies, which can speed up the development build and production build, and some of them also optimize the bundle size.\n\n\n# Upgrade Node.js version\n\nIn general, updating Node.js to the latest LTS release will help improve build performance.\n\nEspecially for devices with Apple M1/M2 chips, it is recommended to use Node 16 or Node 18.\n\nNode 16 provides Apple Silicon binaries by default, so the performance on M1/M2 models will be greatly improved than Node 14. According to our tests, After switching from Node 14 to Node 16, the compilation speed can be improved by more than 100%.\n\nYou can switch to Node 16 by following steps:\n\n# Install Node.js v16\nnvm install 16\n\n# switch to Node 16\nnvm use 16\n\n# Set Node 16 as the default version\nnvm default 16\n\n# View Node version\nnode -v\n\n\n\n# Using SWC or esbuild\n\nSWC (Speedy Web Compiler) is a transformer and minimizer for JavaScript and TypeScript based on Rust. SWC can provide the same abilities with Babel, and it\'s more than 10x faster than Babel.\n\nesbuild is a front-end build tool based on Golang. It has the functions of bundling, compiling and minimizing JavaScript code. Compared with traditional tools, the performance is significantly improved. When minimizing code, compared to webpack\'s built-in terser minimizer, esbuild has dozens of times better performance.\n\nBuilder provides SWC plugin and esbuild plugin that allow you to use SWC or esbuild instead of babel-loader, ts-loader and terser for transformation and minification process. See:\n\n * SWC plugin document\n * esbuild plugin document\n\nSWC vs esbuild\n\nThe SWC compiled outputs has better compatibility, supports polyfills such as core-js, and has more complete features, so it is recommended to use the SWC plugin first.\n\n\n# Avoid using ts-loader\n\nBy default, Builder uses Babel to compile TS files. After enabling the tools.tsLoader option, ts-loader will be used to compile TS files.\n\nPlease avoid using ts-loader because it requires additional parsing and type checking, which will slow down the build.\n\nexport default {\n  tools: {\n    // remove this config\n    tsLoader: {},\n  },\n};\n\n\nSee the tools.tsLoader documentation for details.\n\n\n# Development optimization strategies\n\nThe following are strategies for improve build performance in development environment.\n\n\n# Enable Lazy Compilation\n\nYou can enable the lazy compilation (i.e. on-demand compilation) to improve the compilation startup speed.\n\nexport default {\n  experiments: {\n    lazyCompilation: {\n      imports: true,\n      entries: false,\n    },\n  },\n};\n\n\nThis is an experimental feature and may not work correctly in some scenarios, see experiments.lazyCompilation for details.\n\n\n# Adjust Source Map format\n\nIn order to provide a good debugging experience, Builder uses the cheap-module-source-map format Source Map by default in the development environment, which is a high-quality Source Map format and will bring certain performance overhead.\n\nYou can improve build speed by adjusting the source map format of your development environment.\n\nFor example to disable Source Map:\n\nexport default {\n  tools: {\n    webpackChain(chain, { env }) {\n      if (env === \'development\') {\n        chain.devtool(false);\n      }\n    },\n  },\n};\n\n\nOr set the source map format of the development environment to the cheapest eval format:\n\nexport default {\n  tools: {\n    webpackChain(chain, { env }) {\n      if (env === \'development\') {\n        chain.devtool(\'eval\');\n      }\n    },\n  },\n};\n\n\n> For detailed differences between different Source Map formats, see webpack - devtool.\n\n\n# Adjust Browserslist for development\n\nThis strategy is similar to "Adjust Browserslist", the difference is that we can set different browserslist for development and production environment, thereby reducing the compilation overhead in the development environment.\n\nFor example, you can add the following config to package.json, which means that only the latest browsers are compatible in the development environment, and the actual browsers are compatible in the production environment:\n\n{\n  "browserslist": {\n    "production": [">0.2%", "not dead", "not op_mini all"],\n    "development": [\n      "last 1 chrome version",\n      "last 1 firefox version",\n      "last 1 safari version"\n    ]\n  }\n}\n\n\nNote that this strategy can lead to some differences in the build result of development production environment.\n\n\n# Production optimization strategies\n\nThe following are strategies for improve build performance in production environment.\n\n\n# Disable Source Map\n\nIf your project does not need Source Map in the production, you can turn it off through the disableSourceMap config to improve the build speed.\n\nexport default {\n  output: {\n    disableSourceMap: true,\n  },\n};\n\n\nSee output.disableSourceMap for details.',normalizedContent:'# improve build performance\n\nmodern.js builder optimizes build performance by default, but as the project becomes larger, you may encounter some build performance problems.\n\nthis document provides some optional speed-up strategies, developers can choose some of them to improve the build performance.\n\n📢 notice\n\nthe strategies in bundle size optimization can also be used to improve build performance, so we won\'t repeat them here.\n\n\n# general optimization strategy\n\nthe following are some general optimization strategies, which can speed up the development build and production build, and some of them also optimize the bundle size.\n\n\n# upgrade node.js version\n\nin general, updating node.js to the latest lts release will help improve build performance.\n\nespecially for devices with apple m1/m2 chips, it is recommended to use node 16 or node 18.\n\nnode 16 provides apple silicon binaries by default, so the performance on m1/m2 models will be greatly improved than node 14. according to our tests, after switching from node 14 to node 16, the compilation speed can be improved by more than 100%.\n\nyou can switch to node 16 by following steps:\n\n# install node.js v16\nnvm install 16\n\n# switch to node 16\nnvm use 16\n\n# set node 16 as the default version\nnvm default 16\n\n# view node version\nnode -v\n\n\n\n# using swc or esbuild\n\nswc (speedy web compiler) is a transformer and minimizer for javascript and typescript based on rust. swc can provide the same abilities with babel, and it\'s more than 10x faster than babel.\n\nesbuild is a front-end build tool based on golang. it has the functions of bundling, compiling and minimizing javascript code. compared with traditional tools, the performance is significantly improved. when minimizing code, compared to webpack\'s built-in terser minimizer, esbuild has dozens of times better performance.\n\nbuilder provides swc plugin and esbuild plugin that allow you to use swc or esbuild instead of babel-loader, ts-loader and terser for transformation and minification process. see:\n\n * swc plugin document\n * esbuild plugin document\n\nswc vs esbuild\n\nthe swc compiled outputs has better compatibility, supports polyfills such as core-js, and has more complete features, so it is recommended to use the swc plugin first.\n\n\n# avoid using ts-loader\n\nby default, builder uses babel to compile ts files. after enabling the tools.tsloader option, ts-loader will be used to compile ts files.\n\nplease avoid using ts-loader because it requires additional parsing and type checking, which will slow down the build.\n\nexport default {\n  tools: {\n    // remove this config\n    tsloader: {},\n  },\n};\n\n\nsee the tools.tsloader documentation for details.\n\n\n# development optimization strategies\n\nthe following are strategies for improve build performance in development environment.\n\n\n# enable lazy compilation\n\nyou can enable the lazy compilation (i.e. on-demand compilation) to improve the compilation startup speed.\n\nexport default {\n  experiments: {\n    lazycompilation: {\n      imports: true,\n      entries: false,\n    },\n  },\n};\n\n\nthis is an experimental feature and may not work correctly in some scenarios, see experiments.lazycompilation for details.\n\n\n# adjust source map format\n\nin order to provide a good debugging experience, builder uses the cheap-module-source-map format source map by default in the development environment, which is a high-quality source map format and will bring certain performance overhead.\n\nyou can improve build speed by adjusting the source map format of your development environment.\n\nfor example to disable source map:\n\nexport default {\n  tools: {\n    webpackchain(chain, { env }) {\n      if (env === \'development\') {\n        chain.devtool(false);\n      }\n    },\n  },\n};\n\n\nor set the source map format of the development environment to the cheapest eval format:\n\nexport default {\n  tools: {\n    webpackchain(chain, { env }) {\n      if (env === \'development\') {\n        chain.devtool(\'eval\');\n      }\n    },\n  },\n};\n\n\n> for detailed differences between different source map formats, see webpack - devtool.\n\n\n# adjust browserslist for development\n\nthis strategy is similar to "adjust browserslist", the difference is that we can set different browserslist for development and production environment, thereby reducing the compilation overhead in the development environment.\n\nfor example, you can add the following config to package.json, which means that only the latest browsers are compatible in the development environment, and the actual browsers are compatible in the production environment:\n\n{\n  "browserslist": {\n    "production": [">0.2%", "not dead", "not op_mini all"],\n    "development": [\n      "last 1 chrome version",\n      "last 1 firefox version",\n      "last 1 safari version"\n    ]\n  }\n}\n\n\nnote that this strategy can lead to some differences in the build result of development production environment.\n\n\n# production optimization strategies\n\nthe following are strategies for improve build performance in production environment.\n\n\n# disable source map\n\nif your project does not need source map in the production, you can turn it off through the disablesourcemap config to improve the build speed.\n\nexport default {\n  output: {\n    disablesourcemap: true,\n  },\n};\n\n\nsee output.disablesourcemap for details.',charsets:{}},{title:"Inline Static Assets",frontmatter:{},regularPath:"/en/guide/optimization/inline-assets.html",relativePath:"en/guide/optimization/inline-assets.md",key:"v-0bf79dec",path:"/en/guide/optimization/inline-assets.html",headers:[{level:2,title:"Automatic Inlining",slug:"automatic-inlining",normalizedTitle:"automatic inlining",charIndex:856},{level:2,title:"Force Inlining",slug:"force-inlining",normalizedTitle:"force inlining",charIndex:1492},{level:2,title:"Force no inlining",slug:"force-no-inlining",normalizedTitle:"force no inlining",charIndex:2675},{level:2,title:"Inline JS files",slug:"inline-js-files",normalizedTitle:"inline js files",charIndex:3822},{level:2,title:"Inline CSS files",slug:"inline-css-files",normalizedTitle:"inline css files",charIndex:4359},{level:2,title:"Add Type Declaration",slug:"add-type-declaration",normalizedTitle:"add type declaration",charIndex:4686}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Automatic Inlining Force Inlining Force no inlining Inline JS files Inline CSS files Add Type Declaration",content:"# Inline Static Assets\n\nInline static assets refer to the practice of including the content of a static asset directly in a HTML or JS file, instead of linking to an external file. This can improve the performance of a website by reducing the number of HTTP requests that the browser has to make to load the page.\n\nHowever, static resource inlining also has some disadvantages, such as increasing the size of a single file, which may lead to slower loading. Therefore, in the actual scenario, it is necessary to decide whether to use static resource inlining according to the specific situation.\n\nBuilder will automatically inline static assets that are less than 10KB, but sometimes you may need to manually control assets to force them to be inlined or not, and this document explains how to precisely control the inlining behavior of static assets.\n\n\n# Automatic Inlining\n\nBy default, Builder will inline assets when the file size of is less than a threshold (the default is 10KB). When inlined, the asset will be converted to a Base64 encoded string and will no longer send a separate HTTP request. When the file size is greater than this threshold, it is loaded as a separate file with a separate HTTP request.\n\nThe threshold can be modified with the output.dataUriLimit config. For example, set the threshold of images to 5000 Bytes, and set media assets not to be inlined:\n\nexport default {\n  output: {\n    dataUriLimit: {\n      image: 5000,\n      media: Infinite,\n    },\n  },\n};\n\n\n\n# Force Inlining\n\nYou can force an asset to be inlined by adding the inline query when importing the asset, regardless of whether the asset's size is smaller than the size threshold.\n\nimport React from 'react';\nimport img from '. /foo.png?inline';\n\nexport default function Foo() {\n  return <img src={img} />;\n}\n\n\nIn the above example, the foo.png image will always be inlined, regardless of whether the size of the image is larger than the threshold.\n\nIn addition to the inline query, you can also use the __inline query to force inlining of the asset:\n\nimport img from '. /foo.png?__inline';\n\n\n\n# Referenced from CSS file\n\nWhen you reference a static asset in your CSS file, you can also force inline the asset with the inline or __inline queries.\n\n.foo {\n  background-image: url('. /icon.png?inline');\n}\n\n\nDo you really need to force inlining?\n\nInline large assets will significantly increase the first paint time or first contentful paint time of a page, which will hurt user experience. And when you inline a static asset multiple times into a CSS file, the base64 content will be repeatedly injected, causing the bundle size to grow . Please use forced inlining with caution.\n\n\n# Force no inlining\n\nWhen you want to always treat some assets as separate files, no matter how small the asset is, you can add the url query to force the asset not to be inlined.\n\nimport React from 'react';\nimport img from '. /foo.png?url';\n\nexport default function Foo() {\n  return <img src={img} />;\n}\n\n\nIn the above example, the foo.png image will always be loaded as a separate file, even if the size of the image is smaller than the threshold.\n\nIn addition to the url query, you can also use the __inline=false query to force the asset not to be inlined:\n\nimport img from '. /foo.png?__inline=false';\n\n\n\n# Referenced from CSS file\n\nWhen you reference a static asset in your CSS file, you can also force the asset not to be inlined with url or __inline=false queries.\n\n.foo {\n  background-image: url('. /icon.png?url');\n}\n\n\nDo you really need to exclude assets from inlining?\n\nExcluding assets from inlining will increase the number of assets that the Web App needs to load. This will reduce the efficiency of loading assets in a weak network environment or in scenarios where HTTP2 is not enabled. Please use force no Inline with caution.\n\n\n# Inline JS files\n\nIn addition to inlining static resource files into JS files, Builder also supports inlining JS files into HTML files.\n\nJust enable the output.enableInlineScripts config, and the generated JS files will not be written into the output directory, but will be directly inlined to the corresponding in the HTML file.\n\nexport default {\n  output: {\n    enableInlineScripts: true,\n  },\n};\n\n\nTIP\n\nInline JS files may cause the single HTML file to be too large, and it will break the HTTP caching. Please use it with caution.\n\n\n# Inline CSS files\n\nYou can also inline CSS files into HTML files.\n\nJust enable the output.enableInlineStyles config, the generated CSS file will not be written into the output directory, but will be directly inlined to the corresponding in the HTML file.\n\nexport default {\n  output: {\n    enableInlineStyles: true,\n  },\n};\n\n\n\n# Add Type Declaration\n\nWhen you use URL queries such as ?inline and ?url in TypeScript code, TypeScript may prompt that the module is missing a type definition:\n\nTS2307: Cannot find module './logo.png?inline' or its corresponding type declarations.\n\n\nTo fix this, you can add type declarations for these URL queries, please create src/global.d.ts file and add the following type declarations:\n\ndeclare module '*?inline' {\n  const content: string;\n  export default content;\n}\n\ndeclare module '*?inline' {\n  const content: string;\n  export default content;\n}\n\ndeclare module '*?__inline' {\n  const content: string;\n  export default content;\n}\n\ndeclare module '*?inline=false' {\n  const content: string;\n  export default content;\n}\n",normalizedContent:"# inline static assets\n\ninline static assets refer to the practice of including the content of a static asset directly in a html or js file, instead of linking to an external file. this can improve the performance of a website by reducing the number of http requests that the browser has to make to load the page.\n\nhowever, static resource inlining also has some disadvantages, such as increasing the size of a single file, which may lead to slower loading. therefore, in the actual scenario, it is necessary to decide whether to use static resource inlining according to the specific situation.\n\nbuilder will automatically inline static assets that are less than 10kb, but sometimes you may need to manually control assets to force them to be inlined or not, and this document explains how to precisely control the inlining behavior of static assets.\n\n\n# automatic inlining\n\nby default, builder will inline assets when the file size of is less than a threshold (the default is 10kb). when inlined, the asset will be converted to a base64 encoded string and will no longer send a separate http request. when the file size is greater than this threshold, it is loaded as a separate file with a separate http request.\n\nthe threshold can be modified with the output.dataurilimit config. for example, set the threshold of images to 5000 bytes, and set media assets not to be inlined:\n\nexport default {\n  output: {\n    dataurilimit: {\n      image: 5000,\n      media: infinite,\n    },\n  },\n};\n\n\n\n# force inlining\n\nyou can force an asset to be inlined by adding the inline query when importing the asset, regardless of whether the asset's size is smaller than the size threshold.\n\nimport react from 'react';\nimport img from '. /foo.png?inline';\n\nexport default function foo() {\n  return <img src={img} />;\n}\n\n\nin the above example, the foo.png image will always be inlined, regardless of whether the size of the image is larger than the threshold.\n\nin addition to the inline query, you can also use the __inline query to force inlining of the asset:\n\nimport img from '. /foo.png?__inline';\n\n\n\n# referenced from css file\n\nwhen you reference a static asset in your css file, you can also force inline the asset with the inline or __inline queries.\n\n.foo {\n  background-image: url('. /icon.png?inline');\n}\n\n\ndo you really need to force inlining?\n\ninline large assets will significantly increase the first paint time or first contentful paint time of a page, which will hurt user experience. and when you inline a static asset multiple times into a css file, the base64 content will be repeatedly injected, causing the bundle size to grow . please use forced inlining with caution.\n\n\n# force no inlining\n\nwhen you want to always treat some assets as separate files, no matter how small the asset is, you can add the url query to force the asset not to be inlined.\n\nimport react from 'react';\nimport img from '. /foo.png?url';\n\nexport default function foo() {\n  return <img src={img} />;\n}\n\n\nin the above example, the foo.png image will always be loaded as a separate file, even if the size of the image is smaller than the threshold.\n\nin addition to the url query, you can also use the __inline=false query to force the asset not to be inlined:\n\nimport img from '. /foo.png?__inline=false';\n\n\n\n# referenced from css file\n\nwhen you reference a static asset in your css file, you can also force the asset not to be inlined with url or __inline=false queries.\n\n.foo {\n  background-image: url('. /icon.png?url');\n}\n\n\ndo you really need to exclude assets from inlining?\n\nexcluding assets from inlining will increase the number of assets that the web app needs to load. this will reduce the efficiency of loading assets in a weak network environment or in scenarios where http2 is not enabled. please use force no inline with caution.\n\n\n# inline js files\n\nin addition to inlining static resource files into js files, builder also supports inlining js files into html files.\n\njust enable the output.enableinlinescripts config, and the generated js files will not be written into the output directory, but will be directly inlined to the corresponding in the html file.\n\nexport default {\n  output: {\n    enableinlinescripts: true,\n  },\n};\n\n\ntip\n\ninline js files may cause the single html file to be too large, and it will break the http caching. please use it with caution.\n\n\n# inline css files\n\nyou can also inline css files into html files.\n\njust enable the output.enableinlinestyles config, the generated css file will not be written into the output directory, but will be directly inlined to the corresponding in the html file.\n\nexport default {\n  output: {\n    enableinlinestyles: true,\n  },\n};\n\n\n\n# add type declaration\n\nwhen you use url queries such as ?inline and ?url in typescript code, typescript may prompt that the module is missing a type definition:\n\nts2307: cannot find module './logo.png?inline' or its corresponding type declarations.\n\n\nto fix this, you can add type declarations for these url queries, please create src/global.d.ts file and add the following type declarations:\n\ndeclare module '*?inline' {\n  const content: string;\n  export default content;\n}\n\ndeclare module '*?inline' {\n  const content: string;\n  export default content;\n}\n\ndeclare module '*?__inline' {\n  const content: string;\n  export default content;\n}\n\ndeclare module '*?inline=false' {\n  const content: string;\n  export default content;\n}\n",charsets:{}},{title:"Bundle Size Optimization",frontmatter:{},regularPath:"/en/guide/optimization/optimize-bundle.html",relativePath:"en/guide/optimization/optimize-bundle.md",key:"v-d7c44de8",path:"/en/guide/optimization/optimize-bundle.html",headers:[{level:2,title:"Reduce duplicate dependencies",slug:"reduce-duplicate-dependencies",normalizedTitle:"reduce duplicate dependencies",charIndex:262},{level:2,title:"Use lightweight libraries",slug:"use-lightweight-libraries",normalizedTitle:"use lightweight libraries",charIndex:879},{level:2,title:"Adjust Browserslist",slug:"adjust-browserslist",normalizedTitle:"adjust browserslist",charIndex:1444},{level:2,title:"Usage Polyfill",slug:"usage-polyfill",normalizedTitle:"usage polyfill",charIndex:1985},{level:2,title:"Image Compression",slug:"image-compression",normalizedTitle:"image compression",charIndex:2461},{level:2,title:"Split Chunk",slug:"split-chunk",normalizedTitle:"split chunk",charIndex:3016}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Reduce duplicate dependencies Use lightweight libraries Adjust Browserslist Usage Polyfill Image Compression Split Chunk",content:"# Bundle Size Optimization\n\nBundle size optimization is an important part in production environment because it directly affects the user experience of online users. In this document, we will introduce some common bundle size optimization methods in Builder.\n\n\n# Reduce duplicate dependencies\n\nIn real projects, there will be some third-party dependencies installed with multiple versions. Duplicate dependencies can lead to larger bundles and slower builds.\n\nWe can detect or eliminate duplicate dependencies with some community tools.\n\nIf you are using pnpm, you can use pnpm-deduplicate to analyze all duplicate dependencies, then update dependencies or declare pnpm overrides to merge duplicated dependencies.\n\nnpx pnpm-deduplicate --list\n\n\nIf you are using yarn, you can use yarn-deduplicate to automatically merge duplicated dependencies:\n\nnpx yarn-deduplicate && yarn\n\n\n\n# Use lightweight libraries\n\nIt is recommended to using lightweight libraries in your project, such as replacing moment with day.js.\n\nIf you want to find out the large libraries in the project, you can add the BUNDLE_ANALYZE=true environment variable when building:\n\nBUNDLE_ANALYZE=true pnpm build\n\n\nAfter adding this parameter, Builder will generate a HTML file that analyzes the bundle size, you can manually open the file in the browser and view the detail of the bundle size. When an area is larger, it indicates that its corresponding bundle size is larger.\n\n\n# Adjust Browserslist\n\nThe Builder will compile the code according to the project's Browserslist config, and inject some Polyfills. If the project does not need to be compatible with legacy browsers, you can adjust the Browserslist and drop some legacy browsers, thereby reducing the compilation overhead on syntax and polyfill.\n\nBuilder's default Browserslist config is:\n\n['> 0.01%', 'not dead', 'not op_mini all'];\n\n\nFor example, if you only need to be compatible with browsers above Chrome 61, you can change it to:\n\n['Chrome >= 61'];\n\n\n\n# Usage Polyfill\n\nWhen it is clear that third-party dependencies do not require additional polyfill, you can set output.polyfill to usage.\n\nIn the case where it is clear that third-party dependencies do not require Polyfill, you can set output.polyfill to usage.\n\nIn usage mode, Builder analyzes the syntax used in the source code and injects the required polyfill code on demand to reduce the size of polyfill.\n\nexport default {\n  output: {\n    polyfill: 'usage',\n  },\n};\n\n\n\n# Image Compression\n\nIn general front-end projects, the size of image often accounts for a large proportion of the total bundle size of the project.So if the image size can be reduced as much as possible, it will have a significant optimization effect on the project bundle size. You can enable image compression by registering a plugin in the Builder:\n\nimport { PluginImageCompress } from '@modern-js/builder-plugin-image-compress';\n\n// Add the plugin to the Builder\nbuilder.addPlugins([PluginImageCompress()]);\n\n\nSee details in plugin-image-compress。\n\n\n# Split Chunk\n\nA great chunk splitting strategy is very important to improve the loading performance of the application. It can make full use of the browser's caching mechanism to reduce the number of requests and improve the loading speed of the application.\n\nA variety of chunk splitting strategies are built into Builder, which can meet the needs of most applications. You can also customize the chunk splitting config according to your own business scenarios. For example:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-experience',\n      forceSplitting: {\n        // For example, split the `react-query` into a Chunk\n        react_query: [/node_modules\\/react-query/],\n      },\n    },\n  },\n};\n",normalizedContent:"# bundle size optimization\n\nbundle size optimization is an important part in production environment because it directly affects the user experience of online users. in this document, we will introduce some common bundle size optimization methods in builder.\n\n\n# reduce duplicate dependencies\n\nin real projects, there will be some third-party dependencies installed with multiple versions. duplicate dependencies can lead to larger bundles and slower builds.\n\nwe can detect or eliminate duplicate dependencies with some community tools.\n\nif you are using pnpm, you can use pnpm-deduplicate to analyze all duplicate dependencies, then update dependencies or declare pnpm overrides to merge duplicated dependencies.\n\nnpx pnpm-deduplicate --list\n\n\nif you are using yarn, you can use yarn-deduplicate to automatically merge duplicated dependencies:\n\nnpx yarn-deduplicate && yarn\n\n\n\n# use lightweight libraries\n\nit is recommended to using lightweight libraries in your project, such as replacing moment with day.js.\n\nif you want to find out the large libraries in the project, you can add the bundle_analyze=true environment variable when building:\n\nbundle_analyze=true pnpm build\n\n\nafter adding this parameter, builder will generate a html file that analyzes the bundle size, you can manually open the file in the browser and view the detail of the bundle size. when an area is larger, it indicates that its corresponding bundle size is larger.\n\n\n# adjust browserslist\n\nthe builder will compile the code according to the project's browserslist config, and inject some polyfills. if the project does not need to be compatible with legacy browsers, you can adjust the browserslist and drop some legacy browsers, thereby reducing the compilation overhead on syntax and polyfill.\n\nbuilder's default browserslist config is:\n\n['> 0.01%', 'not dead', 'not op_mini all'];\n\n\nfor example, if you only need to be compatible with browsers above chrome 61, you can change it to:\n\n['chrome >= 61'];\n\n\n\n# usage polyfill\n\nwhen it is clear that third-party dependencies do not require additional polyfill, you can set output.polyfill to usage.\n\nin the case where it is clear that third-party dependencies do not require polyfill, you can set output.polyfill to usage.\n\nin usage mode, builder analyzes the syntax used in the source code and injects the required polyfill code on demand to reduce the size of polyfill.\n\nexport default {\n  output: {\n    polyfill: 'usage',\n  },\n};\n\n\n\n# image compression\n\nin general front-end projects, the size of image often accounts for a large proportion of the total bundle size of the project.so if the image size can be reduced as much as possible, it will have a significant optimization effect on the project bundle size. you can enable image compression by registering a plugin in the builder:\n\nimport { pluginimagecompress } from '@modern-js/builder-plugin-image-compress';\n\n// add the plugin to the builder\nbuilder.addplugins([pluginimagecompress()]);\n\n\nsee details in plugin-image-compress。\n\n\n# split chunk\n\na great chunk splitting strategy is very important to improve the loading performance of the application. it can make full use of the browser's caching mechanism to reduce the number of requests and improve the loading speed of the application.\n\na variety of chunk splitting strategies are built into builder, which can meet the needs of most applications. you can also customize the chunk splitting config according to your own business scenarios. for example:\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'split-by-experience',\n      forcesplitting: {\n        // for example, split the `react-query` into a chunk\n        react_query: [/node_modules\\/react-query/],\n      },\n    },\n  },\n};\n",charsets:{}},{title:"Chunk Splitting Practice",frontmatter:{},regularPath:"/en/guide/optimization/split-chunk.html",relativePath:"en/guide/optimization/split-chunk.md",key:"v-40511e8c",path:"/en/guide/optimization/split-chunk.html",headers:[{level:2,title:"Splitting Strategies",slug:"splitting-strategies",normalizedTitle:"splitting strategies",charIndex:481},{level:2,title:"Custom Splitting Strategy",slug:"custom-splitting-strategy",normalizedTitle:"custom splitting strategy",charIndex:2893}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Splitting Strategies Custom Splitting Strategy",content:"# Chunk Splitting Practice\n\nA great chunk splitting strategy is very important to improve the loading performance of the application. It can make full use of the browser's caching mechanism to reduce the number of requests and improve the loading speed of the application.\n\nA variety of chunk splitting strategies are built into Builder, which can meet the needs of most applications. You can also customize the chunk splitting config according to your own business scenarios.\n\n\n# Splitting Strategies\n\n> The chunk splitting config of Builder is in performance.chunkSplit.\n\nThe Builder includes the following chunk splitting strategies:\n\n * split-by-experience: Built-in splitting strategies (experienced splitting strategies by Builder).\n * split-by-module: Split according to modules, each NPM package is a chunk.\n * all-in-one: Both business code and third-party code are in one chunk.\n * single-vendor: Third-party code is in a vendor chunk.\n * split-by-size: Split according to chunk size.\n\n\n# split-by-experience\n\n# behaviour\n\nBased on past experience, built-in split groups include:\n\n * React (react, react-dom)\n * Router (react-router, react-router-dom, history)\n * Polyfill (core-js, @babel/runtime)\n * Semi (@ies/semi, @douyinfe/semi-ui)\n * Arco (@arco-design/web-react)\n * Lodash (lodash, lodash-es)\n\nThis strategy groups commonly used packages and then splits them into separate chunks. Generally, the number of chunks is not large, which is suitable for most applications and is also our recommended strategy.\n\n# config\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-experience',\n    },\n  },\n};\n\n\n\n# split-by-module\n\n# behaviour\n\nSplit each NPM package into a Chunk.\n\nwarning\n\nThis strategy will split the node_modules in the most granular way, and at the same time, under HTTP/2, multiplexing will speed up the loading time of resources.However, in non-HTTP/2 environments, it needs to be used with caution because of HTTP head-of-line blocking problem.\n\n# config\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-module',\n    },\n  },\n};\n\n\n\n# all-in-one\n\n# behaviour\n\nThis strategy puts business code and third-party dependencies in the same Chunk.\n\n# config\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'all-in-one',\n    },\n  },\n};\n\n\n\n# single-vendor\n\n# behaviour\n\nThis strategy puts third-party dependencies in one Chunk, and business code in another Chunk.\n\n# config\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'single-vendor',\n    },\n  },\n};\n\n\n\n# split-by-size\n\n# behaviour\n\nUnder this strategy, after setting minSize, maxSize to a fixed value, webpack will automatically split them without extra config.\n\n# config\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-size',\n      minSize: 30000,\n      maxSize: 50000,\n    },\n  },\n};\n\n\n\n# Custom Splitting Strategy\n\nIn addition to using the built-in strategies, you can also customize the splitting strategy to meet more customization needs. Custom strategy is divided into two parts:\n\n * Custom group\n * Custom webpack splitChunks config\n\nIt is worth noting that these two custom capabilities can be used together with the built-in strategy, that is, you can use the built-in strategy to split commonly used packages, and then use the custom function to split other packages.\n\n\n# Custom Group\n\nBuilder supports custom group, which is more flexible than the built-in strategies, and simpler than writing webpack config. For example:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-experience',\n      forceSplitting: {\n        // Split lodash into a Chunk\n        lodash: [/node_modules\\/lodash/, /node_modules\\/lodash-es/],\n      },\n    }\n  }\n}\n\n\nThrough forceSplitting config, you can easily split some packages into a Chunk.\n\n\n# Custom Webpack splitChunks Config\n\nIn addition to using custom grouping, you can also customize the native webpack config through override, such as:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-experience',\n      override: {\n        chunks: 'all',\n        minSize: 30000,\n      }\n    }\n  }\n}\n\n\nThe config in override will be merged with the webpack config. For specific config details, please refer to webpack official documentation.",normalizedContent:"# chunk splitting practice\n\na great chunk splitting strategy is very important to improve the loading performance of the application. it can make full use of the browser's caching mechanism to reduce the number of requests and improve the loading speed of the application.\n\na variety of chunk splitting strategies are built into builder, which can meet the needs of most applications. you can also customize the chunk splitting config according to your own business scenarios.\n\n\n# splitting strategies\n\n> the chunk splitting config of builder is in performance.chunksplit.\n\nthe builder includes the following chunk splitting strategies:\n\n * split-by-experience: built-in splitting strategies (experienced splitting strategies by builder).\n * split-by-module: split according to modules, each npm package is a chunk.\n * all-in-one: both business code and third-party code are in one chunk.\n * single-vendor: third-party code is in a vendor chunk.\n * split-by-size: split according to chunk size.\n\n\n# split-by-experience\n\n# behaviour\n\nbased on past experience, built-in split groups include:\n\n * react (react, react-dom)\n * router (react-router, react-router-dom, history)\n * polyfill (core-js, @babel/runtime)\n * semi (@ies/semi, @douyinfe/semi-ui)\n * arco (@arco-design/web-react)\n * lodash (lodash, lodash-es)\n\nthis strategy groups commonly used packages and then splits them into separate chunks. generally, the number of chunks is not large, which is suitable for most applications and is also our recommended strategy.\n\n# config\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'split-by-experience',\n    },\n  },\n};\n\n\n\n# split-by-module\n\n# behaviour\n\nsplit each npm package into a chunk.\n\nwarning\n\nthis strategy will split the node_modules in the most granular way, and at the same time, under http/2, multiplexing will speed up the loading time of resources.however, in non-http/2 environments, it needs to be used with caution because of http head-of-line blocking problem.\n\n# config\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'split-by-module',\n    },\n  },\n};\n\n\n\n# all-in-one\n\n# behaviour\n\nthis strategy puts business code and third-party dependencies in the same chunk.\n\n# config\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'all-in-one',\n    },\n  },\n};\n\n\n\n# single-vendor\n\n# behaviour\n\nthis strategy puts third-party dependencies in one chunk, and business code in another chunk.\n\n# config\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'single-vendor',\n    },\n  },\n};\n\n\n\n# split-by-size\n\n# behaviour\n\nunder this strategy, after setting minsize, maxsize to a fixed value, webpack will automatically split them without extra config.\n\n# config\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'split-by-size',\n      minsize: 30000,\n      maxsize: 50000,\n    },\n  },\n};\n\n\n\n# custom splitting strategy\n\nin addition to using the built-in strategies, you can also customize the splitting strategy to meet more customization needs. custom strategy is divided into two parts:\n\n * custom group\n * custom webpack splitchunks config\n\nit is worth noting that these two custom capabilities can be used together with the built-in strategy, that is, you can use the built-in strategy to split commonly used packages, and then use the custom function to split other packages.\n\n\n# custom group\n\nbuilder supports custom group, which is more flexible than the built-in strategies, and simpler than writing webpack config. for example:\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'split-by-experience',\n      forcesplitting: {\n        // split lodash into a chunk\n        lodash: [/node_modules\\/lodash/, /node_modules\\/lodash-es/],\n      },\n    }\n  }\n}\n\n\nthrough forcesplitting config, you can easily split some packages into a chunk.\n\n\n# custom webpack splitchunks config\n\nin addition to using custom grouping, you can also customize the native webpack config through override, such as:\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'split-by-experience',\n      override: {\n        chunks: 'all',\n        minsize: 30000,\n      }\n    }\n  }\n}\n\n\nthe config in override will be merged with the webpack config. for specific config details, please refer to webpack official documentation.",charsets:{}},{title:"Quick Start",frontmatter:{},regularPath:"/en/guide/quick-start.html",relativePath:"en/guide/quick-start.md",key:"v-fe8b9b74",path:"/en/guide/quick-start.html",headers:[{level:2,title:"Using Modern.js App",slug:"using-modern-js-app",normalizedTitle:"using modern.js app",charIndex:18},{level:2,title:"Use Builder in a front-end framework",slug:"use-builder-in-a-front-end-framework",normalizedTitle:"use builder in a front-end framework",charIndex:363},{level:2,title:"Next Step",slug:"next-step",normalizedTitle:"next step",charIndex:2868}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Using Modern.js App Use Builder in a front-end framework Next Step",content:"# Quick Start\n\n\n# Using Modern.js App\n\nModern.js 2.0 use Modern.js Builder as the build engine by default.\n\nIf you are a business developer, you do not need to manually install Builder, you can just create a Modern.js 2.0 project and use all the features provided by Builder.\n\n> Tips: Modern.js 2.0 is still under development and not officially released yet.\n\n\n# Use Builder in a front-end framework\n\nIf you are developing a front-end framework, you can use Builder by following these steps:\n\n\n# 1. Install Builder\n\nYou need to install two packages:\n\n * @modern-js/builder is the core package of Builder and exports the core API.\n * @modern-js/builder-webpack-provider is a provider for Builder, providing webpack-based building abilities.\n\npnpm add @modern-js/builder@beta @modern-js/builder-webpack-provider@beta -D\n\n\n> When upgrading the version, please make sure that Builder and Provider you installed have the same version.\n\n\n# 2. Create Builder Instance\n\nThere are two steps to creating a Builder instance:\n\nFirst you need to initialize the Builder Provider and pass in the builderConfig config object. Builder provides a lot of configs that allow you to customize the build behavior. At this point, you don't need to know the specific content of the config, just pass in an empty object. You can find all available configs in API - config.\n\nimport { createBuilder } from '@modern-js/builder';\nimport { builderWebpackProvider } from '@modern-js/builder-webpack-provider';\n\nconst provider = builderWebpackProvider({\n  builderConfig: {\n    // some configs\n  },\n});\n\n\nAfter getting the provider object, you can call the createBuilder method to create a Builder instance object:\n\nconst builder = await createBuilder(provider, {\n  entry: {\n    index: './src/index.ts',\n  },\n});\n\n\nExcept the entry option, the createBuilder method also provides some other options, which you can learn more about in API - createBuilder.\n\n\n# 3. Call Builder Instance Method\n\nThe Builder instance provides some methods, which you can use it according to the usage scenarios.\n\nTo start local development, it is recommended to use the builder.startDevServer method, which will start a local Dev Server.\n\nawait builder.startDevServer();\n\n\nAfter successfully starting Dev Server, you can see the following logs:\n\ninfo    Starting dev server...\ninfo    Dev server running at:\n\n  > Local:    http://localhost:8081\n  > Network:  http://192.168.0.1:8081\n\n\nTo deploy the App to production environment, it is recommended to use the builder.build method, which will build the production outputs.\n\nawait builder.build();\n\n\n> For more introduction of Builder instance methods, please read the Builder Instance chapter.\n\nAfter completing the above three steps, you have learned the basic usage of Builder. Next, you can customize the build process through the Builder plugin and Builder configs.\n\n\n# Next Step\n\nYou may want:",normalizedContent:"# quick start\n\n\n# using modern.js app\n\nmodern.js 2.0 use modern.js builder as the build engine by default.\n\nif you are a business developer, you do not need to manually install builder, you can just create a modern.js 2.0 project and use all the features provided by builder.\n\n> tips: modern.js 2.0 is still under development and not officially released yet.\n\n\n# use builder in a front-end framework\n\nif you are developing a front-end framework, you can use builder by following these steps:\n\n\n# 1. install builder\n\nyou need to install two packages:\n\n * @modern-js/builder is the core package of builder and exports the core api.\n * @modern-js/builder-webpack-provider is a provider for builder, providing webpack-based building abilities.\n\npnpm add @modern-js/builder@beta @modern-js/builder-webpack-provider@beta -d\n\n\n> when upgrading the version, please make sure that builder and provider you installed have the same version.\n\n\n# 2. create builder instance\n\nthere are two steps to creating a builder instance:\n\nfirst you need to initialize the builder provider and pass in the builderconfig config object. builder provides a lot of configs that allow you to customize the build behavior. at this point, you don't need to know the specific content of the config, just pass in an empty object. you can find all available configs in api - config.\n\nimport { createbuilder } from '@modern-js/builder';\nimport { builderwebpackprovider } from '@modern-js/builder-webpack-provider';\n\nconst provider = builderwebpackprovider({\n  builderconfig: {\n    // some configs\n  },\n});\n\n\nafter getting the provider object, you can call the createbuilder method to create a builder instance object:\n\nconst builder = await createbuilder(provider, {\n  entry: {\n    index: './src/index.ts',\n  },\n});\n\n\nexcept the entry option, the createbuilder method also provides some other options, which you can learn more about in api - createbuilder.\n\n\n# 3. call builder instance method\n\nthe builder instance provides some methods, which you can use it according to the usage scenarios.\n\nto start local development, it is recommended to use the builder.startdevserver method, which will start a local dev server.\n\nawait builder.startdevserver();\n\n\nafter successfully starting dev server, you can see the following logs:\n\ninfo    starting dev server...\ninfo    dev server running at:\n\n  > local:    http://localhost:8081\n  > network:  http://192.168.0.1:8081\n\n\nto deploy the app to production environment, it is recommended to use the builder.build method, which will build the production outputs.\n\nawait builder.build();\n\n\n> for more introduction of builder instance methods, please read the builder instance chapter.\n\nafter completing the above three steps, you have learned the basic usage of builder. next, you can customize the build process through the builder plugin and builder configs.\n\n\n# next step\n\nyou may want:",charsets:{}},{title:"Integrate to Framework",frontmatter:{},regularPath:"/en/plugins/integration.html",relativePath:"en/plugins/integration.md",key:"v-68c8b2cc",path:"/en/plugins/integration.html",lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"# Integrate to Framework\n\nTODO",normalizedContent:"# integrate to framework\n\ntodo",charsets:{}},{title:"Introduce to Plugin",frontmatter:{},regularPath:"/en/plugins/introduction.html",relativePath:"en/plugins/introduction.md",key:"v-92fa34e8",path:"/en/plugins/introduction.html",headers:[{level:2,title:"Write a plugin",slug:"write-a-plugin",normalizedTitle:"write a plugin",charIndex:740},{level:2,title:"Lifetime Hooks",slug:"lifetime-hooks",normalizedTitle:"lifetime hooks",charIndex:1727},{level:2,title:"Use Builder Config",slug:"use-builder-config",normalizedTitle:"use builder config",charIndex:2105},{level:2,title:"Modify webpack Config",slug:"modify-webpack-config",normalizedTitle:"modify webpack config",charIndex:4736},{level:2,title:"Examples",slug:"examples",normalizedTitle:"examples",charIndex:5246}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Write a plugin Lifetime Hooks Use Builder Config Modify webpack Config Examples",content:"# Introduce to Plugin\n\nBuilder provides developers with a lightweight but powerful plugin system to build itself and any other plugins. Developing plugins to change the Builder's behavior and introduce extra features. such as:\n\n * Modify config of bundlers.\n * Resolve and handle new file types.\n * Modify and compile file modules.\n * Deploy your application.\n\nBuilder can use webpack or rspack as bundler, expose unified Node.js API, and integrate into different frameworks. Users can painlessly switch between bundlers.\n\nBut users can't use Builder plugins directly in frameworks. Because these frameworks (e.g. modern.js) not only reuse the compiling features provided by the Builder, but can also be built with lots of other parts.\n\n\n# Write a plugin\n\nPlugin module should export an entry function just like (options?: PluginOptions) => BuilderPlugin:\n\nimport type { BuilderPlugin } from '@modern-js/builder-webpack-provider';\n\nexport interface PluginFooOptions {\n  message?: string;\n}\n\nexport const PluginFoo = (options?: PluginFooOptions): BuilderPlugin => ({\n  name: 'plugin-foo',\n  setup(api) {\n    api.onExit(() => {\n      const msg = options.message || 'finish.';\n      console.log(msg)\n    });\n  }\n});\n\nbuilder.addPlugins([PluginFoo('some other message.')]);\n\n\nThe function usually takes an options object and returns the plugin instance, which manages state through closures.\n\nLet's look at each part:\n\n * name is used to label the plugin\n * setup as the main entry point of plugins\n * api provides context object, lifetime hooks and utils.\n\nThe package name of the plugin needs to contain the conventional builder-plugin prefix for identification, just like builder-plugin-foo, @scope/builder-plugin-bar, etc.\n\n\n# Lifetime Hooks\n\nBuilder uses lifetime planning work internally, and plugins can also register hooks to take part in any stage of the workflow and implement their own features.\n\nThe full list of Builder's lifetime hooks can be found in the API References.\n\nThe Builder does not take over the hooks of the underlying bundlers, whose documents can be found here: webpack hooks\n\n\n# Use Builder Config\n\nCustom plugins can usually get config from function parameters, just define and use it at your pleasure.\n\nBut sometimes you may need to read and change the public config of the Builder. To begin with, you should understand how the Builder generates and uses its config:\n\n * Read, parse config and merge with default values.\n * Plugins modify the config by api.modifyBuilderConfig(...).\n * Normalize the config and provide it to consume, then the config can no longer be modified.\n\nRefer to this tiny example:\n\nexport const PluginUploadDist = (): BuilderPlugin => ({\n  name: 'plugin-upload-dist',\n  setup(api) {\n    api.modifyBuilderConfig(config => {\n      // try to disable minimize.\n      // should deal with optional value by self.\n      config.output ||= {};\n      config.output.disableMinimize = true;\n      // but also can be enable by other plugins...\n    });\n    api.onBeforeBuild(() => {\n      // use the normalized config.\n      const config = api.getNormalizedConfig();\n      if (!config.output.disableMinimize) {\n        // let it crash when enable minimize.\n        throw new Error('You must disable minimize to upload readable dist files.');\n      }\n    });\n    api.onAfterBuild(() => {\n      const config = api.getNormalizedConfig();\n      const distRoot = config.output.distPath.root;\n      // TODO: upload all files in `distRoot`.\n    });\n  }\n});\n\n\nThere are 3 ways to use Builder config:\n\n * register callback with api.modifyBuilderConfig(config => {}) to modify config.\n * use api.getBuilderConfig() to get Builder config.\n * use api.getNormalizedConfig() to get finally normalized config.\n\nWhen normalized, it will again merge the config object with the default values and make sure the optional properties exist. So for PluginUploadDist, part of its type looks like:\n\napi.modifyBuilderConfig((config: BuilderConfig) => {});\napi.getBuilderConfig() as BuilderConfig;\ntype BuilderConfig = {\n  output?: {\n    disableMinimize?: boolean;\n    distPath?: { root?: string };\n  };\n};\n\napi.getNormalizedConfig() as NormalizedConfig;\ntype NormalizedConfig = {\n  output: {\n    disableMinimize: boolean;\n    distPath: { root: string };\n  };\n};\n\n\nThe return value type of getNormalizedConfig() is slightly different from that of BuilderConfig and is narrowed compared to the types described elsewhere in the documentation. You don't need to fill in the defaults when you use it.\n\nTherefore, the best way to use configuration items is to\n\n * Modify the config with api.modifyBuilderConfig(config => {})\n * Read api.getNormalizedConfig() as the actual config used by the plugin in the further lifetime.\n\n\n# Modify webpack Config\n\nPlugins can handle webpack's config by:\n\n * use api.modifyWebpackChain(chain => {}) to modify webpack-chain.\n * use api.modifyWebpackConfig(config => {}) to modify raw webpack config.\n * use api.onAfterCreateCompiler(compiler => {}) to handle webpack instance directly.\n\nWe recommend that you use neutrinojs/webpack-chain's chained api to handle the config of webpack whenever possible.\n\nBuilder integrated a webpack5-compatible version, which can be found in sorrycc/webpack-chain.\n\n\n# Examples\n\n\n# Modify Loaders\n\nThe webpack loaders can be used to load and transform various file types. For more information, see concepts and loaders.\n\nimport type { BuilderPlugin } from '@modern-js/builder-webpack-provider';\n\nexport const PluginTypeScriptExt = (): BuilderPlugin => ({\n  name: 'builder-typescript-ext',\n  setup(api) {\n    api.modifyWebpackChain(async chain => {\n      // set ts-loader to recognize more files as typescript modules.\n      chain.module\n        .rule(CHAIN_ID.RULE.TS)\n        .test(/\\.(ts|mts|cts|tsx|tss|tsm)$/);\n    });\n  },\n});\n\n\n\n# Add Entry Points\n\nimport type { BuilderPlugin } from '@modern-js/builder-webpack-provider';\n\nexport const PluginAdminPanel = (): BuilderPlugin => ({\n  name: 'builder-admin-panel',\n  setup(api) {\n    api.modifyWebpackChain(async chain => {\n      config\n        .entry('admin-panel')\n        .add('src/admin/panel.js');\n    });\n  },\n});\n\n\n\n# Integrate webpack Plugins\n\nIntegrate existing webpack plugins to migrate your applications:\n\nimport type { BuilderPlugin } from '@modern-js/builder-webpack-provider';\nimport type { Options } from '@modern-js/inspector-webpack-plugin';\n\nexport const PluginInspector = (options?: Options): BuilderPlugin => ({\n  name: 'builder-plugin-inspector',\n  setup(api) {\n    api.modifyWebpackChain(async chain => {\n      // load modules dynamically only when needed\n      // to avoid unnecessary performance cost.\n      const { InspectorWebpackPlugin } = await import(\n        '@modern-js/inspector-webpack-plugin'\n      );\n      // modify webpack-chain to setup webpack plugin.\n      chain\n        .plugin('inspector-webpack-plugin')\n        .use(InspectorWebpackPlugin, [inspectorOptions]);\n    });\n  },\n});\n",normalizedContent:"# introduce to plugin\n\nbuilder provides developers with a lightweight but powerful plugin system to build itself and any other plugins. developing plugins to change the builder's behavior and introduce extra features. such as:\n\n * modify config of bundlers.\n * resolve and handle new file types.\n * modify and compile file modules.\n * deploy your application.\n\nbuilder can use webpack or rspack as bundler, expose unified node.js api, and integrate into different frameworks. users can painlessly switch between bundlers.\n\nbut users can't use builder plugins directly in frameworks. because these frameworks (e.g. modern.js) not only reuse the compiling features provided by the builder, but can also be built with lots of other parts.\n\n\n# write a plugin\n\nplugin module should export an entry function just like (options?: pluginoptions) => builderplugin:\n\nimport type { builderplugin } from '@modern-js/builder-webpack-provider';\n\nexport interface pluginfoooptions {\n  message?: string;\n}\n\nexport const pluginfoo = (options?: pluginfoooptions): builderplugin => ({\n  name: 'plugin-foo',\n  setup(api) {\n    api.onexit(() => {\n      const msg = options.message || 'finish.';\n      console.log(msg)\n    });\n  }\n});\n\nbuilder.addplugins([pluginfoo('some other message.')]);\n\n\nthe function usually takes an options object and returns the plugin instance, which manages state through closures.\n\nlet's look at each part:\n\n * name is used to label the plugin\n * setup as the main entry point of plugins\n * api provides context object, lifetime hooks and utils.\n\nthe package name of the plugin needs to contain the conventional builder-plugin prefix for identification, just like builder-plugin-foo, @scope/builder-plugin-bar, etc.\n\n\n# lifetime hooks\n\nbuilder uses lifetime planning work internally, and plugins can also register hooks to take part in any stage of the workflow and implement their own features.\n\nthe full list of builder's lifetime hooks can be found in the api references.\n\nthe builder does not take over the hooks of the underlying bundlers, whose documents can be found here: webpack hooks\n\n\n# use builder config\n\ncustom plugins can usually get config from function parameters, just define and use it at your pleasure.\n\nbut sometimes you may need to read and change the public config of the builder. to begin with, you should understand how the builder generates and uses its config:\n\n * read, parse config and merge with default values.\n * plugins modify the config by api.modifybuilderconfig(...).\n * normalize the config and provide it to consume, then the config can no longer be modified.\n\nrefer to this tiny example:\n\nexport const pluginuploaddist = (): builderplugin => ({\n  name: 'plugin-upload-dist',\n  setup(api) {\n    api.modifybuilderconfig(config => {\n      // try to disable minimize.\n      // should deal with optional value by self.\n      config.output ||= {};\n      config.output.disableminimize = true;\n      // but also can be enable by other plugins...\n    });\n    api.onbeforebuild(() => {\n      // use the normalized config.\n      const config = api.getnormalizedconfig();\n      if (!config.output.disableminimize) {\n        // let it crash when enable minimize.\n        throw new error('you must disable minimize to upload readable dist files.');\n      }\n    });\n    api.onafterbuild(() => {\n      const config = api.getnormalizedconfig();\n      const distroot = config.output.distpath.root;\n      // todo: upload all files in `distroot`.\n    });\n  }\n});\n\n\nthere are 3 ways to use builder config:\n\n * register callback with api.modifybuilderconfig(config => {}) to modify config.\n * use api.getbuilderconfig() to get builder config.\n * use api.getnormalizedconfig() to get finally normalized config.\n\nwhen normalized, it will again merge the config object with the default values and make sure the optional properties exist. so for pluginuploaddist, part of its type looks like:\n\napi.modifybuilderconfig((config: builderconfig) => {});\napi.getbuilderconfig() as builderconfig;\ntype builderconfig = {\n  output?: {\n    disableminimize?: boolean;\n    distpath?: { root?: string };\n  };\n};\n\napi.getnormalizedconfig() as normalizedconfig;\ntype normalizedconfig = {\n  output: {\n    disableminimize: boolean;\n    distpath: { root: string };\n  };\n};\n\n\nthe return value type of getnormalizedconfig() is slightly different from that of builderconfig and is narrowed compared to the types described elsewhere in the documentation. you don't need to fill in the defaults when you use it.\n\ntherefore, the best way to use configuration items is to\n\n * modify the config with api.modifybuilderconfig(config => {})\n * read api.getnormalizedconfig() as the actual config used by the plugin in the further lifetime.\n\n\n# modify webpack config\n\nplugins can handle webpack's config by:\n\n * use api.modifywebpackchain(chain => {}) to modify webpack-chain.\n * use api.modifywebpackconfig(config => {}) to modify raw webpack config.\n * use api.onaftercreatecompiler(compiler => {}) to handle webpack instance directly.\n\nwe recommend that you use neutrinojs/webpack-chain's chained api to handle the config of webpack whenever possible.\n\nbuilder integrated a webpack5-compatible version, which can be found in sorrycc/webpack-chain.\n\n\n# examples\n\n\n# modify loaders\n\nthe webpack loaders can be used to load and transform various file types. for more information, see concepts and loaders.\n\nimport type { builderplugin } from '@modern-js/builder-webpack-provider';\n\nexport const plugintypescriptext = (): builderplugin => ({\n  name: 'builder-typescript-ext',\n  setup(api) {\n    api.modifywebpackchain(async chain => {\n      // set ts-loader to recognize more files as typescript modules.\n      chain.module\n        .rule(chain_id.rule.ts)\n        .test(/\\.(ts|mts|cts|tsx|tss|tsm)$/);\n    });\n  },\n});\n\n\n\n# add entry points\n\nimport type { builderplugin } from '@modern-js/builder-webpack-provider';\n\nexport const pluginadminpanel = (): builderplugin => ({\n  name: 'builder-admin-panel',\n  setup(api) {\n    api.modifywebpackchain(async chain => {\n      config\n        .entry('admin-panel')\n        .add('src/admin/panel.js');\n    });\n  },\n});\n\n\n\n# integrate webpack plugins\n\nintegrate existing webpack plugins to migrate your applications:\n\nimport type { builderplugin } from '@modern-js/builder-webpack-provider';\nimport type { options } from '@modern-js/inspector-webpack-plugin';\n\nexport const plugininspector = (options?: options): builderplugin => ({\n  name: 'builder-plugin-inspector',\n  setup(api) {\n    api.modifywebpackchain(async chain => {\n      // load modules dynamically only when needed\n      // to avoid unnecessary performance cost.\n      const { inspectorwebpackplugin } = await import(\n        '@modern-js/inspector-webpack-plugin'\n      );\n      // modify webpack-chain to setup webpack plugin.\n      chain\n        .plugin('inspector-webpack-plugin')\n        .use(inspectorwebpackplugin, [inspectoroptions]);\n    });\n  },\n});\n",charsets:{cjk:!0}},{title:"Overview",frontmatter:{},regularPath:"/en/plugins/list.html",relativePath:"en/plugins/list.md",key:"v-4eed870c",path:"/en/plugins/list.html",headers:[{level:2,title:"Official Plugins",slug:"official-plugins",normalizedTitle:"official plugins",charIndex:15}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Official Plugins",content:"# Overview\n\n\n# Official Plugins\n\n * @modern-js/builder-plugin-swc: Use SWC as the transformer and minimizer to improve build performance.\n * @modern-js/builder-plugin-esbuild: Use esbuild as the transformer and minimizer to improve build performance.\n * @modern-js/builder-plugin-node-polyfill: Inject Polyfills of Node core modules in the browser side.\n * @modern-js/builder-plugin-image-compress：Compress the image resources used in the project.\n\nYou can find the source code of these plugins in modern.js/packages/builder directory.",normalizedContent:"# overview\n\n\n# official plugins\n\n * @modern-js/builder-plugin-swc: use swc as the transformer and minimizer to improve build performance.\n * @modern-js/builder-plugin-esbuild: use esbuild as the transformer and minimizer to improve build performance.\n * @modern-js/builder-plugin-node-polyfill: inject polyfills of node core modules in the browser side.\n * @modern-js/builder-plugin-image-compress：compress the image resources used in the project.\n\nyou can find the source code of these plugins in modern.js/packages/builder directory.",charsets:{}},{title:"Esbuild Plugin",frontmatter:{},regularPath:"/en/plugins/plugin-esbuild.html",relativePath:"en/plugins/plugin-esbuild.md",key:"v-312b8968",path:"/en/plugins/plugin-esbuild.html",headers:[{level:2,title:"Quick Start",slug:"quick-start",normalizedTitle:"quick start",charIndex:697},{level:2,title:"Config",slug:"config",normalizedTitle:"config",charIndex:1470},{level:2,title:"Limitations",slug:"limitations",normalizedTitle:"limitations",charIndex:3518}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Quick Start Config Limitations",content:"# Esbuild Plugin\n\nAbout esbuild\n\nesbuild is a front-end build tool based on Golang. It has the functions of bundling, compiling and minimizing JavaScript code. Compared with traditional tools, the performance is significantly improved. When minimizing code, compared to webpack's built-in terser minimizer, esbuild has dozens of times better performance.\n\nBuilder provides esbuild plugin that allow you to use esbuild instead of babel-loader, ts-loader and terser for transformation and minification process. When you enable esbuild in a large project, it can greatly reduce the time required for code compilation and compression, while effectively avoiding OOM (heap out of memory) problems.\n\n\n# Quick Start\n\n\n# Install\n\nYou can install the plugin with the following command:\n\n# npm\nnpm install @modern-js/builder-plugin-esbuild -D\n\n# yarn\nyarn add @modern-js/builder-plugin-esbuild -D\n\n# pnpm\npnpm install @modern-js/builder-plugin-esbuild -D\n\n\n\n# Register\n\nIn upper-level frameworks such as Modern.js or EdenX, you can register esbuild plugins through the builderPlugins config:\n\nimport { PluginEsbuild } from '@modern-js/builder-plugin-esbuild';\n\nexport default {\n  builderPlugins: [PluginEsbuild()],\n};\n\n\nIf you are using the Builder's Node API, you can register esbuild plugins through the addPlugins method:\n\nimport { PluginEsbuild } from '@modern-js/builder-plugin-esbuild';\n\n// add the plugin to the builder instance\nbuilder.addPlugins([PluginEsbuild()]);\n\n\n\n# Config\n\nThe plugin will enable code transformation and minification by default. You can also customize the behavior of the plugin through configuration.\n\n\n# loader\n\n * Type:\n\ntype LoaderOptions = EsbuildLoaderOptions | false | undefined;\n\n\n * Default:\n\nconst defaultOptions = {\n  target: 'es2015',\n  charset: builderConfig.output.charset,\n};\n\n\nThis config is used to enable JavaScript/TypeScript transformation, which will replace babel-loader and ts-loader with esbuild-loader.\n\nIf you want to modify the options, you can check the esbuild-loader documentation.\n\n# Set the target environment\n\nUse the target option to set the target environment for transformation. target can be set directly to the JavaScript language version, such as es6, es2020; it can also be set to several target environments, each target environment is an environment name followed by a version number, such as ['chrome58', 'edge16' ,'firefox57']. For a detailed introduction of the target option, please refer to esbuild - target.\n\ntarget supports setting to the following environments:\n\n * chrome\n * edge\n * firefox\n * ie\n * ios\n * node\n * opera\n * safari\n\nPluginEsbuild({\n  loader: {\n    target: 'chrome61',\n  },\n});\n\n\n# Disable transformation\n\nSet loader to false to disable esbuild transformation, and Builder will continue to use Babel to transform the code.\n\nPluginEsbuild({\n  loader: false,\n});\n\n\n\n# minimize\n\n * Type:\n\ntype MinimizeOptions = EsbuildMinifyOptions | false | undefined;\n\n\n * Default:\n\nconst defaultOptions = {\n  css: true,\n  target: 'es2015',\n};\n\n\nThis option is used to enable minification for JavaScript and CSS.\n\nIf you want to modify the options, you can check the esbuild-loader documentation.\n\n# Set the target environment\n\nUse the target option to set the target environment for minification.\n\nPluginEsbuild({\n  minimize: {\n    target: 'chrome61',\n  },\n});\n\n\n# Disable minification\n\nSet minimize to false to disable esbuild minification, and Builder will continue to use Terser to minify the code.\n\nPluginEsbuild({\n  minimize: false,\n});\n\n\n\n# Limitations\n\nAlthough esbuild can significantly improve the build performance of existing webpack projects, it still has certain limitations that require special attention.\n\n\n# Compatibility\n\nAs a compiler (i.e. loader capability), esbuild usually supports at least ES2015 (that is, ES6) syntax, and does not have the ability to automatically inject Polyfill.. If the production environment needs to downgrade to ES5 and below syntax, it is recommended to use SWC compilation.\n\nYou can specify the target syntax version by following config:\n\nPluginEsbuild({\n  loader: {\n    target: 'es2015',\n  },\n});\n\n\nAs a code minify tool (i.e. minimize capability), esbuild can minify the code in production environment, and usually supports ES2015 syntax at least.\n\nIf you set the compressed target to es5, you need to ensure that all codes have been compiled to ES5 codes, otherwise it will cause esbuild compilation error: Transforming 'xxx' to the configured target environment (\"es5\") is not supported yet.\n\nTherefore, for projects that need to be compatible with ES5 and below syntax in the production environment, please be careful to enable the minimize capability, and it is recommended to use SWC compression.\n\nYou can specify the target syntax version by following config:\n\nPluginEsbuild({\n  minimize: {\n    target: 'es2015',\n  },\n});\n\n\nCaution\n\nProjects that need to be compatible with ES5 and below syntax in the production environment need to be careful to turn on the minimize config.\n\n\n# Not support Babel plugins\n\nAs a compiler, the syntax transformation function of the original Babel plugins such as babel-plugin-import is not available after esbuild is turned on. And since the bottom layer of the plugin uses esbuild's Transform API, it does not support esbuild plugins to customize the compilation process.\n\nIf you have requirements related to Babel plugins such as babel-plugin-import, you can use the SWC plugin.\n\n\n# Bundle Size\n\nAlthough the compression speed of esbuild is faster, the compression ratio of esbuild is lower than that of terser, so the bundle size will increase, please use it according to the scenes. Generally speaking, esbuild is more suitable for scenes that are not sensitive to bundle size.\n\nYou can refer to minification-benchmarks for a detailed comparison between minimizers.",normalizedContent:"# esbuild plugin\n\nabout esbuild\n\nesbuild is a front-end build tool based on golang. it has the functions of bundling, compiling and minimizing javascript code. compared with traditional tools, the performance is significantly improved. when minimizing code, compared to webpack's built-in terser minimizer, esbuild has dozens of times better performance.\n\nbuilder provides esbuild plugin that allow you to use esbuild instead of babel-loader, ts-loader and terser for transformation and minification process. when you enable esbuild in a large project, it can greatly reduce the time required for code compilation and compression, while effectively avoiding oom (heap out of memory) problems.\n\n\n# quick start\n\n\n# install\n\nyou can install the plugin with the following command:\n\n# npm\nnpm install @modern-js/builder-plugin-esbuild -d\n\n# yarn\nyarn add @modern-js/builder-plugin-esbuild -d\n\n# pnpm\npnpm install @modern-js/builder-plugin-esbuild -d\n\n\n\n# register\n\nin upper-level frameworks such as modern.js or edenx, you can register esbuild plugins through the builderplugins config:\n\nimport { pluginesbuild } from '@modern-js/builder-plugin-esbuild';\n\nexport default {\n  builderplugins: [pluginesbuild()],\n};\n\n\nif you are using the builder's node api, you can register esbuild plugins through the addplugins method:\n\nimport { pluginesbuild } from '@modern-js/builder-plugin-esbuild';\n\n// add the plugin to the builder instance\nbuilder.addplugins([pluginesbuild()]);\n\n\n\n# config\n\nthe plugin will enable code transformation and minification by default. you can also customize the behavior of the plugin through configuration.\n\n\n# loader\n\n * type:\n\ntype loaderoptions = esbuildloaderoptions | false | undefined;\n\n\n * default:\n\nconst defaultoptions = {\n  target: 'es2015',\n  charset: builderconfig.output.charset,\n};\n\n\nthis config is used to enable javascript/typescript transformation, which will replace babel-loader and ts-loader with esbuild-loader.\n\nif you want to modify the options, you can check the esbuild-loader documentation.\n\n# set the target environment\n\nuse the target option to set the target environment for transformation. target can be set directly to the javascript language version, such as es6, es2020; it can also be set to several target environments, each target environment is an environment name followed by a version number, such as ['chrome58', 'edge16' ,'firefox57']. for a detailed introduction of the target option, please refer to esbuild - target.\n\ntarget supports setting to the following environments:\n\n * chrome\n * edge\n * firefox\n * ie\n * ios\n * node\n * opera\n * safari\n\npluginesbuild({\n  loader: {\n    target: 'chrome61',\n  },\n});\n\n\n# disable transformation\n\nset loader to false to disable esbuild transformation, and builder will continue to use babel to transform the code.\n\npluginesbuild({\n  loader: false,\n});\n\n\n\n# minimize\n\n * type:\n\ntype minimizeoptions = esbuildminifyoptions | false | undefined;\n\n\n * default:\n\nconst defaultoptions = {\n  css: true,\n  target: 'es2015',\n};\n\n\nthis option is used to enable minification for javascript and css.\n\nif you want to modify the options, you can check the esbuild-loader documentation.\n\n# set the target environment\n\nuse the target option to set the target environment for minification.\n\npluginesbuild({\n  minimize: {\n    target: 'chrome61',\n  },\n});\n\n\n# disable minification\n\nset minimize to false to disable esbuild minification, and builder will continue to use terser to minify the code.\n\npluginesbuild({\n  minimize: false,\n});\n\n\n\n# limitations\n\nalthough esbuild can significantly improve the build performance of existing webpack projects, it still has certain limitations that require special attention.\n\n\n# compatibility\n\nas a compiler (i.e. loader capability), esbuild usually supports at least es2015 (that is, es6) syntax, and does not have the ability to automatically inject polyfill.. if the production environment needs to downgrade to es5 and below syntax, it is recommended to use swc compilation.\n\nyou can specify the target syntax version by following config:\n\npluginesbuild({\n  loader: {\n    target: 'es2015',\n  },\n});\n\n\nas a code minify tool (i.e. minimize capability), esbuild can minify the code in production environment, and usually supports es2015 syntax at least.\n\nif you set the compressed target to es5, you need to ensure that all codes have been compiled to es5 codes, otherwise it will cause esbuild compilation error: transforming 'xxx' to the configured target environment (\"es5\") is not supported yet.\n\ntherefore, for projects that need to be compatible with es5 and below syntax in the production environment, please be careful to enable the minimize capability, and it is recommended to use swc compression.\n\nyou can specify the target syntax version by following config:\n\npluginesbuild({\n  minimize: {\n    target: 'es2015',\n  },\n});\n\n\ncaution\n\nprojects that need to be compatible with es5 and below syntax in the production environment need to be careful to turn on the minimize config.\n\n\n# not support babel plugins\n\nas a compiler, the syntax transformation function of the original babel plugins such as babel-plugin-import is not available after esbuild is turned on. and since the bottom layer of the plugin uses esbuild's transform api, it does not support esbuild plugins to customize the compilation process.\n\nif you have requirements related to babel plugins such as babel-plugin-import, you can use the swc plugin.\n\n\n# bundle size\n\nalthough the compression speed of esbuild is faster, the compression ratio of esbuild is lower than that of terser, so the bundle size will increase, please use it according to the scenes. generally speaking, esbuild is more suitable for scenes that are not sensitive to bundle size.\n\nyou can refer to minification-benchmarks for a detailed comparison between minimizers.",charsets:{cjk:!0}},{title:"Image Compress Plugin",frontmatter:{},regularPath:"/en/plugins/plugin-image-compress.html",relativePath:"en/plugins/plugin-image-compress.md",key:"v-b0db3db4",path:"/en/plugins/plugin-image-compress.html",headers:[{level:2,title:"Quick Start",slug:"quick-start",normalizedTitle:"quick start",charIndex:206},{level:2,title:"Config",slug:"config",normalizedTitle:"config",charIndex:1052}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Quick Start Config",content:"# Image Compress Plugin\n\nWith the image compression plugin, image resources used in the project can be compressed to reduce the size of the product without affecting the visual appearance of the image.\n\n\n# Quick Start\n\n\n# Install\n\nYou can install the plugin with the following command:\n\n# npm\nnpm install @modern-js/builder-plugin-image-compress -D\n\n# yarn\nyarn add @modern-js/builder-plugin-image-compress -D\n\n# pnpm\npnpm install @modern-js/builder-plugin-image-compress -D\n\n\n\n# Register\n\nIn upper-level frameworks such as Modern.js or EdenX, you can register image compress plugins through the builderPlugins config:\n\nimport { PluginImageCompress } from '@modern-js/builder-plugin-image-compress';\n\nexport default {\n  builderPlugins: [PluginImageCompress()],\n};\n\n\nIf you are using the Builder's Node API, you can register image compress plugins through the addPlugins method:\n\nimport { PluginImageCompress } from '@modern-js/builder-plugin-image-compress';\n\n// add the plugin to the builder instance\nbuilder.addPlugins([PluginImageCompress()]);\n\n\n\n# Config\n\nThe plugin accepts an array of compressor configuration items, each of which can be either a string or an object. The string can be the name of a built-in compressor and its default configuration enabled. Or use the object format configuration and specify the compressor in the use field. The remaining fields of the object will be used as compressor configuration items.\n\nBy default, the plugin will enable jpeg, png, ico image compressors, which are equivalent to the following two examples:\n\nPluginImageCompress(['jpeg', 'png', 'ico']);\n\n\nPluginImageCompress([{ use: 'jpeg' }, { use: 'png' }, { use: 'ico' }]);\n\n\nThe default configuration can be overridden by specifying a configuration item. For example, to allow the jpeg compressor to recognize new extension name and to set the quality of the png compressor.\n\nPluginImageCompress([\n  { use: 'jpeg', test: /\\.(jpg|jpeg|jpe)$/ },\n  { use: 'png', minQuality: 50 },\n  'ico',\n]);\n\n\nThe default png compressor is lossy. If you want to replace it with a lossless compressor, you can use the following configuration.\n\nPluginImageCompress(['jpeg', 'pngLossless', 'ico']);\n\n\nThe list of configuration items will eventually be converted to the corresponding bundler loader configuration, so compressors follow the same bottom-to-top matching rule.\n\nFor example, the png compressor will take precedence over the pngLossless compressor for the following configuration:\n\nPluginImageCompress(['jpeg', 'pngLossless', 'ico', 'png']);\n\n\nFor more information on compressors, please visit @napi-rs/image.",normalizedContent:"# image compress plugin\n\nwith the image compression plugin, image resources used in the project can be compressed to reduce the size of the product without affecting the visual appearance of the image.\n\n\n# quick start\n\n\n# install\n\nyou can install the plugin with the following command:\n\n# npm\nnpm install @modern-js/builder-plugin-image-compress -d\n\n# yarn\nyarn add @modern-js/builder-plugin-image-compress -d\n\n# pnpm\npnpm install @modern-js/builder-plugin-image-compress -d\n\n\n\n# register\n\nin upper-level frameworks such as modern.js or edenx, you can register image compress plugins through the builderplugins config:\n\nimport { pluginimagecompress } from '@modern-js/builder-plugin-image-compress';\n\nexport default {\n  builderplugins: [pluginimagecompress()],\n};\n\n\nif you are using the builder's node api, you can register image compress plugins through the addplugins method:\n\nimport { pluginimagecompress } from '@modern-js/builder-plugin-image-compress';\n\n// add the plugin to the builder instance\nbuilder.addplugins([pluginimagecompress()]);\n\n\n\n# config\n\nthe plugin accepts an array of compressor configuration items, each of which can be either a string or an object. the string can be the name of a built-in compressor and its default configuration enabled. or use the object format configuration and specify the compressor in the use field. the remaining fields of the object will be used as compressor configuration items.\n\nby default, the plugin will enable jpeg, png, ico image compressors, which are equivalent to the following two examples:\n\npluginimagecompress(['jpeg', 'png', 'ico']);\n\n\npluginimagecompress([{ use: 'jpeg' }, { use: 'png' }, { use: 'ico' }]);\n\n\nthe default configuration can be overridden by specifying a configuration item. for example, to allow the jpeg compressor to recognize new extension name and to set the quality of the png compressor.\n\npluginimagecompress([\n  { use: 'jpeg', test: /\\.(jpg|jpeg|jpe)$/ },\n  { use: 'png', minquality: 50 },\n  'ico',\n]);\n\n\nthe default png compressor is lossy. if you want to replace it with a lossless compressor, you can use the following configuration.\n\npluginimagecompress(['jpeg', 'pnglossless', 'ico']);\n\n\nthe list of configuration items will eventually be converted to the corresponding bundler loader configuration, so compressors follow the same bottom-to-top matching rule.\n\nfor example, the png compressor will take precedence over the pnglossless compressor for the following configuration:\n\npluginimagecompress(['jpeg', 'pnglossless', 'ico', 'png']);\n\n\nfor more information on compressors, please visit @napi-rs/image.",charsets:{cjk:!0}},{title:"Node Polyfill Plugin",frontmatter:{},regularPath:"/en/plugins/plugin-node-polyfill.html",relativePath:"en/plugins/plugin-node-polyfill.md",key:"v-4df7304c",path:"/en/plugins/plugin-node-polyfill.html",headers:[{level:2,title:"Quick Start",slug:"quick-start",normalizedTitle:"quick start",charIndex:484},{level:2,title:"Node Polyfills",slug:"node-polyfills",normalizedTitle:"node polyfills",charIndex:1319}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Quick Start Node Polyfills",content:"# Node Polyfill Plugin\n\nAbout Node Polyfill\n\nNormally, we don't need to use Node libs on the browser side. However, it is possible to use some Node libs when the code will run on both the Node side and the browser side, and Node Polyfill provides browser versions of polyfills for these Node libs.\n\nBy using the Node Polyfill plugin, Node core libs polyfills are automatically injected into the browser-side, allowing you to use these modules on the browser side with confidence.\n\n\n# Quick Start\n\n\n# Install\n\nYou can install the plugin with the following command:\n\n# npm\nnpm install @modern-js/builder-plugin-node-polyfill -D\n\n# yarn\nyarn add @modern-js/builder-plugin-node-polyfill -D\n\n# pnpm\npnpm install @modern-js/builder-plugin-node-polyfill -D\n\n\n\n# Register\n\nIn upper-level frameworks such as Modern.js or EdenX, you can register node polyfill plugins through the builderPlugins config:\n\nimport { PluginNodePolyfill } from '@modern-js/builder-plugin-node-polyfill';\n\nexport default {\n  builderPlugins: [PluginNodePolyfill()],\n};\n\n\nIf you are using the Builder's Node API, you can register node polyfill plugins through the addPlugins method:\n\nimport { PluginNodePolyfill } from '@modern-js/builder-plugin-node-polyfill';\n\n// add the plugin to the builder instance\nbuilder.addPlugins([PluginNodePolyfill()]);\n\n\n\n# Node Polyfills\n\n\n# Globals\n\n * Buffer\n * process\n\nWhen the above module is used directly in code, the corresponding polyfill will be injected.\n\nconst bufferData = Buffer.from('xxxx');\n\n\n\n# Modules\n\n * assert\n * buffer\n * console\n * constants\n * crypto\n * domain\n * events\n * http\n * https\n * os\n * path\n * punycode\n * process\n * querystring\n * stream\n * _stream_duplex\n * _stream_passthrough\n * _stream_readable\n * _stream_transform\n * _stream_writable\n * string_decoder\n * sys\n * timers\n * tty\n * url\n * util\n * vm\n * zlib\n\nWhen the above module is referenced in code via import / require syntax, the corresponding polyfill will be injected.\n\nimport { Buffer } from 'buffer';\n\nconst bufferData = Buffer.from('xxxx');\n",normalizedContent:"# node polyfill plugin\n\nabout node polyfill\n\nnormally, we don't need to use node libs on the browser side. however, it is possible to use some node libs when the code will run on both the node side and the browser side, and node polyfill provides browser versions of polyfills for these node libs.\n\nby using the node polyfill plugin, node core libs polyfills are automatically injected into the browser-side, allowing you to use these modules on the browser side with confidence.\n\n\n# quick start\n\n\n# install\n\nyou can install the plugin with the following command:\n\n# npm\nnpm install @modern-js/builder-plugin-node-polyfill -d\n\n# yarn\nyarn add @modern-js/builder-plugin-node-polyfill -d\n\n# pnpm\npnpm install @modern-js/builder-plugin-node-polyfill -d\n\n\n\n# register\n\nin upper-level frameworks such as modern.js or edenx, you can register node polyfill plugins through the builderplugins config:\n\nimport { pluginnodepolyfill } from '@modern-js/builder-plugin-node-polyfill';\n\nexport default {\n  builderplugins: [pluginnodepolyfill()],\n};\n\n\nif you are using the builder's node api, you can register node polyfill plugins through the addplugins method:\n\nimport { pluginnodepolyfill } from '@modern-js/builder-plugin-node-polyfill';\n\n// add the plugin to the builder instance\nbuilder.addplugins([pluginnodepolyfill()]);\n\n\n\n# node polyfills\n\n\n# globals\n\n * buffer\n * process\n\nwhen the above module is used directly in code, the corresponding polyfill will be injected.\n\nconst bufferdata = buffer.from('xxxx');\n\n\n\n# modules\n\n * assert\n * buffer\n * console\n * constants\n * crypto\n * domain\n * events\n * http\n * https\n * os\n * path\n * punycode\n * process\n * querystring\n * stream\n * _stream_duplex\n * _stream_passthrough\n * _stream_readable\n * _stream_transform\n * _stream_writable\n * string_decoder\n * sys\n * timers\n * tty\n * url\n * util\n * vm\n * zlib\n\nwhen the above module is referenced in code via import / require syntax, the corresponding polyfill will be injected.\n\nimport { buffer } from 'buffer';\n\nconst bufferdata = buffer.from('xxxx');\n",charsets:{}},{title:"SWC plugin",frontmatter:{},regularPath:"/en/plugins/plugin-swc.html",relativePath:"en/plugins/plugin-swc.md",key:"v-0613ddec",path:"/en/plugins/plugin-swc.html",headers:[{level:2,title:"Quick Start",slug:"quick-start",normalizedTitle:"quick start",charIndex:372},{level:2,title:"Config",slug:"config",normalizedTitle:"config",charIndex:1182},{level:2,title:"Limitation",slug:"limitation",normalizedTitle:"limitation",charIndex:5855}],lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:"Quick Start Config Limitation",content:"# SWC plugin\n\nSWC (Speedy Web Compiler) is a transformer and minimizer for JavaScript and TypeScript based on Rust. SWC can provide the same abilities with Babel, and it's more than 10x faster than Babel.\n\nModern.js Builder has a out-of-box plugin for SWC, power your Web application with Polyfill and minification, we also port some common used Babel plugins to SWC.\n\n\n# Quick Start\n\n\n# Install\n\nYou can install the plugin with the following command:\n\n# npm\nnpm install @modern-js/builder-plugin-swc -D\n\n# yarn\nyarn add @modern-js/builder-plugin-swc -D\n\n# pnpm\npnpm install @modern-js/builder-plugin-swc -D\n\n\n\n# Register\n\nIn upper-level frameworks such as Modern.js or EdenX, you can register SWC plugin through the builderPlugins config:\n\nimport { PluginSwc } from '@modern-js/builder-plugin-swc';\n\nexport default {\n  builderPlugins: [PluginSwc()],\n};\n\n\nIf you are using the Builder's Node API, you can register SWC plugin through the addPlugins method:\n\nimport { PluginSwc } from '@modern-js/builder-plugin-swc';\n\n// add the plugin to the builder instance\nbuilder.addPlugins([PluginSwc()]);\n\n\nThat's it !\n\nNow you can use SWC transformation and minification in your project.\n\n\n# Config\n\n * Type: PluginConfig\n\ntype PluginConfig = {\n  presetReact?: ReactConfig;\n  presetEnv?: EnvConfig;\n  jsMinify?: boolean | JsMinifyOptions;\n  extensions?: Extensions;\n};\n\n\n\n# presetReact\n\n * Type: presetReact in SWC.\n\nPorted from @babel/preset-react. The value you passed will be merged with default option.\n\nBy default, the plugin can set some fields based on your tsconfig.json file.\n\n * runtime: jsx field in compilerOptions.\n * importSource: jsxImportSource field in compilerOptions.\n * pragma: jsxFactory field in compilerOptions.\n * pragmaFrag: jsxFragmentFactory field in compilerOptions.\n\nIf there is no tsconfig.json file, default option is { runtime: 'automatic' }.\n\n\n# presetEnv\n\n * Type: presetEnv in SWC.\n\nPorted from @babel/preset-env. The value you passed will be merged with default option.\n\nDefault option is:\n\n{\n  targets: '', // automatic get browserslist from your project, so you don't have to set this field\n  mode: 'usage',\n}\n\n\n\n# jsMinify\n\n * Type: boolean or compress configuration.\n\nDefault option is: { compress: {}, mangle: true }.\n\nIf set it to false, then SWC minification will be disabled, if set it to true then will it applies default option. If you pass an object, then this object will be merged with default option.\n\n\n# extensions\n\n * Type: Object\n\nSome plugins ported from Babel.\n\n# extensions.pluginImport\n\n * type\n\ntype PluginImportOptions = Array<{\n  fromSource: string;\n  replaceJs?: {\n    ignoreEsComponent?: string[];\n    template?: string;\n    replaceExpr?: (member: string) => string | false;\n    transformToDefaultImport?: boolean;\n  };\n  replaceCss?: {\n    ignoreStyleComponent?: string[];\n    template?: string;\n    replaceExpr?: (member: string) => string | false;\n  };\n}>;\n\n\nPorted from babel-plugin-import.\n\nfromSource\n\n * Type: string\n\nThe package that need to be transformed，eg. in import { a } from 'foo', fromSource should be foo.\n\nreplaceJs.ignoreEsComponent\n\n * Type: string[]\n * Default: []\n\nThe import specifiers which don't need to be transformed.\n\nreplaceJs.template\n\n * Type: string\n * Default: undefined\n\nTemplate that represents replacement, for example:\n\nimport { MyButton as Btn } from 'foo';\n\n\nIf we set:\n\nPluginSWC({\n  extensions: {\n    pluginImport: [\n      {\n        replaceJs: {\n          template: 'foo/es/{{member}}',\n        },\n      },\n    ],\n  },\n});\n\n\nThen the code above will be replaced to code below:\n\nimport Btn from 'foo/es/MyButton';\n\n\nWe also put some naming conversion functions, take the above example again, if we set it to:\n\nPluginSWC({\n  extensions: {\n    pluginImport: [\n      {\n        replaceJs: {\n          template: 'foo/es/{{ kebabCase member }}',\n        },\n      },\n    ],\n  },\n});\n\n\nIt will be transformed to code below:\n\nimport Btn from 'foo/es/my-button';\n\n\nBesides kebabCase, there are also camelCase, snakeCase, upperCase, lowerCase.\n\nreplaceJs.replaceExpr\n\n * Type: (member: string) => string\n * Default: undefined\n\nThis is also used to replace import specifiers. The argument is the specifier that imported. eg. a in import { a as b } from 'foo'. This function is called by Rust，and it needs to be synchronous. We recommend template instead, because call js function through node-api will cause performance issue. node-api invokes js function actually put this js call inside a queue, and wait for this call to be executed, so if current js thread is busy, then this call will block Rust thread for a while.\n\ntransformToDefaultImport\n\n * Type: boolean\n * Default: true\n\nWhether transform specifier to default specifier.\n\n# extensions.reactUtils\n\n * Type: Object\n\ntype ReactUtilsOptions = {\n  autoImportReact?: boolean;\n  removeEffect?: boolean;\n  removePropTypes?: {\n    mode?: 'remove' | 'unwrap' | 'unsafe-wrap';\n    removeImport?: boolean;\n    ignoreFilenames?: string[];\n    additionalLibraries?: string[];\n    classNameMatchers?: string[];\n  };\n};\n\n\nSome little help utils for React.\n\nreactUtils.autoImportReact\n\n * Type: boolean\n\nAutomatically import React as global variable, eg: import React from 'react'. Mostly used for generated React.createElement.\n\nreactUtils.removeEffect\n\n * Type: boolean\n\nRemove useEffect call.\n\nreactUtils.removePropTypes\n\n * Type:\n\ntype RemovePropTypesOptions = {\n  mode?: 'remove' | 'unwrap' | 'unsafe-wrap';\n  removeImport?: boolean;\n  ignoreFilenames?: string[];\n  additionalLibraries?: string[];\n  classNameMatchers?: string[];\n};\n\n\nRemove React runtime type checking. This is ported from @babel/plugin-react-transform-remove-prop-types, All the configurations remain the same.\n\n# extensions.lodash\n\n * Type: { cwd?: string; ids?: string;}\n * Default: { cwd: process.cwd(), ids: [] }\n\nPorted from @babel/plugin-lodash.\n\n\n# Limitation\n\nDo not support @babel/plugin-transform-runtime and other custom Babel plugins.",normalizedContent:"# swc plugin\n\nswc (speedy web compiler) is a transformer and minimizer for javascript and typescript based on rust. swc can provide the same abilities with babel, and it's more than 10x faster than babel.\n\nmodern.js builder has a out-of-box plugin for swc, power your web application with polyfill and minification, we also port some common used babel plugins to swc.\n\n\n# quick start\n\n\n# install\n\nyou can install the plugin with the following command:\n\n# npm\nnpm install @modern-js/builder-plugin-swc -d\n\n# yarn\nyarn add @modern-js/builder-plugin-swc -d\n\n# pnpm\npnpm install @modern-js/builder-plugin-swc -d\n\n\n\n# register\n\nin upper-level frameworks such as modern.js or edenx, you can register swc plugin through the builderplugins config:\n\nimport { pluginswc } from '@modern-js/builder-plugin-swc';\n\nexport default {\n  builderplugins: [pluginswc()],\n};\n\n\nif you are using the builder's node api, you can register swc plugin through the addplugins method:\n\nimport { pluginswc } from '@modern-js/builder-plugin-swc';\n\n// add the plugin to the builder instance\nbuilder.addplugins([pluginswc()]);\n\n\nthat's it !\n\nnow you can use swc transformation and minification in your project.\n\n\n# config\n\n * type: pluginconfig\n\ntype pluginconfig = {\n  presetreact?: reactconfig;\n  presetenv?: envconfig;\n  jsminify?: boolean | jsminifyoptions;\n  extensions?: extensions;\n};\n\n\n\n# presetreact\n\n * type: presetreact in swc.\n\nported from @babel/preset-react. the value you passed will be merged with default option.\n\nby default, the plugin can set some fields based on your tsconfig.json file.\n\n * runtime: jsx field in compileroptions.\n * importsource: jsximportsource field in compileroptions.\n * pragma: jsxfactory field in compileroptions.\n * pragmafrag: jsxfragmentfactory field in compileroptions.\n\nif there is no tsconfig.json file, default option is { runtime: 'automatic' }.\n\n\n# presetenv\n\n * type: presetenv in swc.\n\nported from @babel/preset-env. the value you passed will be merged with default option.\n\ndefault option is:\n\n{\n  targets: '', // automatic get browserslist from your project, so you don't have to set this field\n  mode: 'usage',\n}\n\n\n\n# jsminify\n\n * type: boolean or compress configuration.\n\ndefault option is: { compress: {}, mangle: true }.\n\nif set it to false, then swc minification will be disabled, if set it to true then will it applies default option. if you pass an object, then this object will be merged with default option.\n\n\n# extensions\n\n * type: object\n\nsome plugins ported from babel.\n\n# extensions.pluginimport\n\n * type\n\ntype pluginimportoptions = array<{\n  fromsource: string;\n  replacejs?: {\n    ignoreescomponent?: string[];\n    template?: string;\n    replaceexpr?: (member: string) => string | false;\n    transformtodefaultimport?: boolean;\n  };\n  replacecss?: {\n    ignorestylecomponent?: string[];\n    template?: string;\n    replaceexpr?: (member: string) => string | false;\n  };\n}>;\n\n\nported from babel-plugin-import.\n\nfromsource\n\n * type: string\n\nthe package that need to be transformed，eg. in import { a } from 'foo', fromsource should be foo.\n\nreplacejs.ignoreescomponent\n\n * type: string[]\n * default: []\n\nthe import specifiers which don't need to be transformed.\n\nreplacejs.template\n\n * type: string\n * default: undefined\n\ntemplate that represents replacement, for example:\n\nimport { mybutton as btn } from 'foo';\n\n\nif we set:\n\npluginswc({\n  extensions: {\n    pluginimport: [\n      {\n        replacejs: {\n          template: 'foo/es/{{member}}',\n        },\n      },\n    ],\n  },\n});\n\n\nthen the code above will be replaced to code below:\n\nimport btn from 'foo/es/mybutton';\n\n\nwe also put some naming conversion functions, take the above example again, if we set it to:\n\npluginswc({\n  extensions: {\n    pluginimport: [\n      {\n        replacejs: {\n          template: 'foo/es/{{ kebabcase member }}',\n        },\n      },\n    ],\n  },\n});\n\n\nit will be transformed to code below:\n\nimport btn from 'foo/es/my-button';\n\n\nbesides kebabcase, there are also camelcase, snakecase, uppercase, lowercase.\n\nreplacejs.replaceexpr\n\n * type: (member: string) => string\n * default: undefined\n\nthis is also used to replace import specifiers. the argument is the specifier that imported. eg. a in import { a as b } from 'foo'. this function is called by rust，and it needs to be synchronous. we recommend template instead, because call js function through node-api will cause performance issue. node-api invokes js function actually put this js call inside a queue, and wait for this call to be executed, so if current js thread is busy, then this call will block rust thread for a while.\n\ntransformtodefaultimport\n\n * type: boolean\n * default: true\n\nwhether transform specifier to default specifier.\n\n# extensions.reactutils\n\n * type: object\n\ntype reactutilsoptions = {\n  autoimportreact?: boolean;\n  removeeffect?: boolean;\n  removeproptypes?: {\n    mode?: 'remove' | 'unwrap' | 'unsafe-wrap';\n    removeimport?: boolean;\n    ignorefilenames?: string[];\n    additionallibraries?: string[];\n    classnamematchers?: string[];\n  };\n};\n\n\nsome little help utils for react.\n\nreactutils.autoimportreact\n\n * type: boolean\n\nautomatically import react as global variable, eg: import react from 'react'. mostly used for generated react.createelement.\n\nreactutils.removeeffect\n\n * type: boolean\n\nremove useeffect call.\n\nreactutils.removeproptypes\n\n * type:\n\ntype removeproptypesoptions = {\n  mode?: 'remove' | 'unwrap' | 'unsafe-wrap';\n  removeimport?: boolean;\n  ignorefilenames?: string[];\n  additionallibraries?: string[];\n  classnamematchers?: string[];\n};\n\n\nremove react runtime type checking. this is ported from @babel/plugin-react-transform-remove-prop-types, all the configurations remain the same.\n\n# extensions.lodash\n\n * type: { cwd?: string; ids?: string;}\n * default: { cwd: process.cwd(), ids: [] }\n\nported from @babel/plugin-lodash.\n\n\n# limitation\n\ndo not support @babel/plugin-transform-runtime and other custom babel plugins.",charsets:{cjk:!0}},{title:"Writing tests",frontmatter:{},regularPath:"/en/plugins/testing.html",relativePath:"en/plugins/testing.md",key:"v-1e762fa2",path:"/en/plugins/testing.html",lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"# Writing tests",normalizedContent:"# writing tests",charsets:{}},{frontmatter:{},regularPath:"/en/shared/getBuilderConfig.html",relativePath:"en/shared/getBuilderConfig.md",key:"v-239a7502",path:"/en/shared/getBuilderConfig.html",lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"Get the Builder config, this method must be called after the modifyBuilderConfig hook is executed.\n\n * Type\n\nfunction GetBuilderConfig(): Readonly<BuilderConfig>;\n",normalizedContent:"get the builder config, this method must be called after the modifybuilderconfig hook is executed.\n\n * type\n\nfunction getbuilderconfig(): readonly<builderconfig>;\n",charsets:{}},{frontmatter:{},regularPath:"/en/shared/getHTMLPaths.html",relativePath:"en/shared/getHTMLPaths.md",key:"v-c2c39494",path:"/en/shared/getHTMLPaths.html",lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"Get path information for all HTML assets.\n\nThis method will return an object, the key is the entry name and the value is the relative path of the HTML file in the dist directory.\n\n * Type\n\nfunction GetHTMLPaths(): Record<string, string>;\n",normalizedContent:"get path information for all html assets.\n\nthis method will return an object, the key is the entry name and the value is the relative path of the html file in the dist directory.\n\n * type\n\nfunction gethtmlpaths(): record<string, string>;\n",charsets:{}},{frontmatter:{},regularPath:"/en/shared/getNormalizedConfig.html",relativePath:"en/shared/getNormalizedConfig.md",key:"v-26b6f1cc",path:"/en/shared/getNormalizedConfig.html",lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"Get the normalized Builder config, this method must be called after the modifyBuilderConfig hook is executed.\n\nCompared with the api.getBuilderConfig method, the config returned by this method has been normalized, and the type definition of the config will be narrowed. For example, the undefined type of config.html will be removed.\n\nIt is recommended to use this method to get the Builder config.\n\n * Type\n\nfunction GetNormalizedConfig(): Readonly<NormalizedConfig>;\n",normalizedContent:"get the normalized builder config, this method must be called after the modifybuilderconfig hook is executed.\n\ncompared with the api.getbuilderconfig method, the config returned by this method has been normalized, and the type definition of the config will be narrowed. for example, the undefined type of config.html will be removed.\n\nit is recommended to use this method to get the builder config.\n\n * type\n\nfunction getnormalizedconfig(): readonly<normalizedconfig>;\n",charsets:{}},{frontmatter:{},regularPath:"/en/shared/isPluginExists.html",relativePath:"en/shared/isPluginExists.md",key:"v-d6f0ab44",path:"/en/shared/isPluginExists.html",lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"Determines whether a plugin has been registered.\n\n * Type\n\nfunction IsPluginExists(pluginName: string): boolean;\n",normalizedContent:"determines whether a plugin has been registered.\n\n * type\n\nfunction ispluginexists(pluginname: string): boolean;\n",charsets:{}},{frontmatter:{},regularPath:"/en/shared/onAfterBuild.html",relativePath:"en/shared/onAfterBuild.md",key:"v-d4ca9fa4",path:"/en/shared/onAfterBuild.html",lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"Called after executing the production build, you can get the build result information through the stats parameter.\n\n * Type\n\nfunction OnAfterBuild(\n  callback: (params: { stats?: Stats | MultiStats }) => Promise<void> | void,\n): void;\n",normalizedContent:"called after executing the production build, you can get the build result information through the stats parameter.\n\n * type\n\nfunction onafterbuild(\n  callback: (params: { stats?: stats | multistats }) => promise<void> | void,\n): void;\n",charsets:{cjk:!0}},{frontmatter:{},regularPath:"/en/shared/onAfterCreateCompiler.html",relativePath:"en/shared/onAfterCreateCompiler.md",key:"v-7d6046a8",path:"/en/shared/onAfterCreateCompiler.html",lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"Called after creating a compiler instance, before executing a build, when you execute builder.startDevServer, builder.build or builder.createCompiler, this hook will be called. You can get the compiler instance through the compiler parameter.\n\n * Type\n\nfunction OnAfterCreateCompiler(callback: (params: {\n  compiler: Compiler | MultiCompiler;\n}) => Promise<void> | void;): void;\n",normalizedContent:"called after creating a compiler instance, before executing a build, when you execute builder.startdevserver, builder.build or builder.createcompiler, this hook will be called. you can get the compiler instance through the compiler parameter.\n\n * type\n\nfunction onaftercreatecompiler(callback: (params: {\n  compiler: compiler | multicompiler;\n}) => promise<void> | void;): void;\n",charsets:{cjk:!0}},{frontmatter:{},regularPath:"/en/shared/onAfterStartDevServer.html",relativePath:"en/shared/onAfterStartDevServer.md",key:"v-10fbe28c",path:"/en/shared/onAfterStartDevServer.html",lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"Called after starting the development server, you can get the port number through the port parameter.\n\n * Type\n\nfunction OnAfterStartDevServer(\n  callback: (params: { port: number }) => Promise<void> | void,\n): void;\n",normalizedContent:"called after starting the development server, you can get the port number through the port parameter.\n\n * type\n\nfunction onafterstartdevserver(\n  callback: (params: { port: number }) => promise<void> | void,\n): void;\n",charsets:{cjk:!0}},{frontmatter:{},regularPath:"/en/shared/onBeforeBuild.html",relativePath:"en/shared/onBeforeBuild.md",key:"v-1b08f7ac",path:"/en/shared/onBeforeBuild.html",lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"Called before executing the production environment build, you can get the final config object of the bundler through the bundlerConfigs parameter.\n\n * Type\n\nfunction OnBeforeBuild(\n  callback: (params: {\n    bundlerConfigs?: WebpackConfig[] | RspackConfig[];\n  }) => Promise<void> | void,\n): void;\n",normalizedContent:"called before executing the production environment build, you can get the final config object of the bundler through the bundlerconfigs parameter.\n\n * type\n\nfunction onbeforebuild(\n  callback: (params: {\n    bundlerconfigs?: webpackconfig[] | rspackconfig[];\n  }) => promise<void> | void,\n): void;\n",charsets:{cjk:!0}},{frontmatter:{},regularPath:"/en/shared/onBeforeCreateCompiler.html",relativePath:"en/shared/onBeforeCreateCompiler.md",key:"v-0e8ad0c4",path:"/en/shared/onBeforeCreateCompiler.html",lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"Called before creating the compiler instance, when you execute builder.startDevServer, builder.build or builder.createCompiler, this hook will be called. You can get the final config object of the bundler through the bundlerConfigs parameter.\n\n * Type\n\nfunction OnBeforeCreateCompiler(\n  callback: (params: {\n    bundlerConfigs: WebpackConfig[] | RspackConfig[];\n  }) => Promise<void> | void,\n): void;\n",normalizedContent:"called before creating the compiler instance, when you execute builder.startdevserver, builder.build or builder.createcompiler, this hook will be called. you can get the final config object of the bundler through the bundlerconfigs parameter.\n\n * type\n\nfunction onbeforecreatecompiler(\n  callback: (params: {\n    bundlerconfigs: webpackconfig[] | rspackconfig[];\n  }) => promise<void> | void,\n): void;\n",charsets:{cjk:!0}},{frontmatter:{},regularPath:"/en/shared/onBeforeStartDevServer.html",relativePath:"en/shared/onBeforeStartDevServer.md",key:"v-b56ff930",path:"/en/shared/onBeforeStartDevServer.html",lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"Called before starting the development server.\n\n * Type\n\nfunction OnBeforeStartDevServer(callback: () => Promise<void> | void): void;\n",normalizedContent:"called before starting the development server.\n\n * type\n\nfunction onbeforestartdevserver(callback: () => promise<void> | void): void;\n",charsets:{cjk:!0}},{frontmatter:{},regularPath:"/en/shared/onDevCompileDone.html",relativePath:"en/shared/onDevCompileDone.md",key:"v-42c62992",path:"/en/shared/onDevCompileDone.html",lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"Called after each development environment build, you can use isFirstCompile to determine whether it is the first build.\n\n * Type\n\nfunction OnDevCompileDone(\n  callback: (params: { isFirstCompile: boolean }) => Promise<void> | void,\n): void;\n",normalizedContent:"called after each development environment build, you can use isfirstcompile to determine whether it is the first build.\n\n * type\n\nfunction ondevcompiledone(\n  callback: (params: { isfirstcompile: boolean }) => promise<void> | void,\n): void;\n",charsets:{cjk:!0}},{frontmatter:{},regularPath:"/en/shared/onExit.html",relativePath:"en/shared/onExit.md",key:"v-39956c96",path:"/en/shared/onExit.html",lastUpdated:"12/21/2022, 7:37:07 AM",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"Called when the process is going to exit, this hook can only execute synchronous code.\n\n * Type\n\nfunction OnExit(callback: () => void): void;\n",normalizedContent:"called when the process is going to exit, this hook can only execute synchronous code.\n\n * type\n\nfunction onexit(callback: () => void): void;\n",charsets:{}},{title:"Home",frontmatter:{home:!0,actionText:"介绍",actionLink:"/zh/guide/introduction.html",subActionText:"快速上手",subActionLink:"/zh/guide/quick-start.html",features:[{title:"开箱即用",details:"基于字节跳动数千个应用沉淀的实践经验，默认提供 Web 应用构建所需的各类能力。"},{title:"深度优化",details:"内置多种拆包策略，自动优化各类静态资源，保障生产环境产物性能。"},{title:"易于扩展",details:"提供丰富的配置项和可插拔的插件系统，支持对各项能力进行扩展和定制。"}]},regularPath:"/zh/",relativePath:"zh/README.md",key:"v-67d941bf",path:"/zh/",lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"The Modern\n\nWeb Build Engine\n\n一个面向现代 Web 开发场景的构建引擎\n\nCopyright © 2022 ByteDance.",normalizedContent:"the modern\n\nweb build engine\n\n一个面向现代 web 开发场景的构建引擎\n\ncopyright © 2022 bytedance.",charsets:{cjk:!0}},{title:"Builder Core",frontmatter:{extractApiHeaders:[2]},regularPath:"/zh/api/builder-core.html",relativePath:"zh/api/builder-core.md",key:"v-2cc513e8",path:"/zh/api/builder-core.html",headers:[{level:2,title:"createBuilder",slug:"createbuilder",normalizedTitle:"createbuilder",charIndex:46},{level:2,title:"mergeBuilderConfig",slug:"mergebuilderconfig",normalizedTitle:"mergebuilderconfig",charIndex:1563},{level:2,title:"webpack",slug:"webpack",normalizedTitle:"webpack",charIndex:112},{level:2,title:"HtmlWebpackPlugin",slug:"htmlwebpackplugin",normalizedTitle:"htmlwebpackplugin",charIndex:2254}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"createBuilder mergeBuilderConfig webpack HtmlWebpackPlugin",content:"# Builder Core\n\n本章节描述了 Builder 提供的一些核心方法。\n\n\n# createBuilder\n\n创建一个 Builder 实例对象。\n\n使用该方法时，需要搭配 @modern-js/builder-webpack-provider 或 @modern-js/builder-rspack-provider 使用，Provider 基于特定 bundler 实现了对应的构建能力。\n\n\n# Webpack Provider\n\n当传入 builderWebpackProvider 时，Builder 会使用 webpack 作为 bundler 进行构建。\n\nimport { createBuilder } from '@modern-js/builder';\nimport { builderWebpackProvider } from '@modern-js/builder-webpack-provider';\n\nconst provider = builderWebpackProvider({\n  builderConfig: {\n    // some configs\n  },\n});\n\nconst builder = await createBuilder(provider, {\n  // some options\n});\n\n\n\n# Rspack Provider\n\n当传入 builderRspackProvider 时，Builder 会使用 rspack 作为 bundler 进行构建。\n\nimport { createBuilder } from '@modern-js/builder';\nimport { builderRspackProvider } from '@modern-js/builder-rspack-provider';\n\nconst provider = builderRspackProvider({\n  builderConfig: {\n    // some configs\n  },\n});\n\nconst builder = await createBuilder(provider, {\n  // some options\n});\n\n\n> Tips: @modern-js/builder-rspack-provider 尚未开发完成。\n\n\n# options\n\ncreateBuilder 的第二个参数是一个配置对象，你可以传入以下选项：\n\ntype BuilderEntry = Record<string, string | string[]>;\n\ntype BuilderTarget = 'web' | 'node' | 'modern-web' | 'web-worker';\n\ntype CreateBuilderOptions = {\n  cwd?: string;\n  entry?: BuilderEntry;\n  target?: BuilderTarget | BuilderTarget[];\n  framework?: string;\n  configPath?: string | null;\n};\n\n\n各个选项的作用：\n\n * cwd: 当前执行构建的根路径，默认值为 process.cwd()\n * entry: 构建入口对象\n * target: 构建产物类型，默认值为 ['web']，详见 构建产物类型 章节。\n * framework: 框架的英文名称，唯一标识符，默认值为 'modern.js'\n * configPath: 框架配置文件的路径（绝对路径），该参数影响构建缓存更新\n\n\n# mergeBuilderConfig\n\n合并多份 Builder 配置对象，并返回一个合并后的新对象。\n\n * Type\n\nfunction mergeBuilderConfig(...configs: BuilderConfig[]): BuilderConfig;\n\n\n * Example\n\nimport { mergeBuilderConfig } from '@modern-js/builder';\n\nconst config1 = {\n  dev: {\n    https: false,\n  },\n};\nconst config2 = {\n  dev: {\n    https: true,\n  },\n};\n\nconst mergedConfig = mergeBuilderConfig(config1, config2);\n\nconsole.log(mergedConfig); // { dev: { https: true } }\n\n\n> 该方法不会修改传入的 config 对象。\n\n\n# webpack\n\nwebpack 对象，用于消费 webpack 内置插件或类型定义。\n\n * Example\n\nimport webpack from '@modern-js/builder-webpack-provider/webpack';\n\nnew webpack.DefinePlugin();\n\n\n> 大部分场景下，推荐从 Builder 中引用 webpack 对象，而不是手动安装一份 \"webpack\" 依赖，这样可以避免出现多实例问题。\n\n\n# HtmlWebpackPlugin\n\nHtmlWebpackPlugin 对象，通常用于实现 HtmlWebpackPlugin 的自定义插件。\n\n * Example\n\nimport HtmlWebpackPlugin from '@modern-js/builder-webpack-provider/html-webpack-plugin';\n\n\n> 大部分场景下，推荐从 Builder 中引用 HtmlWebpackPlugin 对象，而不是手动安装一份 \"html-webpack-plugin\" 依赖，这样可以避免出现多实例问题。",normalizedContent:"# builder core\n\n本章节描述了 builder 提供的一些核心方法。\n\n\n# createbuilder\n\n创建一个 builder 实例对象。\n\n使用该方法时，需要搭配 @modern-js/builder-webpack-provider 或 @modern-js/builder-rspack-provider 使用，provider 基于特定 bundler 实现了对应的构建能力。\n\n\n# webpack provider\n\n当传入 builderwebpackprovider 时，builder 会使用 webpack 作为 bundler 进行构建。\n\nimport { createbuilder } from '@modern-js/builder';\nimport { builderwebpackprovider } from '@modern-js/builder-webpack-provider';\n\nconst provider = builderwebpackprovider({\n  builderconfig: {\n    // some configs\n  },\n});\n\nconst builder = await createbuilder(provider, {\n  // some options\n});\n\n\n\n# rspack provider\n\n当传入 builderrspackprovider 时，builder 会使用 rspack 作为 bundler 进行构建。\n\nimport { createbuilder } from '@modern-js/builder';\nimport { builderrspackprovider } from '@modern-js/builder-rspack-provider';\n\nconst provider = builderrspackprovider({\n  builderconfig: {\n    // some configs\n  },\n});\n\nconst builder = await createbuilder(provider, {\n  // some options\n});\n\n\n> tips: @modern-js/builder-rspack-provider 尚未开发完成。\n\n\n# options\n\ncreatebuilder 的第二个参数是一个配置对象，你可以传入以下选项：\n\ntype builderentry = record<string, string | string[]>;\n\ntype buildertarget = 'web' | 'node' | 'modern-web' | 'web-worker';\n\ntype createbuilderoptions = {\n  cwd?: string;\n  entry?: builderentry;\n  target?: buildertarget | buildertarget[];\n  framework?: string;\n  configpath?: string | null;\n};\n\n\n各个选项的作用：\n\n * cwd: 当前执行构建的根路径，默认值为 process.cwd()\n * entry: 构建入口对象\n * target: 构建产物类型，默认值为 ['web']，详见 构建产物类型 章节。\n * framework: 框架的英文名称，唯一标识符，默认值为 'modern.js'\n * configpath: 框架配置文件的路径（绝对路径），该参数影响构建缓存更新\n\n\n# mergebuilderconfig\n\n合并多份 builder 配置对象，并返回一个合并后的新对象。\n\n * type\n\nfunction mergebuilderconfig(...configs: builderconfig[]): builderconfig;\n\n\n * example\n\nimport { mergebuilderconfig } from '@modern-js/builder';\n\nconst config1 = {\n  dev: {\n    https: false,\n  },\n};\nconst config2 = {\n  dev: {\n    https: true,\n  },\n};\n\nconst mergedconfig = mergebuilderconfig(config1, config2);\n\nconsole.log(mergedconfig); // { dev: { https: true } }\n\n\n> 该方法不会修改传入的 config 对象。\n\n\n# webpack\n\nwebpack 对象，用于消费 webpack 内置插件或类型定义。\n\n * example\n\nimport webpack from '@modern-js/builder-webpack-provider/webpack';\n\nnew webpack.defineplugin();\n\n\n> 大部分场景下，推荐从 builder 中引用 webpack 对象，而不是手动安装一份 \"webpack\" 依赖，这样可以避免出现多实例问题。\n\n\n# htmlwebpackplugin\n\nhtmlwebpackplugin 对象，通常用于实现 htmlwebpackplugin 的自定义插件。\n\n * example\n\nimport htmlwebpackplugin from '@modern-js/builder-webpack-provider/html-webpack-plugin';\n\n\n> 大部分场景下，推荐从 builder 中引用 htmlwebpackplugin 对象，而不是手动安装一份 \"html-webpack-plugin\" 依赖，这样可以避免出现多实例问题。",charsets:{cjk:!0}},{title:"Builder Instance",frontmatter:{extractApiHeaders:[2]},regularPath:"/zh/api/builder-instance.html",relativePath:"zh/api/builder-instance.md",key:"v-25796e4c",path:"/zh/api/builder-instance.html",headers:[{level:2,title:"builder.context",slug:"builder-context",normalizedTitle:"builder.context",charIndex:54},{level:2,title:"builder.build",slug:"builder-build",normalizedTitle:"builder.build",charIndex:1392},{level:2,title:"builder.startDevServer",slug:"builder-startdevserver",normalizedTitle:"builder.startdevserver",charIndex:2015},{level:2,title:"builder.createCompiler",slug:"builder-createcompiler",normalizedTitle:"builder.createcompiler",charIndex:3498},{level:2,title:"builder.addPlugins",slug:"builder-addplugins",normalizedTitle:"builder.addplugins",charIndex:3814},{level:2,title:"builder.removePlugins",slug:"builder-removeplugins",normalizedTitle:"builder.removeplugins",charIndex:4285},{level:2,title:"builder.isPluginExists",slug:"builder-ispluginexists",normalizedTitle:"builder.ispluginexists",charIndex:4576},{level:2,title:"builder.inspectConfig",slug:"builder-inspectconfig",normalizedTitle:"builder.inspectconfig",charIndex:4784},{level:2,title:"builder.onBeforeCreateCompiler",slug:"builder-onbeforecreatecompiler",normalizedTitle:"builder.onbeforecreatecompiler",charIndex:5598},{level:2,title:"builder.onAfterCreateCompiler",slug:"builder-onaftercreatecompiler",normalizedTitle:"builder.onaftercreatecompiler",charIndex:6063},{level:2,title:"builder.onBeforeBuild",slug:"builder-onbeforebuild",normalizedTitle:"builder.onbeforebuild",charIndex:6486},{level:2,title:"builder.onAfterBuild",slug:"builder-onafterbuild",normalizedTitle:"builder.onafterbuild",charIndex:6842},{level:2,title:"builder.onBeforeStartDevServer",slug:"builder-onbeforestartdevserver",normalizedTitle:"builder.onbeforestartdevserver",charIndex:7115},{level:2,title:"builder.onAfterStartDevServer",slug:"builder-onafterstartdevserver",normalizedTitle:"builder.onafterstartdevserver",charIndex:7341},{level:2,title:"builder.onDevCompileDone",slug:"builder-ondevcompiledone",normalizedTitle:"builder.ondevcompiledone",charIndex:7635},{level:2,title:"builder.onExit",slug:"builder-onexit",normalizedTitle:"builder.onexit",charIndex:8010},{level:2,title:"builder.getBuilderConfig",slug:"builder-getbuilderconfig",normalizedTitle:"builder.getbuilderconfig",charIndex:8176},{level:2,title:"builder.getNormalizedConfig",slug:"builder-getnormalizedconfig",normalizedTitle:"builder.getnormalizedconfig",charIndex:8450},{level:2,title:"builder.getHTMLPaths",slug:"builder-gethtmlpaths",normalizedTitle:"builder.gethtmlpaths",charIndex:8846}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"builder.context builder.build builder.startDevServer builder.createCompiler builder.addPlugins builder.removePlugins builder.isPluginExists builder.inspectConfig builder.onBeforeCreateCompiler builder.onAfterCreateCompiler builder.onBeforeBuild builder.onAfterBuild builder.onBeforeStartDevServer builder.onAfterStartDevServer builder.onDevCompileDone builder.onExit builder.getBuilderConfig builder.getNormalizedConfig builder.getHTMLPaths",content:"# Builder Instance\n\n本章节描述了 Builder 实例对象上所有的属性和方法。\n\n\n# builder.context\n\nbuilder.context 是一个只读对象，提供一些上下文信息。\n\n\n# builder.context.entry\n\n构建入口对象，对应调用 createBuilder 时传入的 entry 选项。\n\n * Type\n\ntype BuilderEntry = Record<string, string | string[]>;\n\n\n\n# builder.context.target\n\n构建产物类型，对应调用 createBuilder 时传入的 target 选项。\n\n * Type\n\ntype BuilderTarget = 'web' | 'node' | 'modern-web' | 'web-worker';\n\ntype Context = {\n  target: BuilderTarget | BuilderTarget[];\n};\n\n\n\n# builder.context.rootPath\n\n当前执行构建的根路径，对应调用 createBuilder 时传入的 cwd 选项。\n\n * Type\n\ntype RootPath = string;\n\n\n\n# builder.context.srcPath\n\nsrc 目录的绝对路径。\n\n * Type\n\ntype SrcPath = string;\n\n\n\n# builder.context.distPath\n\n构建产物输出目录的绝对路径，对应 BuilderConfig 中的 output.distPath.root 配置项。\n\n * Type\n\ntype DistPath = string;\n\n\n\n# builder.context.cachePath\n\n构建过程中生成的缓存文件所在的绝对路径。\n\n * Type\n\ntype CachePath = string;\n\n\n\n# builder.context.configPath\n\n框架配置文件的绝对路径，对应调用 createBuilder 时传入的 configPath 选项。\n\n * Type\n\ntype ConfigPath = string | undefined;\n\n\n\n# builder.context.tsconfigPath\n\ntsconfig.json 文件的绝对路径，若项目中不存在 tsconfig.json 文件，则为 undefined。\n\n * Type\n\ntype TsconfigPath = string | undefined;\n\n\n\n# builder.context.framework\n\n框架的英文名称，唯一标识符，默认值为 'modern.js'。\n\n * Type\n\ntype Framework = string | undefined;\n\n\n\n# builder.context.devServer\n\nDev Server 相关信息，包含了当前 Dev Server 的 hostname 和端口号。\n\n * Type\n\ntype DevServer = {\n  hostname: string;\n  port: number;\n};\n\n\n\n# builder.build\n\n调用 build 方法时，会执行一次生产环境构建。\n\n * Type\n\ntype BuildOptions = {\n  mode?: 'development' | 'production';\n  watch?: boolean;\n  // 自定义 Compiler 对象\n  compiler?: Compiler | MultiCompiler;\n};\n\nfunction Build(options?: BuildOptions): Promise<void>;\n\n\n * Example\n\nawait builder.build();\n\n\n\n# 开发环境构建\n\n如果需要执行一次开发环境构建，可以将 mode 参数设置为 'development'。\n\nawait builder.build({\n  mode: 'development',\n});\n\n\n\n# 监听文件变化\n\n如果需要自动监听文件变化并重新执行构建，可以将 watch 参数设置为 true。\n\nawait builder.build({\n  watch: true,\n});\n\n\n\n# 自定义 Compiler\n\n个别情况下，你可能希望使用自定义的 compiler：\n\nconst compiler = webpack({\n  // ...\n});\nawait builder.build({\n  compiler,\n});\n\n\n\n# builder.startDevServer\n\n启动本地 Dev Server，基于 Modern.js Dev Server 实现。\n\n * Type\n\ntype StartDevServerOptions = {\n  // 是否输出 URL 信息，默认为 true\n  printURLs?: boolean;\n  // 是否在端口被占用时抛出异常，默认为 false\n  strictPort?: boolean;\n  // 自定义 Compiler 对象\n  compiler?: Compiler | MultiCompiler;\n  // 透传与构建无关的 dev server 配置\n  serverOptions?: Partial<ModernDevServerOptions>;\n};\n\ntype StartDevServerResult = {\n  urls: string[];\n  port: number;\n  server: Server;\n};\n\nfunction StartDevServer(\n  options?: StartDevServerOptions,\n): Promise<StartDevServerResult>;\n\n\n * Example\n\n启动 Dev Server：\n\nawait builder.startDevServer();\n\n\n成功启动 Dev Server 后，可以看到以下日志信息：\n\ninfo    Starting dev server...\ninfo    Dev server running at:\n\n  > Local:    http://localhost:8080\n  > Network:  http://192.168.0.1:8080\n\n\nstartDevServer 会返回以下参数：\n\n * urls：访问 Dev Server 的 URLs\n * port 实际监听的端口号\n * server：Server 实例对象\n\nconst { urls, port, server } = await builder.startDevServer();\nconsole.log(urls); // ['http://localhost:8080', 'http://192.168.0.1:8080']\nconsole.log(port); // 8080\n\n// 关闭 Dev Server\nawait server.close();\n\n\n\n# 自定义 URL 输出\n\n将 printURLs 设置为 false 可以禁用默认的 URL 输出，此时你可以输出自定义的日志内容。\n\nawait builder.startDevServer({\n  printURLs: false,\n});\n\n\n\n# 严格限制端口\n\n当端口被占用时，Builder 会自动递增端口号，直至找到一个可用端口。\n\n如果你希望在端口被占用时抛出异常，可以将 strictPort 设置为 true。\n\nawait builder.startDevServer({\n  strictPort: true,\n});\n\n\n\n# 自定义 Compiler\n\n个别情况下，你可能希望使用自定义的 compiler：\n\nconst compiler = webpack({\n  // ...\n});\nawait builder.startDevServer({\n  compiler,\n});\n\n\n\n# builder.createCompiler\n\n创建一个 compiler 对象。\n\n当 createBuilder 的 target 选项包含一个值时，返回值为 Compiler；当 target 包含多个值时，返回值为 MultiCompiler。\n\n * Type\n\nfunction CreateCompiler(): Promise<Compiler | MultiCompiler>;\n\n\n * Example\n\nconst compiler = await builder.createCompiler();\n\n\n> 大部分场景下，不需要使用该 API，除非需要进行自定义 Dev Server 等高级操作。\n\n\n# builder.addPlugins\n\n注册一个或多个 builder 插件，可以被多次调用。\n\n该方法需要在开始编译前调用，如果在开始编译之后调用，则不会影响编译结果。\n\n * Type\n\ntype AddPluginsOptions = { before?: string } | { after?: string };\n\nfunction AddPlugins(\n  plugins: BuilderPlugins[],\n  options?: AddPluginsOptions,\n): Promise<void>;\n\n\n * Example\n\nbuilder.addPlugins([PluginFoo(), PluginBar()]);\n\n// 在 bar 插件之前插入\nbuilder.addPlugins([PluginFoo()], { before: 'bar' });\n\n// 在 bar 插件之后插入\nbuilder.addPlugins([PluginFoo()], { after: 'bar' });\n\n\n\n# builder.removePlugins\n\n移除一个或多个 builder 插件，可以被多次调用。\n\n该方法需要在开始编译前调用，如果在开始编译之后调用，则不会影响编译结果。\n\n * Type\n\nfunction RemovePlugins(pluginNames: string[]): void;\n\n\n * Example\n\n// 添加插件\nconst pluginFoo = PluginFoo();\nbuilder.addPlugins(pluginFoo);\n\n// 移除插件\nbuilder.removePlugins([pluginFoo.name]);\n\n\n\n# builder.isPluginExists\n\n判断某个插件是否已经被注册。\n\n * Type\n\nfunction IsPluginExists(pluginName: string): boolean;\n\n\n * Example\n\nbuilder.addPlugins([PluginFoo()]);\n\nbuilder.isPluginExists(PluginFoo().name); // true\n\n\n\n# builder.inspectConfig\n\n查看 Builder 内部最终生成的 builder 配置和 bundler 配置。\n\n * Type\n\ntype InspectConfigOptions = {\n  // 查看指定环境下的配置，默认为 \"development\"，可以设置为 \"production\"\n  env?: BuilderMode;\n  // 是否开启冗余模式，展示配置中函数的完整内容，默认为 `false`\n  verbose?: boolean;\n  // 指定输出路径，默认为 `output.distPath.root` 配置的值\n  outputPath?: string;\n  // 是否将结果写入到磁盘中，默认为 `false`\n  writeToDisk?: boolean;\n};\n\nasync function InspectConfig(options?: InspectConfigOptions): Promise<{\n  builderConfig: string;\n  bundlerConfigs: string[];\n  origin: {\n    builderConfig: BuilderConfig;\n    bundlerConfigs: BundlerConfigs[];\n  };\n}>;\n\n\n * Example\n\n拿到字符串格式的 Config 内容：\n\nconst { builderConfig, bundlerConfigs } = await builder.inspectConfig();\n\nconsole.log(builderConfig, bundlerConfigs);\n\n\n直接将配置内容写入到磁盘上：\n\nawait builder.inspectConfig({\n  writeToDisk: true,\n});\n\n\n\n# builder.onBeforeCreateCompiler\n\n在创建 compiler 实例前调用，当你执行 builder.startDevServer、builder.build 或 builder.createCompiler 时，都会调用此钩子。你可以通过 bundlerConfigs 参数获取到底层打包工具的最终配置对象。\n\n * Type\n\nfunction OnBeforeCreateCompiler(\n  callback: (params: {\n    bundlerConfigs: WebpackConfig[] | RspackConfig[];\n  }) => Promise<void> | void,\n): void;\n\n\n * Example\n\nbuilder.onBeforeCreateCompiler(({ bundlerConfigs }) => {\n  console.log('the bundler config is ', bundlerConfigs);\n});\n\n\n\n# builder.onAfterCreateCompiler\n\n在创建 compiler 实例后、执行构建前调用，当你执行 builder.startDevServer、builder.build 或 builder.createCompiler 时，都会调用此钩子。你可以通过 compiler 参数获取到 compiler 实例对象。\n\n * Type\n\nfunction OnAfterCreateCompiler(callback: (params: {\n  compiler: Compiler | MultiCompiler;\n}) => Promise<void> | void;): void;\n\n\n * Example\n\nbuilder.onAfterCreateCompiler(({ compiler }) => {\n  console.log('the compiler is ', compiler);\n});\n\n\n\n# builder.onBeforeBuild\n\n在执行生产环境构建前调用，你可以通过 bundlerConfigs 参数获取到底层打包工具的最终配置对象。\n\n * Type\n\nfunction OnBeforeBuild(\n  callback: (params: {\n    bundlerConfigs?: WebpackConfig[] | RspackConfig[];\n  }) => Promise<void> | void,\n): void;\n\n\n * Example\n\nbuilder.onBeforeBuild(({ bundlerConfigs }) => {\n  console.log('the bundler config is ', bundlerConfigs);\n});\n\n\n\n# builder.onAfterBuild\n\n在执行生产环境构建后调用，你可以通过 stats 参数获取到构建结果信息。\n\n * Type\n\nfunction OnAfterBuild(\n  callback: (params: { stats?: Stats | MultiStats }) => Promise<void> | void,\n): void;\n\n\n * Example\n\nbuilder.onAfterBuild(({ stats }) => {\n  console.log(stats?.toJson());\n});\n\n\n\n# builder.onBeforeStartDevServer\n\n在启动开发服务器前调用。\n\n * Type\n\nfunction OnBeforeStartDevServer(callback: () => Promise<void> | void): void;\n\n\n * Example\n\nbuilder.onBeforeStartDevServer(() => {\n  console.log('before start!');\n});\n\n\n\n# builder.onAfterStartDevServer\n\n在启动开发服务器后调用，你可以通过 port 参数获得开发服务器监听的端口号。\n\n * Type\n\nfunction OnAfterStartDevServer(\n  callback: (params: { port: number }) => Promise<void> | void,\n): void;\n\n\n * Example\n\nbuilder.onAfterStartDevServer(({ port }) => {\n  console.log('this port is: ', port);\n});\n\n\n\n# builder.onDevCompileDone\n\n在每次开发环境构建结束后调用，你可以通过 isFirstCompile 来判断是否为首次构建。\n\n * Type\n\nfunction OnDevCompileDone(\n  callback: (params: { isFirstCompile: boolean }) => Promise<void> | void,\n): void;\n\n\n * Example\n\nbuilder.onDevCompileDone(({ isFirstCompile }) => {\n  if (isFirstCompile) {\n    console.log('first compile!');\n  } else {\n    console.log('re-compile!');\n  }\n});\n\n\n\n# builder.onExit\n\n在进程即将退出时调用，这个钩子只能执行同步代码。\n\n * Type\n\nfunction OnExit(callback: () => void): void;\n\n\n * Example\n\nbuilder.onExit(() => {\n  console.log('exit!');\n});\n\n\n\n# builder.getBuilderConfig\n\n获取 Builder 配置，该方法必须在 modifyBuilderConfig 钩子执行完成后才能被调用。\n\n * Type\n\nfunction GetBuilderConfig(): Readonly<BuilderConfig>;\n\n\n * Example\n\nbuilder.onBeforeBuild(() => {\n  const config = api.getBuilderConfig();\n  console.log(config.html?.title);\n});\n\n\n\n# builder.getNormalizedConfig\n\n获取归一化后的 Builder 配置，该方法必须在 modifyBuilderConfig 钩子执行完成后才能被调用。\n\n相较于 getBuilderConfig 方法，该方法返回的配置经过了归一化处理，配置的类型定义会得到收敛，比如 config.html 的 undefined 类型将被移除。\n\n推荐优先使用该方法获取配置。\n\n * Type\n\nfunction GetNormalizedConfig(): Readonly<NormalizedConfig>;\n\n\n * Example\n\nbuilder.onBeforeBuild(() => {\n  const config = api.getNormalizedConfig();\n  console.log(config.html.title);\n});\n\n\n\n# builder.getHTMLPaths\n\n获取所有 HTML 产物的路径信息。\n\n该方法会返回一个对象，对象的 key 为 entry 名称，value 为 HTML 文件在产物目录下的相对路径。\n\n * Type\n\nfunction GetHTMLPaths(): Record<string, string>;\n\n\n * Example\n\nbuilder.onBeforeBuild(() => {\n  const htmlPaths = api.getHTMLPaths();\n  console.log(htmlPaths); // { main: 'html/main/index.html' };\n});\n",normalizedContent:"# builder instance\n\n本章节描述了 builder 实例对象上所有的属性和方法。\n\n\n# builder.context\n\nbuilder.context 是一个只读对象，提供一些上下文信息。\n\n\n# builder.context.entry\n\n构建入口对象，对应调用 createbuilder 时传入的 entry 选项。\n\n * type\n\ntype builderentry = record<string, string | string[]>;\n\n\n\n# builder.context.target\n\n构建产物类型，对应调用 createbuilder 时传入的 target 选项。\n\n * type\n\ntype buildertarget = 'web' | 'node' | 'modern-web' | 'web-worker';\n\ntype context = {\n  target: buildertarget | buildertarget[];\n};\n\n\n\n# builder.context.rootpath\n\n当前执行构建的根路径，对应调用 createbuilder 时传入的 cwd 选项。\n\n * type\n\ntype rootpath = string;\n\n\n\n# builder.context.srcpath\n\nsrc 目录的绝对路径。\n\n * type\n\ntype srcpath = string;\n\n\n\n# builder.context.distpath\n\n构建产物输出目录的绝对路径，对应 builderconfig 中的 output.distpath.root 配置项。\n\n * type\n\ntype distpath = string;\n\n\n\n# builder.context.cachepath\n\n构建过程中生成的缓存文件所在的绝对路径。\n\n * type\n\ntype cachepath = string;\n\n\n\n# builder.context.configpath\n\n框架配置文件的绝对路径，对应调用 createbuilder 时传入的 configpath 选项。\n\n * type\n\ntype configpath = string | undefined;\n\n\n\n# builder.context.tsconfigpath\n\ntsconfig.json 文件的绝对路径，若项目中不存在 tsconfig.json 文件，则为 undefined。\n\n * type\n\ntype tsconfigpath = string | undefined;\n\n\n\n# builder.context.framework\n\n框架的英文名称，唯一标识符，默认值为 'modern.js'。\n\n * type\n\ntype framework = string | undefined;\n\n\n\n# builder.context.devserver\n\ndev server 相关信息，包含了当前 dev server 的 hostname 和端口号。\n\n * type\n\ntype devserver = {\n  hostname: string;\n  port: number;\n};\n\n\n\n# builder.build\n\n调用 build 方法时，会执行一次生产环境构建。\n\n * type\n\ntype buildoptions = {\n  mode?: 'development' | 'production';\n  watch?: boolean;\n  // 自定义 compiler 对象\n  compiler?: compiler | multicompiler;\n};\n\nfunction build(options?: buildoptions): promise<void>;\n\n\n * example\n\nawait builder.build();\n\n\n\n# 开发环境构建\n\n如果需要执行一次开发环境构建，可以将 mode 参数设置为 'development'。\n\nawait builder.build({\n  mode: 'development',\n});\n\n\n\n# 监听文件变化\n\n如果需要自动监听文件变化并重新执行构建，可以将 watch 参数设置为 true。\n\nawait builder.build({\n  watch: true,\n});\n\n\n\n# 自定义 compiler\n\n个别情况下，你可能希望使用自定义的 compiler：\n\nconst compiler = webpack({\n  // ...\n});\nawait builder.build({\n  compiler,\n});\n\n\n\n# builder.startdevserver\n\n启动本地 dev server，基于 modern.js dev server 实现。\n\n * type\n\ntype startdevserveroptions = {\n  // 是否输出 url 信息，默认为 true\n  printurls?: boolean;\n  // 是否在端口被占用时抛出异常，默认为 false\n  strictport?: boolean;\n  // 自定义 compiler 对象\n  compiler?: compiler | multicompiler;\n  // 透传与构建无关的 dev server 配置\n  serveroptions?: partial<moderndevserveroptions>;\n};\n\ntype startdevserverresult = {\n  urls: string[];\n  port: number;\n  server: server;\n};\n\nfunction startdevserver(\n  options?: startdevserveroptions,\n): promise<startdevserverresult>;\n\n\n * example\n\n启动 dev server：\n\nawait builder.startdevserver();\n\n\n成功启动 dev server 后，可以看到以下日志信息：\n\ninfo    starting dev server...\ninfo    dev server running at:\n\n  > local:    http://localhost:8080\n  > network:  http://192.168.0.1:8080\n\n\nstartdevserver 会返回以下参数：\n\n * urls：访问 dev server 的 urls\n * port 实际监听的端口号\n * server：server 实例对象\n\nconst { urls, port, server } = await builder.startdevserver();\nconsole.log(urls); // ['http://localhost:8080', 'http://192.168.0.1:8080']\nconsole.log(port); // 8080\n\n// 关闭 dev server\nawait server.close();\n\n\n\n# 自定义 url 输出\n\n将 printurls 设置为 false 可以禁用默认的 url 输出，此时你可以输出自定义的日志内容。\n\nawait builder.startdevserver({\n  printurls: false,\n});\n\n\n\n# 严格限制端口\n\n当端口被占用时，builder 会自动递增端口号，直至找到一个可用端口。\n\n如果你希望在端口被占用时抛出异常，可以将 strictport 设置为 true。\n\nawait builder.startdevserver({\n  strictport: true,\n});\n\n\n\n# 自定义 compiler\n\n个别情况下，你可能希望使用自定义的 compiler：\n\nconst compiler = webpack({\n  // ...\n});\nawait builder.startdevserver({\n  compiler,\n});\n\n\n\n# builder.createcompiler\n\n创建一个 compiler 对象。\n\n当 createbuilder 的 target 选项包含一个值时，返回值为 compiler；当 target 包含多个值时，返回值为 multicompiler。\n\n * type\n\nfunction createcompiler(): promise<compiler | multicompiler>;\n\n\n * example\n\nconst compiler = await builder.createcompiler();\n\n\n> 大部分场景下，不需要使用该 api，除非需要进行自定义 dev server 等高级操作。\n\n\n# builder.addplugins\n\n注册一个或多个 builder 插件，可以被多次调用。\n\n该方法需要在开始编译前调用，如果在开始编译之后调用，则不会影响编译结果。\n\n * type\n\ntype addpluginsoptions = { before?: string } | { after?: string };\n\nfunction addplugins(\n  plugins: builderplugins[],\n  options?: addpluginsoptions,\n): promise<void>;\n\n\n * example\n\nbuilder.addplugins([pluginfoo(), pluginbar()]);\n\n// 在 bar 插件之前插入\nbuilder.addplugins([pluginfoo()], { before: 'bar' });\n\n// 在 bar 插件之后插入\nbuilder.addplugins([pluginfoo()], { after: 'bar' });\n\n\n\n# builder.removeplugins\n\n移除一个或多个 builder 插件，可以被多次调用。\n\n该方法需要在开始编译前调用，如果在开始编译之后调用，则不会影响编译结果。\n\n * type\n\nfunction removeplugins(pluginnames: string[]): void;\n\n\n * example\n\n// 添加插件\nconst pluginfoo = pluginfoo();\nbuilder.addplugins(pluginfoo);\n\n// 移除插件\nbuilder.removeplugins([pluginfoo.name]);\n\n\n\n# builder.ispluginexists\n\n判断某个插件是否已经被注册。\n\n * type\n\nfunction ispluginexists(pluginname: string): boolean;\n\n\n * example\n\nbuilder.addplugins([pluginfoo()]);\n\nbuilder.ispluginexists(pluginfoo().name); // true\n\n\n\n# builder.inspectconfig\n\n查看 builder 内部最终生成的 builder 配置和 bundler 配置。\n\n * type\n\ntype inspectconfigoptions = {\n  // 查看指定环境下的配置，默认为 \"development\"，可以设置为 \"production\"\n  env?: buildermode;\n  // 是否开启冗余模式，展示配置中函数的完整内容，默认为 `false`\n  verbose?: boolean;\n  // 指定输出路径，默认为 `output.distpath.root` 配置的值\n  outputpath?: string;\n  // 是否将结果写入到磁盘中，默认为 `false`\n  writetodisk?: boolean;\n};\n\nasync function inspectconfig(options?: inspectconfigoptions): promise<{\n  builderconfig: string;\n  bundlerconfigs: string[];\n  origin: {\n    builderconfig: builderconfig;\n    bundlerconfigs: bundlerconfigs[];\n  };\n}>;\n\n\n * example\n\n拿到字符串格式的 config 内容：\n\nconst { builderconfig, bundlerconfigs } = await builder.inspectconfig();\n\nconsole.log(builderconfig, bundlerconfigs);\n\n\n直接将配置内容写入到磁盘上：\n\nawait builder.inspectconfig({\n  writetodisk: true,\n});\n\n\n\n# builder.onbeforecreatecompiler\n\n在创建 compiler 实例前调用，当你执行 builder.startdevserver、builder.build 或 builder.createcompiler 时，都会调用此钩子。你可以通过 bundlerconfigs 参数获取到底层打包工具的最终配置对象。\n\n * type\n\nfunction onbeforecreatecompiler(\n  callback: (params: {\n    bundlerconfigs: webpackconfig[] | rspackconfig[];\n  }) => promise<void> | void,\n): void;\n\n\n * example\n\nbuilder.onbeforecreatecompiler(({ bundlerconfigs }) => {\n  console.log('the bundler config is ', bundlerconfigs);\n});\n\n\n\n# builder.onaftercreatecompiler\n\n在创建 compiler 实例后、执行构建前调用，当你执行 builder.startdevserver、builder.build 或 builder.createcompiler 时，都会调用此钩子。你可以通过 compiler 参数获取到 compiler 实例对象。\n\n * type\n\nfunction onaftercreatecompiler(callback: (params: {\n  compiler: compiler | multicompiler;\n}) => promise<void> | void;): void;\n\n\n * example\n\nbuilder.onaftercreatecompiler(({ compiler }) => {\n  console.log('the compiler is ', compiler);\n});\n\n\n\n# builder.onbeforebuild\n\n在执行生产环境构建前调用，你可以通过 bundlerconfigs 参数获取到底层打包工具的最终配置对象。\n\n * type\n\nfunction onbeforebuild(\n  callback: (params: {\n    bundlerconfigs?: webpackconfig[] | rspackconfig[];\n  }) => promise<void> | void,\n): void;\n\n\n * example\n\nbuilder.onbeforebuild(({ bundlerconfigs }) => {\n  console.log('the bundler config is ', bundlerconfigs);\n});\n\n\n\n# builder.onafterbuild\n\n在执行生产环境构建后调用，你可以通过 stats 参数获取到构建结果信息。\n\n * type\n\nfunction onafterbuild(\n  callback: (params: { stats?: stats | multistats }) => promise<void> | void,\n): void;\n\n\n * example\n\nbuilder.onafterbuild(({ stats }) => {\n  console.log(stats?.tojson());\n});\n\n\n\n# builder.onbeforestartdevserver\n\n在启动开发服务器前调用。\n\n * type\n\nfunction onbeforestartdevserver(callback: () => promise<void> | void): void;\n\n\n * example\n\nbuilder.onbeforestartdevserver(() => {\n  console.log('before start!');\n});\n\n\n\n# builder.onafterstartdevserver\n\n在启动开发服务器后调用，你可以通过 port 参数获得开发服务器监听的端口号。\n\n * type\n\nfunction onafterstartdevserver(\n  callback: (params: { port: number }) => promise<void> | void,\n): void;\n\n\n * example\n\nbuilder.onafterstartdevserver(({ port }) => {\n  console.log('this port is: ', port);\n});\n\n\n\n# builder.ondevcompiledone\n\n在每次开发环境构建结束后调用，你可以通过 isfirstcompile 来判断是否为首次构建。\n\n * type\n\nfunction ondevcompiledone(\n  callback: (params: { isfirstcompile: boolean }) => promise<void> | void,\n): void;\n\n\n * example\n\nbuilder.ondevcompiledone(({ isfirstcompile }) => {\n  if (isfirstcompile) {\n    console.log('first compile!');\n  } else {\n    console.log('re-compile!');\n  }\n});\n\n\n\n# builder.onexit\n\n在进程即将退出时调用，这个钩子只能执行同步代码。\n\n * type\n\nfunction onexit(callback: () => void): void;\n\n\n * example\n\nbuilder.onexit(() => {\n  console.log('exit!');\n});\n\n\n\n# builder.getbuilderconfig\n\n获取 builder 配置，该方法必须在 modifybuilderconfig 钩子执行完成后才能被调用。\n\n * type\n\nfunction getbuilderconfig(): readonly<builderconfig>;\n\n\n * example\n\nbuilder.onbeforebuild(() => {\n  const config = api.getbuilderconfig();\n  console.log(config.html?.title);\n});\n\n\n\n# builder.getnormalizedconfig\n\n获取归一化后的 builder 配置，该方法必须在 modifybuilderconfig 钩子执行完成后才能被调用。\n\n相较于 getbuilderconfig 方法，该方法返回的配置经过了归一化处理，配置的类型定义会得到收敛，比如 config.html 的 undefined 类型将被移除。\n\n推荐优先使用该方法获取配置。\n\n * type\n\nfunction getnormalizedconfig(): readonly<normalizedconfig>;\n\n\n * example\n\nbuilder.onbeforebuild(() => {\n  const config = api.getnormalizedconfig();\n  console.log(config.html.title);\n});\n\n\n\n# builder.gethtmlpaths\n\n获取所有 html 产物的路径信息。\n\n该方法会返回一个对象，对象的 key 为 entry 名称，value 为 html 文件在产物目录下的相对路径。\n\n * type\n\nfunction gethtmlpaths(): record<string, string>;\n\n\n * example\n\nbuilder.onbeforebuild(() => {\n  const htmlpaths = api.gethtmlpaths();\n  console.log(htmlpaths); // { main: 'html/main/index.html' };\n});\n",charsets:{cjk:!0}},{title:"Builder Types",frontmatter:{extractApiHeaders:[2]},regularPath:"/zh/api/builder-types.html",relativePath:"zh/api/builder-types.md",key:"v-4f7a5876",path:"/zh/api/builder-types.html",headers:[{level:2,title:"BuilderInstance",slug:"builderinstance",normalizedTitle:"builderinstance",charIndex:47},{level:2,title:"BuilderContext",slug:"buildercontext",normalizedTitle:"buildercontext",charIndex:443},{level:2,title:"BuilderPlugin",slug:"builderplugin",normalizedTitle:"builderplugin",charIndex:602},{level:2,title:"BuilderTarget",slug:"buildertarget",normalizedTitle:"buildertarget",charIndex:905},{level:2,title:"BuilderEntry",slug:"builderentry",normalizedTitle:"builderentry",charIndex:1e3},{level:2,title:"CreateBuilderOptions",slug:"createbuilderoptions",normalizedTitle:"createbuilderoptions",charIndex:1110}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"BuilderInstance BuilderContext BuilderPlugin BuilderTarget BuilderEntry CreateBuilderOptions",content:"# Builder Types\n\n本章节描述了 Builder 提供的一些类型定义。\n\n\n# BuilderInstance\n\nBuilder 实例的类型。\n\nimport type { BuilderInstance } from '@modern-js/builder';\n\nlet builder: BuilderInstance;\n\n\n你可以通过泛型来传入 Provider 的类型，使 Builder 实例获得更准确的类型定义：\n\nimport type { createBuilder, type BuilderInstance } from '@modern-js/builder';\nimport type { BuilderWebpackProvider } from '@modern-js/builder-webpack-provider';\n\nlet builder: BuilderInstance<BuilderWebpackProvider>;\n\n\n\n# BuilderContext\n\nBuilder 实例中 context 属性的类型定义。\n\nimport type { BuilderContext } from '@modern-js/builder';\n\nconst context: BuilderContext = builder.context;\n\n\n\n# BuilderPlugin\n\nBuilder 插件的类型，需要配合 provider 中提供的 BuilderPluginAPI 类型来使用。\n\nimport type { BuilderPlugin } from '@modern-js/builder';\nimport type { BuilderPluginAPI } from '@modern-js/builder-webpack-provider';\n\nconst myPlugin: BuilderPlugin<BuilderPluginAPI> = {\n  name: 'my-plugin',\n  setup() {},\n};\n\n\n\n# BuilderTarget\n\nBuilder 构建产物的类型。\n\nimport type { BuilderTarget } from '@modern-js/builder';\n\n\n\n# BuilderEntry\n\n对应 createBuilder 方法的 entry 选项的类型。\n\nimport type { BuilderEntry } from '@modern-js/builder';\n\n\n\n# CreateBuilderOptions\n\n对应 createBuilder 方法的入参类型。\n\nimport type { CreateBuilderOptions } from '@modern-js/builder';\n",normalizedContent:"# builder types\n\n本章节描述了 builder 提供的一些类型定义。\n\n\n# builderinstance\n\nbuilder 实例的类型。\n\nimport type { builderinstance } from '@modern-js/builder';\n\nlet builder: builderinstance;\n\n\n你可以通过泛型来传入 provider 的类型，使 builder 实例获得更准确的类型定义：\n\nimport type { createbuilder, type builderinstance } from '@modern-js/builder';\nimport type { builderwebpackprovider } from '@modern-js/builder-webpack-provider';\n\nlet builder: builderinstance<builderwebpackprovider>;\n\n\n\n# buildercontext\n\nbuilder 实例中 context 属性的类型定义。\n\nimport type { buildercontext } from '@modern-js/builder';\n\nconst context: buildercontext = builder.context;\n\n\n\n# builderplugin\n\nbuilder 插件的类型，需要配合 provider 中提供的 builderpluginapi 类型来使用。\n\nimport type { builderplugin } from '@modern-js/builder';\nimport type { builderpluginapi } from '@modern-js/builder-webpack-provider';\n\nconst myplugin: builderplugin<builderpluginapi> = {\n  name: 'my-plugin',\n  setup() {},\n};\n\n\n\n# buildertarget\n\nbuilder 构建产物的类型。\n\nimport type { buildertarget } from '@modern-js/builder';\n\n\n\n# builderentry\n\n对应 createbuilder 方法的 entry 选项的类型。\n\nimport type { builderentry } from '@modern-js/builder';\n\n\n\n# createbuilderoptions\n\n对应 createbuilder 方法的入参类型。\n\nimport type { createbuilderoptions } from '@modern-js/builder';\n",charsets:{cjk:!0}},{title:"Dev Config",frontmatter:{extractApiHeaders:[2]},regularPath:"/zh/api/config-dev.html",relativePath:"zh/api/config-dev.md",key:"v-86a08da8",path:"/zh/api/config-dev.html",headers:[{level:2,title:"dev.assetPrefix",slug:"dev-assetprefix",normalizedTitle:"dev.assetprefix",charIndex:46},{level:2,title:"dev.hmr",slug:"dev-hmr",normalizedTitle:"dev.hmr",charIndex:839},{level:2,title:"dev.https",slug:"dev-https",normalizedTitle:"dev.https",charIndex:1021},{level:2,title:"dev.port",slug:"dev-port",normalizedTitle:"dev.port",charIndex:1993},{level:2,title:"dev.progressBar",slug:"dev-progressbar",normalizedTitle:"dev.progressbar",charIndex:2182},{level:2,title:"dev.startUrl",slug:"dev-starturl",normalizedTitle:"dev.starturl",charIndex:2488}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"dev.assetPrefix dev.hmr dev.https dev.port dev.progressBar dev.startUrl",content:"# Dev Config\n\n本章节描述了 Builder 中与本地开发有关的配置。\n\n\n# dev.assetPrefix\n\n * Type: boolean | string\n * Default: '/'\n\n设置开发环境下的静态资源 URL 前缀，对应 webpack 的 output.publicPath 配置。\n\nassetPrefix 会影响构建产物中绝大部分静态资源的 URL，包括 JavaScript 文件、CSS 文件、图片、视频等。如果指定了一个错误的值，则在加载这些资源时可能会出现 404 错误。\n\n该配置项仅用于开发环境。在生产环境下，请使用 output.assetPrefix 配置项进行设置。\n\n# Boolean 类型\n\n如果设置 assetPrefix 为 true，Builder 会自动计算出 //ip:port/ 作为 URL 前缀：\n\nexport default {\n  dev: {\n    assetPrefix: true,\n  },\n};\n\n\n对应 JS 文件在浏览器中加载的地址如下：\n\n<script defer src=\"//${ip}:8080/static/js/main.js\"><\/script>\n\n\n如果设置 assetPrefix 为 false 或不设置，则默认使用 / 作为访问前缀。\n\n# String 类型\n\n当 assetPrefix 的值为 string 类型时，字符串会作为前缀，自动拼接到静态资源访问 URL 上：\n\nexport default {\n  dev: {\n    assetPrefix: 'http://example.com/assets/',\n  },\n};\n\n\n对应 JS 文件在浏览器中加载的地址如下：\n\n<script defer src=\"http://example.com/assets/static/js/main.js\"><\/script>\n\n\n\n# dev.hmr\n\n * Type: boolean\n * Default: true\n\n是否开启 Hot Module Replacement 热更新能力。\n\n当 hmr 设置为 false 时，将不再提供热更新和 react-refresh 功能。\n\nexport default {\n  dev: {\n    hmr: false,\n  },\n};\n\n\n\n# dev.https\n\n * Type: boolean | { key: string; cert: string }\n * Default: false\n\n配置该选项后，可以开启 Dev Server 对 HTTPS 的支持，同时会禁用 HTTP 服务器。\n\n开启前：\n\n  > Local:    http://localhost:8080/\n  > Network:  http://192.168.0.1:8080/\n\n\n开启后：\n\n  > Local:    https://localhost:8080/\n  > Network:  https://192.168.0.1:8080/\n\n\n# 自动生成证书\n\n你可以直接将 https 设置为 true，Builder 会基于 devcert 来自动生成 Dev Server 所需的 HTTPS 证书。\n\nexport default {\n  dev: {\n    https: true,\n  },\n};\n\n\n该方式有一定局限性，由于 devcert 目前不支持 IP addresses，因此访问 Network 域名时，会遇到「您的连接不是私密连接」的问题。\n\n此问题的解决方法为：点击 Chrome 浏览器问题页面的「高级」->「继续前往 192.168.0.1（不安全）」。\n\nTIP\n\nhttps 代理自动安装证书需要获取 root 权限, 请根据提示输入密码即可。 密码仅在信任证书时使用，不会泄漏或者用于其他环节。\n\n# 手动设置证书\n\n你也可以在 dev.https 选项中手动传入 HTTPS 服务器所需要的证书和对应的私钥，这个参数将直接传递给 Node.js 中 https 模块的 createServer。\n\n具体可以参考 https.createServer。\n\nimport fs from 'fs';\n\nexport default {\n  dev: {\n    https: {\n      key: fs.readFileSync('certificates/private.pem'),\n      cert: fs.readFileSync('certificates/public.pem'),\n    },\n  },\n};\n\n\n\n# dev.port\n\n * Type: number\n * Default: 8080\n\n设置 Dev Server 监听的端口号。\n\n默认情况下，Dev Server 会监听 8080 端口，并在端口被占用时自动递增端口号。\n\n# 示例\n\n将端口设置为 3000：\n\nexport default {\n  dev: {\n    port: 3000,\n  },\n};\n\n\n\n# dev.progressBar\n\n * Type:\n\ntype ProgressBar =\n  | boolean\n  | {\n      id?: string;\n    };\n\n\n * Default: true\n\n是否在编译过程中展示进度条。\n\nexport default {\n  dev: {\n    progressBar: false,\n  },\n};\n\n\n如果需要修改进度条左侧显示的文本内容，可以设置 id 选项：\n\nexport default {\n  dev: {\n    progressBar: {\n      id: 'Some Text',\n    },\n  },\n};\n\n\n\n# dev.startUrl\n\n * Type: boolean | string | string[] | undefined\n * Default: undefined\n\ndev.startUrl 用于设置 Dev Server 启动时自动在浏览器中打开的页面 URL。\n\n默认情况下，Dev Server 启动时不会打开任何页面。\n\n你可以设置为如下的值：\n\nexport default {\n  dev: {\n    // 打开项目的默认页面\n    startUrl: true,\n    // 打开指定的页面\n    startUrl: 'http://localhost:8080',\n    // 打开多个页面\n    startUrl: ['http://localhost:8080', 'http://localhost:8080/about'],\n  },\n};\n",normalizedContent:"# dev config\n\n本章节描述了 builder 中与本地开发有关的配置。\n\n\n# dev.assetprefix\n\n * type: boolean | string\n * default: '/'\n\n设置开发环境下的静态资源 url 前缀，对应 webpack 的 output.publicpath 配置。\n\nassetprefix 会影响构建产物中绝大部分静态资源的 url，包括 javascript 文件、css 文件、图片、视频等。如果指定了一个错误的值，则在加载这些资源时可能会出现 404 错误。\n\n该配置项仅用于开发环境。在生产环境下，请使用 output.assetprefix 配置项进行设置。\n\n# boolean 类型\n\n如果设置 assetprefix 为 true，builder 会自动计算出 //ip:port/ 作为 url 前缀：\n\nexport default {\n  dev: {\n    assetprefix: true,\n  },\n};\n\n\n对应 js 文件在浏览器中加载的地址如下：\n\n<script defer src=\"//${ip}:8080/static/js/main.js\"><\/script>\n\n\n如果设置 assetprefix 为 false 或不设置，则默认使用 / 作为访问前缀。\n\n# string 类型\n\n当 assetprefix 的值为 string 类型时，字符串会作为前缀，自动拼接到静态资源访问 url 上：\n\nexport default {\n  dev: {\n    assetprefix: 'http://example.com/assets/',\n  },\n};\n\n\n对应 js 文件在浏览器中加载的地址如下：\n\n<script defer src=\"http://example.com/assets/static/js/main.js\"><\/script>\n\n\n\n# dev.hmr\n\n * type: boolean\n * default: true\n\n是否开启 hot module replacement 热更新能力。\n\n当 hmr 设置为 false 时，将不再提供热更新和 react-refresh 功能。\n\nexport default {\n  dev: {\n    hmr: false,\n  },\n};\n\n\n\n# dev.https\n\n * type: boolean | { key: string; cert: string }\n * default: false\n\n配置该选项后，可以开启 dev server 对 https 的支持，同时会禁用 http 服务器。\n\n开启前：\n\n  > local:    http://localhost:8080/\n  > network:  http://192.168.0.1:8080/\n\n\n开启后：\n\n  > local:    https://localhost:8080/\n  > network:  https://192.168.0.1:8080/\n\n\n# 自动生成证书\n\n你可以直接将 https 设置为 true，builder 会基于 devcert 来自动生成 dev server 所需的 https 证书。\n\nexport default {\n  dev: {\n    https: true,\n  },\n};\n\n\n该方式有一定局限性，由于 devcert 目前不支持 ip addresses，因此访问 network 域名时，会遇到「您的连接不是私密连接」的问题。\n\n此问题的解决方法为：点击 chrome 浏览器问题页面的「高级」->「继续前往 192.168.0.1（不安全）」。\n\ntip\n\nhttps 代理自动安装证书需要获取 root 权限, 请根据提示输入密码即可。 密码仅在信任证书时使用，不会泄漏或者用于其他环节。\n\n# 手动设置证书\n\n你也可以在 dev.https 选项中手动传入 https 服务器所需要的证书和对应的私钥，这个参数将直接传递给 node.js 中 https 模块的 createserver。\n\n具体可以参考 https.createserver。\n\nimport fs from 'fs';\n\nexport default {\n  dev: {\n    https: {\n      key: fs.readfilesync('certificates/private.pem'),\n      cert: fs.readfilesync('certificates/public.pem'),\n    },\n  },\n};\n\n\n\n# dev.port\n\n * type: number\n * default: 8080\n\n设置 dev server 监听的端口号。\n\n默认情况下，dev server 会监听 8080 端口，并在端口被占用时自动递增端口号。\n\n# 示例\n\n将端口设置为 3000：\n\nexport default {\n  dev: {\n    port: 3000,\n  },\n};\n\n\n\n# dev.progressbar\n\n * type:\n\ntype progressbar =\n  | boolean\n  | {\n      id?: string;\n    };\n\n\n * default: true\n\n是否在编译过程中展示进度条。\n\nexport default {\n  dev: {\n    progressbar: false,\n  },\n};\n\n\n如果需要修改进度条左侧显示的文本内容，可以设置 id 选项：\n\nexport default {\n  dev: {\n    progressbar: {\n      id: 'some text',\n    },\n  },\n};\n\n\n\n# dev.starturl\n\n * type: boolean | string | string[] | undefined\n * default: undefined\n\ndev.starturl 用于设置 dev server 启动时自动在浏览器中打开的页面 url。\n\n默认情况下，dev server 启动时不会打开任何页面。\n\n你可以设置为如下的值：\n\nexport default {\n  dev: {\n    // 打开项目的默认页面\n    starturl: true,\n    // 打开指定的页面\n    starturl: 'http://localhost:8080',\n    // 打开多个页面\n    starturl: ['http://localhost:8080', 'http://localhost:8080/about'],\n  },\n};\n",charsets:{cjk:!0}},{title:"Experiments Config",frontmatter:{extractApiHeaders:[2]},regularPath:"/zh/api/config-experiments.html",relativePath:"zh/api/config-experiments.md",key:"v-5671b58c",path:"/zh/api/config-experiments.html",headers:[{level:2,title:"experiments.lazyCompilation",slug:"experiments-lazycompilation",normalizedTitle:"experiments.lazycompilation",charIndex:131}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"experiments.lazyCompilation",content:"# Experiments Config\n\n本章节描述了 Builder 中的一些实验性配置，实验性配置可以开启 Builder 中尚未稳定的功能。\n\n如果你在使用实验性功能时遇到问题，请先关闭对应的配置，并通过 GitHub Issues 进行反馈。\n\n\n# experiments.lazyCompilation\n\n * Type:\n\ntype LazyCompilationOptions =\n  | boolean\n  | {\n      // 是否为异步模块开启延迟编译\n      imports?: boolean;\n      // 是否为入口模块开启延迟编译\n      entries?: boolean;\n    };\n\n\n * Default: false\n\n用于开启延迟编译（即按需编译）的能力。当开启此配置项时，Builder 会进行延迟编译，提升项目的编译启动速度。\n\n延迟编译只在开发环境下生效。\n\n\n# 延迟编译异步模块\n\n延迟编译 Dynamic Import 引入的异步模块：\n\nexport default {\n  experiments: {\n    lazyCompilation: {\n      imports: true,\n      entries: false,\n    },\n  },\n};\n\n\n开启 imports 选项后，所有的异步模块只有在被请求时才触发编译。如果你的项目是一个单页应用（SPA），并通过 Dynamic Import 进行了路由拆分，那么会有明显的编译提速效果。\n\n\n# 延迟编译入口模块\n\n除了延迟编译异步模块，你也可以选择同时延迟编译入口模块和异步模块。\n\nexport default {\n  experiments: {\n    lazyCompilation: {\n      imports: true,\n      entries: true,\n    },\n  },\n};\n\n\n以上配置也可以简化为：\n\nexport default {\n  experiments: {\n    lazyCompilation: true,\n  },\n};\n\n\n开启 entries 选项后，当启动编译时，不会编译所有的页面，而是仅在路由跳转到对应的页面时，才对该页面进行编译。\n\n使用延迟编译入口模块时，有以下注意事项：\n\n * 只适用于多页应用（MPA），对单页应用（SPA）没有优化效果。\n * 当你访问一个页面时，由于要等待页面编译完成，会有一段时间的白屏。\n\n禁用拆包规则\n\n当你开启延迟编译时，为了保证编译结果正常，Builder 会在开发环境下禁用拆包规则。这不会影响生产环境的打包产物，但会导致开发环境和生产环境的打包产物有一定差异。",normalizedContent:"# experiments config\n\n本章节描述了 builder 中的一些实验性配置，实验性配置可以开启 builder 中尚未稳定的功能。\n\n如果你在使用实验性功能时遇到问题，请先关闭对应的配置，并通过 github issues 进行反馈。\n\n\n# experiments.lazycompilation\n\n * type:\n\ntype lazycompilationoptions =\n  | boolean\n  | {\n      // 是否为异步模块开启延迟编译\n      imports?: boolean;\n      // 是否为入口模块开启延迟编译\n      entries?: boolean;\n    };\n\n\n * default: false\n\n用于开启延迟编译（即按需编译）的能力。当开启此配置项时，builder 会进行延迟编译，提升项目的编译启动速度。\n\n延迟编译只在开发环境下生效。\n\n\n# 延迟编译异步模块\n\n延迟编译 dynamic import 引入的异步模块：\n\nexport default {\n  experiments: {\n    lazycompilation: {\n      imports: true,\n      entries: false,\n    },\n  },\n};\n\n\n开启 imports 选项后，所有的异步模块只有在被请求时才触发编译。如果你的项目是一个单页应用（spa），并通过 dynamic import 进行了路由拆分，那么会有明显的编译提速效果。\n\n\n# 延迟编译入口模块\n\n除了延迟编译异步模块，你也可以选择同时延迟编译入口模块和异步模块。\n\nexport default {\n  experiments: {\n    lazycompilation: {\n      imports: true,\n      entries: true,\n    },\n  },\n};\n\n\n以上配置也可以简化为：\n\nexport default {\n  experiments: {\n    lazycompilation: true,\n  },\n};\n\n\n开启 entries 选项后，当启动编译时，不会编译所有的页面，而是仅在路由跳转到对应的页面时，才对该页面进行编译。\n\n使用延迟编译入口模块时，有以下注意事项：\n\n * 只适用于多页应用（mpa），对单页应用（spa）没有优化效果。\n * 当你访问一个页面时，由于要等待页面编译完成，会有一段时间的白屏。\n\n禁用拆包规则\n\n当你开启延迟编译时，为了保证编译结果正常，builder 会在开发环境下禁用拆包规则。这不会影响生产环境的打包产物，但会导致开发环境和生产环境的打包产物有一定差异。",charsets:{cjk:!0}},{title:"Html Config",frontmatter:{extractApiHeaders:[2]},regularPath:"/zh/api/config-html.html",relativePath:"zh/api/config-html.md",key:"v-4311ae18",path:"/zh/api/config-html.html",headers:[{level:2,title:"html.appIcon",slug:"html-appicon",normalizedTitle:"html.appicon",charIndex:49},{level:2,title:"html.crossorigin",slug:"html-crossorigin",normalizedTitle:"html.crossorigin",charIndex:380},{level:2,title:"html.disableHtmlFolder",slug:"html-disablehtmlfolder",normalizedTitle:"html.disablehtmlfolder",charIndex:725},{level:2,title:"html.favicon",slug:"html-favicon",normalizedTitle:"html.favicon",charIndex:1175},{level:2,title:"html.faviconByEntries",slug:"html-faviconbyentries",normalizedTitle:"html.faviconbyentries",charIndex:1454},{level:2,title:"html.inject",slug:"html-inject",normalizedTitle:"html.inject",charIndex:1926},{level:2,title:"html.injectByEntries",slug:"html-injectbyentries",normalizedTitle:"html.injectbyentries",charIndex:2938},{level:2,title:"html.meta",slug:"html-meta",normalizedTitle:"html.meta",charIndex:3363},{level:2,title:"html.metaByEntries",slug:"html-metabyentries",normalizedTitle:"html.metabyentries",charIndex:4299},{level:2,title:"html.mountId",slug:"html-mountid",normalizedTitle:"html.mountid",charIndex:4814},{level:2,title:"html.template",slug:"html-template",normalizedTitle:"html.template",charIndex:5171},{level:2,title:"html.templateByEntries",slug:"html-templatebyentries",normalizedTitle:"html.templatebyentries",charIndex:5388},{level:2,title:"html.templateParameters",slug:"html-templateparameters",normalizedTitle:"html.templateparameters",charIndex:5791},{level:2,title:"html.templateParametersByEntries",slug:"html-templateparametersbyentries",normalizedTitle:"html.templateparametersbyentries",charIndex:7252},{level:2,title:"html.title",slug:"html-title",normalizedTitle:"html.title",charIndex:5941},{level:2,title:"html.titleByEntries",slug:"html-titlebyentries",normalizedTitle:"html.titlebyentries",charIndex:7812}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"html.appIcon html.crossorigin html.disableHtmlFolder html.favicon html.faviconByEntries html.inject html.injectByEntries html.meta html.metaByEntries html.mountId html.template html.templateByEntries html.templateParameters html.templateParametersByEntries html.title html.titleByEntries",content:"# Html Config\n\n本章节描述了 Builder 中与 HTML 有关的配置。\n\n\n# html.appIcon\n\n * Type: string\n * Default: undefined\n\n设置 app icon 的文件路径，可以为相对路径或绝对路径。\n\n配置该选项后，在编译过程中会自动将图标拷贝至 dist 目录下，并在 HTML 中添加相应的 link 标签。\n\n# 示例\n\nexport default {\n  html: {\n    appIcon: './src/assets/icon.png',\n  },\n};\n\n\n重新编译后，HTML 中自动生成了以下标签：\n\n<link rel=\"apple-touch-icon\" sizes=\"180*180\" href=\"/static/image/icon.png\" />\n\n\n\n# html.crossorigin\n\n * Type: boolean | 'anonymous' | 'use-credentials'\n * Default: false\n\n用于设置 <script> 标签的 crossorigin 属性。\n\n传入 true 时，会自动设置为 crossorigin=\"anonymous\"。\n\n# 示例\n\nexport default {\n  html: {\n    crossorigin: 'anonymous',\n  },\n};\n\n\n编译后，HTML 中的 <script> 标签变为：\n\n<script defer src=\"/static/js/main.js\" crossorigin=\"anonymous\"><\/script>\n\n\n\n# html.disableHtmlFolder\n\n * Type: boolean\n * Default: false\n\n移除 HTML 产物对应的文件夹。开启该选项后，生成的 HTML 文件目录会从 [name]/index.html 变为 [name].html。\n\n# 示例\n\n默认情况下，HTML 产物在 dist 目录下的结构为：\n\n/dist\n└── html\n    └── main\n        └── index.html\n\n\n开启 html.disableHtmlFolder 配置:\n\nexport default {\n  html: {\n    disableHtmlFolder: true,\n  },\n};\n\n\n重新编译后，HTML 产物在 dist 中的目录结构如下：\n\n/dist\n└── html\n    └── main.html\n\n\n> 如果需要设置 HTML 文件在 dist 目录中的路径，请使用 output.distPath.html 配置。\n\n\n# html.favicon\n\n * Type: string\n * Default: undefined\n\n设置页面的 favicon 图标。\n\n配置该选项后，在编译过程中会自动将图标拷贝至 dist 目录下，并在 HTML 中添加相应的 link 标签。\n\n# 示例\n\nexport default {\n  html: {\n    favicon: './src/assets/icon.png',\n  },\n};\n\n\n重新编译后，HTML 中自动生成了以下标签：\n\n<link rel=\"icon\" href=\"/favicon.ico\" />\n\n\n\n# html.faviconByEntries\n\n * Type: Record<string, string>\n * Default: undefined\n\n用于在多页面的场景下，为不同的页面设置不同的 favicon。\n\n整体用法与 favicon 一致，并且可以使用「入口名称」作为 key ，对各个页面进行单独设置。\n\nfaviconByEntries 的优先级高于 favicon，因此会覆盖 favicon 中设置的值。\n\n# 示例\n\nexport default {\n  html: {\n    favicon: './src/assets/default.png',\n    faviconByEntries: {\n      foo: './src/assets/foo.png',\n    },\n  },\n};\n\n\n重新编译后，可以看到:\n\n * 页面 foo 的 favicon 为 ./src/assets/foo.png。\n * 其他页面的 favicon 为 ./src/assets/default.png。\n\n\n# html.inject\n\n * Type: 'head' | 'body'| 'true' | false\n * Default: 'head'\n\n修改构建产物中 <script> 标签在 HTML 中的插入位置。\n\n可以设置为以下值：\n\n * 'head': script 标签会插入在 HTML 的 head 标签内。\n * 'body': script 标签会插入在 HTML 的 body 标签尾部。\n * true: 最终表现取决于 html-webpack-plugin 的 scriptLoading 配置项。\n * false: script 标签不插入 HTML 中。\n\n# 默认插入位置\n\nscript 标签默认在 head 标签内：\n\n<html>\n  <head>\n    <title></title>\n    <script defer src=\"/static/js/runtime-main.js\"><\/script>\n    <script defer src=\"/static/js/main.js\"><\/script>\n    <link href=\"/static/css/main.css\" rel=\"stylesheet\" />\n  </head>\n  <body>\n    <div id=\"root\"></div>\n  </body>\n</html>\n\n\n# 插入至 body 标签\n\n添加如下配置，可以将 script 插入至 body 标签：\n\nexport default {\n  html: {\n    inject: 'body',\n  },\n};\n\n\n可以看到 script 标签生成在 body 标签尾部：\n\n<html>\n  <head>\n    <title></title>\n    <link href=\"/static/css/main.css\" rel=\"stylesheet\" />\n  </head>\n  <body>\n    <div id=\"root\"></div>\n    <script defer src=\"/static/js/runtime-main.js\"><\/script>\n    <script defer src=\"/static/js/main.js\"><\/script>\n  </body>\n</html>\n\n\n\n# html.injectByEntries\n\n * Type: Record<string, boolean | string>\n * Default: undefined\n\n用于在多页面的场景下，为不同的页面设置不同的 script 标签插入位置。\n\n整体用法与 inject 一致，并且可以使用「入口名称」作为 key ，对各个页面进行单独设置。\n\ninjectByEntries 的优先级高于 inject，因此会覆盖 inject 中设置的值。\n\n# 示例\n\nexport default {\n  html: {\n    inject: 'head',\n    injectByEntries: {\n      foo: 'body',\n    },\n  },\n};\n\n\n重新编译后，可以看到:\n\n * 页面 foo 的 script 标签会插入到 body 标签内。\n * 其他页面的 script 标签会插入到 head 标签内。\n\n\n# html.meta\n\n * Type: Record<string, false | string | Record<string, string | boolean>>\n * Default: undefined\n\n配置 HTML 页面的 <meta> 标签。\n\n# 字符串用法\n\n当 meta 对象的 value 为字符串时，会自动将对象的 key 映射为 name，value 映射为 content。\n\n比如设置 description：\n\nexport default {\n  html: {\n    meta: {\n      description: 'a description of the page',\n    },\n  },\n};\n\n\n最终在 HTML 中生成的 meta 标签为：\n\n<meta name=\"description\" content=\"a description of the page\" />\n\n\n# 对象用法\n\n当 meta 对象的 value 为对象时，会将该对象的 key: value 映射为 meta 标签的属性。\n\n这种情况下默认不会设置 name 和 content 属性。\n\n比如设置 http-equiv：\n\nexport default {\n  html: {\n    meta: {\n      'http-equiv': {\n        'http-equiv': 'x-ua-compatible',\n        content: 'ie=edge',\n      },\n    },\n  },\n};\n\n\n最终在 HTML 中生成的 meta 标签为：\n\n<meta http-equiv=\"x-ua-compatible\" content=\"ie=edge\" />\n\n\n\n# 移除默认值\n\n将 meta 对象的 value 设置为 false，则表示不生成对应的 meta 标签。\n\n比如移除框架预设的 imagemode：\n\nexport default {\n  html: {\n    meta: {\n      imagemode: false,\n    },\n  },\n};\n\n\n\n# html.metaByEntries\n\n * Type: Record<string, Meta>\n * Default: undefined\n\n用于在多页面的场景下，为不同的页面设置不同的 meta 标签。\n\n整体用法与 meta 一致，并且可以使用「入口名称」作为 key ，对各个页面进行单独设置。\n\nmetaByEntries 的优先级高于 meta，因此会覆盖 meta 中设置的值。\n\n# 示例\n\nexport default {\n  html: {\n    meta: {\n      description: 'ByteDance',\n    },\n    metaByEntries: {\n      foo: {\n        description: 'TikTok',\n      },\n    },\n  },\n};\n\n\n编译后，可以看到页面 foo 的 meta 为：\n\n<meta name=\"description\" content=\"TikTok\" />\n\n\n其他页面的 meta 为：\n\n<meta name=\"description\" content=\"ByteDance\" />\n\n\n\n# html.mountId\n\n * Type: string\n * Default: 'root'\n\n默认情况下，HTML 模板中包含了 root 节点用于组件挂载，通过 mountId 可以修改该节点的 id。\n\n<body>\n  <div id=\"root\"></div>\n</body>\n\n\n# 示例\n\n修改 DOM 挂载节点 id 为 app：\n\nexport default {\n  html: {\n    mountId: 'app',\n  },\n};\n\n\n编译后：\n\n<body>\n  <div id=\"app\"></div>\n</body>\n\n\nTIP\n\n如果自定义了 HTML 模板，请确保模板中包含 <div id=\"<%= mountId %>\"></div>，否则该配置项无法生效。\n\n\n# html.template\n\n * Type: string\n * Default:\n\n定义 HTML 模板的文件路径，对应 html-webpack-plugin 的 template 配置项。\n\n# 示例\n\n使用自定义的 HTML 模板文件替代默认模板，可以添加如下设置：\n\nexport default {\n  html: {\n    template: './static/index.html',\n  },\n};\n\n\n\n# html.templateByEntries\n\n * Type: Object\n * Default: undefined\n\n用于在多页面的场景下，为不同的页面设置不同的 HTML 模板。\n\n整体用法与 template 一致，并且可以使用「入口名称」作为 key ，对各个页面进行单独设置。\n\ntemplateByEntries 的优先级高于 template，因此会覆盖 template 设置的值。\n\n# 示例\n\nexport default {\n  output: {\n    template: './static/index.html',\n    templateByEntries: {\n      foo: './src/pages/foo/index.html',\n      bar: './src/pages/bar/index.html',\n    },\n  },\n};\n\n\n\n# html.templateParameters\n\n * Type: Object | Function\n * Default:\n\ntype DefaultParameters = {\n  meta: string; // 对应 html.meta 配置\n  title: string; // 对应 html.title 配置\n  mountId: string; // 对应 html.mountId 配置\n  entryName: string; // 入口名称\n  assetPrefix: string; // 对应 output.assetPrefix 配置\n  compilation: webpack.Compilation; // 对应 webpack 的 compilation 对象\n  webpackConfig: Configuration; // webpack 配置\n  // htmlWebpackPlugin 内置的参数\n  // 详见 https://github.com/jantimon/html-webpack-plugin\n  htmlWebpackPlugin: {\n    tags: object;\n    files: object;\n    options: object;\n  };\n};\n\n\n定义 HTML 模板中的参数，对应 html-webpack-plugin 的 templateParameters 配置项。你可以使用配置为对象或者函数。\n\n如果是对象，会和默认参数合并。比如：\n\nexport default {\n  html: {\n    templateParameters: {\n      title: 'My App',\n    },\n  },\n};\n\n\n如果是函数，会传入默认参数，你可以返回一个对象，用于覆盖默认参数。比如：\n\nexport default {\n  html: {\n    templateParameters: defaultParameters => {\n      console.log(defaultParameters.compilation);\n      console.log(defaultParameters.title);\n      return {\n        title: 'My App',\n      };\n    },\n  },\n};\n\n\n# 示例\n\n如果需要在 HTML 模板中使用 foo 参数，可以添加如下设置：\n\nexport default {\n  html: {\n    templateParameters: {\n      foo: 'bar',\n    },\n  },\n};\n\n\n或者使用函数配置：\n\nexport default {\n  html: {\n    templateParameters: defaultParameters => {\n      return {\n        foo: 'bar',\n      };\n    },\n  },\n};\n\n\n接下来，你可以在 HTML 模板中，通过 <%= foo %> 来读取参数：\n\n<script>window.foo = '<%= foo %>'<\/script>\n\n\n经过编译后的最终 HTML 代码如下：\n\n<script>window.foo = 'bar'<\/script>\n\n\n\n# html.templateParametersByEntries\n\n * Type: Object\n * Default: undefined\n\n用于在多页面的场景下，为不同的页面设置不同的模板参数。\n\n整体用法与 templateParameters 一致，并且可以使用「入口名称」作为 key ，对各个页面进行单独设置。\n\ntemplateParametersByEntries 的优先级高于 templateParameters，因此会覆盖 templateParameters 中设置的值。\n\n# 示例\n\nexport default {\n  html: {\n    templateParametersByEntries: {\n      foo: {\n        type: 'a',\n      },\n      bar: {\n        type: 'b',\n      },\n    },\n  },\n};\n\n\n\n# html.title\n\n * Type: string\n * Default: undefined\n\n配置 HTML 页面的 title 标签，例如：\n\nexport default {\n  html: {\n    title: 'example',\n  },\n};\n\n\n\n# html.titleByEntries\n\n * Type: Record<string, string>\n * Default: undefined\n\n用于在多页面的场景下，为不同的页面设置不同的 title。\n\n整体用法与 title 一致，并且可以使用「入口名称」作为 key ，对各个页面进行单独设置。\n\ntitleByEntries 的优先级高于 title，因此会覆盖 title 中设置的值。\n\n# 示例\n\nexport default {\n  html: {\n    title: 'ByteDance',\n    titleByEntries: {\n      foo: 'TikTok',\n    },\n  },\n};\n\n\n重新编译后，可以看到:\n\n * 页面 foo 的 title 为 TikTok。\n * 其他页面的 title 为 ByteDance。",normalizedContent:"# html config\n\n本章节描述了 builder 中与 html 有关的配置。\n\n\n# html.appicon\n\n * type: string\n * default: undefined\n\n设置 app icon 的文件路径，可以为相对路径或绝对路径。\n\n配置该选项后，在编译过程中会自动将图标拷贝至 dist 目录下，并在 html 中添加相应的 link 标签。\n\n# 示例\n\nexport default {\n  html: {\n    appicon: './src/assets/icon.png',\n  },\n};\n\n\n重新编译后，html 中自动生成了以下标签：\n\n<link rel=\"apple-touch-icon\" sizes=\"180*180\" href=\"/static/image/icon.png\" />\n\n\n\n# html.crossorigin\n\n * type: boolean | 'anonymous' | 'use-credentials'\n * default: false\n\n用于设置 <script> 标签的 crossorigin 属性。\n\n传入 true 时，会自动设置为 crossorigin=\"anonymous\"。\n\n# 示例\n\nexport default {\n  html: {\n    crossorigin: 'anonymous',\n  },\n};\n\n\n编译后，html 中的 <script> 标签变为：\n\n<script defer src=\"/static/js/main.js\" crossorigin=\"anonymous\"><\/script>\n\n\n\n# html.disablehtmlfolder\n\n * type: boolean\n * default: false\n\n移除 html 产物对应的文件夹。开启该选项后，生成的 html 文件目录会从 [name]/index.html 变为 [name].html。\n\n# 示例\n\n默认情况下，html 产物在 dist 目录下的结构为：\n\n/dist\n└── html\n    └── main\n        └── index.html\n\n\n开启 html.disablehtmlfolder 配置:\n\nexport default {\n  html: {\n    disablehtmlfolder: true,\n  },\n};\n\n\n重新编译后，html 产物在 dist 中的目录结构如下：\n\n/dist\n└── html\n    └── main.html\n\n\n> 如果需要设置 html 文件在 dist 目录中的路径，请使用 output.distpath.html 配置。\n\n\n# html.favicon\n\n * type: string\n * default: undefined\n\n设置页面的 favicon 图标。\n\n配置该选项后，在编译过程中会自动将图标拷贝至 dist 目录下，并在 html 中添加相应的 link 标签。\n\n# 示例\n\nexport default {\n  html: {\n    favicon: './src/assets/icon.png',\n  },\n};\n\n\n重新编译后，html 中自动生成了以下标签：\n\n<link rel=\"icon\" href=\"/favicon.ico\" />\n\n\n\n# html.faviconbyentries\n\n * type: record<string, string>\n * default: undefined\n\n用于在多页面的场景下，为不同的页面设置不同的 favicon。\n\n整体用法与 favicon 一致，并且可以使用「入口名称」作为 key ，对各个页面进行单独设置。\n\nfaviconbyentries 的优先级高于 favicon，因此会覆盖 favicon 中设置的值。\n\n# 示例\n\nexport default {\n  html: {\n    favicon: './src/assets/default.png',\n    faviconbyentries: {\n      foo: './src/assets/foo.png',\n    },\n  },\n};\n\n\n重新编译后，可以看到:\n\n * 页面 foo 的 favicon 为 ./src/assets/foo.png。\n * 其他页面的 favicon 为 ./src/assets/default.png。\n\n\n# html.inject\n\n * type: 'head' | 'body'| 'true' | false\n * default: 'head'\n\n修改构建产物中 <script> 标签在 html 中的插入位置。\n\n可以设置为以下值：\n\n * 'head': script 标签会插入在 html 的 head 标签内。\n * 'body': script 标签会插入在 html 的 body 标签尾部。\n * true: 最终表现取决于 html-webpack-plugin 的 scriptloading 配置项。\n * false: script 标签不插入 html 中。\n\n# 默认插入位置\n\nscript 标签默认在 head 标签内：\n\n<html>\n  <head>\n    <title></title>\n    <script defer src=\"/static/js/runtime-main.js\"><\/script>\n    <script defer src=\"/static/js/main.js\"><\/script>\n    <link href=\"/static/css/main.css\" rel=\"stylesheet\" />\n  </head>\n  <body>\n    <div id=\"root\"></div>\n  </body>\n</html>\n\n\n# 插入至 body 标签\n\n添加如下配置，可以将 script 插入至 body 标签：\n\nexport default {\n  html: {\n    inject: 'body',\n  },\n};\n\n\n可以看到 script 标签生成在 body 标签尾部：\n\n<html>\n  <head>\n    <title></title>\n    <link href=\"/static/css/main.css\" rel=\"stylesheet\" />\n  </head>\n  <body>\n    <div id=\"root\"></div>\n    <script defer src=\"/static/js/runtime-main.js\"><\/script>\n    <script defer src=\"/static/js/main.js\"><\/script>\n  </body>\n</html>\n\n\n\n# html.injectbyentries\n\n * type: record<string, boolean | string>\n * default: undefined\n\n用于在多页面的场景下，为不同的页面设置不同的 script 标签插入位置。\n\n整体用法与 inject 一致，并且可以使用「入口名称」作为 key ，对各个页面进行单独设置。\n\ninjectbyentries 的优先级高于 inject，因此会覆盖 inject 中设置的值。\n\n# 示例\n\nexport default {\n  html: {\n    inject: 'head',\n    injectbyentries: {\n      foo: 'body',\n    },\n  },\n};\n\n\n重新编译后，可以看到:\n\n * 页面 foo 的 script 标签会插入到 body 标签内。\n * 其他页面的 script 标签会插入到 head 标签内。\n\n\n# html.meta\n\n * type: record<string, false | string | record<string, string | boolean>>\n * default: undefined\n\n配置 html 页面的 <meta> 标签。\n\n# 字符串用法\n\n当 meta 对象的 value 为字符串时，会自动将对象的 key 映射为 name，value 映射为 content。\n\n比如设置 description：\n\nexport default {\n  html: {\n    meta: {\n      description: 'a description of the page',\n    },\n  },\n};\n\n\n最终在 html 中生成的 meta 标签为：\n\n<meta name=\"description\" content=\"a description of the page\" />\n\n\n# 对象用法\n\n当 meta 对象的 value 为对象时，会将该对象的 key: value 映射为 meta 标签的属性。\n\n这种情况下默认不会设置 name 和 content 属性。\n\n比如设置 http-equiv：\n\nexport default {\n  html: {\n    meta: {\n      'http-equiv': {\n        'http-equiv': 'x-ua-compatible',\n        content: 'ie=edge',\n      },\n    },\n  },\n};\n\n\n最终在 html 中生成的 meta 标签为：\n\n<meta http-equiv=\"x-ua-compatible\" content=\"ie=edge\" />\n\n\n\n# 移除默认值\n\n将 meta 对象的 value 设置为 false，则表示不生成对应的 meta 标签。\n\n比如移除框架预设的 imagemode：\n\nexport default {\n  html: {\n    meta: {\n      imagemode: false,\n    },\n  },\n};\n\n\n\n# html.metabyentries\n\n * type: record<string, meta>\n * default: undefined\n\n用于在多页面的场景下，为不同的页面设置不同的 meta 标签。\n\n整体用法与 meta 一致，并且可以使用「入口名称」作为 key ，对各个页面进行单独设置。\n\nmetabyentries 的优先级高于 meta，因此会覆盖 meta 中设置的值。\n\n# 示例\n\nexport default {\n  html: {\n    meta: {\n      description: 'bytedance',\n    },\n    metabyentries: {\n      foo: {\n        description: 'tiktok',\n      },\n    },\n  },\n};\n\n\n编译后，可以看到页面 foo 的 meta 为：\n\n<meta name=\"description\" content=\"tiktok\" />\n\n\n其他页面的 meta 为：\n\n<meta name=\"description\" content=\"bytedance\" />\n\n\n\n# html.mountid\n\n * type: string\n * default: 'root'\n\n默认情况下，html 模板中包含了 root 节点用于组件挂载，通过 mountid 可以修改该节点的 id。\n\n<body>\n  <div id=\"root\"></div>\n</body>\n\n\n# 示例\n\n修改 dom 挂载节点 id 为 app：\n\nexport default {\n  html: {\n    mountid: 'app',\n  },\n};\n\n\n编译后：\n\n<body>\n  <div id=\"app\"></div>\n</body>\n\n\ntip\n\n如果自定义了 html 模板，请确保模板中包含 <div id=\"<%= mountid %>\"></div>，否则该配置项无法生效。\n\n\n# html.template\n\n * type: string\n * default:\n\n定义 html 模板的文件路径，对应 html-webpack-plugin 的 template 配置项。\n\n# 示例\n\n使用自定义的 html 模板文件替代默认模板，可以添加如下设置：\n\nexport default {\n  html: {\n    template: './static/index.html',\n  },\n};\n\n\n\n# html.templatebyentries\n\n * type: object\n * default: undefined\n\n用于在多页面的场景下，为不同的页面设置不同的 html 模板。\n\n整体用法与 template 一致，并且可以使用「入口名称」作为 key ，对各个页面进行单独设置。\n\ntemplatebyentries 的优先级高于 template，因此会覆盖 template 设置的值。\n\n# 示例\n\nexport default {\n  output: {\n    template: './static/index.html',\n    templatebyentries: {\n      foo: './src/pages/foo/index.html',\n      bar: './src/pages/bar/index.html',\n    },\n  },\n};\n\n\n\n# html.templateparameters\n\n * type: object | function\n * default:\n\ntype defaultparameters = {\n  meta: string; // 对应 html.meta 配置\n  title: string; // 对应 html.title 配置\n  mountid: string; // 对应 html.mountid 配置\n  entryname: string; // 入口名称\n  assetprefix: string; // 对应 output.assetprefix 配置\n  compilation: webpack.compilation; // 对应 webpack 的 compilation 对象\n  webpackconfig: configuration; // webpack 配置\n  // htmlwebpackplugin 内置的参数\n  // 详见 https://github.com/jantimon/html-webpack-plugin\n  htmlwebpackplugin: {\n    tags: object;\n    files: object;\n    options: object;\n  };\n};\n\n\n定义 html 模板中的参数，对应 html-webpack-plugin 的 templateparameters 配置项。你可以使用配置为对象或者函数。\n\n如果是对象，会和默认参数合并。比如：\n\nexport default {\n  html: {\n    templateparameters: {\n      title: 'my app',\n    },\n  },\n};\n\n\n如果是函数，会传入默认参数，你可以返回一个对象，用于覆盖默认参数。比如：\n\nexport default {\n  html: {\n    templateparameters: defaultparameters => {\n      console.log(defaultparameters.compilation);\n      console.log(defaultparameters.title);\n      return {\n        title: 'my app',\n      };\n    },\n  },\n};\n\n\n# 示例\n\n如果需要在 html 模板中使用 foo 参数，可以添加如下设置：\n\nexport default {\n  html: {\n    templateparameters: {\n      foo: 'bar',\n    },\n  },\n};\n\n\n或者使用函数配置：\n\nexport default {\n  html: {\n    templateparameters: defaultparameters => {\n      return {\n        foo: 'bar',\n      };\n    },\n  },\n};\n\n\n接下来，你可以在 html 模板中，通过 <%= foo %> 来读取参数：\n\n<script>window.foo = '<%= foo %>'<\/script>\n\n\n经过编译后的最终 html 代码如下：\n\n<script>window.foo = 'bar'<\/script>\n\n\n\n# html.templateparametersbyentries\n\n * type: object\n * default: undefined\n\n用于在多页面的场景下，为不同的页面设置不同的模板参数。\n\n整体用法与 templateparameters 一致，并且可以使用「入口名称」作为 key ，对各个页面进行单独设置。\n\ntemplateparametersbyentries 的优先级高于 templateparameters，因此会覆盖 templateparameters 中设置的值。\n\n# 示例\n\nexport default {\n  html: {\n    templateparametersbyentries: {\n      foo: {\n        type: 'a',\n      },\n      bar: {\n        type: 'b',\n      },\n    },\n  },\n};\n\n\n\n# html.title\n\n * type: string\n * default: undefined\n\n配置 html 页面的 title 标签，例如：\n\nexport default {\n  html: {\n    title: 'example',\n  },\n};\n\n\n\n# html.titlebyentries\n\n * type: record<string, string>\n * default: undefined\n\n用于在多页面的场景下，为不同的页面设置不同的 title。\n\n整体用法与 title 一致，并且可以使用「入口名称」作为 key ，对各个页面进行单独设置。\n\ntitlebyentries 的优先级高于 title，因此会覆盖 title 中设置的值。\n\n# 示例\n\nexport default {\n  html: {\n    title: 'bytedance',\n    titlebyentries: {\n      foo: 'tiktok',\n    },\n  },\n};\n\n\n重新编译后，可以看到:\n\n * 页面 foo 的 title 为 tiktok。\n * 其他页面的 title 为 bytedance。",charsets:{cjk:!0}},{title:"Output Config",frontmatter:{extractApiHeaders:[2]},regularPath:"/zh/api/config-output.html",relativePath:"zh/api/config-output.md",key:"v-7f5b896c",path:"/zh/api/config-output.html",headers:[{level:2,title:"output.assetPrefix",slug:"output-assetprefix",normalizedTitle:"output.assetprefix",charIndex:49},{level:2,title:"output.assetsRetry",slug:"output-assetsretry",normalizedTitle:"output.assetsretry",charIndex:622},{level:2,title:"output.charset",slug:"output-charset",normalizedTitle:"output.charset",charIndex:3480},{level:2,title:"output.cleanDistPath",slug:"output-cleandistpath",normalizedTitle:"output.cleandistpath",charIndex:3787},{level:2,title:"output.convertToRem",slug:"output-converttorem",normalizedTitle:"output.converttorem",charIndex:4009},{level:2,title:"output.copy",slug:"output-copy",normalizedTitle:"output.copy",charIndex:5953},{level:2,title:"output.cssModuleLocalIdentName",slug:"output-cssmodulelocalidentname",normalizedTitle:"output.cssmodulelocalidentname",charIndex:6230},{level:2,title:"output.dataUriLimit",slug:"output-dataurilimit",normalizedTitle:"output.dataurilimit",charIndex:7069},{level:2,title:"output.disableCssExtract",slug:"output-disablecssextract",normalizedTitle:"output.disablecssextract",charIndex:7701},{level:2,title:"output.disableCssModuleExtension",slug:"output-disablecssmoduleextension",normalizedTitle:"output.disablecssmoduleextension",charIndex:7984},{level:2,title:"output.distPath",slug:"output-distpath",normalizedTitle:"output.distpath",charIndex:8897},{level:2,title:"output.disableMinimize",slug:"output-disableminimize",normalizedTitle:"output.disableminimize",charIndex:9871},{level:2,title:"output.disableSourceMap",slug:"output-disablesourcemap",normalizedTitle:"output.disablesourcemap",charIndex:10094},{level:2,title:"output.disableTsChecker",slug:"output-disabletschecker",normalizedTitle:"output.disabletschecker",charIndex:11024},{level:2,title:"output.disableFilenameHash",slug:"output-disablefilenamehash",normalizedTitle:"output.disablefilenamehash",charIndex:11717},{level:2,title:"output.disableInlineRuntimeChunk",slug:"output-disableinlineruntimechunk",normalizedTitle:"output.disableinlineruntimechunk",charIndex:12377},{level:2,title:"output.enableAssetManifest",slug:"output-enableassetmanifest",normalizedTitle:"output.enableassetmanifest",charIndex:12644},{level:2,title:"output.enableAssetFallback",slug:"output-enableassetfallback",normalizedTitle:"output.enableassetfallback",charIndex:13125},{level:2,title:"output.enableLatestDecorators",slug:"output-enablelatestdecorators",normalizedTitle:"output.enablelatestdecorators",charIndex:13575},{level:2,title:"output.enableCssModuleTSDeclaration",slug:"output-enablecssmoduletsdeclaration",normalizedTitle:"output.enablecssmoduletsdeclaration",charIndex:13877},{level:2,title:"output.enableInlineScripts",slug:"output-enableinlinescripts",normalizedTitle:"output.enableinlinescripts",charIndex:14266},{level:2,title:"output.enableInlineStyles",slug:"output-enableinlinestyles",normalizedTitle:"output.enableinlinestyles",charIndex:14900},{level:2,title:"output.externals",slug:"output-externals",normalizedTitle:"output.externals",charIndex:15552},{level:2,title:"output.filename",slug:"output-filename",normalizedTitle:"output.filename",charIndex:13442},{level:2,title:"output.legalComments",slug:"output-legalcomments",normalizedTitle:"output.legalcomments",charIndex:17124},{level:2,title:"output.overrideBrowserslist",slug:"output-overridebrowserslist",normalizedTitle:"output.overridebrowserslist",charIndex:17588},{level:2,title:"output.polyfill",slug:"output-polyfill",normalizedTitle:"output.polyfill",charIndex:18681},{level:2,title:"output.svgDefaultExport",slug:"output-svgdefaultexport",normalizedTitle:"output.svgdefaultexport",charIndex:19134}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"output.assetPrefix output.assetsRetry output.charset output.cleanDistPath output.convertToRem output.copy output.cssModuleLocalIdentName output.dataUriLimit output.disableCssExtract output.disableCssModuleExtension output.distPath output.disableMinimize output.disableSourceMap output.disableTsChecker output.disableFilenameHash output.disableInlineRuntimeChunk output.enableAssetManifest output.enableAssetFallback output.enableLatestDecorators output.enableCssModuleTSDeclaration output.enableInlineScripts output.enableInlineStyles output.externals output.filename output.legalComments output.overrideBrowserslist output.polyfill output.svgDefaultExport",content:"# Output Config\n\n本章节描述了 Builder 中与构建产物有关的配置。\n\n\n# output.assetPrefix\n\n * Type: boolean | string\n * Default: '/'\n\n在生产环境使用 CDN 部署时，可使用该选项设置静态资源的 URL 前缀，对应 webpack 的 output.publicPath 配置。\n\nassetPrefix 会影响构建产物中绝大部分静态资源的 URL，包括 JavaScript 文件、CSS 文件、图片、视频等。如果指定了一个错误的值，则在加载这些资源时可能会出现 404 错误。\n\n该配置项仅用于生产环境。在开发环境下，请使用 dev.assetPrefix 配置项进行设置。\n\n设置后，项目的 JavaScript、CSS、图片等静态资源的 URL 都会加上 output.assetPrefix 作为前缀：\n\n# 示例\n\nexport default {\n  output: {\n    assetPrefix: 'https://cdn.example.com/assets/',\n  },\n};\n\n\n构建之后，可以看到 JS 文件从以下地址加载：\n\n<script\n  defer\n  src=\"https://cdn.example.com/assets/static/js/main.ebc4ff4f.js\"\n><\/script>\n\n\n\n# output.assetsRetry\n\n * Type: Object\n\noutput.assetsRetry 用于配置资源加载失败时的重试逻辑。配置类型如下:\n\nexport type AssetsRetryHookContext = {\n  times: number;\n  domain: string;\n  url: string;\n  tagName: string;\n};\n\nexport type AssetsRetryOptions = {\n  type?: string[];\n  domain?: string[];\n  max?: number;\n  test?: string | ((url: string) => boolean);\n  crossOrigin?: boolean;\n  onRetry?: (options: AssetsRetryHookContext) => void;\n  onSuccess?: (options: AssetsRetryHookContext) => void;\n  onFail?: (options: AssetsRetryHookContext) => void;\n};\n\n\n默认值如下:\n\nexport const defaultAssetsRetryOptions: AssetsRetryOptions = {\n  type: ['script', 'link', 'img'],\n  domain: [],\n  max: 3,\n  test: '',\n  crossOrigin: false,\n  onRetry: () => {},\n  onSuccess: () => {},\n  onFail: () => {},\n};\n\n\n\n# assetsRetry.max\n\n * Type: number\n * Default: 3\n\n单个资源的最大重试次数。比如：\n\nexport default {\n  output: {\n    assetsRetry: {\n      max: 3,\n    },\n  },\n};\n\n\n\n# assetsRetry.domain\n\n * Type: string[]\n * Default: []\n\n指定资源加载失败时的重试域名，如果为空则使用当前页面的域名。比如：\n\nexport default {\n  output: {\n    assetsRetry: {\n      domain: ['https://cdn1.example.com', 'https://cdn2.example.com'],\n    },\n  },\n};\n\n\n\n# assetsRetry.type\n\n * Type: string[]\n * Default: ['script', 'link', 'img']\n\n可重试的资源类型。比如：\n\nexport default {\n  output: {\n    assetsRetry: {\n      type: ['script', 'link'],\n    },\n  },\n};\n\n\n\n# assetsRetry.test\n\n * Type: string | ((url: string) => boolean) | undefined\n * Default: undefined\n\n匹配资源 URL 的正则表达式或函数，默认匹配所有资源。比如：\n\nexport default {\n  output: {\n    assetsRetry: {\n      test: /cdn\\.example\\.com/,\n    },\n  },\n};\n\n\n\n# assetsRetry.crossOrigin\n\n * Type: undefined | boolean\n * Default: false\n\n用于向 <script> 资源标签中注入 crossorigin 属性，传入 true 则会启用默认值 anonymous。比如：\n\nexport default {\n  output: {\n    assetsRetry: {\n      crossOrigin: true,\n    },\n  },\n};\n\n\n\n# assetsRetry.onRetry\n\n * Type: undefined | (options: AssetsRetryHookContext) => void\n\n资源重试时的回调函数。比如：\n\nexport default {\n  output: {\n    assetsRetry: {\n      onRetry: ({ times, domain, url, tagName }) => {\n        console.log(\n          `Retry ${times} times, domain: ${domain}, url: ${url}, tagName: ${tagName}`,\n        );\n      },\n    },\n  },\n};\n\n\n\n# assetsRetry.onSuccess\n\n * Type: undefined | (options: AssetsRetryHookContext) => void\n\n资源重试成功时的回调函数。比如：\n\nexport default {\n  output: {\n    assetsRetry: {\n      onSuccess: ({ times, domain, url, tagName }) => {\n        console.log(\n          `Retry ${times} times, domain: ${domain}, url: ${url}, tagName: ${tagName}`,\n        );\n      },\n    },\n  },\n};\n\n\n\n# assetsRetry.onFail\n\n * Type: undefined | (options: AssetsRetryHookContext) => void\n\n资源重试超过最大重试次数时的回调函数。比如：\n\nexport default {\n  output: {\n    assetsRetry: {\n      onFail: ({ times, domain, url, tagName }) => {\n        console.log(\n          `Retry ${times} times, domain: ${domain}, url: ${url}, tagName: ${tagName}`,\n        );\n      },\n    },\n  },\n};\n\n\n\n# output.charset\n\n * Type: 'ascii' | 'utf8'\n * Default: 'ascii'\n\n默认情况下，Builder 的产物内容是纯 ASCII 的，并且会转义所有非 ASCII 字符。\n\n如果不希望进行转义，而是输出所有原始字符，可以将 output.charset 设置为 utf8。\n\nexport default {\n  output: {\n    charset: 'utf8',\n  },\n};\n\n\n当 output.charset 为 utf8 时，Builder 会自动将 <meta charset=\"utf-8\"> 添加到生成的 HTML 文件中。\n\n\n# output.cleanDistPath\n\n * Type: boolean\n * Default: true\n\n是否在构建开始前清理 dist 目录下的所有文件。\n\n默认情况下，Builder 会自动清理 dist 目录下的文件，你可以把 cleanDistPath 设置为 false 来禁用该行为。\n\nexport default {\n  output: {\n    cleanDistPath: false,\n  },\n};\n\n\n\n# output.convertToRem\n\n * Type: boolean | object\n * Default: false\n\n通过设置 output.convertToRem，Builder 可进行如下处理：\n\n * 将 CSS 中的 px 转成 rem\n * 在 HTML 模版中插入运行时代码，对根元素 fontSize 进行设置\n\n# Boolean 类型\n\n当设置 output.convertToRem 为 true，将开启 rem 处理能力。\n\nexport default {\n  output: {\n    convertToRem: true,\n  },\n};\n\n\n此时，rem 配置默认如下：\n\n{\n  enableRuntime: true,\n  rootFontSize: 50,\n  screenWidth: 375,\n  rootFontSize: 50,\n  maxRootFontSize: 64,\n  widthQueryKey: '',\n  excludeEntries: [],\n  supportLandscape: false,\n  useRootFontSizeBeyondMax: false,\n  pxtorem: {\n    rootValue: 50,\n    unitPrecision: 5,\n    propList: ['*'],\n  }\n}\n\n\n# Object 类型\n\n当 output.convertToRem 的值为 object 类型时，Builder 会根据当前配置进行 rem 处理。\n\n选项：\n\n名称                         类型         默认值                                描述\nenableRuntime              boolean    true                               开启 HTML 模版插入功能，动态计算根元素字体大小\nrootFontSize               number     50                                 根元素字体值\nmaxRootFontSize            number     64                                 最大根元素字体值\nwidthQueryKey              string     ''                                 根据 widthQueryKey 的值去 url query 中取 client width\nscreenWidth                number     375                                UI 设计图宽度\nexcludeEntries             string[]   []                                 不进行调整的页面入口\nsupportLandscape           boolean    false                              横屏时使用 height 计算 rem\nuseRootFontSizeBeyondMax   boolean    false                              超过 maxRootFontSize 时，是否使用 rootFontSize\npxtorem                    object      * rootValue。默认与 rootFontSize 相同   postcss-pxtorem 插件属性\n                                       * unitPrecision: 5。精确位数\n                                       * propList: ['*']。支持转换的 CSS 属性\n\n# 示例\n\nexport default {\n  output: {\n    convertToRem: {\n      rootFontSize: 30,\n      excludeEntries: ['404', 'page2'],\n      pxtorem: {\n        propList: ['font-size'],\n      },\n    },\n  },\n};\n\n\n\n# output.copy\n\n * Type: CopyPluginOptions | CopyPluginOptions['patterns']\n * Default: undefined\n\n将指定的文件或目录拷贝到构建输出目录中。\n\n例如，将 src/assets 下的文件直接拷贝到 dist 目录：\n\nexport default {\n  output: {\n    copy: [{ from: './src/assets', to: '' }],\n  },\n};\n\n\n更详细的配置项请参考：copy-webpack-plugin 文档。\n\n\n# output.cssModuleLocalIdentName\n\n * Type: string\n * Default:\n\n// isProd 表示生产环境构建\nconst localIdentName = isProd\n  ? '[hash:base64:5]'\n  : '[path][name]__[local]--[hash:base64:5]';\n\n\n设置 CSS Modules 编译后生成的 className 格式。\n\n\n# 默认值\n\ncssModuleLocalIdentName 在开发环境和生产环境有不同的默认值。\n\n在生产环境，Builder 会生成更简短的类名，从而减少构建产物的体积。\n\nimport styles from './index.module.scss';\n\n// 在开发环境下，值为 `.src-index-module__header--xxxxx`\n// 在生产环境下，值为 `.xxxxx`\nconsole.log(styles.header);\n\n\n\n# 模板字符串\n\n在 cssModuleLocalIdentName 中，你可以使用以下模板字符串：\n\n * [name] - 源文件名称。\n * [local] - 原始类名。\n * [hash] - 字符串的哈希值。\n * [folder] - 文件夹的相对路径。\n * [path] - 源文件的相对路径。\n * [file] - 文件名和路径。\n * [ext] - 文件后缀名，包含点号。\n * [hash:<hashDigest>:<hashDigestLength>] - 带有哈希设置的哈希。\n\n\n# 示例\n\n将 cssModuleLocalIdentName 设置为其他值：\n\nexport default {\n  output: {\n    cssModuleLocalIdentName: '[hash:base64:4]',\n  },\n};\n\n\n\n# output.dataUriLimit\n\n * Type\n\ntype DataUriLimitConfig = {\n  svg?: number;\n  font?: number;\n  image?: number;\n  media?: number;\n};\n\n\n * Default\n\nconst defaultDatUriLimit = {\n  svg: 10000,\n  font: 10000,\n  image: 10000,\n  media: 10000,\n};\n\n\n设置图片、字体、媒体等静态资源被自动内联为 base64 的体积阈值。\n\n默认情况下，体积小于 10KB 的图片、字体、媒体等文件，会自动经过 Base64 编码，内联到页面中，不再会发送独立的 HTTP 请求。\n\n你可以通过修改 dataUriLimit 参数来调整这个阈值。\n\n其中：\n\n * svg：表示 SVG 图片的体积阈值。\n * font：表示字体文件的体积阈值。\n * image：表示非 SVG 图片的体积阈值。\n * media：表示视频等媒体资源的体积阈值。\n\n# 示例\n\n修改图片资源的阈值为 5000 Bytes，设置视频资源不内联：\n\nexport default {\n  output: {\n    dataUriLimit: {\n      image: 5000,\n      media: Infinite,\n    },\n  },\n};\n\n\n\n# output.disableCssExtract\n\n * Type: boolean\n * Default: false\n\n是否禁用 CSS 提取逻辑，并将 CSS 文件内联到 JS 文件中。\n\n默认情况下，Builder 会把 CSS 提取为独立的 .css 文件，并输出到构建产物目录。设置该选项为 true 后，CSS 文件会被内联到 JS 文件中，并在运行时通过 <style> 标签插入到页面上。\n\n\n# 示例\n\nexport default {\n  output: {\n    disableCssExtract: true,\n  },\n};\n\n\n\n# output.disableCssModuleExtension\n\n * Type: boolean\n * Default: false\n\n是否将源码目录下的所有样式文件当做 CSS Modules 模块进行处理。\n\n在默认情况下，只有 *.module.css 结尾的文件才被视为 CSS Modules 模块。开启该配置项之后，会将源码目录下的所有 *.css 样式文件当做 CSS Modules 模块。\n\n.sass、.scss 和 .less 文件的处理规则与 .css 文件一致，也会受到 disableCssModuleExtension 的影响。\n\nTIP\n\n我们不推荐开启此配置项，因为开启 disableCssModuleExtension 后，CSS Modules 文件和普通 CSS 文件无法得到明确的区分，不利于长期维护。\n\n\n# 示例\n\nexport default {\n  output: {\n    disableCssModuleExtension: true,\n  },\n};\n\n\n\n# 规则\n\n以下是对 CSS Modules 判断规则的详细解释：\n\n# 未开启 disableCssModuleExtension（默认）\n\n以下文件会视为 CSS Modules：\n\n * 所有 *.module.css 文件\n\n以下文件会视为普通 CSS：\n\n * 所有 *.css 文件（不含 .module）\n * 所有 *.global.css 文件\n\n# 开启 disableCssModuleExtension\n\n以下文件会视为 CSS Modules：\n\n * 源码目录下的 *.css 和 *.module.css 文件\n * node_modules 下的 *.module.css 文件\n\n以下文件会视为普通 CSS：\n\n * 所有 *.global.css 文件\n * node_modules 下的 *.css 文件（不含 .module）\n\nTIP\n\n对于 node_modules 中的 CSS Modules 文件，请始终使用 *.module.css 后缀。\n\n\n# output.distPath\n\n * Type\n\ntype DistPathConfig = {\n  root?: string;\n  js?: string;\n  css?: string;\n  svg?: string;\n  font?: string;\n  html?: string;\n  image?: string;\n  media?: string;\n  server?: string;\n};\n\n\n * Default\n\nconst defaultDistPath = {\n  root: 'dist',\n  html: 'html',\n  js: 'static/js',\n  css: 'static/css',\n  svg: 'static/svg',\n  font: 'static/font',\n  image: 'static/image',\n  media: 'static/media',\n  server: 'bundles',\n};\n\n\n设置构建产物的输出目录，Builder 会根据产物的类型输出到对应的子目录下。\n\n其中：\n\n * root: 表示所有构建产物输出的根目录。\n * html：表示 HTML 文件的输出目录。\n * js：表示 JavaScript 文件的输出目录。\n * css：表示 CSS 样式文件的输出目录。\n * svg：表示 SVG 图片的输出目录。\n * font：表示字体文件的输出目录。\n * image：表示非 SVG 图片的输出目录。\n * media：表示视频等媒体资源的输出目录。\n * server: 表示服务端产物的输出目录，仅在 target 为 node 时有效。\n\n# 示例\n\n以 JavaScript 文件为例，会输出到 distPath.root + distPath.js 目录，即为 dist/static/js。\n\n如果需要将 JavaScript 文件输出到 build/resource/js 目录，可以这样设置：\n\nexport default {\n  output: {\n    distPath: {\n      root: 'build',\n      js: 'resource/js',\n    },\n  },\n};\n\n\n\n# output.disableMinimize\n\n * Type: boolean\n * Default: false\n\n是否禁用生产环境下的代码压缩。\n\n默认情况下，JS 代码和 CSS 代码会在生产环境构建时被自动压缩。如果不希望执行代码压缩，可以将 disableMinimize 设置为 true。\n\nexport default {\n  output: {\n    disableMinimize: true,\n  },\n};\n\n\n\n# output.disableSourceMap\n\n * Type:\n\ntype DisableSourceMap =\n  | boolean\n  | {\n      js?: boolean;\n      css?: boolean;\n    };\n\n\n * Default:\n\nconst defaultDisableSourceMap = {\n  js: false,\n  css: process.env.NODE_ENV === 'production',\n};\n\n\n是否禁用 Source Map 生成。\n\n什么是 Source Map\n\nSource Map 是保存源代码映射关系的信息文件，它记录了编译后的代码的每一个位置，以及所对应的编译前的位置。通过 Source Map，可以在调试编译后的代码时，直接查看对应的源代码。\n\n默认情况下，Builder 的 Source Map 生成规则如下：\n\n * 在开发环境构建时，会生成 JS 文件和 CSS 文件的 SourceMap，便于进行开发调试。\n * 在生产环境构建时，会生成 JS 文件的 Source Map，用于调试和排查线上问题；不会生成 CSS 文件的 Source Map。\n\n如果项目不需要 Source Map，可以关闭该功能，从而提升构建的速度。\n\nexport default {\n  output: {\n    disableSourceMap: true,\n  },\n};\n\n\n如果需要开启开发环境的 Source Map，并在生产环境禁用，可以设置为：\n\nexport default {\n  output: {\n    disableSourceMap: process.env.NODE_ENV === 'production',\n  },\n};\n\n\n如果需要单独控制 JS 文件或 CSS 文件的 Source Map，可以参考下方设置：\n\nexport default {\n  output: {\n    disableSourceMap: {\n      js: false,\n      css: true,\n    },\n  },\n};\n\n\n\n# output.disableTsChecker\n\n * Type: boolean\n * Default: false\n\n是否禁用编译过程中的 TypeScript 类型检查。\n\n默认情况下，Builder 执行构建的过程中，会在一个独立的进程里运行 TypeScript 类型检查工具，它的检查逻辑与 TypeScript 原生的 tsc 命令一致，你可以通过 tsconfig.json 或是 Builder 的 tools.tsChecker 配置项来自定义检查行为。\n\n\n# 阻塞编译\n\n * 在开发环境构建时，类型错误不会阻塞编译流程。\n * 在生产环境构建时，类型错误会导致构建失败，以保证生产环境代码的稳定性。\n\n\n# 示例\n\n禁用 TypeScript 类型检查：\n\nexport default {\n  output: {\n    disableTsChecker: true,\n  },\n};\n\n\n禁用开发环境构建时的类型检查：\n\nexport default {\n  output: {\n    disableTsChecker: process.env.NODE_ENV === 'development',\n  },\n};\n\n\n禁用生产环境构建时的类型检查：\n\nexport default {\n  output: {\n    disableTsChecker: process.env.NODE_ENV === 'production',\n  },\n};\n\n\nTIP\n\n不建议在生产环境构建时禁用类型检查，这会导致线上代码的稳定性下降，请谨慎使用。\n\n\n# output.disableFilenameHash\n\n * Type: boolean\n * Default: false\n\n移除生产环境的构建产物名称中的 hash 值。\n\n在生产环境构建后，会自动在文件名中间添加 hash 值，如果不需要添加，可以通过 output.disableFilenameHash 配置来禁用该行为。\n\n# 示例\n\n默认情况下，构建后的产物名称为：\n\nFile                                     Size         Gzipped\ndist/static/css/187.7879e19d.css         126.99 KB    9.17 KB\ndist/static/js/main.18a568e5.js          2.24 KB      922 B\n\n\n添加 output.disableFilenameHash 配置：\n\nexport default {\n  output: {\n    disableFilenameHash: true,\n  },\n};\n\n\n重新构建，产物的名称变为：\n\nFile                            Size         Gzipped\ndist/static/css/187.css         126.99 KB    9.17 KB\ndist/static/js/main.js          2.24 KB      922 B\n\n\n\n# output.disableInlineRuntimeChunk\n\n * Type: boolean\n * Default: false\n\n用于控制是否内联 runtimeChunk 到 HTML 中。\n\n在生产环境下，runtime chunk 文件将会默认被内联到 HTML 文件中，而不是写到产物目录中，这样可以减少文件请求的数量。\n\n这个选项用来关闭这个默认行为。\n\nexport default {\n  output: {\n    disableInlineRuntimeChunk: true,\n  },\n};\n\n\n\n# output.enableAssetManifest\n\n * Type: boolean\n * Default: false\n\n是否生成 manifest 文件，该文件包含所有构建产物的信息。\n\n# 示例\n\n添加以下配置来开启：\n\nexport default {\n  output: {\n    enableAssetManifest: true,\n  },\n};\n\n\n开启后，当编译完成时，会自动生成 dist/manifest.json 文件：\n\n{\n  \"files\": {\n    \"main.css\": \"/static/css/main.45b01211.css\",\n    \"main.js\": \"/static/js/main.52fd298f.js\",\n    \"html/main/index.html\": \"/html/main/index.html\"\n  },\n  \"entrypoints\": [\"static/css/main.45b01211.css\", \"static/js/main.52fd298f.js\"]\n}\n\n\n\n# output.enableAssetFallback\n\n * Type: boolean\n * Default: false\n\n开启该选项后，当编译过程中遇到无法识别的文件类型时，会直接将该文件直接输出到产物目录；否则会抛出一个异常。\n\n# 示例\n\n开启配置项：\n\nexport default {\n  output: {\n    enableAssetFallback: true,\n  },\n};\n\n\n在代码中引用一个未知类型的模块：\n\nimport './foo.xxx';\n\n\n编译后，foo.xxx 会被自动输出到 dist/static/media 目录下。\n\n你可以通过 output.distPath.media 和 output.filename.media 配置项来控制 fallback 后的输出路径和文件名称。\n\nTIP\n\n开启该配置会导致 webpack 配置中的 rules 结构变化，增加一层额外的 oneOf 嵌套结构。大多数情况下，我们不推荐你使用此配置。\n\n\n# output.enableLatestDecorators\n\n * Type: boolean\n * Default: false\n\n是否要使用新版 decorator 提案 进行编译。\n\n默认情况下，Builder 在编译装饰器时采用旧版 decorator 提案。\n\n将 output.enableLatestDecorators 设置为 true 时，Builder 会采用新版 decorator 提案 (2018-09 版本) 进行编译。\n\nexport default {\n  output: {\n    enableLatestDecorators: true,\n  },\n};\n\n\n\n# output.enableCssModuleTSDeclaration\n\n * Type: boolean\n * Default: false\n\n是否生成 CSS Modules 的 TypeScript 声明文件。\n\n# Example\n\n启用 CSS Module TypeScript 声明，比如：\n\nexport default {\n  output: {\n    enableCssModuleTSDeclaration: true,\n  },\n};\n\n\n项目构建完成后，每个 CSS Module 文件都会生成一个 .d.ts 文件。例如：\n\ninterface CssExports {\n  title: string;\n}\nexport const cssExports: CssExports;\nexport default cssExports;\n\n\n\n# output.enableInlineScripts\n\n * Type: boolean\n * Default: false\n\n用来控制生产环境中是否用 <script> 标签将产物中的 script 文件（.js 文件）inline 到 HTML 中。\n\n注意，如果开启了这个选项，那么 script 文件将不会被写入产物目录中，而只会以 inline 脚本的形式存在于 HTML 文件中。\n\n# 示例\n\n默认情况下，我们有这样的产物文件：\n\ndist/html/main/index.html\ndist/static/css/style.css\ndist/static/js/main.js\n\n\n开启 output.enableInlineScripts 选项后：\n\nexport default {\n  output: {\n    enableInlineScripts: true,\n  },\n};\n\n\n产物文件将变成：\n\ndist/html/main/index.html\ndist/static/css/style.css\n\n\n同时，dist/static/js/main.js 文件将被 inline 到 index.html 中：\n\n<html>\n  <body>\n    <script>\n      // content of dist/static/js/main.js\n    <\/script>\n  </body>\n</html>\n\n\n\n# output.enableInlineStyles\n\n * Type: boolean\n * Default: false\n\n用来控制生产环境中是否用 <style> 标签将产物中的 style 文件（.css 文件）inline 到 HTML 中。\n\n注意，如果开启了这个选项，那么 style 文件将不会被写入产物目录中，而只会以 inline 样式的形式存在于 HTML 文件中。\n\n# 示例\n\n默认情况下，我们有这样的产物文件：\n\ndist/html/main/index.html\ndist/static/css/style.css\ndist/static/js/main.js\n\n\n开启 output.enableInlineStyles 选项后：\n\nexport default {\n  output: {\n    enableInlineStyles: true,\n  },\n};\n\n\n产物文件将变成：\n\ndist/html/main/index.html\ndist/static/js/main.js\n\n\n同时，dist/static/css/style.css 文件将被 inline 到 index.html 中：\n\n<html>\n  <head>\n    <style>\n      /* content of dist/static/css/style.css */\n    </style>\n  </head>\n  <body>\n  </body>\n</html>\n\n\n\n# output.externals\n\n * Type : string | object | function | RegExp\n * Default: undefined\n\n在构建时，防止将代码中某些 import 的依赖包打包到 bundle 中，而是在运行时再去从外部获取这些依赖。\n\n详情请见: webpack 外部扩展 (Externals)\n\n# 示例\n\n将 react-dom 依赖从构建产物中剔除。为了在运行时获取这个模块, react-dom 的值将全局检索 ReactDOM 变量。\n\nexport default {\n  output: {\n    externals: {\n      'react-dom': 'ReactDOM',\n    },\n  },\n};\n\n\nTIP\n\n当构建 Web Worker 产物时，externals 将不会生效。这是因为 Worker 环境不支持通过访问全局变量。\n\n\n# output.filename\n\n * Type\n\ntype FilenameConfig = {\n  js?: string;\n  css?: string;\n  svg?: string;\n  font?: string;\n  image?: string;\n  media?: string;\n};\n\n\n * Default\n\n// 开发环境\nconst devDefaultFilename = {\n  js: '[name].js',\n  css: '[name].css',\n  svg: '[name].[contenthash:8].svg',\n  font: '[name].[contenthash:8][ext]',\n  image: '[name].[contenthash:8][ext]',\n  media: '[name].[contenthash:8][ext]',\n};\n\n// 生产环境\nconst prodDefaultFilename = {\n  js: '[name].[contenthash:8].js',\n  css: '[name].[contenthash:8].css',\n  svg: '[name].[contenthash:8].svg',\n  font: '[name].[contenthash:8][ext]',\n  image: '[name].[contenthash:8][ext]',\n  media: '[name].[contenthash:8][ext]',\n};\n\n\n设置构建产物的名称。\n\n在生产环境构建后，会自动在文件名中间添加 hash 值，如果不需要添加，可以通过 output.disableFilenameHash 配置来禁用该行为。\n\n其中：\n\n * js：表示 JavaScript 文件的名称。\n * css：表示 CSS 样式文件的名称。\n * svg：表示 SVG 图片的名称。\n * font：表示字体文件的名称。\n * image：表示非 SVG 图片的名称。\n * media：表示视频等媒体资源的名称。\n\n# 示例\n\n修改 JavaScript 文件的名称为 [name]_script.js：\n\nexport default {\n  output: {\n    filename: {\n      js:\n        process.env.NODE_ENV === 'production'\n          ? '[name]_script.[contenthash:8].js'\n          : '[name]_script.js',\n    },\n  },\n};\n\n\n\n# output.legalComments\n\n * Type : 'linked' | 'inline' | 'none'\n * Default: 'linked'\n\n配置 legal comment 的处理方式。\n\nlegal comment 是 JS 或 CSS 文件中的一些特殊注释，这些注释包含 @license 或 @preserve，或是以 //! 开头。默认情况下，这些注释保留在输出文件中，因为这遵循了代码原作者的意图。\n\n你可以通过 legalComments 来配置相关行为：\n\n * linked：将所有 legal comments 移至 .LEGAL.txt 文件并通过注释链接到它们。\n * inline：保留所有 legal comments。\n * none：移除所有 legal comments。\n\n# 示例\n\n移除所有 legal comments。\n\nexport default {\n  output: {\n    legalComments: 'none',\n  },\n};\n\n\n\n# output.overrideBrowserslist\n\n * Type: string[] | Record<BuilderTarget, string[]>\n * Default: undefined\n\n指定项目兼容的目标浏览器范围。该值会被 @babel/preset-env 和 autoprefixer 用来确定需要转换的 JavaScript 语法特性和需要添加的 CSS 浏览器前缀。\n\n# 优先级\n\noverrideBrowserslist 配置的优先级高于项目中的 .browserslistrc 配置文件和 package.json 中的 browserslist 字段。\n\n大多数场景下，推荐优先使用 .browserslistrc 文件，而不是使用 overrideBrowserslist 配置。因为 .browserslistrc 文件是官方定义的配置文件，通用性更强，可以被社区中的其他库识别。\n\n# 默认值\n\n如果项目中没有定义任何 browserslist 相关的配置，也没有定义 overrideBrowserslist，那么 Builder 会设置默认值为：\n\n['> 0.01%', 'not dead', 'not op_mini all'];\n\n\n# 示例\n\n下面是兼容移动端 H5 场景的示例：\n\nexport default {\n  output: {\n    overrideBrowserslist: [\n      'iOS 9',\n      'Android 4.4',\n      'last 2 versions',\n      '> 0.2%',\n      'not dead',\n    ],\n  },\n};\n\n\n可以查看 browserslist 文档 来了解如何自定义浏览器范围。\n\n# 根据产物类型设置\n\n当你同时构建多种类型的产物时，你可以为不同的产物类型设置不同的目标浏览器范围。此时，你需要把 overrideBrowserslist 设置为一个对象，对象的 key 为对应的产物类型。\n\n比如为 web 和 node 设置不同的范围：\n\nexport default {\n  output: {\n    overrideBrowserslist: {\n      web: ['iOS 9', 'Android 4.4', 'last 2 versions', '> 0.2%', 'not dead'],\n      node: ['node >= 14'],\n    },\n  },\n};\n\n\n\n# output.polyfill\n\n * Type: 'entry' | 'usage' | 'ua' | 'off'\n * Default: 'entry'\n\n通过 output.polyfill 你可以配置 Polyfill 的注入方式。\n\n\n# 配置项\n\n# entry\n\n当 output.polyfill 配置为 'entry' 时，会在每个入口文件中注入 Polyfill。\n\n等价于 @babel/preset-env 的 useBuiltIns: 'entry' 配置。\n\n# usage\n\n当 output.polyfill 配置为 'usage' 时，会在每个文件中根据代码中使用的 API 注入 Polyfill。\n\n等价于 @babel/preset-env 的 useBuiltIns: 'usage' 配置。\n\n# ua\n\n根据当前请求的 UA 信息，动态下发 Polyfill 代码。\n\n# off\n\n不注入 Polyfill。使用此选项时，需要自行保证代码的兼容性。\n\n\n# output.svgDefaultExport\n\n * Type: url | component\n * Default: url\n\noutput.svgDefaultExport 可以用来配置 SVG 文件的默认导出。\n\n当 output.svgDefaultExport 配置为 url 时，SVG 文件的默认导出是文件的 URL。例如：\n\nimport logo from './logo.svg';\n\nconsole.log(logo); // => 资源 url\n\n\n当 output.svgDefaultExport 配置为 component 时，SVG 文件的默认导出是文件的 React 组件。例如：\n\nimport Logo from './logo.svg';\n\nconsole.log(Logo); // => React 组件\n\n\n此时，你也可以通过指定 ?url 的 query 来导入 url，比如：\n\nimport logo from './logo.svg?url';\n\nconsole.log(logo); // => 资源 url\n",normalizedContent:"# output config\n\n本章节描述了 builder 中与构建产物有关的配置。\n\n\n# output.assetprefix\n\n * type: boolean | string\n * default: '/'\n\n在生产环境使用 cdn 部署时，可使用该选项设置静态资源的 url 前缀，对应 webpack 的 output.publicpath 配置。\n\nassetprefix 会影响构建产物中绝大部分静态资源的 url，包括 javascript 文件、css 文件、图片、视频等。如果指定了一个错误的值，则在加载这些资源时可能会出现 404 错误。\n\n该配置项仅用于生产环境。在开发环境下，请使用 dev.assetprefix 配置项进行设置。\n\n设置后，项目的 javascript、css、图片等静态资源的 url 都会加上 output.assetprefix 作为前缀：\n\n# 示例\n\nexport default {\n  output: {\n    assetprefix: 'https://cdn.example.com/assets/',\n  },\n};\n\n\n构建之后，可以看到 js 文件从以下地址加载：\n\n<script\n  defer\n  src=\"https://cdn.example.com/assets/static/js/main.ebc4ff4f.js\"\n><\/script>\n\n\n\n# output.assetsretry\n\n * type: object\n\noutput.assetsretry 用于配置资源加载失败时的重试逻辑。配置类型如下:\n\nexport type assetsretryhookcontext = {\n  times: number;\n  domain: string;\n  url: string;\n  tagname: string;\n};\n\nexport type assetsretryoptions = {\n  type?: string[];\n  domain?: string[];\n  max?: number;\n  test?: string | ((url: string) => boolean);\n  crossorigin?: boolean;\n  onretry?: (options: assetsretryhookcontext) => void;\n  onsuccess?: (options: assetsretryhookcontext) => void;\n  onfail?: (options: assetsretryhookcontext) => void;\n};\n\n\n默认值如下:\n\nexport const defaultassetsretryoptions: assetsretryoptions = {\n  type: ['script', 'link', 'img'],\n  domain: [],\n  max: 3,\n  test: '',\n  crossorigin: false,\n  onretry: () => {},\n  onsuccess: () => {},\n  onfail: () => {},\n};\n\n\n\n# assetsretry.max\n\n * type: number\n * default: 3\n\n单个资源的最大重试次数。比如：\n\nexport default {\n  output: {\n    assetsretry: {\n      max: 3,\n    },\n  },\n};\n\n\n\n# assetsretry.domain\n\n * type: string[]\n * default: []\n\n指定资源加载失败时的重试域名，如果为空则使用当前页面的域名。比如：\n\nexport default {\n  output: {\n    assetsretry: {\n      domain: ['https://cdn1.example.com', 'https://cdn2.example.com'],\n    },\n  },\n};\n\n\n\n# assetsretry.type\n\n * type: string[]\n * default: ['script', 'link', 'img']\n\n可重试的资源类型。比如：\n\nexport default {\n  output: {\n    assetsretry: {\n      type: ['script', 'link'],\n    },\n  },\n};\n\n\n\n# assetsretry.test\n\n * type: string | ((url: string) => boolean) | undefined\n * default: undefined\n\n匹配资源 url 的正则表达式或函数，默认匹配所有资源。比如：\n\nexport default {\n  output: {\n    assetsretry: {\n      test: /cdn\\.example\\.com/,\n    },\n  },\n};\n\n\n\n# assetsretry.crossorigin\n\n * type: undefined | boolean\n * default: false\n\n用于向 <script> 资源标签中注入 crossorigin 属性，传入 true 则会启用默认值 anonymous。比如：\n\nexport default {\n  output: {\n    assetsretry: {\n      crossorigin: true,\n    },\n  },\n};\n\n\n\n# assetsretry.onretry\n\n * type: undefined | (options: assetsretryhookcontext) => void\n\n资源重试时的回调函数。比如：\n\nexport default {\n  output: {\n    assetsretry: {\n      onretry: ({ times, domain, url, tagname }) => {\n        console.log(\n          `retry ${times} times, domain: ${domain}, url: ${url}, tagname: ${tagname}`,\n        );\n      },\n    },\n  },\n};\n\n\n\n# assetsretry.onsuccess\n\n * type: undefined | (options: assetsretryhookcontext) => void\n\n资源重试成功时的回调函数。比如：\n\nexport default {\n  output: {\n    assetsretry: {\n      onsuccess: ({ times, domain, url, tagname }) => {\n        console.log(\n          `retry ${times} times, domain: ${domain}, url: ${url}, tagname: ${tagname}`,\n        );\n      },\n    },\n  },\n};\n\n\n\n# assetsretry.onfail\n\n * type: undefined | (options: assetsretryhookcontext) => void\n\n资源重试超过最大重试次数时的回调函数。比如：\n\nexport default {\n  output: {\n    assetsretry: {\n      onfail: ({ times, domain, url, tagname }) => {\n        console.log(\n          `retry ${times} times, domain: ${domain}, url: ${url}, tagname: ${tagname}`,\n        );\n      },\n    },\n  },\n};\n\n\n\n# output.charset\n\n * type: 'ascii' | 'utf8'\n * default: 'ascii'\n\n默认情况下，builder 的产物内容是纯 ascii 的，并且会转义所有非 ascii 字符。\n\n如果不希望进行转义，而是输出所有原始字符，可以将 output.charset 设置为 utf8。\n\nexport default {\n  output: {\n    charset: 'utf8',\n  },\n};\n\n\n当 output.charset 为 utf8 时，builder 会自动将 <meta charset=\"utf-8\"> 添加到生成的 html 文件中。\n\n\n# output.cleandistpath\n\n * type: boolean\n * default: true\n\n是否在构建开始前清理 dist 目录下的所有文件。\n\n默认情况下，builder 会自动清理 dist 目录下的文件，你可以把 cleandistpath 设置为 false 来禁用该行为。\n\nexport default {\n  output: {\n    cleandistpath: false,\n  },\n};\n\n\n\n# output.converttorem\n\n * type: boolean | object\n * default: false\n\n通过设置 output.converttorem，builder 可进行如下处理：\n\n * 将 css 中的 px 转成 rem\n * 在 html 模版中插入运行时代码，对根元素 fontsize 进行设置\n\n# boolean 类型\n\n当设置 output.converttorem 为 true，将开启 rem 处理能力。\n\nexport default {\n  output: {\n    converttorem: true,\n  },\n};\n\n\n此时，rem 配置默认如下：\n\n{\n  enableruntime: true,\n  rootfontsize: 50,\n  screenwidth: 375,\n  rootfontsize: 50,\n  maxrootfontsize: 64,\n  widthquerykey: '',\n  excludeentries: [],\n  supportlandscape: false,\n  userootfontsizebeyondmax: false,\n  pxtorem: {\n    rootvalue: 50,\n    unitprecision: 5,\n    proplist: ['*'],\n  }\n}\n\n\n# object 类型\n\n当 output.converttorem 的值为 object 类型时，builder 会根据当前配置进行 rem 处理。\n\n选项：\n\n名称                         类型         默认值                                描述\nenableruntime              boolean    true                               开启 html 模版插入功能，动态计算根元素字体大小\nrootfontsize               number     50                                 根元素字体值\nmaxrootfontsize            number     64                                 最大根元素字体值\nwidthquerykey              string     ''                                 根据 widthquerykey 的值去 url query 中取 client width\nscreenwidth                number     375                                ui 设计图宽度\nexcludeentries             string[]   []                                 不进行调整的页面入口\nsupportlandscape           boolean    false                              横屏时使用 height 计算 rem\nuserootfontsizebeyondmax   boolean    false                              超过 maxrootfontsize 时，是否使用 rootfontsize\npxtorem                    object      * rootvalue。默认与 rootfontsize 相同   postcss-pxtorem 插件属性\n                                       * unitprecision: 5。精确位数\n                                       * proplist: ['*']。支持转换的 css 属性\n\n# 示例\n\nexport default {\n  output: {\n    converttorem: {\n      rootfontsize: 30,\n      excludeentries: ['404', 'page2'],\n      pxtorem: {\n        proplist: ['font-size'],\n      },\n    },\n  },\n};\n\n\n\n# output.copy\n\n * type: copypluginoptions | copypluginoptions['patterns']\n * default: undefined\n\n将指定的文件或目录拷贝到构建输出目录中。\n\n例如，将 src/assets 下的文件直接拷贝到 dist 目录：\n\nexport default {\n  output: {\n    copy: [{ from: './src/assets', to: '' }],\n  },\n};\n\n\n更详细的配置项请参考：copy-webpack-plugin 文档。\n\n\n# output.cssmodulelocalidentname\n\n * type: string\n * default:\n\n// isprod 表示生产环境构建\nconst localidentname = isprod\n  ? '[hash:base64:5]'\n  : '[path][name]__[local]--[hash:base64:5]';\n\n\n设置 css modules 编译后生成的 classname 格式。\n\n\n# 默认值\n\ncssmodulelocalidentname 在开发环境和生产环境有不同的默认值。\n\n在生产环境，builder 会生成更简短的类名，从而减少构建产物的体积。\n\nimport styles from './index.module.scss';\n\n// 在开发环境下，值为 `.src-index-module__header--xxxxx`\n// 在生产环境下，值为 `.xxxxx`\nconsole.log(styles.header);\n\n\n\n# 模板字符串\n\n在 cssmodulelocalidentname 中，你可以使用以下模板字符串：\n\n * [name] - 源文件名称。\n * [local] - 原始类名。\n * [hash] - 字符串的哈希值。\n * [folder] - 文件夹的相对路径。\n * [path] - 源文件的相对路径。\n * [file] - 文件名和路径。\n * [ext] - 文件后缀名，包含点号。\n * [hash:<hashdigest>:<hashdigestlength>] - 带有哈希设置的哈希。\n\n\n# 示例\n\n将 cssmodulelocalidentname 设置为其他值：\n\nexport default {\n  output: {\n    cssmodulelocalidentname: '[hash:base64:4]',\n  },\n};\n\n\n\n# output.dataurilimit\n\n * type\n\ntype dataurilimitconfig = {\n  svg?: number;\n  font?: number;\n  image?: number;\n  media?: number;\n};\n\n\n * default\n\nconst defaultdaturilimit = {\n  svg: 10000,\n  font: 10000,\n  image: 10000,\n  media: 10000,\n};\n\n\n设置图片、字体、媒体等静态资源被自动内联为 base64 的体积阈值。\n\n默认情况下，体积小于 10kb 的图片、字体、媒体等文件，会自动经过 base64 编码，内联到页面中，不再会发送独立的 http 请求。\n\n你可以通过修改 dataurilimit 参数来调整这个阈值。\n\n其中：\n\n * svg：表示 svg 图片的体积阈值。\n * font：表示字体文件的体积阈值。\n * image：表示非 svg 图片的体积阈值。\n * media：表示视频等媒体资源的体积阈值。\n\n# 示例\n\n修改图片资源的阈值为 5000 bytes，设置视频资源不内联：\n\nexport default {\n  output: {\n    dataurilimit: {\n      image: 5000,\n      media: infinite,\n    },\n  },\n};\n\n\n\n# output.disablecssextract\n\n * type: boolean\n * default: false\n\n是否禁用 css 提取逻辑，并将 css 文件内联到 js 文件中。\n\n默认情况下，builder 会把 css 提取为独立的 .css 文件，并输出到构建产物目录。设置该选项为 true 后，css 文件会被内联到 js 文件中，并在运行时通过 <style> 标签插入到页面上。\n\n\n# 示例\n\nexport default {\n  output: {\n    disablecssextract: true,\n  },\n};\n\n\n\n# output.disablecssmoduleextension\n\n * type: boolean\n * default: false\n\n是否将源码目录下的所有样式文件当做 css modules 模块进行处理。\n\n在默认情况下，只有 *.module.css 结尾的文件才被视为 css modules 模块。开启该配置项之后，会将源码目录下的所有 *.css 样式文件当做 css modules 模块。\n\n.sass、.scss 和 .less 文件的处理规则与 .css 文件一致，也会受到 disablecssmoduleextension 的影响。\n\ntip\n\n我们不推荐开启此配置项，因为开启 disablecssmoduleextension 后，css modules 文件和普通 css 文件无法得到明确的区分，不利于长期维护。\n\n\n# 示例\n\nexport default {\n  output: {\n    disablecssmoduleextension: true,\n  },\n};\n\n\n\n# 规则\n\n以下是对 css modules 判断规则的详细解释：\n\n# 未开启 disablecssmoduleextension（默认）\n\n以下文件会视为 css modules：\n\n * 所有 *.module.css 文件\n\n以下文件会视为普通 css：\n\n * 所有 *.css 文件（不含 .module）\n * 所有 *.global.css 文件\n\n# 开启 disablecssmoduleextension\n\n以下文件会视为 css modules：\n\n * 源码目录下的 *.css 和 *.module.css 文件\n * node_modules 下的 *.module.css 文件\n\n以下文件会视为普通 css：\n\n * 所有 *.global.css 文件\n * node_modules 下的 *.css 文件（不含 .module）\n\ntip\n\n对于 node_modules 中的 css modules 文件，请始终使用 *.module.css 后缀。\n\n\n# output.distpath\n\n * type\n\ntype distpathconfig = {\n  root?: string;\n  js?: string;\n  css?: string;\n  svg?: string;\n  font?: string;\n  html?: string;\n  image?: string;\n  media?: string;\n  server?: string;\n};\n\n\n * default\n\nconst defaultdistpath = {\n  root: 'dist',\n  html: 'html',\n  js: 'static/js',\n  css: 'static/css',\n  svg: 'static/svg',\n  font: 'static/font',\n  image: 'static/image',\n  media: 'static/media',\n  server: 'bundles',\n};\n\n\n设置构建产物的输出目录，builder 会根据产物的类型输出到对应的子目录下。\n\n其中：\n\n * root: 表示所有构建产物输出的根目录。\n * html：表示 html 文件的输出目录。\n * js：表示 javascript 文件的输出目录。\n * css：表示 css 样式文件的输出目录。\n * svg：表示 svg 图片的输出目录。\n * font：表示字体文件的输出目录。\n * image：表示非 svg 图片的输出目录。\n * media：表示视频等媒体资源的输出目录。\n * server: 表示服务端产物的输出目录，仅在 target 为 node 时有效。\n\n# 示例\n\n以 javascript 文件为例，会输出到 distpath.root + distpath.js 目录，即为 dist/static/js。\n\n如果需要将 javascript 文件输出到 build/resource/js 目录，可以这样设置：\n\nexport default {\n  output: {\n    distpath: {\n      root: 'build',\n      js: 'resource/js',\n    },\n  },\n};\n\n\n\n# output.disableminimize\n\n * type: boolean\n * default: false\n\n是否禁用生产环境下的代码压缩。\n\n默认情况下，js 代码和 css 代码会在生产环境构建时被自动压缩。如果不希望执行代码压缩，可以将 disableminimize 设置为 true。\n\nexport default {\n  output: {\n    disableminimize: true,\n  },\n};\n\n\n\n# output.disablesourcemap\n\n * type:\n\ntype disablesourcemap =\n  | boolean\n  | {\n      js?: boolean;\n      css?: boolean;\n    };\n\n\n * default:\n\nconst defaultdisablesourcemap = {\n  js: false,\n  css: process.env.node_env === 'production',\n};\n\n\n是否禁用 source map 生成。\n\n什么是 source map\n\nsource map 是保存源代码映射关系的信息文件，它记录了编译后的代码的每一个位置，以及所对应的编译前的位置。通过 source map，可以在调试编译后的代码时，直接查看对应的源代码。\n\n默认情况下，builder 的 source map 生成规则如下：\n\n * 在开发环境构建时，会生成 js 文件和 css 文件的 sourcemap，便于进行开发调试。\n * 在生产环境构建时，会生成 js 文件的 source map，用于调试和排查线上问题；不会生成 css 文件的 source map。\n\n如果项目不需要 source map，可以关闭该功能，从而提升构建的速度。\n\nexport default {\n  output: {\n    disablesourcemap: true,\n  },\n};\n\n\n如果需要开启开发环境的 source map，并在生产环境禁用，可以设置为：\n\nexport default {\n  output: {\n    disablesourcemap: process.env.node_env === 'production',\n  },\n};\n\n\n如果需要单独控制 js 文件或 css 文件的 source map，可以参考下方设置：\n\nexport default {\n  output: {\n    disablesourcemap: {\n      js: false,\n      css: true,\n    },\n  },\n};\n\n\n\n# output.disabletschecker\n\n * type: boolean\n * default: false\n\n是否禁用编译过程中的 typescript 类型检查。\n\n默认情况下，builder 执行构建的过程中，会在一个独立的进程里运行 typescript 类型检查工具，它的检查逻辑与 typescript 原生的 tsc 命令一致，你可以通过 tsconfig.json 或是 builder 的 tools.tschecker 配置项来自定义检查行为。\n\n\n# 阻塞编译\n\n * 在开发环境构建时，类型错误不会阻塞编译流程。\n * 在生产环境构建时，类型错误会导致构建失败，以保证生产环境代码的稳定性。\n\n\n# 示例\n\n禁用 typescript 类型检查：\n\nexport default {\n  output: {\n    disabletschecker: true,\n  },\n};\n\n\n禁用开发环境构建时的类型检查：\n\nexport default {\n  output: {\n    disabletschecker: process.env.node_env === 'development',\n  },\n};\n\n\n禁用生产环境构建时的类型检查：\n\nexport default {\n  output: {\n    disabletschecker: process.env.node_env === 'production',\n  },\n};\n\n\ntip\n\n不建议在生产环境构建时禁用类型检查，这会导致线上代码的稳定性下降，请谨慎使用。\n\n\n# output.disablefilenamehash\n\n * type: boolean\n * default: false\n\n移除生产环境的构建产物名称中的 hash 值。\n\n在生产环境构建后，会自动在文件名中间添加 hash 值，如果不需要添加，可以通过 output.disablefilenamehash 配置来禁用该行为。\n\n# 示例\n\n默认情况下，构建后的产物名称为：\n\nfile                                     size         gzipped\ndist/static/css/187.7879e19d.css         126.99 kb    9.17 kb\ndist/static/js/main.18a568e5.js          2.24 kb      922 b\n\n\n添加 output.disablefilenamehash 配置：\n\nexport default {\n  output: {\n    disablefilenamehash: true,\n  },\n};\n\n\n重新构建，产物的名称变为：\n\nfile                            size         gzipped\ndist/static/css/187.css         126.99 kb    9.17 kb\ndist/static/js/main.js          2.24 kb      922 b\n\n\n\n# output.disableinlineruntimechunk\n\n * type: boolean\n * default: false\n\n用于控制是否内联 runtimechunk 到 html 中。\n\n在生产环境下，runtime chunk 文件将会默认被内联到 html 文件中，而不是写到产物目录中，这样可以减少文件请求的数量。\n\n这个选项用来关闭这个默认行为。\n\nexport default {\n  output: {\n    disableinlineruntimechunk: true,\n  },\n};\n\n\n\n# output.enableassetmanifest\n\n * type: boolean\n * default: false\n\n是否生成 manifest 文件，该文件包含所有构建产物的信息。\n\n# 示例\n\n添加以下配置来开启：\n\nexport default {\n  output: {\n    enableassetmanifest: true,\n  },\n};\n\n\n开启后，当编译完成时，会自动生成 dist/manifest.json 文件：\n\n{\n  \"files\": {\n    \"main.css\": \"/static/css/main.45b01211.css\",\n    \"main.js\": \"/static/js/main.52fd298f.js\",\n    \"html/main/index.html\": \"/html/main/index.html\"\n  },\n  \"entrypoints\": [\"static/css/main.45b01211.css\", \"static/js/main.52fd298f.js\"]\n}\n\n\n\n# output.enableassetfallback\n\n * type: boolean\n * default: false\n\n开启该选项后，当编译过程中遇到无法识别的文件类型时，会直接将该文件直接输出到产物目录；否则会抛出一个异常。\n\n# 示例\n\n开启配置项：\n\nexport default {\n  output: {\n    enableassetfallback: true,\n  },\n};\n\n\n在代码中引用一个未知类型的模块：\n\nimport './foo.xxx';\n\n\n编译后，foo.xxx 会被自动输出到 dist/static/media 目录下。\n\n你可以通过 output.distpath.media 和 output.filename.media 配置项来控制 fallback 后的输出路径和文件名称。\n\ntip\n\n开启该配置会导致 webpack 配置中的 rules 结构变化，增加一层额外的 oneof 嵌套结构。大多数情况下，我们不推荐你使用此配置。\n\n\n# output.enablelatestdecorators\n\n * type: boolean\n * default: false\n\n是否要使用新版 decorator 提案 进行编译。\n\n默认情况下，builder 在编译装饰器时采用旧版 decorator 提案。\n\n将 output.enablelatestdecorators 设置为 true 时，builder 会采用新版 decorator 提案 (2018-09 版本) 进行编译。\n\nexport default {\n  output: {\n    enablelatestdecorators: true,\n  },\n};\n\n\n\n# output.enablecssmoduletsdeclaration\n\n * type: boolean\n * default: false\n\n是否生成 css modules 的 typescript 声明文件。\n\n# example\n\n启用 css module typescript 声明，比如：\n\nexport default {\n  output: {\n    enablecssmoduletsdeclaration: true,\n  },\n};\n\n\n项目构建完成后，每个 css module 文件都会生成一个 .d.ts 文件。例如：\n\ninterface cssexports {\n  title: string;\n}\nexport const cssexports: cssexports;\nexport default cssexports;\n\n\n\n# output.enableinlinescripts\n\n * type: boolean\n * default: false\n\n用来控制生产环境中是否用 <script> 标签将产物中的 script 文件（.js 文件）inline 到 html 中。\n\n注意，如果开启了这个选项，那么 script 文件将不会被写入产物目录中，而只会以 inline 脚本的形式存在于 html 文件中。\n\n# 示例\n\n默认情况下，我们有这样的产物文件：\n\ndist/html/main/index.html\ndist/static/css/style.css\ndist/static/js/main.js\n\n\n开启 output.enableinlinescripts 选项后：\n\nexport default {\n  output: {\n    enableinlinescripts: true,\n  },\n};\n\n\n产物文件将变成：\n\ndist/html/main/index.html\ndist/static/css/style.css\n\n\n同时，dist/static/js/main.js 文件将被 inline 到 index.html 中：\n\n<html>\n  <body>\n    <script>\n      // content of dist/static/js/main.js\n    <\/script>\n  </body>\n</html>\n\n\n\n# output.enableinlinestyles\n\n * type: boolean\n * default: false\n\n用来控制生产环境中是否用 <style> 标签将产物中的 style 文件（.css 文件）inline 到 html 中。\n\n注意，如果开启了这个选项，那么 style 文件将不会被写入产物目录中，而只会以 inline 样式的形式存在于 html 文件中。\n\n# 示例\n\n默认情况下，我们有这样的产物文件：\n\ndist/html/main/index.html\ndist/static/css/style.css\ndist/static/js/main.js\n\n\n开启 output.enableinlinestyles 选项后：\n\nexport default {\n  output: {\n    enableinlinestyles: true,\n  },\n};\n\n\n产物文件将变成：\n\ndist/html/main/index.html\ndist/static/js/main.js\n\n\n同时，dist/static/css/style.css 文件将被 inline 到 index.html 中：\n\n<html>\n  <head>\n    <style>\n      /* content of dist/static/css/style.css */\n    </style>\n  </head>\n  <body>\n  </body>\n</html>\n\n\n\n# output.externals\n\n * type : string | object | function | regexp\n * default: undefined\n\n在构建时，防止将代码中某些 import 的依赖包打包到 bundle 中，而是在运行时再去从外部获取这些依赖。\n\n详情请见: webpack 外部扩展 (externals)\n\n# 示例\n\n将 react-dom 依赖从构建产物中剔除。为了在运行时获取这个模块, react-dom 的值将全局检索 reactdom 变量。\n\nexport default {\n  output: {\n    externals: {\n      'react-dom': 'reactdom',\n    },\n  },\n};\n\n\ntip\n\n当构建 web worker 产物时，externals 将不会生效。这是因为 worker 环境不支持通过访问全局变量。\n\n\n# output.filename\n\n * type\n\ntype filenameconfig = {\n  js?: string;\n  css?: string;\n  svg?: string;\n  font?: string;\n  image?: string;\n  media?: string;\n};\n\n\n * default\n\n// 开发环境\nconst devdefaultfilename = {\n  js: '[name].js',\n  css: '[name].css',\n  svg: '[name].[contenthash:8].svg',\n  font: '[name].[contenthash:8][ext]',\n  image: '[name].[contenthash:8][ext]',\n  media: '[name].[contenthash:8][ext]',\n};\n\n// 生产环境\nconst proddefaultfilename = {\n  js: '[name].[contenthash:8].js',\n  css: '[name].[contenthash:8].css',\n  svg: '[name].[contenthash:8].svg',\n  font: '[name].[contenthash:8][ext]',\n  image: '[name].[contenthash:8][ext]',\n  media: '[name].[contenthash:8][ext]',\n};\n\n\n设置构建产物的名称。\n\n在生产环境构建后，会自动在文件名中间添加 hash 值，如果不需要添加，可以通过 output.disablefilenamehash 配置来禁用该行为。\n\n其中：\n\n * js：表示 javascript 文件的名称。\n * css：表示 css 样式文件的名称。\n * svg：表示 svg 图片的名称。\n * font：表示字体文件的名称。\n * image：表示非 svg 图片的名称。\n * media：表示视频等媒体资源的名称。\n\n# 示例\n\n修改 javascript 文件的名称为 [name]_script.js：\n\nexport default {\n  output: {\n    filename: {\n      js:\n        process.env.node_env === 'production'\n          ? '[name]_script.[contenthash:8].js'\n          : '[name]_script.js',\n    },\n  },\n};\n\n\n\n# output.legalcomments\n\n * type : 'linked' | 'inline' | 'none'\n * default: 'linked'\n\n配置 legal comment 的处理方式。\n\nlegal comment 是 js 或 css 文件中的一些特殊注释，这些注释包含 @license 或 @preserve，或是以 //! 开头。默认情况下，这些注释保留在输出文件中，因为这遵循了代码原作者的意图。\n\n你可以通过 legalcomments 来配置相关行为：\n\n * linked：将所有 legal comments 移至 .legal.txt 文件并通过注释链接到它们。\n * inline：保留所有 legal comments。\n * none：移除所有 legal comments。\n\n# 示例\n\n移除所有 legal comments。\n\nexport default {\n  output: {\n    legalcomments: 'none',\n  },\n};\n\n\n\n# output.overridebrowserslist\n\n * type: string[] | record<buildertarget, string[]>\n * default: undefined\n\n指定项目兼容的目标浏览器范围。该值会被 @babel/preset-env 和 autoprefixer 用来确定需要转换的 javascript 语法特性和需要添加的 css 浏览器前缀。\n\n# 优先级\n\noverridebrowserslist 配置的优先级高于项目中的 .browserslistrc 配置文件和 package.json 中的 browserslist 字段。\n\n大多数场景下，推荐优先使用 .browserslistrc 文件，而不是使用 overridebrowserslist 配置。因为 .browserslistrc 文件是官方定义的配置文件，通用性更强，可以被社区中的其他库识别。\n\n# 默认值\n\n如果项目中没有定义任何 browserslist 相关的配置，也没有定义 overridebrowserslist，那么 builder 会设置默认值为：\n\n['> 0.01%', 'not dead', 'not op_mini all'];\n\n\n# 示例\n\n下面是兼容移动端 h5 场景的示例：\n\nexport default {\n  output: {\n    overridebrowserslist: [\n      'ios 9',\n      'android 4.4',\n      'last 2 versions',\n      '> 0.2%',\n      'not dead',\n    ],\n  },\n};\n\n\n可以查看 browserslist 文档 来了解如何自定义浏览器范围。\n\n# 根据产物类型设置\n\n当你同时构建多种类型的产物时，你可以为不同的产物类型设置不同的目标浏览器范围。此时，你需要把 overridebrowserslist 设置为一个对象，对象的 key 为对应的产物类型。\n\n比如为 web 和 node 设置不同的范围：\n\nexport default {\n  output: {\n    overridebrowserslist: {\n      web: ['ios 9', 'android 4.4', 'last 2 versions', '> 0.2%', 'not dead'],\n      node: ['node >= 14'],\n    },\n  },\n};\n\n\n\n# output.polyfill\n\n * type: 'entry' | 'usage' | 'ua' | 'off'\n * default: 'entry'\n\n通过 output.polyfill 你可以配置 polyfill 的注入方式。\n\n\n# 配置项\n\n# entry\n\n当 output.polyfill 配置为 'entry' 时，会在每个入口文件中注入 polyfill。\n\n等价于 @babel/preset-env 的 usebuiltins: 'entry' 配置。\n\n# usage\n\n当 output.polyfill 配置为 'usage' 时，会在每个文件中根据代码中使用的 api 注入 polyfill。\n\n等价于 @babel/preset-env 的 usebuiltins: 'usage' 配置。\n\n# ua\n\n根据当前请求的 ua 信息，动态下发 polyfill 代码。\n\n# off\n\n不注入 polyfill。使用此选项时，需要自行保证代码的兼容性。\n\n\n# output.svgdefaultexport\n\n * type: url | component\n * default: url\n\noutput.svgdefaultexport 可以用来配置 svg 文件的默认导出。\n\n当 output.svgdefaultexport 配置为 url 时，svg 文件的默认导出是文件的 url。例如：\n\nimport logo from './logo.svg';\n\nconsole.log(logo); // => 资源 url\n\n\n当 output.svgdefaultexport 配置为 component 时，svg 文件的默认导出是文件的 react 组件。例如：\n\nimport logo from './logo.svg';\n\nconsole.log(logo); // => react 组件\n\n\n此时，你也可以通过指定 ?url 的 query 来导入 url，比如：\n\nimport logo from './logo.svg?url';\n\nconsole.log(logo); // => 资源 url\n",charsets:{cjk:!0}},{title:"Performance Config",frontmatter:{extractApiHeaders:[2]},regularPath:"/zh/api/config-performance.html",relativePath:"zh/api/config-performance.md",key:"v-5908a168",path:"/zh/api/config-performance.html",headers:[{level:2,title:"performance.buildCache",slug:"performance-buildcache",normalizedTitle:"performance.buildcache",charIndex:52},{level:2,title:"performance.bundleAnalyze",slug:"performance-bundleanalyze",normalizedTitle:"performance.bundleanalyze",charIndex:694},{level:2,title:"performance.chunkSplit",slug:"performance-chunksplit",normalizedTitle:"performance.chunksplit",charIndex:1219},{level:2,title:"performance.printFileSize",slug:"performance-printfilesize",normalizedTitle:"performance.printfilesize",charIndex:4593},{level:2,title:"performance.profile",slug:"performance-profile",normalizedTitle:"performance.profile",charIndex:5197},{level:2,title:"performance.removeConsole",slug:"performance-removeconsole",normalizedTitle:"performance.removeconsole",charIndex:5419},{level:2,title:"performance.removeMomentLocale",slug:"performance-removemomentlocale",normalizedTitle:"performance.removemomentlocale",charIndex:5924}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"performance.buildCache performance.bundleAnalyze performance.chunkSplit performance.printFileSize performance.profile performance.removeConsole performance.removeMomentLocale",content:"# Performance Config\n\n本章节描述了 Builder 中与性能有关的配置。\n\n\n# performance.buildCache\n\n * Type\n\ntype BuildCacheConfig =\n  | {\n      /**\n       * webpack 文件缓存系统的缓存目录\n       */\n      cacheDirectory?: string;\n    }\n  | boolean;\n\n\n * Default:\n\nconst defaultBuildCacheConfig = {\n  cacheDirectory: './node_modules/.cache/webpack',\n};\n\n\n控制 Builder 在构建过程中的缓存行为。\n\nBuilder 默认会开启构建缓存来提升二次构建的速度，并默认把生成的缓存文件写到 ./node_modules/.cache/webpack 目录下。\n\n你可以通过 buildCache 配置缓存路径，比如：\n\nexport default {\n  performance: {\n    buildCache: {\n      cacheDirectory: './node_modules/.custom_cache/webpack',\n    },\n  },\n};\n\n\n如果不希望缓存，你也可以将 buildCache 置为 false 将其禁用掉：\n\nexport default {\n  performance: {\n    buildCache: false,\n  },\n};\n\n\n\n# performance.bundleAnalyze\n\n * Type: Object | undefined\n\n你有两种方式开启 webpack-bundle-analyzer 来分析构建产物的体积:\n\n * 添加环境变量 BUNDLE_ANALYZE=true；\n * 配置 performance.bundleAnalyze。\n\n默认情况下，不会开启 webpack-bundle-analyzer，当开启之后它的配置如下:\n\n{\n  analyzerMode: 'static',\n  openAnalyzer: false,\n  // target 为编译目标，如 `web`、`node` 等\n  reportFilename: `report-${target}.html`,\n}\n\n\n你可以通过 performance.bundleAnalyze 来覆盖默认配置，比如：\n\nexport default {\n  performance: {\n    bundleAnalyze: {\n      analyzerMode: 'server',\n      openAnalyzer: true,\n    },\n  },\n};\n\n\n\n# performance.chunkSplit\n\n * Type: Object\n * Default: { strategy: 'split-by-experience' }\n\nperformance.chunkSplit 用于配置 Builder 的拆包策略。配置项的类型 ChunkSplit 如下:\n\ninterface BaseChunkSplit {\n  strategy?:\n    | 'split-by-module'\n    | 'split-by-experience'\n    | 'all-in-one'\n    | 'single-vendor';\n  override?: SplitChunks;\n  forceSplitting?: Array<RegExp>;\n}\n\ninterface SplitBySize {\n  strategy?: 'split-by-size';\n  minSize?: number;\n  maxSize?: number;\n  override?: SplitChunks;\n  forceSplitting?: Array<RegExp>;\n}\n\ninterface SplitCustom {\n  strategy?: 'custom';\n  splitChunks?: SplitChunks;\n  forceSplitting?: Array<RegExp>;\n}\n\nexport type ChunkSplit = BaseChunkSplit | SplitBySize | SplitCustom;\n\n\n\n# chunkSplit.strategy\n\nBuilder 支持六种类型的拆包策略:\n\n * split-by-experience: 根据经验内置拆分策略\n * split-by-module: 根据 NPM 包拆分，每个 NPM 包一个 chunk\n * split-by-size: 根据 chunk 大小拆分\n * all-in-one: 所有代码打包到一个 chunk\n * single-vendor: node_modules 中的代码打包到一个单独的 chunk\n * custom: 自定义拆包配置\n\nBuilder 默认采用 split-by-experience 策略，具体来说，以下的 NPM 包分组会被拆分为单独的 chunk:\n\n * react 和 react-dom\n * react-router、history 和 react-router-dom\n * antd 组件库\n * semi 组件库\n * arco 组件库\n * @babel/runtime 的代码(也包括 @babel/runtime-corejs2、 @babel/runtime-corejs3)\n * lodash 和 lodash-es\n * core-js\n\n如果你想使用其他拆包策略，可以通过 performance.chunkSplit.strategy 配置项来指定。\n\n\n# chunkSplit.minSize\n\n * Type: number\n * Default: 10000\n\n当 performance.chunkSplit.strategy 为 split-by-size 时，可以通过 performance.chunkSplit.minSize 配置项来指定 chunk 的最小大小，单位为字节。默认值为 10000。比如:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-size',\n      minSize: 20000,\n    },\n  },\n};\n\n\n\n# chunkSplit.maxSize\n\n * Type: number\n * Default: Infinity\n\n当 performance.chunkSplit.strategy 为 split-by-size 时，可以通过 performance.chunkSplit.maxSize 配置项来指定 chunk 的最大大小，单位为字节。默认值为 Infinity。比如:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-size',\n      maxSize: 50000,\n    },\n  },\n};\n\n\n\n# chunkSplit.forceSplitting\n\n * Type: Array<RegExp>\n * Default: []\n\n通过 performance.chunkSplit.forceSplitting 配置项可以指定强制拆包的 NPM 包。比如:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      forceSplitting: [/^@arco-design\\/web-react/],\n    },\n  },\n};\n\n\n相比直接配置 webpack 的 splitChunks，这是一个更加简便的方式。\n\n\n# chunkSplit.splitChunks\n\n当 performance.chunkSplit.strategy 为 custom 时，可以通过 performance.chunkSplit.splitChunks 配置项来指定自定义的 webpack 拆包配置。此配置会和 webpack 的 splitChunks 配置进行合并（cacheGroups 配置也会合并）。比如:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'custom',\n      splitChunks: {\n        cacheGroups: {\n          react: {\n            test: /[\\\\/]node_modules[\\\\/](react|react-dom)[\\\\/]/,\n            name: 'react',\n            chunks: 'all',\n          },\n        },\n      },\n    },\n  },\n};\n\n\n\n# chunkSplit.override\n\n当 performance.chunkSplit.strategy 为 split-by-experience、split-by-module、split-by-size 或 single-vendor 时，可以通过 performance.chunkSplit.override 配置项来自定义 webpack 拆包配置，此配置会和 webpack 的 splitChunks 配置进行合并（cacheGroups 配置也会合并）。比如:\n\nexport default {\n  performance: {\n    strategy: 'split-by-experience',\n    chunkSplit: {\n      override: {\n        cacheGroups: {\n          react: {\n            test: /[\\\\/]node_modules[\\\\/](react|react-dom)[\\\\/]/,\n            name: 'react',\n            chunks: 'all',\n          },\n        },\n      },\n    },\n  },\n};\n\n\n> 当 Builder 构建 \"node\" 类型的产物时，由于 Node Bundles 不需要通过拆包来优化加载性能，因此 chunkSplit 规则不会生效。\n\n\n# performance.printFileSize\n\n * Type: boolean\n * Default: true\n\n是否在生产环境构建后输出所有静态资源文件的体积。\n\ninfo    File sizes after production build:\n\n  File                                     Size         Gzipped\n  dist/static/js/lib-corejs.1c836fe7.js    212.89 kB    66.57 kB\n  dist/static/js/lib-react.fcafbc5c.js     134.65 kB    43.45 kB\n  dist/static/js/main.6ff06f70.js          8.93 kB      3.73 kB\n  dist/static/css/main.9f48031b.css        2.64 kB      927 B\n  dist/html/main/index.html                1.64 kB      874 B\n\n\n# 示例\n\n禁用相关日志：\n\nexport default {\n  performance: {\n    printFileSize: false,\n  },\n};\n\n\n\n# performance.profile\n\n * Type: boolean\n * Default: false\n\n是否捕获每个模块的耗时信息，对应 webpack 的 profile 配置。\n\n# 示例\n\nexport default {\n  performance: {\n    profile: true,\n  },\n};\n\n\n开启后，Webpack 生成一些有关模块的统计数据的 JSON 文件会将模块构建的耗时信息也包含进去。\n\n\n# performance.removeConsole\n\n * Type: boolean | ConsoleType[]\n * Default: false\n\n在生产环境构建时，是否自动移除代码中的 console.xx。\n\n# 移除所有 console\n\n当 removeConsole 被设置为 true 时，会移除所有类型的 console.xx：\n\nexport default {\n  performance: {\n    removeConsole: true,\n  },\n};\n\n\n# 移除特定的 console\n\n你也可以指定仅移除特定类型的 console.xx，比如移除 console.log 和 console.warn：\n\nexport default {\n  performance: {\n    removeConsole: ['log', 'warn'],\n  },\n};\n\n\n目前支持配置以下类型的 console：\n\ntype ConsoleType = 'log' | 'info' | 'warn' | 'error' | 'table' | 'group';\n\n\n\n# performance.removeMomentLocale\n\n * Type: boolean\n * Default: false\n\n是否移除 moment.js 的语言包文件。\n\nmoment.js 默认包含了大量的语言包文件，会导致打包后的包体积增大。\n\n当项目中使用了 moment.js 时，推荐开启此选项，自动排除所有的语言包文件：\n\nexport default {\n  performance: {\n    removeMomentLocale: true,\n  },\n};\n\n\n开启后，可以通过以下方式来加载语言包文件：\n\nimport moment from 'moment';\nimport 'moment/locale/zh-cn';\n\nmoment.locale('zh-cn');\n",normalizedContent:"# performance config\n\n本章节描述了 builder 中与性能有关的配置。\n\n\n# performance.buildcache\n\n * type\n\ntype buildcacheconfig =\n  | {\n      /**\n       * webpack 文件缓存系统的缓存目录\n       */\n      cachedirectory?: string;\n    }\n  | boolean;\n\n\n * default:\n\nconst defaultbuildcacheconfig = {\n  cachedirectory: './node_modules/.cache/webpack',\n};\n\n\n控制 builder 在构建过程中的缓存行为。\n\nbuilder 默认会开启构建缓存来提升二次构建的速度，并默认把生成的缓存文件写到 ./node_modules/.cache/webpack 目录下。\n\n你可以通过 buildcache 配置缓存路径，比如：\n\nexport default {\n  performance: {\n    buildcache: {\n      cachedirectory: './node_modules/.custom_cache/webpack',\n    },\n  },\n};\n\n\n如果不希望缓存，你也可以将 buildcache 置为 false 将其禁用掉：\n\nexport default {\n  performance: {\n    buildcache: false,\n  },\n};\n\n\n\n# performance.bundleanalyze\n\n * type: object | undefined\n\n你有两种方式开启 webpack-bundle-analyzer 来分析构建产物的体积:\n\n * 添加环境变量 bundle_analyze=true；\n * 配置 performance.bundleanalyze。\n\n默认情况下，不会开启 webpack-bundle-analyzer，当开启之后它的配置如下:\n\n{\n  analyzermode: 'static',\n  openanalyzer: false,\n  // target 为编译目标，如 `web`、`node` 等\n  reportfilename: `report-${target}.html`,\n}\n\n\n你可以通过 performance.bundleanalyze 来覆盖默认配置，比如：\n\nexport default {\n  performance: {\n    bundleanalyze: {\n      analyzermode: 'server',\n      openanalyzer: true,\n    },\n  },\n};\n\n\n\n# performance.chunksplit\n\n * type: object\n * default: { strategy: 'split-by-experience' }\n\nperformance.chunksplit 用于配置 builder 的拆包策略。配置项的类型 chunksplit 如下:\n\ninterface basechunksplit {\n  strategy?:\n    | 'split-by-module'\n    | 'split-by-experience'\n    | 'all-in-one'\n    | 'single-vendor';\n  override?: splitchunks;\n  forcesplitting?: array<regexp>;\n}\n\ninterface splitbysize {\n  strategy?: 'split-by-size';\n  minsize?: number;\n  maxsize?: number;\n  override?: splitchunks;\n  forcesplitting?: array<regexp>;\n}\n\ninterface splitcustom {\n  strategy?: 'custom';\n  splitchunks?: splitchunks;\n  forcesplitting?: array<regexp>;\n}\n\nexport type chunksplit = basechunksplit | splitbysize | splitcustom;\n\n\n\n# chunksplit.strategy\n\nbuilder 支持六种类型的拆包策略:\n\n * split-by-experience: 根据经验内置拆分策略\n * split-by-module: 根据 npm 包拆分，每个 npm 包一个 chunk\n * split-by-size: 根据 chunk 大小拆分\n * all-in-one: 所有代码打包到一个 chunk\n * single-vendor: node_modules 中的代码打包到一个单独的 chunk\n * custom: 自定义拆包配置\n\nbuilder 默认采用 split-by-experience 策略，具体来说，以下的 npm 包分组会被拆分为单独的 chunk:\n\n * react 和 react-dom\n * react-router、history 和 react-router-dom\n * antd 组件库\n * semi 组件库\n * arco 组件库\n * @babel/runtime 的代码(也包括 @babel/runtime-corejs2、 @babel/runtime-corejs3)\n * lodash 和 lodash-es\n * core-js\n\n如果你想使用其他拆包策略，可以通过 performance.chunksplit.strategy 配置项来指定。\n\n\n# chunksplit.minsize\n\n * type: number\n * default: 10000\n\n当 performance.chunksplit.strategy 为 split-by-size 时，可以通过 performance.chunksplit.minsize 配置项来指定 chunk 的最小大小，单位为字节。默认值为 10000。比如:\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'split-by-size',\n      minsize: 20000,\n    },\n  },\n};\n\n\n\n# chunksplit.maxsize\n\n * type: number\n * default: infinity\n\n当 performance.chunksplit.strategy 为 split-by-size 时，可以通过 performance.chunksplit.maxsize 配置项来指定 chunk 的最大大小，单位为字节。默认值为 infinity。比如:\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'split-by-size',\n      maxsize: 50000,\n    },\n  },\n};\n\n\n\n# chunksplit.forcesplitting\n\n * type: array<regexp>\n * default: []\n\n通过 performance.chunksplit.forcesplitting 配置项可以指定强制拆包的 npm 包。比如:\n\nexport default {\n  performance: {\n    chunksplit: {\n      forcesplitting: [/^@arco-design\\/web-react/],\n    },\n  },\n};\n\n\n相比直接配置 webpack 的 splitchunks，这是一个更加简便的方式。\n\n\n# chunksplit.splitchunks\n\n当 performance.chunksplit.strategy 为 custom 时，可以通过 performance.chunksplit.splitchunks 配置项来指定自定义的 webpack 拆包配置。此配置会和 webpack 的 splitchunks 配置进行合并（cachegroups 配置也会合并）。比如:\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'custom',\n      splitchunks: {\n        cachegroups: {\n          react: {\n            test: /[\\\\/]node_modules[\\\\/](react|react-dom)[\\\\/]/,\n            name: 'react',\n            chunks: 'all',\n          },\n        },\n      },\n    },\n  },\n};\n\n\n\n# chunksplit.override\n\n当 performance.chunksplit.strategy 为 split-by-experience、split-by-module、split-by-size 或 single-vendor 时，可以通过 performance.chunksplit.override 配置项来自定义 webpack 拆包配置，此配置会和 webpack 的 splitchunks 配置进行合并（cachegroups 配置也会合并）。比如:\n\nexport default {\n  performance: {\n    strategy: 'split-by-experience',\n    chunksplit: {\n      override: {\n        cachegroups: {\n          react: {\n            test: /[\\\\/]node_modules[\\\\/](react|react-dom)[\\\\/]/,\n            name: 'react',\n            chunks: 'all',\n          },\n        },\n      },\n    },\n  },\n};\n\n\n> 当 builder 构建 \"node\" 类型的产物时，由于 node bundles 不需要通过拆包来优化加载性能，因此 chunksplit 规则不会生效。\n\n\n# performance.printfilesize\n\n * type: boolean\n * default: true\n\n是否在生产环境构建后输出所有静态资源文件的体积。\n\ninfo    file sizes after production build:\n\n  file                                     size         gzipped\n  dist/static/js/lib-corejs.1c836fe7.js    212.89 kb    66.57 kb\n  dist/static/js/lib-react.fcafbc5c.js     134.65 kb    43.45 kb\n  dist/static/js/main.6ff06f70.js          8.93 kb      3.73 kb\n  dist/static/css/main.9f48031b.css        2.64 kb      927 b\n  dist/html/main/index.html                1.64 kb      874 b\n\n\n# 示例\n\n禁用相关日志：\n\nexport default {\n  performance: {\n    printfilesize: false,\n  },\n};\n\n\n\n# performance.profile\n\n * type: boolean\n * default: false\n\n是否捕获每个模块的耗时信息，对应 webpack 的 profile 配置。\n\n# 示例\n\nexport default {\n  performance: {\n    profile: true,\n  },\n};\n\n\n开启后，webpack 生成一些有关模块的统计数据的 json 文件会将模块构建的耗时信息也包含进去。\n\n\n# performance.removeconsole\n\n * type: boolean | consoletype[]\n * default: false\n\n在生产环境构建时，是否自动移除代码中的 console.xx。\n\n# 移除所有 console\n\n当 removeconsole 被设置为 true 时，会移除所有类型的 console.xx：\n\nexport default {\n  performance: {\n    removeconsole: true,\n  },\n};\n\n\n# 移除特定的 console\n\n你也可以指定仅移除特定类型的 console.xx，比如移除 console.log 和 console.warn：\n\nexport default {\n  performance: {\n    removeconsole: ['log', 'warn'],\n  },\n};\n\n\n目前支持配置以下类型的 console：\n\ntype consoletype = 'log' | 'info' | 'warn' | 'error' | 'table' | 'group';\n\n\n\n# performance.removemomentlocale\n\n * type: boolean\n * default: false\n\n是否移除 moment.js 的语言包文件。\n\nmoment.js 默认包含了大量的语言包文件，会导致打包后的包体积增大。\n\n当项目中使用了 moment.js 时，推荐开启此选项，自动排除所有的语言包文件：\n\nexport default {\n  performance: {\n    removemomentlocale: true,\n  },\n};\n\n\n开启后，可以通过以下方式来加载语言包文件：\n\nimport moment from 'moment';\nimport 'moment/locale/zh-cn';\n\nmoment.locale('zh-cn');\n",charsets:{cjk:!0}},{title:"Security Config",frontmatter:{extractApiHeaders:[2]},regularPath:"/zh/api/config-security.html",relativePath:"zh/api/config-security.md",key:"v-2564926e",path:"/zh/api/config-security.html",headers:[{level:2,title:"security.sri",slug:"security-sri",normalizedTitle:"security.sri",charIndex:49}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"security.sri",content:'# Security Config\n\n本章节描述了 Builder 中与安全有关的配置。\n\n\n# security.sri\n\n * Type:\n\ntype SRIOptions = {\n  hashFuncNames?: []string;\n  enabled?: "auto" | true | false;\n  hashLoading?: "eager" | "lazy";\n} | boolean;\n\n\n * Default: undefined\n\n为 HTML 所引入的子资源添加完整性属性 —— integrity，使浏览器能够验证引入资源的完整性，以此防止下载的资源被篡改。\n\n启动该选项后会将 webpack 的 output.crossOriginLoading 配置项设置为 anonymous。\n\n# SRI 介绍\n\n子资源完整性 Subresource Integrity（SRI）是专门用来校验资源的一种方案，它读取资源标签中的 integrity 属性，将其中的信息摘要值，和资源实际的信息摘要值进行对比，如果发现无法匹配，那么浏览器就会拒绝执行资源。\n\n对于 script 标签来说，结果为拒绝执行其中的代码；对于 CSS link 来说，结果为不加载其中的样式。\n\n关于 SRI 的更多内容，可以查看 Subresource Integrity - MDN。\n\n# 示例\n\n默认情况下，不会开启 SRI，当开启之后它的默认配置如下：\n\n{\n  hashFuncNames: [\'sha384\'];\n  enabled: "auto",\n  hashLoading: "eager",\n}\n\n\n你可以按照你自己的需求自定义配置项:\n\nexport default {\n  security: {\n    sri: {\n      hashFuncNames: [\'sha-256\'],\n      enabled: true,\n      hashLoading: \'lazy\',\n    },\n  },\n};\n',normalizedContent:'# security config\n\n本章节描述了 builder 中与安全有关的配置。\n\n\n# security.sri\n\n * type:\n\ntype srioptions = {\n  hashfuncnames?: []string;\n  enabled?: "auto" | true | false;\n  hashloading?: "eager" | "lazy";\n} | boolean;\n\n\n * default: undefined\n\n为 html 所引入的子资源添加完整性属性 —— integrity，使浏览器能够验证引入资源的完整性，以此防止下载的资源被篡改。\n\n启动该选项后会将 webpack 的 output.crossoriginloading 配置项设置为 anonymous。\n\n# sri 介绍\n\n子资源完整性 subresource integrity（sri）是专门用来校验资源的一种方案，它读取资源标签中的 integrity 属性，将其中的信息摘要值，和资源实际的信息摘要值进行对比，如果发现无法匹配，那么浏览器就会拒绝执行资源。\n\n对于 script 标签来说，结果为拒绝执行其中的代码；对于 css link 来说，结果为不加载其中的样式。\n\n关于 sri 的更多内容，可以查看 subresource integrity - mdn。\n\n# 示例\n\n默认情况下，不会开启 sri，当开启之后它的默认配置如下：\n\n{\n  hashfuncnames: [\'sha384\'];\n  enabled: "auto",\n  hashloading: "eager",\n}\n\n\n你可以按照你自己的需求自定义配置项:\n\nexport default {\n  security: {\n    sri: {\n      hashfuncnames: [\'sha-256\'],\n      enabled: true,\n      hashloading: \'lazy\',\n    },\n  },\n};\n',charsets:{cjk:!0}},{title:"Source Config",frontmatter:{extractApiHeaders:[2]},regularPath:"/zh/api/config-source.html",relativePath:"zh/api/config-source.md",key:"v-3857cc90",path:"/zh/api/config-source.html",headers:[{level:2,title:"source.alias",slug:"source-alias",normalizedTitle:"source.alias",charIndex:48},{level:2,title:"source.include",slug:"source-include",normalizedTitle:"source.include",charIndex:874},{level:2,title:"source.exclude",slug:"source-exclude",normalizedTitle:"source.exclude",charIndex:2562},{level:2,title:"source.compileJsDataURI",slug:"source-compilejsdatauri",normalizedTitle:"source.compilejsdatauri",charIndex:2861},{level:2,title:"source.define",slug:"source-define",normalizedTitle:"source.define",charIndex:3213},{level:2,title:"source.globalVars",slug:"source-globalvars",normalizedTitle:"source.globalvars",charIndex:3992},{level:2,title:"source.moduleScopes",slug:"source-modulescopes",normalizedTitle:"source.modulescopes",charIndex:5166},{level:2,title:"source.preEntry",slug:"source-preentry",normalizedTitle:"source.preentry",charIndex:5946},{level:2,title:"source.resolveExtensionPrefix",slug:"source-resolveextensionprefix",normalizedTitle:"source.resolveextensionprefix",charIndex:6485},{level:2,title:"source.resolveMainFields",slug:"source-resolvemainfields",normalizedTitle:"source.resolvemainfields",charIndex:7397}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"source.alias source.include source.exclude source.compileJsDataURI source.define source.globalVars source.moduleScopes source.preEntry source.resolveExtensionPrefix source.resolveMainFields",content:"# Source Config\n\n本章节描述了 Builder 中与源代码有关的配置。\n\n\n# source.alias\n\n * Type: Record<string, string | string[]> | Function\n * Default: undefined\n\n设置文件引用的别名，对应 webpack 的 resolve.alias 配置。\n\nTIP\n\n对于 TypeScript 项目，只需要在 tsconfig.json 中配置 compilerOptions.paths 即可，Builder 会自动识别 tsconfig.json 里的别名，因此不需要额外配置 alias 字段。\n\n# Object 类型\n\nalias 的值可以定义为 Object 类型，其中的相对路径会自动被 Builder 转换为绝对路径。\n\nexport default {\n  source: {\n    alias: {\n      '@common': './src/common',\n    },\n  },\n};\n\n\n以上配置完成后，如果在代码中引用 @common/Foo.tsx, 则会映射到 <root>/src/common/Foo.tsx 路径上。\n\n# Function 类型\n\nalias 的值定义为函数时，可以接受预设的 alias 对象，并对其进行修改。\n\nexport default {\n  source: {\n    alias: alias => {\n      alias['@common'] = './src/common';\n    },\n  },\n};\n\n\n也可以在函数中返回一个新对象作为最终结果，新对象会覆盖预设的 alias 对象。\n\nexport default {\n  source: {\n    alias: alias => {\n      return {\n        '@common': './src/common',\n      };\n    },\n  },\n};\n\n\n\n# source.include\n\n * Type: Array<string | RegExp>\n * Default: []\n\n出于编译性能的考虑，默认情况下，Builder 不会编译 node_modules 下的 JavaScript/TypeScript 文件，也不会编译当前工程目录外部的 JavaScript/TypeScript 文件。\n\n通过 source.include 配置项，可以指定需要额外进行编译的目录或模块。用法与 webpack 中的 Rule.include 一致，支持传入字符串或正则表达式来匹配模块的路径。\n\n比如:\n\nimport path from 'path';\n\nexport default {\n  source: {\n    include: [path.resolve(__dirname, '../other-dir')],\n  },\n};\n\n\n\n# 场景示例\n\n比较典型的使用场景是编译 node_modules 下的文件，因为某些第三方依赖存在 ES6+ 的语法，这可能导致在低版本浏览器上无法运行，你可以通过该选项指定需要编译的依赖，从而解决此类问题。以 query-string 为例，你可以做如下的配置：\n\nimport path from 'path';\n\nexport default {\n  source: {\n    include: [\n      // 方法一:\n      // 先通过 require.resolve 来获取模块的路径\n      // 再通过 path.dirname 来指向对应的目录\n      path.dirname(require.resolve('query-string')),\n      // 方法二:\n      // 通过正则表达式进行匹配\n      // 所有包含 `/query-string/` 的路径都会被匹配到\n      /\\/query-string\\//,\n    ],\n  },\n};\n\n\n> 注意，该配置只会编译 query-string 自身的代码，不会编译 query-string 的子依赖。如果需要编译 query-string 的子依赖，则需要将对应的 npm 包也加入到 source.include 中。\n\n\n# Monorepo 项目\n\n使用 Monorepo 时，如果需要引用 Monorepo 中其他库的源代码，也可以直接在 source.include 进行配置:\n\nimport path from 'path';\n\nexport default {\n  source: {\n    include: [\n      // 方法一:\n      // 编译 Monorepo 的 package 目录下的所有文件\n      path.resolve(__dirname, '../../packages'),\n\n      // 方法二:\n      // 编译 Monorepo 的 package 目录里某个包的源代码\n      // 这种写法匹配的范围更加精准，对整体编译性能的影响更小\n      path.resolve(__dirname, '../../packages/xxx/src'),\n    ],\n  },\n};\n\n\n\n# 注意事项\n\n注意，Babel 默认无法编译 CommonJS 模块，当你使用 source.include 来编译 CommonJS 模块时，需要将 Babel 的 sourceType 配置设置为 unambiguous：\n\nexport default {\n  tools: {\n    babel(config) {\n      config.sourceType = 'unambiguous';\n    },\n  },\n};\n\n\n将 sourceType 设置为 unambiguous 可能会产生一些其他影响，请参考 Babel 官方文档。\n\n\n# source.exclude\n\n * Type: Array<string | RegExp>\n * Default: []\n\n指定不需要编译的 JavaScript/TypeScript 文件。用法与 webpack 中的 Rule.exclude 一致，支持传入字符串或正则表达式来匹配模块的路径。\n\n比如:\n\nimport path from 'path';\n\nexport default {\n  source: {\n    exclude: [path.resolve(__dirname, 'src/module-a'), /src\\/module-b/],\n  },\n};\n\n\n\n# source.compileJsDataURI\n\n * Type: boolean\n * Default: true\n\n对于使用 Data URI 引入的 JavaScript 代码，是否采用 babel 进行编译。\n\n比如以下代码：\n\nimport x from 'data:text/javascript,export default 1;';\n\nimport 'data:text/javascript;charset=utf-8;base64,Y29uc29sZS5sb2coJ2lubGluZSAxJyk7';\n\n\n# 示例\n\n添加以下配置来关闭：\n\nexport default {\n  source: {\n    compileJsDataURI: false,\n  },\n};\n\n\n\n# source.define\n\n * Type: Record<string, unknown>\n * Default: {}\n\n构建时将代码中的变量替换成其它值或者表达式，可以用于在代码逻辑中区分开发环境与生产环境等场景。\n\n传入的配置对象的键名是需要替换变量的名称，或者是用 . 连接的多个标识符，配置项的值则根据类型进行不同的处理：\n\n * 字符串会被当作代码片段。\n * 包括函数在内的其他类型会被转换成字符串。\n * 嵌套对象的父子键名之间会用 . 连接作为需要替换的变量名。\n * 以 typeof 开头的键名会用来替换 typeof 调用。\n\n更多细节参考 https://webpack.js.org/plugins/define-plugin/。\n\n# 示例\n\nexport default {\n  source: {\n    define: {\n      PRODUCTION: JSON.stringify(true),\n      VERSION: JSON.stringify('5fa3b9'),\n      BROWSER_SUPPORTS_HTML5: true,\n      TWO: '1 + 1',\n      'typeof window': JSON.stringify('object'),\n      'process.env.NODE_ENV': JSON.stringify(process.env.NODE_ENV),\n      'import.meta': { test: undefined },\n    },\n  },\n};\n\n\n表达式会被替换为对应的代码段：\n\nconst foo = TWO;\n\n// ⬇️ Turn into being...\nconst foo = 1 + 1;\n\n\n\n# source.globalVars\n\n * Type: Record<string, JSONValue>\n * Default:\n\n// Builder 会自动添加环境变量 `process.env.NODE_ENV` 作为默认值，因此你不需要手动添加它。\nconst defaultGlobalVars = {\n  'process.env.NODE_ENV': JSON.stringify(process.env.NODE_ENV),\n};\n\n\n构建时将类似 process.env.FOO 的全局变量表达式替换为指定的值，比如：\n\nconsole.log(process.env.NODE_ENV);\n\n// ⬇️ Turn into being...\nconsole.log('development');\n\n\n使用解构赋值时，构建器无法判断变量 NODE_ENV 是否与要替换的表达式 process.env.NODE_ENV 存在关联，所以这样的使用方式是无效的：\n\nconst { NODE_ENV } = process.env;\nconsole.log(NODE_ENV);\n// ❌ Won't get a string.\n\n\nsource.globalVars 是 source.define 的一个语法糖，唯一的区别是 source.globalVars 会自动将传入的值进行 JSON 序列化处理，这使得设置全局变量的值更容易。注意 globalVars 的每个值都需要是可以被 JSON 序列化的值。\n\nexport default {\n  source: {\n    globalVars: {\n      'process.env.BUILD_VERSION': '0.0.1',\n      'import.meta.foo': { bar: 42 },\n      'import.meta.baz': false,\n    },\n    define: {\n      'process.env.BUILD_VERSION': JSON.stringify('0.0.1'),\n      'import.meta': {\n        foo: JSON.stringify({ bar: 42 }),\n        baz: JSON.stringify(false),\n      },\n    },\n  },\n};\n\n\n# 示例\n\nexport default {\n  source: {\n    globalVars: {\n      ENABLE_VCONSOLE: true,\n      APP_CONTEXT: { answer: 42 },\n    },\n  },\n};\n\n\n\n# source.moduleScopes\n\n * Type: Array<string | Regexp> | Function\n * Default: undefined\n\n限制源代码的引用路径。配置该选项后，所有源文件只能从约定的目录下引用代码，从其他目录引用代码会产生对应的报错提示。\n\n# 示例\n\n首先我们配置 moduleScopes 仅包含 src 目录：\n\nexport default {\n  source: {\n    moduleScopes: ['./src'],\n  },\n};\n\n\n然后在 src/App.tsx 中导入 src 目录外部的 utils/a 模块:\n\nimport a from '../utils/a';\n\n\n在编译时，会提示引用路径错误:\n\n\n\n通过该选项配置 utils 目录，再进行编译，则不会出现错误提示。\n\nexport default {\n  source: {\n    moduleScopes: ['./src', './utils'],\n  },\n};\n\n\n# Array 类型\n\n当 moduleScopes 的值为 Array 类型时，可以直接设置若干个代码路径，比如添加以下配置：\n\nexport default {\n  source: {\n    moduleScopes: ['./src', './shared', './utils'],\n  },\n};\n\n\n# Function 类型\n\nmoduleScopes 也支持通过函数的形式来进行修改，避免覆盖默认值：\n\nexport default {\n  source: {\n    moduleScopes: scopes => {\n      scopes.push('./shared');\n    },\n  },\n};\n\n\n\n# source.preEntry\n\n * Type: string | string[]\n * Default: undefined\n\n在每个页面的入口文件前添加一段脚本，这段脚本会早于页面的代码执行，在这个脚本中可以进行执行一些全局的代码配置，比如注入 polyfill 等。\n\n# 添加单个脚本\n\n首先创建一个 src/polyfill.ts 文件：\n\nconsole.log('I am a polyfill');\n\n\n然后将 src/polyfill.ts 配置到 source.preEntry 上：\n\nexport default {\n  source: {\n    preEntry: './src/polyfill.ts',\n  },\n};\n\n\n重新运行编译并访问任意页面，可以看到 src/polyfill.ts 中的代码已经执行，并在 console 中输出了对应的内容。\n\n# 添加多个脚本\n\n可以将 preEntry 设置为数组来添加多个脚本：\n\nexport default {\n  source: {\n    preEntry: ['./src/polyfill-a.ts', './src/polyfill-b.ts'],\n  },\n};\n\n\n\n# source.resolveExtensionPrefix\n\n * Type: string | Record<BuilderTarget, string>\n * Default: undefined\n\n用于为 resolve.extensions 添加统一的前缀。\n\n如果多个文件拥有相同的名称，但具有不同的文件后缀，Builder 会根据 extensions 数组的顺序进行识别，解析数组中第一个被识别的文件，并跳过其余文件。\n\n# 示例\n\n下面是配置 .web 前缀的例子。\n\nexport default {\n  source: {\n    resolveExtensionPrefix: '.web',\n  },\n};\n\n\n配置完成后，extensions 数组会发生以下变化：\n\n// 配置前\nconst extensions = ['.js', '.ts', ...];\n\n// 配置后\nconst extensions = ['.web.js', '.js', '.web.ts' , '.ts', ...];\n\n\n在代码中 import './foo' 时，会优先识别 foo.web.js 文件，再识别 foo.js 文件。\n\n# 根据产物类型设置\n\n当你同时构建多种类型的产物时，你可以为不同的产物类型设置不同的 extension 前缀。此时，你需要把 resolveExtensionPrefix 设置为一个对象，对象的 key 为对应的产物类型。\n\n比如为 web 和 node 设置不同的 extension 前缀：\n\nexport default {\n  output: {\n    source: {\n      resolveExtensionPrefix: {\n        web: '.web',\n        node: '.node',\n      },\n    },\n  },\n};\n\n\n在代码中 import './foo' 时，对于 node 产物，会优先识别 foo.node.js 文件，而对于 web 产物，则会优先识别 foo.web.js 文件。\n\n\n# source.resolveMainFields\n\n * Type:\n\ntype Fields = (string | string[])[];\n\ntype ResolveMainFields = Fields | Record<BuilderTarget, Fields>;\n\n\n * Default: undefined\n\n该配置项将决定你使用 package.json 哪个字段导入 npm 模块。对应 webpack 的 resolve.mainFields 配置。\n\n# 示例\n\nexport default {\n  source: {\n    resolveMainFields: ['main', 'browser', 'exports'],\n  },\n};\n\n\n# 根据产物类型设置\n\n当你同时构建多种类型的产物时，你可以为不同的产物类型设置不同的 mainFields。此时，你需要把 resolveMainFields 设置为一个对象，对象的 key 为对应的产物类型。\n\n比如为 web 和 node 设置不同的 mainFields：\n\nexport default {\n  output: {\n    source: {\n      resolveMainFields: {\n        web: ['main', 'browser', 'exports'],\n        node: ['main', 'node', 'exports'],\n      },\n    },\n  },\n};\n",normalizedContent:"# source config\n\n本章节描述了 builder 中与源代码有关的配置。\n\n\n# source.alias\n\n * type: record<string, string | string[]> | function\n * default: undefined\n\n设置文件引用的别名，对应 webpack 的 resolve.alias 配置。\n\ntip\n\n对于 typescript 项目，只需要在 tsconfig.json 中配置 compileroptions.paths 即可，builder 会自动识别 tsconfig.json 里的别名，因此不需要额外配置 alias 字段。\n\n# object 类型\n\nalias 的值可以定义为 object 类型，其中的相对路径会自动被 builder 转换为绝对路径。\n\nexport default {\n  source: {\n    alias: {\n      '@common': './src/common',\n    },\n  },\n};\n\n\n以上配置完成后，如果在代码中引用 @common/foo.tsx, 则会映射到 <root>/src/common/foo.tsx 路径上。\n\n# function 类型\n\nalias 的值定义为函数时，可以接受预设的 alias 对象，并对其进行修改。\n\nexport default {\n  source: {\n    alias: alias => {\n      alias['@common'] = './src/common';\n    },\n  },\n};\n\n\n也可以在函数中返回一个新对象作为最终结果，新对象会覆盖预设的 alias 对象。\n\nexport default {\n  source: {\n    alias: alias => {\n      return {\n        '@common': './src/common',\n      };\n    },\n  },\n};\n\n\n\n# source.include\n\n * type: array<string | regexp>\n * default: []\n\n出于编译性能的考虑，默认情况下，builder 不会编译 node_modules 下的 javascript/typescript 文件，也不会编译当前工程目录外部的 javascript/typescript 文件。\n\n通过 source.include 配置项，可以指定需要额外进行编译的目录或模块。用法与 webpack 中的 rule.include 一致，支持传入字符串或正则表达式来匹配模块的路径。\n\n比如:\n\nimport path from 'path';\n\nexport default {\n  source: {\n    include: [path.resolve(__dirname, '../other-dir')],\n  },\n};\n\n\n\n# 场景示例\n\n比较典型的使用场景是编译 node_modules 下的文件，因为某些第三方依赖存在 es6+ 的语法，这可能导致在低版本浏览器上无法运行，你可以通过该选项指定需要编译的依赖，从而解决此类问题。以 query-string 为例，你可以做如下的配置：\n\nimport path from 'path';\n\nexport default {\n  source: {\n    include: [\n      // 方法一:\n      // 先通过 require.resolve 来获取模块的路径\n      // 再通过 path.dirname 来指向对应的目录\n      path.dirname(require.resolve('query-string')),\n      // 方法二:\n      // 通过正则表达式进行匹配\n      // 所有包含 `/query-string/` 的路径都会被匹配到\n      /\\/query-string\\//,\n    ],\n  },\n};\n\n\n> 注意，该配置只会编译 query-string 自身的代码，不会编译 query-string 的子依赖。如果需要编译 query-string 的子依赖，则需要将对应的 npm 包也加入到 source.include 中。\n\n\n# monorepo 项目\n\n使用 monorepo 时，如果需要引用 monorepo 中其他库的源代码，也可以直接在 source.include 进行配置:\n\nimport path from 'path';\n\nexport default {\n  source: {\n    include: [\n      // 方法一:\n      // 编译 monorepo 的 package 目录下的所有文件\n      path.resolve(__dirname, '../../packages'),\n\n      // 方法二:\n      // 编译 monorepo 的 package 目录里某个包的源代码\n      // 这种写法匹配的范围更加精准，对整体编译性能的影响更小\n      path.resolve(__dirname, '../../packages/xxx/src'),\n    ],\n  },\n};\n\n\n\n# 注意事项\n\n注意，babel 默认无法编译 commonjs 模块，当你使用 source.include 来编译 commonjs 模块时，需要将 babel 的 sourcetype 配置设置为 unambiguous：\n\nexport default {\n  tools: {\n    babel(config) {\n      config.sourcetype = 'unambiguous';\n    },\n  },\n};\n\n\n将 sourcetype 设置为 unambiguous 可能会产生一些其他影响，请参考 babel 官方文档。\n\n\n# source.exclude\n\n * type: array<string | regexp>\n * default: []\n\n指定不需要编译的 javascript/typescript 文件。用法与 webpack 中的 rule.exclude 一致，支持传入字符串或正则表达式来匹配模块的路径。\n\n比如:\n\nimport path from 'path';\n\nexport default {\n  source: {\n    exclude: [path.resolve(__dirname, 'src/module-a'), /src\\/module-b/],\n  },\n};\n\n\n\n# source.compilejsdatauri\n\n * type: boolean\n * default: true\n\n对于使用 data uri 引入的 javascript 代码，是否采用 babel 进行编译。\n\n比如以下代码：\n\nimport x from 'data:text/javascript,export default 1;';\n\nimport 'data:text/javascript;charset=utf-8;base64,y29uc29szs5sb2coj2lubgluzsaxjyk7';\n\n\n# 示例\n\n添加以下配置来关闭：\n\nexport default {\n  source: {\n    compilejsdatauri: false,\n  },\n};\n\n\n\n# source.define\n\n * type: record<string, unknown>\n * default: {}\n\n构建时将代码中的变量替换成其它值或者表达式，可以用于在代码逻辑中区分开发环境与生产环境等场景。\n\n传入的配置对象的键名是需要替换变量的名称，或者是用 . 连接的多个标识符，配置项的值则根据类型进行不同的处理：\n\n * 字符串会被当作代码片段。\n * 包括函数在内的其他类型会被转换成字符串。\n * 嵌套对象的父子键名之间会用 . 连接作为需要替换的变量名。\n * 以 typeof 开头的键名会用来替换 typeof 调用。\n\n更多细节参考 https://webpack.js.org/plugins/define-plugin/。\n\n# 示例\n\nexport default {\n  source: {\n    define: {\n      production: json.stringify(true),\n      version: json.stringify('5fa3b9'),\n      browser_supports_html5: true,\n      two: '1 + 1',\n      'typeof window': json.stringify('object'),\n      'process.env.node_env': json.stringify(process.env.node_env),\n      'import.meta': { test: undefined },\n    },\n  },\n};\n\n\n表达式会被替换为对应的代码段：\n\nconst foo = two;\n\n// ⬇️ turn into being...\nconst foo = 1 + 1;\n\n\n\n# source.globalvars\n\n * type: record<string, jsonvalue>\n * default:\n\n// builder 会自动添加环境变量 `process.env.node_env` 作为默认值，因此你不需要手动添加它。\nconst defaultglobalvars = {\n  'process.env.node_env': json.stringify(process.env.node_env),\n};\n\n\n构建时将类似 process.env.foo 的全局变量表达式替换为指定的值，比如：\n\nconsole.log(process.env.node_env);\n\n// ⬇️ turn into being...\nconsole.log('development');\n\n\n使用解构赋值时，构建器无法判断变量 node_env 是否与要替换的表达式 process.env.node_env 存在关联，所以这样的使用方式是无效的：\n\nconst { node_env } = process.env;\nconsole.log(node_env);\n// ❌ won't get a string.\n\n\nsource.globalvars 是 source.define 的一个语法糖，唯一的区别是 source.globalvars 会自动将传入的值进行 json 序列化处理，这使得设置全局变量的值更容易。注意 globalvars 的每个值都需要是可以被 json 序列化的值。\n\nexport default {\n  source: {\n    globalvars: {\n      'process.env.build_version': '0.0.1',\n      'import.meta.foo': { bar: 42 },\n      'import.meta.baz': false,\n    },\n    define: {\n      'process.env.build_version': json.stringify('0.0.1'),\n      'import.meta': {\n        foo: json.stringify({ bar: 42 }),\n        baz: json.stringify(false),\n      },\n    },\n  },\n};\n\n\n# 示例\n\nexport default {\n  source: {\n    globalvars: {\n      enable_vconsole: true,\n      app_context: { answer: 42 },\n    },\n  },\n};\n\n\n\n# source.modulescopes\n\n * type: array<string | regexp> | function\n * default: undefined\n\n限制源代码的引用路径。配置该选项后，所有源文件只能从约定的目录下引用代码，从其他目录引用代码会产生对应的报错提示。\n\n# 示例\n\n首先我们配置 modulescopes 仅包含 src 目录：\n\nexport default {\n  source: {\n    modulescopes: ['./src'],\n  },\n};\n\n\n然后在 src/app.tsx 中导入 src 目录外部的 utils/a 模块:\n\nimport a from '../utils/a';\n\n\n在编译时，会提示引用路径错误:\n\n\n\n通过该选项配置 utils 目录，再进行编译，则不会出现错误提示。\n\nexport default {\n  source: {\n    modulescopes: ['./src', './utils'],\n  },\n};\n\n\n# array 类型\n\n当 modulescopes 的值为 array 类型时，可以直接设置若干个代码路径，比如添加以下配置：\n\nexport default {\n  source: {\n    modulescopes: ['./src', './shared', './utils'],\n  },\n};\n\n\n# function 类型\n\nmodulescopes 也支持通过函数的形式来进行修改，避免覆盖默认值：\n\nexport default {\n  source: {\n    modulescopes: scopes => {\n      scopes.push('./shared');\n    },\n  },\n};\n\n\n\n# source.preentry\n\n * type: string | string[]\n * default: undefined\n\n在每个页面的入口文件前添加一段脚本，这段脚本会早于页面的代码执行，在这个脚本中可以进行执行一些全局的代码配置，比如注入 polyfill 等。\n\n# 添加单个脚本\n\n首先创建一个 src/polyfill.ts 文件：\n\nconsole.log('i am a polyfill');\n\n\n然后将 src/polyfill.ts 配置到 source.preentry 上：\n\nexport default {\n  source: {\n    preentry: './src/polyfill.ts',\n  },\n};\n\n\n重新运行编译并访问任意页面，可以看到 src/polyfill.ts 中的代码已经执行，并在 console 中输出了对应的内容。\n\n# 添加多个脚本\n\n可以将 preentry 设置为数组来添加多个脚本：\n\nexport default {\n  source: {\n    preentry: ['./src/polyfill-a.ts', './src/polyfill-b.ts'],\n  },\n};\n\n\n\n# source.resolveextensionprefix\n\n * type: string | record<buildertarget, string>\n * default: undefined\n\n用于为 resolve.extensions 添加统一的前缀。\n\n如果多个文件拥有相同的名称，但具有不同的文件后缀，builder 会根据 extensions 数组的顺序进行识别，解析数组中第一个被识别的文件，并跳过其余文件。\n\n# 示例\n\n下面是配置 .web 前缀的例子。\n\nexport default {\n  source: {\n    resolveextensionprefix: '.web',\n  },\n};\n\n\n配置完成后，extensions 数组会发生以下变化：\n\n// 配置前\nconst extensions = ['.js', '.ts', ...];\n\n// 配置后\nconst extensions = ['.web.js', '.js', '.web.ts' , '.ts', ...];\n\n\n在代码中 import './foo' 时，会优先识别 foo.web.js 文件，再识别 foo.js 文件。\n\n# 根据产物类型设置\n\n当你同时构建多种类型的产物时，你可以为不同的产物类型设置不同的 extension 前缀。此时，你需要把 resolveextensionprefix 设置为一个对象，对象的 key 为对应的产物类型。\n\n比如为 web 和 node 设置不同的 extension 前缀：\n\nexport default {\n  output: {\n    source: {\n      resolveextensionprefix: {\n        web: '.web',\n        node: '.node',\n      },\n    },\n  },\n};\n\n\n在代码中 import './foo' 时，对于 node 产物，会优先识别 foo.node.js 文件，而对于 web 产物，则会优先识别 foo.web.js 文件。\n\n\n# source.resolvemainfields\n\n * type:\n\ntype fields = (string | string[])[];\n\ntype resolvemainfields = fields | record<buildertarget, fields>;\n\n\n * default: undefined\n\n该配置项将决定你使用 package.json 哪个字段导入 npm 模块。对应 webpack 的 resolve.mainfields 配置。\n\n# 示例\n\nexport default {\n  source: {\n    resolvemainfields: ['main', 'browser', 'exports'],\n  },\n};\n\n\n# 根据产物类型设置\n\n当你同时构建多种类型的产物时，你可以为不同的产物类型设置不同的 mainfields。此时，你需要把 resolvemainfields 设置为一个对象，对象的 key 为对应的产物类型。\n\n比如为 web 和 node 设置不同的 mainfields：\n\nexport default {\n  output: {\n    source: {\n      resolvemainfields: {\n        web: ['main', 'browser', 'exports'],\n        node: ['main', 'node', 'exports'],\n      },\n    },\n  },\n};\n",charsets:{cjk:!0}},{title:"Tools Config",frontmatter:{extractApiHeaders:[2]},regularPath:"/zh/api/config-tools.html",relativePath:"zh/api/config-tools.md",key:"v-843d4e28",path:"/zh/api/config-tools.html",headers:[{level:2,title:"tools.autoprefixer",slug:"tools-autoprefixer",normalizedTitle:"tools.autoprefixer",charIndex:48},{level:2,title:"tools.babel",slug:"tools-babel",normalizedTitle:"tools.babel",charIndex:711},{level:2,title:"tools.cssExtract",slug:"tools-cssextract",normalizedTitle:"tools.cssextract",charIndex:4286},{level:2,title:"tools.cssLoader",slug:"tools-cssloader",normalizedTitle:"tools.cssloader",charIndex:5205},{level:2,title:"tools.devServer",slug:"tools-devserver",normalizedTitle:"tools.devserver",charIndex:6054},{level:2,title:"tools.htmlPlugin",slug:"tools-htmlplugin",normalizedTitle:"tools.htmlplugin",charIndex:11484},{level:2,title:"tools.inspector",slug:"tools-inspector",normalizedTitle:"tools.inspector",charIndex:12759},{level:2,title:"tools.less",slug:"tools-less",normalizedTitle:"tools.less",charIndex:13375},{level:2,title:"tools.minifyCss",slug:"tools-minifycss",normalizedTitle:"tools.minifycss",charIndex:14356},{level:2,title:"tools.postcss",slug:"tools-postcss",normalizedTitle:"tools.postcss",charIndex:15220},{level:2,title:"tools.pug",slug:"tools-pug",normalizedTitle:"tools.pug",charIndex:17428},{level:2,title:"tools.sass",slug:"tools-sass",normalizedTitle:"tools.sass",charIndex:18040},{level:2,title:"tools.styleLoader",slug:"tools-styleloader",normalizedTitle:"tools.styleloader",charIndex:18945},{level:2,title:"tools.styledComponents",slug:"tools-styledcomponents",normalizedTitle:"tools.styledcomponents",charIndex:19484},{level:2,title:"tools.terser",slug:"tools-terser",normalizedTitle:"tools.terser",charIndex:17704},{level:2,title:"tools.tsLoader",slug:"tools-tsloader",normalizedTitle:"tools.tsloader",charIndex:20678},{level:2,title:"tools.tsChecker",slug:"tools-tschecker",normalizedTitle:"tools.tschecker",charIndex:22038},{level:2,title:"tools.webpack",slug:"tools-webpack",normalizedTitle:"tools.webpack",charIndex:22903},{level:2,title:"tools.webpackChain",slug:"tools-webpackchain",normalizedTitle:"tools.webpackchain",charIndex:23016}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"tools.autoprefixer tools.babel tools.cssExtract tools.cssLoader tools.devServer tools.htmlPlugin tools.inspector tools.less tools.minifyCss tools.postcss tools.pug tools.sass tools.styleLoader tools.styledComponents tools.terser tools.tsLoader tools.tsChecker tools.webpack tools.webpackChain",content:"# Tools Config\n\n本章节描述了 Builder 中与底层工具有关的配置。\n\n\n# tools.autoprefixer\n\n * Type: Object | Function\n * Default\n\n{\n  flexbox: 'no-2009',\n  // browserslist 取决于项目中的 browserslist 配置\n  // 以及 `output.overrideBrowserslist`(优先级更高) 配置\n  overrideBrowserslist: browserslist,\n}\n\n\n通过 tools.autoprefixer 可以修改 autoprefixer 的配置。\n\n\n# Object 类型\n\n当 tools.autoprefixer 的值为 Object 类型时，会与默认配置通过 Object.assign 合并。比如：\n\nexport default {\n  tools: {\n    autoprefixer: {\n      flexbox: 'no-2009',\n    },\n  },\n};\n\n\n\n# Function 类型\n\n当 tools.autoprefixer 为 Function 类型时，默认配置作为第一个参数传入，可以直接修改配置对象，也可以返回一个值作为最终结果。比如：\n\nexport default {\n  tools: {\n    autoprefixer(config) {\n      // 修改 flexbox 的配置\n      config.flexbox = 'no-2009';\n    },\n  },\n};\n\n\n\n# tools.babel\n\n * Type: Object | Function\n * Default: undefined\n\n通过 tools.babel 可以修改 babel-loader 的配置项。\n\n\n# Function 类型\n\n当 tools.babel 为 Function 类型时，默认配置作为第一个参数传入，可以直接修改配置对象，也可以返回一个值作为最终结果，第二个参数提供了一些可以直接调用的工具函数：\n\nexport default {\n  tools: {\n    babel(config) {\n      // 添加一个插件，比如配置某个组件库的按需引入\n      // 目前内置了 antd 的按需引入规则\n      config.plugins.push([\n        'babel-plugin-import',\n        {\n          libraryName: 'xxx-components',\n          libraryDirectory: 'es',\n          style: true,\n        },\n      ]);\n    },\n  },\n};\n\n\n\n# Object 类型\n\n当 tools.babel 的值为 Object 类型时，会与默认配置通过 Object.assign 合并。注意 Object.assign 是浅拷贝，会完全覆盖内置的 presets 或 plugins 数组，请谨慎使用。\n\nexport default {\n  tools: {\n    babel: {\n      plugins: [\n        [\n          'babel-plugin-import',\n          {\n            libraryName: 'xxx-components',\n            libraryDirectory: 'es',\n            style: true,\n          },\n        ],\n      ],\n    },\n  },\n};\n\n\n\n# 工具函数\n\ntools.babel 为 Function 类型时，第二个参数可用的工具函数如下:\n\n# addPlugins\n\n * Type: (plugins: BabelPlugin[]) => void\n\n添加若干个 Babel 插件。\n\nexport default {\n  tools: {\n    babel(config, { addPlugins }) {\n      addPlugins([\n        [\n          'babel-plugin-import',\n          {\n            libraryName: 'xxx-components',\n            libraryDirectory: 'es',\n            style: true,\n          },\n        ],\n      ]);\n    },\n  },\n};\n\n\n# addPresets\n\n * Type: (presets: BabelPlugin[]) => void\n\n添加若干个 Babel 预设配置 (大多数情况下不需要增加预设)。\n\nexport default {\n  tools: {\n    babel(config, { addPresets }) {\n      addPresets(['@babel/preset-env']);\n    },\n  },\n};\n\n\n# removePlugins\n\n * Type: (plugins: string | string[]) => void\n\n移除 Babel 插件，传入需要移除的插件名称即可，你可以传入单个字符串，也可以传入一个字符串数组。\n\nexport default {\n  tools: {\n    babel(config, { removePlugins }) {\n      removePlugins('babel-plugin-import');\n    },\n  },\n};\n\n\n# removePresets\n\n * Type: (presets: string | string[]) => void\n\n移除 Babel 预设配置，传入需要移除的预设名称即可，你可以传入单个字符串，也可以传入一个字符串数组。\n\nexport default {\n  tools: {\n    babel(config, { removePresets }) {\n      removePresets('@babel/preset-env');\n    },\n  },\n};\n\n\n# addIncludes\n\n * Type: (includes: string | RegExp | (string | RegExp)[]) => void\n\n默认情况下 Babel 只会编译 src 目录下的业务代码，使用 addIncludes 你可以指定 Babel 编译 node_modules 下的一些文件。比如:\n\nexport default {\n  tools: {\n    babel(config, { addIncludes }) {\n      addIncludes('node_modules/xxx-components');\n    },\n  },\n};\n\n\n注意，Babel 默认无法编译 CommonJS 模块，当你使用 addIncludes 来编译 CommonJS 模块时，需要将 Babel 的 sourceType 配置设置为 unambiguous：\n\nexport default {\n  tools: {\n    babel(config) {\n      config.sourceType = 'unambiguous';\n    },\n  },\n};\n\n\n将 sourceType 设置为 unambiguous 可能会产生一些其他影响，请参考 Babel 官方文档。\n\nTIP\n\nBuilder 提供了比 addIncludes 更通用的 source.include 配置项，推荐优先使用该配置项。\n\n# addExcludes\n\n * Type: (excludes: string | RegExp | (string | RegExp)[]) => void\n\n和 addIncludes 相反，指定 Babel 编译时排除某些文件。\n\n比如不编译 src/example 目录下的文件:\n\nexport default {\n  tools: {\n    babel(config, { addExcludes }) {\n      addExcludes('src/example');\n    },\n  },\n};\n\n\n# modifyPresetEnvOptions\n\n * Type: (options: PresetEnvOptions) => void\n\n修改 @babel/preset-env 的配置项，传入的配置会与默认配置进行浅层合并，比如:\n\nexport default {\n  tools: {\n    babel(config, { modifyPresetEnvOptions }) {\n      modifyPresetEnvOptions({\n        targets: {\n          browsers: ['last 2 versions'],\n        },\n      });\n    },\n  },\n};\n\n\n# modifyPresetReactOptions\n\n * Type: (options: PresetReactOptions) => void\n\n修改 @babel/preset-react 的配置项，传入的配置会与默认配置进行浅层合并，比如:\n\nexport default {\n  tools: {\n    babel(config, { modifyPresetReactOptions }) {\n      modifyPresetReactOptions({\n        pragma: 'React.createElement',\n      });\n    },\n  },\n};\n\n\n\n# tools.cssExtract\n\n * Type: Object | Function\n * Default:\n\nconst defaultOptions = {\n  // Loader 配置\n  loaderOptions: {},\n  // Plugin 配置\n  pluginOptions: {\n    // cssPath 默认为 static/css, cssFilename 默认为 [name].[contenthash:8].css\n    filename: `${cssPath}/${cssFilename}`,\n    chunkFilename: `${cssPath}/async/${cssFilename}`,\n    ignoreOrder: true,\n  },\n};\n\n\n通过 tools.cssExtract 可以更改 mini-css-extract-plugin 的配置。\n\n\n# Object 类型\n\n当此值为 Object 类型时，与默认配置通过 Object.assign 合并。比如：\n\nexport default {\n  tools: {\n    cssExtract: {\n      pluginOptions: {\n        filename: 'static/css/[name].[contenthash:8].css',\n      },\n    },\n  },\n};\n\n\n\n# Function 类型\n\n当此值为 Function 类型时，默认配置作为第一个参数传入，你可以直接修改配置对象，也可以返回一个对象作为最终配置。比如：\n\nexport default {\n  tools: {\n    cssExtract: config => {\n      config.pluginOptions.filename = 'static/css/[name].[contenthash:8].css';\n      return config;\n    },\n  },\n};\n\n\n更多配置细节可参考 mini-css-extract-plugin。\n\n\n# tools.cssLoader\n\n * Type: Object | Function\n * Default: undefined\n\n通过 tools.cssLoader 可以修改 css-loader 的配置项。默认配置如下:\n\n{\n  importLoaders: 1,\n  modules: {\n    auto: true,\n    exportLocalsConvention: 'camelCase',\n    localIdentName: config.output.cssModuleLocalIdentName,\n    // isServer 表示 node (SSR) 构建\n    // isWebWorker 表示 web worker 构建\n    exportOnlyLocals: isServer || isWebWorker,\n  },\n  // 默认在开发环境下启用 CSS 的 Source Map\n  sourceMap: isDev,\n}\n\n\n\n# Object 类型\n\n当此值为 Object 类型时，会与默认配置进行深层合并 (deep merge)。比如：\n\nexport default {\n  tools: {\n    cssLoader: {\n      modules: {\n        exportOnlyLocals: true,\n      },\n    },\n  },\n};\n\n\n\n# Function 类型\n\n当此值为 Function 类型时，默认配置作为第一个参数传入，你可以直接修改配置对象，也可以返回一个对象作为最终配置。比如：\n\nexport default {\n  tools: {\n    cssLoader: config => {\n      config.modules.exportOnlyLocals = true;\n      return config;\n    },\n  },\n};\n\n\n\n# tools.devServer\n\n * Type: Object\n * Default: {}\n\n通过 tools.devServer 可以修改开发环境服务器的配置。\n\n\n# 选项\n\n# after\n\n * Type: Array\n * Default: []\n\n添加自定义中间件，在所有开发环境中间件后执行。\n\nexport default {\n  tools: {\n    devServer: {\n      after: [\n        async (req, res, next) => {\n          console.log('after dev middleware');\n          next();\n        },\n      ],\n    },\n  },\n};\n\n\n# before\n\n * Type: Array\n * Default: []\n\n添加自定义中间件，在所有开发环境中间件前执行。\n\nexport default {\n  tools: {\n    devServer: {\n      before: [\n        async (req, res, next) => {\n          console.log('before dev middleware');\n          next();\n        },\n      ],\n    },\n  },\n};\n\n\n# client\n\n * Type:\n\n{\n    /** 事件流路径 */\n    path?: string;\n    /** 指定监听请求的端口号 */\n    port?: string;\n    /** 指定要使用的 host */\n    host?: string;\n}\n\n\n * Default:\n\n{\n    path: '/webpack-hmr',\n    port: '8080',\n    host: networkAddress || 'localhost',\n}\n\n\n配置 hmr 客户端相关功能。\n\n# devMiddleware\n\n * Type:\n\n{\n  writeToDisk: boolean | ((filename: string) => boolean);\n}\n\n\n * Default:\n\n{\n  writeToDisk: (file: string) => !file.includes('.hot-update.'),\n}\n\n\ndevMiddleware 配置项。当前配置是 webpack-dev-middleware 配置项的子集.\n\n# headers\n\n * Type: Record<string, string>\n * Default: undefined\n\n设置自定义响应头。\n\nexport default {\n  tools: {\n    devServer: {\n      headers: {\n        'X-Custom-Foo': 'bar',\n      },\n    },\n  },\n};\n\n\n# historyApiFallback\n\n * Type: boolean | ConnectHistoryApiFallbackOptions\n * Default: false\n\n在需要对一些 404 响应或其他请求提供替代页面的场景，可通过 devServer.historyApiFallback 进行设置：\n\nexport default {\n  tools: {\n    devServer: {\n      historyApiFallback: true,\n    },\n  },\n};\n\n\n更多选项和详细信息可参考 connect-history-api-fallback 文档。\n\n# hot\n\n * Type: boolean\n * Default: true\n\n是否开启 Hot Module Replacement 热更新能力。\n\n# https\n\n * Type: boolean | { key: string; cert: string }\n * Default: false\n\n默认情况下，DevServer 会启用 HTTP 服务器。通过设置 devServer.https 为 true 将开启对 HTTPS 的支持，同时会禁用 HTTP 服务器。\n\n你也可以手动传入 HTTPS 服务器所需要的证书和对应的私钥：\n\nexport default {\n  tools: {\n    devServer: {\n      https: {\n        key: fs.readFileSync('certificates/private.pem'),\n        cert: fs.readFileSync('certificates/public.pem'),\n      },\n    },\n  },\n};\n\n\n# liveReload\n\n * Type: boolean\n * Default: true\n\n默认情况下，当监听到文件变化时，DevServer 将会刷新页面（为使 liveReload 能够生效，devServer.hot 配置项应当禁用）。通过设置 devServer.liveReload 为 false 可以关闭该行为。\n\n# setupMiddlewares\n\n * Type:\n\nArray<\n  (\n    middlewares: {\n      unshift: (...handlers: RequestHandler[]) => void;\n      push: (...handlers: RequestHandler[]) => void;\n    },\n    server: {\n      sockWrite: (\n        type: string,\n        data?: string | boolean | Record<string, any>,\n      ) => void;\n    },\n  ) => void\n>;\n\n\n * Default: undefined\n\n提供执行自定义函数和应用自定义中间件的能力。\n\n几种不同中间件之间的执行顺序是: devServer.before => unshift => 内置中间件 => push => devServer.after。\n\nexport default {\n  tools: {\n    devServer: {\n      setupMiddlewares: [\n        (middlewares, server) => {\n          middlewares.unshift((req, res, next) => {\n            next();\n          });\n\n          middlewares.push((req, res, next) => {\n            next();\n          });\n        },\n      ],\n    },\n  },\n};\n\n\n一些特殊场景需求可能需要使用服务器 API：\n\n * sockWrite。允许向 hmr 客户端传递一些消息，hmr 客户端将根据接收到的消息类型进行不同的处理。如果你发送一个 \"content-changed \" 的消息，页面将会重新加载。\n\nexport default {\n  tools: {\n    devServer: {\n      setupMiddlewares: [\n        (middlewares, server) => {\n          // 添加自定义 watcher 并在文件更新时触发页面刷新\n          watcher.on('change', changed => {\n            server.sockWrite('content-changed');\n          });\n        },\n      ],\n    },\n  },\n};\n\n\n# proxy\n\n * Type: Record<string, string> | Record<string, ProxyDetail>\n * Default: undefined\n\n代理请求到指定的服务上。\n\nexport default {\n  tools: {\n    devServer: {\n      proxy: {\n        '/api': 'http://localhost:3000',\n      },\n    },\n  },\n};\n\n\n此时，/api/users 请求将会代理到 http://localhost:3000/api/users。\n\n如果你不想传递 /api，可以通过 pathRewrite 重写请求路径：\n\nexport default {\n  tools: {\n    devServer: {\n      proxy: {\n        '/api': {\n          target: 'http://localhost:3000',\n          pathRewrite: { '^/api': '' },\n        },\n      },\n    },\n  },\n};\n\n\nDevServer Proxy 基于 http-proxy-middleware 实现。你可以使用 http-proxy-middleware 的所有配置项，具体可以查看文档。\n\nDevServer Proxy 完整类型定义为：\n\nimport type { Options as HttpProxyOptions } from 'http-proxy-middleware';\n\ntype ProxyDetail = HttpProxyOptions & {\n  bypass?: (\n    req: IncomingMessage,\n    res: ServerResponse,\n    proxyOptions: ProxyOptions,\n  ) => string | undefined | null | false;\n  context?: string | string[];\n};\n\ntype ProxyOptions =\n  | Record<string, string>\n  | Record<string, ProxyDetail>\n  | ProxyDetail[]\n  | ProxyDetail;\n\n\n除了 http-proxy-middleware 的选项外，还支持 bypass 和 context 两个配置项：\n\n * bypass：根据函数的返回值绕过代理。\n   * 返回 null 或 undefined 会继续用代理处理请求。\n   * 返回 false 会返回 404 错误。\n   * 返回一个具体的服务路径，将会使用此路径替代原请求路径。\n * context：如果你想代理多个特定的路径到同一个目标，你可以使用 context 配置项。\n\n// 自定义 bypass 方法\nexport default {\n  tools: {\n    devServer: {\n      proxy: {\n        '/api': {\n          target: 'http://localhost:3000',\n          bypass: function (req, res, proxyOptions) {\n            if (req.headers.accept.indexOf('html') !== -1) {\n              console.log('Skipping proxy for browser request.');\n              return '/index.html';\n            }\n          },\n        },\n      },\n    },\n  },\n};\n\n\n// 代理多个路径到同一个目标\nexport default {\n  tools: {\n    devServer: {\n      proxy: [\n        {\n          context: ['/auth', '/api'],\n          target: 'http://localhost:3000',\n        },\n      ],\n    },\n  },\n};\n\n\n# watch\n\n * Type: boolean\n * Default: true\n\n是否监听 mock/、server/、api/ 等目录的文件变化。\n\n\n# tools.htmlPlugin\n\n * Type: false | Object | Function\n * Default:\n\nconst defaultHtmlPluginOptions = {\n  inject, // 对应 html.inject 配置项\n  favicon, // 对应 html.favicon 配置项\n  filename, // 基于 output.distPath 和 entryName 生成\n  template, // 默认为内置的 HTML 模板路径\n  templateParameters, // 对应 html.templateParameters 配置项\n  chunks: [entryName],\n  minify: {\n    removeComments: true,\n    useShortDoctype: true,\n    keepClosingSlash: true,\n    collapseWhitespace: true,\n    removeRedundantAttributes: true,\n    removeScriptTypeAttributes: true,\n    removeStyleLinkTypeAttributes: true,\n  },\n};\n\n\n通过 tools.htmlPlugin 可以修改 html-webpack-plugin 的配置项。\n\n\n# Object 类型\n\n当 tools.htmlPlugin 的值为 Object 类型时，会与默认配置通过 Object.assign 合并。\n\nexport default {\n  tools: {\n    htmlPlugin: {\n      scriptLoading: 'blocking',\n    },\n  },\n};\n\n\n\n# Function 类型\n\n当 tools.htmlPlugin 为 Function 类型时：\n\n * 第一个参数是默认配置的对象，可以直接修改该对象。\n * 第二个参数是也是一个对象，包含了 entry 的名称和 entry 的值。\n * 函数可以 return 一个新的对象作为最终的配置。\n\nexport default {\n  tools: {\n    htmlPlugin(config, { entryName, entryValue }) {\n      if (entryName === 'main') {\n        config.scriptLoading = 'blocking';\n      }\n    },\n  },\n};\n\n\n\n# Boolean 类型\n\n将 tools.htmlPlugin 配置为 false，可以禁用默认的 html-webpack-plugin 插件。\n\nexport default {\n  tools: {\n    htmlPlugin: false,\n  },\n};\n\n\n\n# tools.inspector\n\n * Type: Object | Function | undefined\n * Default: undefined\n\n你可以通过 tools.inspector 开启或者配置 webpack 调试工具 webpack inspector。\n\n当配置不为 undefined 时，则表示开启了 webpack-inspector，此时 tools.inspector 的类型可以为 Object 或者 Function。\n\n\n# Object 类型\n\n当 tools.inspector 的值为 Object 类型时，会与默认配置通过 Object.assign 合并。比如：\n\nexport default {\n  tools: {\n    inspector: {\n      // 默认端口为 3333\n      port: 3334,\n    },\n  },\n};\n\n\n\n# Function 类型\n\n当 tools.inspector 为 Function 类型时，默认配置作为第一个参数传入，可以直接修改配置对象，也可以返回一个值作为最终结果。比如：\n\nexport default {\n  tools: {\n    inspector(config) {\n      // 修改端口号\n      config.port = 3333;\n    },\n  },\n};\n\n\n\n# tools.less\n\n * Type: Object | Function\n * Default:\n\nconst defaultOptions = {\n  lessOptions: {\n    javascriptEnabled: true,\n  },\n  // 默认在开发环境下启用 CSS 的 Source Map\n  sourceMap: isDev,\n};\n\n\n你可以通过 tools.less 修改 less-loader 的配置。\n\n\n# Object 类型\n\n当 tools.less 的值为 Object 类型时，会与默认配置通过 Object.assign 进行浅层合并，值得注意的是，lessOptions 会通过 deepMerge 进行深层合并。\n\nexport default {\n  tools: {\n    less: {\n      lessOptions: {\n        javascriptEnabled: false,\n      },\n    },\n  },\n};\n\n\n\n# Function 类型\n\n当 tools.less 为 Function 类型时，默认配置作为第一个参数传入，可以直接修改配置对象，也可以返回一个值作为最终结果，第二个参数提供了一些可以直接调用的工具函数：\n\nexport default {\n  tools: {\n    less(config) {\n      // 修改 lessOptions 配置\n      config.lessOptions = {\n        javascriptEnabled: false,\n      };\n    },\n  },\n};\n\n\n\n# 工具函数\n\n# addExcludes\n\n * Type: (excludes: RegExp | RegExp[]) => void\n\n用来指定 less-loader 不编译哪些文件，你可以传入一个或多个正则表达式来匹配 less 文件的路径。例如：\n\nexport default {\n  tools: {\n    less(config, { addExcludes }) {\n      addExcludes(/node_modules/);\n    },\n  },\n};\n\n\n\n# tools.minifyCss\n\n * Type: Object | Function | undefined\n * Default:\n\nconst defaultOptions = {\n  minimizerOptions: {\n    preset: [\n      'default',\n      {\n        mergeLonghand: false,\n      },\n    ],\n  },\n};\n\n\n在生产环境构建时，Builder 会通过 css-minimizer-webpack-plugin 对 CSS 代码进行压缩优化。可以通过 tools.minifyCss 修改 css-minimizer-webpack-plugin 的配置。\n\n\n# Object 类型\n\n当 tools.minifyCss 的值为 Object 类型时，会与默认配置通过 Object.assign 合并。\n\n例如下面修改 cssnano 的 preset 配置：\n\nexport default {\n  tools: {\n    minifyCss: {\n      minimizerOptions: {\n        preset: require.resolve('cssnano-preset-simple'),\n      },\n    },\n  },\n};\n\n\n\n# Function 类型\n\n当 tools.minifyCss 配置为 Function 类型时，默认配置作为第一个参数传入，可以直接修改配置对象，也可以返回一个值作为最终结果。\n\nexport default {\n   tools: {\n    minifyCss: options => {\n      options.minimizerOptions = {\n        preset: require.resolve('cssnano-preset-simple'),\n      },\n    }\n  }\n};\n\n\n\n# tools.postcss\n\n * Type: Object | Function\n * Default:\n\nconst defaultOptions = {\n  postcssOptions: {\n    plugins: [\n      require('postcss-flexbugs-fixes'),\n      require('postcss-custom-properties'),\n      require('postcss-initial'),\n      require('postcss-page-break'),\n      require('postcss-font-variant'),\n      require('postcss-media-minmax'),\n      require('postcss-nesting'),\n      require('autoprefixer')({\n        flexbox: 'no-2009',\n      }),\n    ],\n    // 默认在开发环境下启用 CSS 的 Source Map\n    sourceMap: isDev,\n  },\n};\n\n\nBuilder 默认集成 PostCSS，你可以通过 tools.postcss 对 postcss-loader 进行配置。\n\n\n# Function 类型\n\n值为 Function 类型时，内部默认配置作为第一参数传入，可以直接修改配置对象不做返回，也可以返回一个对象作为最终结果；第二个参数为修改 postcss-loader 配置的工具函数集合。\n\n例如，需要在原有插件的基础上新增一个 PostCSS 插件，在 postcssOptions.plugins 数组中 push 一个新的插件即可：\n\nexport default {\n  tools: {\n    postcss: opts => {\n      opts.postcssOptions.plugins.push(require('postcss-px-to-viewport'));\n    },\n  },\n};\n\n\n需要给 PostCSS 插件传递参数时，可以通过函数参数的形式进行传入：\n\nexport default {\n  tools: {\n    postcss: opts => {\n      const viewportPlugin = require('postcss-px-to-viewport')({\n        viewportWidth: 375,\n      });\n      opts.postcssOptions.plugins.push(viewportPlugin);\n    },\n  },\n};\n\n\ntools.postcss 可以返回一个配置对象，并完全替换默认配置：\n\nexport default {\n  tools: {\n    postcss: () => {\n      return {\n        postcssOptions: {\n          plugins: [require('postcss-px-to-viewport')],\n        },\n      };\n    },\n  },\n};\n\n\n\n# Object 类型\n\n当此值为 Object 类型时，与默认配置通过 Object.assign 合并。注意 Object.assign 是浅拷贝，会完全覆盖内置的 plugins 数组，请谨慎使用。\n\nexport default {\n  tools: {\n    postcss: {\n      // 由于使用 `Object.assign` 合并，因此默认的 postcssOptions 会被覆盖。\n      postcssOptions: {\n        plugins: [require('postcss-px-to-viewport')],\n      },\n    },\n  },\n};\n\n\n\n# 工具函数\n\n# addPlugins\n\n * Type: (plugins: PostCSSPlugin | PostCSSPlugin[]) => void\n\n用于添加额外的 PostCSS 插件，你可以传入单个 PostCSS 插件，也可以传入 PostCSS 插件数组。\n\nexport default {\n  tools: {\n    postcss: (config, { addPlugins }) => {\n      // 添加一个插件\n      addPlugins(require('postcss-preset-env'));\n      // 批量添加插件\n      addPlugins([require('postcss-preset-env'), require('postcss-import')]);\n    },\n  },\n};\n\n\nTIP\n\nBuilder 中使用的 PostCSS 版本为 v8，当你引入社区中的 PostCSS 插件时，请注意版本是否适配，部分旧版本插件可能无法在 PostCSS v8 下运行。\n\n\n# tools.pug\n\n * Type: true | Object | Function | undefined\n * Default: false\n\n配置 Pug 模板引擎。\n\n\n# Boolean 类型\n\nBuilder 默认不启用 Pug 模板引擎，你可以将 tools.pug 设置为 true 来启用它。\n\nexport default {\n  tools: {\n    pug: true,\n  },\n};\n\n\n启用后，你可以在 html.template 中指定使用 index.pug 作为模板文件。\n\n\n# Object 类型\n\n当 tools.terser 的值为 Object 类型时，可以配置 Pug 模板引擎的选项：\n\nexport default {\n  tools: {\n    pug: {\n      doctype: 'xml',\n    },\n  },\n};\n\n\n详细参数请查看 Pug API Reference。\n\n\n# Function 类型\n\n当 tools.pug 配置为 Function 类型时，默认配置作为第一个参数传入，可以直接修改配置对象，也可以返回一个值作为最终结果。\n\nexport default {\n  tools: {\n    pug(config) {\n      config.doctype = 'xml';\n    },\n  },\n};\n\n\n\n# tools.sass\n\n * Type: Object | Function\n * Default:\n\nconst defaultOptions = {\n  // 默认在开发环境下启用 CSS 的 Source Map\n  sourceMap: isDev,\n};\n\n\n你可以通过 tools.sass 修改 sass-loader 的配置。\n\n\n# Object 类型\n\n当 tools.sass 的值为 Object 类型时，会与默认配置通过 Object.assign 进行浅层合并，值得注意的是，sassOptions 会通过 deepMerge 进行深层合并。\n\nexport default {\n  tools: {\n    sass: {\n      sourceMap: true,\n    },\n  },\n};\n\n\n\n# Function 类型\n\n当 tools.sass 为 Function 类型时，默认配置作为第一个参数传入，可以直接修改配置对象，也可以返回一个值作为最终结果，第二个参数提供了一些可以直接调用的工具函数：\n\nexport default {\n  tools: {\n    sass(config) {\n      // 修改 sourceMap 配置\n      config.additionalData = async (content, loaderContext) => {\n        // ...\n      };\n    },\n  },\n};\n\n\n\n# 工具函数\n\n# addExcludes\n\n * Type: (excludes: RegExp | RegExp[]) => void\n\n用来指定 sass-loader 不编译哪些文件，你可以传入一个或多个正则表达式来匹配 sass 文件的路径。例如：\n\nexport default {\n  tools: {\n    sass(config, { addExcludes }) {\n      addExcludes(/node_modules/);\n    },\n  },\n};\n\n\n\n# tools.styleLoader\n\n * Type: Object | Function\n * Default: {}\n\n通过 tools.styleLoader 可以设置 style-loader 的配置项。\n\n值得注意的是，Builder 默认不会开启 style-loader，你可以通过 output.disableCssExtract 配置项来开启它。\n\n\n# Object 类型\n\n当此值为 Object 类型时，与默认配置通过 Object.assign 合并。比如：\n\nexport default {\n  tools: {\n    styleLoader: {\n      insert: 'head',\n    },\n  },\n};\n\n\n\n# Function 类型\n\n当此值为 Function 类型时，默认配置作为第一个参数传入，你可以直接修改配置对象，也可以返回一个对象作为最终配置。比如：\n\nexport default {\n  tools: {\n    styleLoader: config => {\n      config.insert = 'head';\n      return config;\n    },\n  },\n};\n\n\n\n# tools.styledComponents\n\n * Type: Object | Function\n * Default\n\n{\n  pure: true,\n  displayName: true,\n  // 在 SSR 构建中 isSSR 为 true\n  ssr: isSSR,\n  transpileTemplateLiterals: true,\n}\n\n\n对应 babel-plugin-styled-components 的配置。 值为 Object 类型时，利用 Object.assign 函数与默认配置合并。比如:\n\nexport default {\n  tools: {\n    styledComponents: {\n      pure: false,\n    },\n  },\n};\n\n\n值为 Function 类型时，第一个参数为默认配置，第二个参数提供了一些可以直接调用的工具函数：\n\nexport default {\n  tools: {\n    styledComponents(config) {\n      // 修改 pure 配置\n      config.pure = false;\n    },\n  },\n};\n\n\n\n# tools.terser\n\n * Type: Object | Function | undefined\n * Default:\n\nconst defaultTerserOptions = {\n  terserOptions: {\n    mangle: {\n      safari10: true,\n    },\n  },\n};\n\n\n在生产环境构建时，Builder 会通过 terser-webpack-plugin 对 JavaScript 代码进行压缩优化。可以通过 tools.terser 修改 terser-webpack-plugin 的配置。\n\n\n# Object 类型\n\n当 tools.terser 的值为 Object 类型时，会与默认配置通过 Object.assign 合并。\n\n例如通过 exclude 排除部分文件的压缩：\n\nexport default {\n  tools: {\n    terser: {\n      exclude: /\\/excludes/,\n    },\n  },\n};\n\n\n\n# Function 类型\n\n当 tools.terser 配置为 Function 类型时，默认配置作为第一个参数传入，可以直接修改配置对象，也可以返回一个值作为最终结果。\n\nexport default {\n  tools: {\n    terser: opts => {\n      opts.exclude = /\\/excludes/;\n    },\n  },\n};\n\n\n\n# tools.tsLoader\n\n * Type: Object | Function | undefined\n * Default: undefined\n\n项目中默认不开启 ts-loader，当 tools.tsLoader 不为 undefined 则表示开启 ts-loader，同时禁用 babel-loader 对 TypeScript 的编译。\n\n\n# Object 类型\n\n当此值为 Object 类型时，与默认配置通过 Object.assign 合并。\n\n默认配置如下:\n\n{\n  \"compilerOptions\": {\n    \"target\": \"es5\",\n    \"module\": \"ESNext\"\n  },\n  \"transpileOnly\": true,\n  \"allowTsInNodeModules\": true\n}\n\n\n你可以通过 tools.tsLoader 配置项来覆盖默认配置:\n\nexport default {\n  tools: {\n    tsLoader: {\n      allowTsInNodeModules: false,\n    },\n  },\n};\n\n\n\n# Function 类型\n\n当此值为 Function 类型时，默认配置作为第一参数传入，可以直接修改配置对象，也可以返回一个对象作为最终配置；第二个参数为修改 ts-loader 配置工具函数集合：\n\nexport default {\n  tools: {\n    tsLoader: opts => {\n      opts.allowTsInNodeModules = false;\n    },\n  },\n};\n\n\n\n# 工具函数\n\ntools.tsLoader 的值为 Function 类型时，第二个参数可用的工具函数如下：\n\n# addIncludes\n\n类型: (includes: string | RegExp | Array<string | RegExp>) => void\n\n默认情况下只会编译 src 目录下的业务代码，使用 addIncludes 可以指定 ts-loader 编译 node_modules 下的一些文件。比如:\n\nexport default {\n  tools: {\n    tsLoader: (config, { addIncludes }) => {\n      addIncludes([/node_modules\\/react/]);\n    },\n  },\n};\n\n\n# addExcludes\n\n类型: (excludes: string | RegExp | Array<string | RegExp>) => void\n\n和 addIncludes 相反，指定 ts-loader 编译时排除某些文件。\n\n例如不编译 src/example 目录下的文件：\n\nexport default {\n  tools: {\n    tsLoader: (config, { addExcludes }) => {\n      addExcludes([/src\\/example\\//]);\n    },\n  },\n};\n\n\n\n# tools.tsChecker\n\n * Type: Object | Function\n * Default:\n\nconst defaultOptions = {\n  typescript: {\n    // avoid OOM issue\n    memoryLimit: 8192,\n    // use tsconfig of user project\n    configFile: tsconfigPath,\n    // use typescript of user project\n    typescriptPath: require.resolve('typescript'),\n  },\n  issue: {\n    exclude: [\n      { file: '**/*.(spec|test).ts' },\n      { file: '**/node_modules/**/*' },\n    ],\n  },\n  logger: {\n    log() {\n      // do nothing\n      // we only want to display error messages\n    },\n    error(message: string) {\n      console.error(message.replace(/ERROR/g, 'Type Error'));\n    },\n  },\n},\n\n\n默认情况下，Builder 会开启 fork-ts-checker-webpack-plugin 进行类型检查。你可以通过 output.disableTsChecker 配置项来关闭类型检查。\n\n\n# Object 类型\n\n当此值为 Object 类型时，与默认配置通过 Object.assign 合并。\n\n\n# Function 类型\n\n当此值为 Function 类型时，默认配置作为第一个参数传入，你可以直接修改配置对象，也可以返回一个对象作为最终配置。\n\n\n# tools.webpack\n\n * Type: Object | Function | undefined\n * Default: undefined\n\ntools.webpack 选项用于配置原生的 webpack。\n\n> tools.webpackChain 同样可以修改 webpack 配置，并且功能更加强大，建议优先使用 tools.webpackChain。\n\n\n# Object 类型\n\n你可以配置为一个对象，这个对象将会和原始的 webpack 配置通过 webpack-merge 进行合并。比如：\n\nexport default {\n  tools: {\n    webpack: {\n      resolve: {\n        alias: {\n          '@util': 'src/util',\n        },\n      },\n    },\n  },\n};\n\n\n\n# Function 类型\n\n你也可以配置为一个函数，这个函数接收一个参数，即原始的 webpack 配置，你可以对这个配置进行修改，然后返回一个新的配置。比如：\n\nexport default {\n  tools: {\n    webpack: config => {\n      config.resolve.alias['@util'] = 'src/util';\n      return config;\n    },\n  },\n};\n\n\n这个函数的第二个参数是一个对象，包含了一些工具集合的信息。详情如下：\n\n\n# 工具集合\n\n# env\n\n * Type: 'development' | 'production' | 'test'\n\n通过 env 参数可以判断当前环境为 development、production 还是 test。比如：\n\nexport default {\n  tools: {\n    webpack: (config, { env }) => {\n      if (env === 'development') {\n        config.devtool = 'cheap-module-eval-source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\n# isProd\n\n * Type: boolean\n\n通过 isProd 参数可以判断当前环境是否为 production。比如：\n\nexport default {\n  tools: {\n    webpack: (config, { isProd }) => {\n      if (isProd) {\n        config.devtool = 'source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\n# target\n\n * Type: 'web' | 'node' | 'modern-web' | 'web-worker'\n\n通过 target 参数可以判断当前构建的目标运行时环境。比如：\n\nexport default {\n  tools: {\n    webpack: (config, { target }) => {\n      if (target === 'node') {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\n# isServer\n\n * Type: boolean\n\n判断当前构建的目标运行时环境是否为 node，等价于 target === 'node'。\n\nexport default {\n  tools: {\n    webpack: (config, { isServer }) => {\n      if (isServer) {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\n# isWebWorker\n\n * Type: boolean\n\n判断当前构建的目标运行时环境是否为 web-worker，等价于 target === 'web-worker'。\n\nexport default {\n  tools: {\n    webpack: (config, { isWebWorker }) => {\n      if (isWebWorker) {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\n# webpack\n\n * Type: typeof import('webpack')\n\n通过这个参数你可以拿到 webpack 实例。比如：\n\nexport default {\n  tools: {\n    webpack: (config, { webpack }) => {\n      config.plugins.push(new webpack.ProgressPlugin());\n      return config;\n    },\n  },\n};\n\n\n\n# HtmlWebpackPlugin\n\n * Type: typeof import('html-webpack-plugin')\n\n通过这个参数你可以拿到 HtmlWebpackPlugin 实例。\n\nexport default {\n  tools: {\n    webpackChain: (chain, { HtmlWebpackPlugin }) => {\n      console.log(HtmlWebpackPlugin);\n    },\n  },\n};\n\n\n\n# addRules\n\n * Type: (rules: RuleSetRule | RuleSetRule[]) => void\n\n添加额外的 webpack rules。\n\n示例：\n\nexport default {\n  tools: {\n    webpack: (config, { addRules }) => {\n      // 添加单条规则\n      addRules({\n        test: /\\.foo/,\n        loader: require.resolve('foo-loader'),\n      });\n\n      // 以数组形式添加多条规则\n      addRules([\n        {\n          test: /\\.foo/,\n          loader: require.resolve('foo-loader'),\n        },\n        {\n          test: /\\.bar/,\n          loader: require.resolve('bar-loader'),\n        },\n      ]);\n    },\n  },\n};\n\n\n\n# prependPlugins\n\n * Type: (plugins: WebpackPluginInstance | WebpackPluginInstance[]) => void\n\n在内部 webpack 插件数组头部添加额外的插件，数组头部的插件会优先执行。\n\nexport default {\n  tools: {\n    webpack: (config, { prependPlugins, webpack }) => {\n      // 添加单个插件\n      prependPlugins(\n        new webpack.BannerPlugin({\n          banner: 'hello world!',\n        }),\n      );\n\n      // 以数组形式添加多个插件\n      prependPlugins([new PluginA(), new PluginB()]);\n    },\n  },\n};\n\n\n\n# appendPlugins\n\n * Type: (plugins: WebpackPluginInstance | WebpackPluginInstance[]) => void\n\n在内部 webpack 插件数组尾部添加额外的插件，数组尾部的插件会在最后执行。\n\nexport default {\n  tools: {\n    webpack: (config, { appendPlugins, webpack }) => {\n      // 添加单个插件\n      appendPlugins([\n        new webpack.BannerPlugin({\n          banner: 'hello world!',\n        }),\n      ]);\n\n      // 以数组形式添加多个插件\n      appendPlugins([new PluginA(), new PluginB()]);\n    },\n  },\n};\n\n\n\n# removePlugin\n\n * Type: (name: string) => void\n\n删除内部的 webpack 插件，参数为该插件的 constructor.name。\n\n例如，删除内部的 fork-ts-checker-webpack-plugin：\n\nexport default {\n  tools: {\n    webpack: (config, { removePlugin }) => {\n      removePlugin('ForkTsCheckerWebpackPlugin');\n    },\n  },\n};\n\n\n\n# tools.webpackChain\n\n * Type: Function | undefined\n * Default: undefined\n\n你可以通过 tools.webpackChain 来修改默认的 webpack 配置，值为 Function 类型，接收两个参数：\n\n * 第一个参数为 webpack-chain 对象实例，你可以通过这个实例来修改默认的 webpack 配置。\n * 第二个参数为一个工具集合，包括env、isProd、CHAIN_ID 等。\n\n相比于 tools.webpack，webpack-chain 不仅支持链式调用，而且能够基于别名来定位到内置的 Rule 或 Plugin，从而实现精准的配置修改。我们推荐使用 tools.webpackChain 来代替 tools.webpack。\n\n> tools.webpackChain 的执行时机早于 tools.webpack，因此会被 tools.webpack 中的修改所覆盖。\n\n\n# 工具集合\n\n# env\n\n * Type: 'development' | 'production' | 'test'\n\n通过 env 参数可以判断当前环境为 development、production 还是 test。比如：\n\nexport default {\n  tools: {\n    webpackChain: (chain, { env }) => {\n      if (env === 'development') {\n        chain.devtool('cheap-module-eval-source-map');\n      }\n    },\n  },\n};\n\n\n# isProd\n\n * Type: boolean\n\n通过 isProd 参数可以判断当前环境是否为 production。比如：\n\nexport default {\n  tools: {\n    webpackChain: (chain, { isProd }) => {\n      if (isProd) {\n        chain.devtool('source-map');\n      }\n    },\n  },\n};\n\n\n# target\n\n * Type: 'web' | 'node' | 'modern-web' | 'web-worker'\n\n通过 target 参数可以判断当前构建的目标运行时环境。比如：\n\nexport default {\n  tools: {\n    webpackChain: (chain, { target }) => {\n      if (target === 'node') {\n        // ...\n      }\n    },\n  },\n};\n\n\n# isServer\n\n * Type: boolean\n\n判断当前构建的目标运行时环境是否为 node，等价于 target === 'node'。\n\nexport default {\n  tools: {\n    webpackChain: (chain, { isServer }) => {\n      if (isServer) {\n        // ...\n      }\n    },\n  },\n};\n\n\n# isWebWorker\n\n * Type: boolean\n\n判断当前构建的目标运行时环境是否为 web-worker，等价于 target === 'web-worker'。\n\nexport default {\n  tools: {\n    webpackChain: (chain, { isWebWorker }) => {\n      if (isWebWorker) {\n        // ...\n      }\n    },\n  },\n};\n\n\n# webpack\n\n * Type: typeof import('webpack')\n\n通过这个参数你可以拿到 webpack 实例。比如：\n\nexport default {\n  tools: {\n    webpackChain: (chain, { webpack }) => {\n      chain.plugin('my-progress').use(webpack.ProgressPlugin);\n    },\n  },\n};\n\n\n\n# HtmlWebpackPlugin\n\n * Type: typeof import('html-webpack-plugin')\n\n通过这个参数你可以拿到 HtmlWebpackPlugin 实例。\n\nexport default {\n  tools: {\n    webpackChain: (chain, { HtmlWebpackPlugin }) => {\n      console.log(HtmlWebpackPlugin);\n    },\n  },\n};\n\n\n# CHAIN_ID\n\nBuilder 中预先定义了一些常用的 Chain ID，你可以通过这些 ID 来定位到内置的 Rule 或 Plugin。\n\n# CHAIN_ID.RULE\n\nID           描述\nRULE.MJS     处理 mjs 的规则\nRULE.JS      处理 js 的规则\nRULE.TS      处理 ts 的规则\nRULE.CSS     处理 css 的规则\nRULE.LESS    处理 less 的规则\nRULE.SASS    处理 sass 的规则\nRULE.PUG     处理 pug 的规则\nRULE.TOML    处理 toml 的规则\nRULE.YAML    处理 yaml 的规则\nRULE.FONT    处理字体的规则\nRULE.IMAGE   处理图片的规则\nRULE.MEDIA   处理媒体资源的规则\n\n\n# CHAIN_ID.ONE_OF\n\n通过 ONE_OF.XXX 可以匹配到规则数组中的某一类规则。\n\nID                  描述\nONE_OF.SVG          处理 SVG 的规则，在 data URI 和单独文件之间自动选择\nONE_OF.SVG_URL      处理 SVG 的规则，输出为单独文件\nONE_OF.SVG_INLINE   处理 SVG 的规则，作为 data URI 内联到 bundle 中\nONE_OF.SVG_ASSETS   处理 SVG 的规则，在 data URI 和单独文件之间自动选择\n\n\n# CHAIN_ID.USE\n\n通过 USE.XXX 可以匹配到对应的 loader。\n\nID                     描述\nUSE.TS                 对应 ts-loader\nUSE.CSS                对应 css-loader\nUSE.LESS               对应 less-loader\nUSE.SASS               对应 sass-loader\nUSE.PUG                对应 pug-loader\nUSE.TOML               对应 toml-loader\nUSE.YAML               对应 yaml-loader\nUSE.FILE               对应 file-loader\nUSE.URL                对应 url-loader\nUSE.SVGR               对应 @svgr/webpack\nUSE.BABEL              对应 babel-loader\nUSE.STYLE              对应 style-loader\nUSE.POSTCSS            对应 postcss-loader\nUSE.MARKDOWN           对应 markdown-loader\nUSE.CSS_MODULES_TS     对应 css-modules-typescript-loader\nUSE.MINI_CSS_EXTRACT   对应 mini-css-extract-plugin.loader\n\n\n# CHAIN_ID.PLUGIN\n\n通过 PLUGIN.XXX 可以匹配到对应的 plugin。\n\nID                             描述\nPLUGIN.HMR                     对应 HotModuleReplacementPlugin\nPLUGIN.COPY                    对应 CopyWebpackPlugin\nPLUGIN.HTML                    对应 HtmlWebpackPlugin，使用时需要拼接 entry\n                               名称：${PLUGIN.HTML}-${entryName}\nPLUGIN.DEFINE                  对应 DefinePlugin\nPLUGIN.IGNORE                  对应 IgnorePlugin\nPLUGIN.BANNER                  对应 BannerPlugin\nPLUGIN.PROGRESS                对应 Webpackbar\nPLUGIN.APP_ICON                对应 AppIconPlugin\nPLUGIN.LOADABLE                对应 LoadableWebpackPlugin\nPLUGIN.MANIFEST                对应 WebpackManifestPlugin\nPLUGIN.TS_CHECKER              对应 ForkTsCheckerWebpackPlugin\nPLUGIN.INLINE_HTML             对应 InlineChunkHtmlPlugin\nPLUGIN.BUNDLE_ANALYZER         对应 WebpackBundleAnalyzer\nPLUGIN.BOTTOM_TEMPLATE         对应 BottomTemplatePlugin\nPLUGIN.MINI_CSS_EXTRACT        对应 MiniCssExtractPlugin\nPLUGIN.REACT_FAST_REFRESH      对应 ReactFastRefreshPlugin\nPLUGIN.NODE_POLYFILL_PROVIDE   对应处理 node polyfill 的 ProvidePlugin\nPLUGIN.INSPECTOR               对应 @modern-js/inspector-webpack-plugin\nPLUGIN.SUBRESOURCE_INTEGRITY   对应 webpack-subresource-integrity\nPLUGIN.ASSETS_RETRY            对应 Builder 中的 webpack 静态资源重试插件 WebpackAssetsRetryPlugin\nPLUGIN.AUTO_SET_ROOT_SIZE      对应 Builder 中的自动设置根字体大小插件 AutoSetRootSizePlugin\n\n\n# CHAIN_ID.MINIMIZER\n\n通过 MINIMIZER.XXX 可以匹配到对应的压缩工具。\n\nID                  描述\nMINIMIZER.JS        对应 TerserWebpackPlugin\nMINIMIZER.CSS       对应 CssMinimizerWebpackPlugin\nMINIMIZER.ESBUILD   对应 ESBuildPlugin\nMINIMIZER.SWC       对应 SwcWebpackPlugin\n\n\n# 常用 WebpackChain 使用示例\n\n以下是一些常见的配置示例，完整的 webpack-chain API 请见 webpack-chain 文档。\n\n# 新增/修改/删除 loader\n\nexport default {\n  tools: {\n    webpackChain: (chain, { CHAIN_ID }) => {\n      // 新增 loader\n      chain.module\n        .rule('md')\n        .test(/\\.md$/)\n        .use('md-loader')\n        .loader('md-loader');\n\n      // 修改 loader\n      chain.module\n        .rule(CHAIN_ID.RULE.JS)\n        .use(CHAIN_ID.USE.BABEL)\n        .tap(options => {\n          options.plugins.push('babel-plugin-xxx');\n          return options;\n        });\n\n      // 删除 loader\n      chain.module.rule(CHAIN_ID.RULE.JS).uses.delete(CHAIN_ID.USE.BABEL);\n    },\n  },\n};\n\n\n# 新增/修改/删除 plugin\n\nexport default {\n  tools: {\n    webpackChain: (chain, { webpack, CHAIN_ID }) => {\n      // 新增插件\n      chain.plugin('define').use(webpack.DefinePlugin, [\n        {\n          'process.env': {\n            NODE_ENV: JSON.stringify(process.env.NODE_ENV),\n          },\n        },\n      ]);\n\n      // 修改插件\n      chain.plugin(CHAIN_ID.PLUGIN.HMR).tap(options => {\n        options[0].fullBuildTimeout = 200;\n        return options;\n      });\n\n      // 删除插件\n      chain.plugins.delete(CHAIN_ID.PLUGIN.HMR);\n    },\n  },\n};\n",normalizedContent:"# tools config\n\n本章节描述了 builder 中与底层工具有关的配置。\n\n\n# tools.autoprefixer\n\n * type: object | function\n * default\n\n{\n  flexbox: 'no-2009',\n  // browserslist 取决于项目中的 browserslist 配置\n  // 以及 `output.overridebrowserslist`(优先级更高) 配置\n  overridebrowserslist: browserslist,\n}\n\n\n通过 tools.autoprefixer 可以修改 autoprefixer 的配置。\n\n\n# object 类型\n\n当 tools.autoprefixer 的值为 object 类型时，会与默认配置通过 object.assign 合并。比如：\n\nexport default {\n  tools: {\n    autoprefixer: {\n      flexbox: 'no-2009',\n    },\n  },\n};\n\n\n\n# function 类型\n\n当 tools.autoprefixer 为 function 类型时，默认配置作为第一个参数传入，可以直接修改配置对象，也可以返回一个值作为最终结果。比如：\n\nexport default {\n  tools: {\n    autoprefixer(config) {\n      // 修改 flexbox 的配置\n      config.flexbox = 'no-2009';\n    },\n  },\n};\n\n\n\n# tools.babel\n\n * type: object | function\n * default: undefined\n\n通过 tools.babel 可以修改 babel-loader 的配置项。\n\n\n# function 类型\n\n当 tools.babel 为 function 类型时，默认配置作为第一个参数传入，可以直接修改配置对象，也可以返回一个值作为最终结果，第二个参数提供了一些可以直接调用的工具函数：\n\nexport default {\n  tools: {\n    babel(config) {\n      // 添加一个插件，比如配置某个组件库的按需引入\n      // 目前内置了 antd 的按需引入规则\n      config.plugins.push([\n        'babel-plugin-import',\n        {\n          libraryname: 'xxx-components',\n          librarydirectory: 'es',\n          style: true,\n        },\n      ]);\n    },\n  },\n};\n\n\n\n# object 类型\n\n当 tools.babel 的值为 object 类型时，会与默认配置通过 object.assign 合并。注意 object.assign 是浅拷贝，会完全覆盖内置的 presets 或 plugins 数组，请谨慎使用。\n\nexport default {\n  tools: {\n    babel: {\n      plugins: [\n        [\n          'babel-plugin-import',\n          {\n            libraryname: 'xxx-components',\n            librarydirectory: 'es',\n            style: true,\n          },\n        ],\n      ],\n    },\n  },\n};\n\n\n\n# 工具函数\n\ntools.babel 为 function 类型时，第二个参数可用的工具函数如下:\n\n# addplugins\n\n * type: (plugins: babelplugin[]) => void\n\n添加若干个 babel 插件。\n\nexport default {\n  tools: {\n    babel(config, { addplugins }) {\n      addplugins([\n        [\n          'babel-plugin-import',\n          {\n            libraryname: 'xxx-components',\n            librarydirectory: 'es',\n            style: true,\n          },\n        ],\n      ]);\n    },\n  },\n};\n\n\n# addpresets\n\n * type: (presets: babelplugin[]) => void\n\n添加若干个 babel 预设配置 (大多数情况下不需要增加预设)。\n\nexport default {\n  tools: {\n    babel(config, { addpresets }) {\n      addpresets(['@babel/preset-env']);\n    },\n  },\n};\n\n\n# removeplugins\n\n * type: (plugins: string | string[]) => void\n\n移除 babel 插件，传入需要移除的插件名称即可，你可以传入单个字符串，也可以传入一个字符串数组。\n\nexport default {\n  tools: {\n    babel(config, { removeplugins }) {\n      removeplugins('babel-plugin-import');\n    },\n  },\n};\n\n\n# removepresets\n\n * type: (presets: string | string[]) => void\n\n移除 babel 预设配置，传入需要移除的预设名称即可，你可以传入单个字符串，也可以传入一个字符串数组。\n\nexport default {\n  tools: {\n    babel(config, { removepresets }) {\n      removepresets('@babel/preset-env');\n    },\n  },\n};\n\n\n# addincludes\n\n * type: (includes: string | regexp | (string | regexp)[]) => void\n\n默认情况下 babel 只会编译 src 目录下的业务代码，使用 addincludes 你可以指定 babel 编译 node_modules 下的一些文件。比如:\n\nexport default {\n  tools: {\n    babel(config, { addincludes }) {\n      addincludes('node_modules/xxx-components');\n    },\n  },\n};\n\n\n注意，babel 默认无法编译 commonjs 模块，当你使用 addincludes 来编译 commonjs 模块时，需要将 babel 的 sourcetype 配置设置为 unambiguous：\n\nexport default {\n  tools: {\n    babel(config) {\n      config.sourcetype = 'unambiguous';\n    },\n  },\n};\n\n\n将 sourcetype 设置为 unambiguous 可能会产生一些其他影响，请参考 babel 官方文档。\n\ntip\n\nbuilder 提供了比 addincludes 更通用的 source.include 配置项，推荐优先使用该配置项。\n\n# addexcludes\n\n * type: (excludes: string | regexp | (string | regexp)[]) => void\n\n和 addincludes 相反，指定 babel 编译时排除某些文件。\n\n比如不编译 src/example 目录下的文件:\n\nexport default {\n  tools: {\n    babel(config, { addexcludes }) {\n      addexcludes('src/example');\n    },\n  },\n};\n\n\n# modifypresetenvoptions\n\n * type: (options: presetenvoptions) => void\n\n修改 @babel/preset-env 的配置项，传入的配置会与默认配置进行浅层合并，比如:\n\nexport default {\n  tools: {\n    babel(config, { modifypresetenvoptions }) {\n      modifypresetenvoptions({\n        targets: {\n          browsers: ['last 2 versions'],\n        },\n      });\n    },\n  },\n};\n\n\n# modifypresetreactoptions\n\n * type: (options: presetreactoptions) => void\n\n修改 @babel/preset-react 的配置项，传入的配置会与默认配置进行浅层合并，比如:\n\nexport default {\n  tools: {\n    babel(config, { modifypresetreactoptions }) {\n      modifypresetreactoptions({\n        pragma: 'react.createelement',\n      });\n    },\n  },\n};\n\n\n\n# tools.cssextract\n\n * type: object | function\n * default:\n\nconst defaultoptions = {\n  // loader 配置\n  loaderoptions: {},\n  // plugin 配置\n  pluginoptions: {\n    // csspath 默认为 static/css, cssfilename 默认为 [name].[contenthash:8].css\n    filename: `${csspath}/${cssfilename}`,\n    chunkfilename: `${csspath}/async/${cssfilename}`,\n    ignoreorder: true,\n  },\n};\n\n\n通过 tools.cssextract 可以更改 mini-css-extract-plugin 的配置。\n\n\n# object 类型\n\n当此值为 object 类型时，与默认配置通过 object.assign 合并。比如：\n\nexport default {\n  tools: {\n    cssextract: {\n      pluginoptions: {\n        filename: 'static/css/[name].[contenthash:8].css',\n      },\n    },\n  },\n};\n\n\n\n# function 类型\n\n当此值为 function 类型时，默认配置作为第一个参数传入，你可以直接修改配置对象，也可以返回一个对象作为最终配置。比如：\n\nexport default {\n  tools: {\n    cssextract: config => {\n      config.pluginoptions.filename = 'static/css/[name].[contenthash:8].css';\n      return config;\n    },\n  },\n};\n\n\n更多配置细节可参考 mini-css-extract-plugin。\n\n\n# tools.cssloader\n\n * type: object | function\n * default: undefined\n\n通过 tools.cssloader 可以修改 css-loader 的配置项。默认配置如下:\n\n{\n  importloaders: 1,\n  modules: {\n    auto: true,\n    exportlocalsconvention: 'camelcase',\n    localidentname: config.output.cssmodulelocalidentname,\n    // isserver 表示 node (ssr) 构建\n    // iswebworker 表示 web worker 构建\n    exportonlylocals: isserver || iswebworker,\n  },\n  // 默认在开发环境下启用 css 的 source map\n  sourcemap: isdev,\n}\n\n\n\n# object 类型\n\n当此值为 object 类型时，会与默认配置进行深层合并 (deep merge)。比如：\n\nexport default {\n  tools: {\n    cssloader: {\n      modules: {\n        exportonlylocals: true,\n      },\n    },\n  },\n};\n\n\n\n# function 类型\n\n当此值为 function 类型时，默认配置作为第一个参数传入，你可以直接修改配置对象，也可以返回一个对象作为最终配置。比如：\n\nexport default {\n  tools: {\n    cssloader: config => {\n      config.modules.exportonlylocals = true;\n      return config;\n    },\n  },\n};\n\n\n\n# tools.devserver\n\n * type: object\n * default: {}\n\n通过 tools.devserver 可以修改开发环境服务器的配置。\n\n\n# 选项\n\n# after\n\n * type: array\n * default: []\n\n添加自定义中间件，在所有开发环境中间件后执行。\n\nexport default {\n  tools: {\n    devserver: {\n      after: [\n        async (req, res, next) => {\n          console.log('after dev middleware');\n          next();\n        },\n      ],\n    },\n  },\n};\n\n\n# before\n\n * type: array\n * default: []\n\n添加自定义中间件，在所有开发环境中间件前执行。\n\nexport default {\n  tools: {\n    devserver: {\n      before: [\n        async (req, res, next) => {\n          console.log('before dev middleware');\n          next();\n        },\n      ],\n    },\n  },\n};\n\n\n# client\n\n * type:\n\n{\n    /** 事件流路径 */\n    path?: string;\n    /** 指定监听请求的端口号 */\n    port?: string;\n    /** 指定要使用的 host */\n    host?: string;\n}\n\n\n * default:\n\n{\n    path: '/webpack-hmr',\n    port: '8080',\n    host: networkaddress || 'localhost',\n}\n\n\n配置 hmr 客户端相关功能。\n\n# devmiddleware\n\n * type:\n\n{\n  writetodisk: boolean | ((filename: string) => boolean);\n}\n\n\n * default:\n\n{\n  writetodisk: (file: string) => !file.includes('.hot-update.'),\n}\n\n\ndevmiddleware 配置项。当前配置是 webpack-dev-middleware 配置项的子集.\n\n# headers\n\n * type: record<string, string>\n * default: undefined\n\n设置自定义响应头。\n\nexport default {\n  tools: {\n    devserver: {\n      headers: {\n        'x-custom-foo': 'bar',\n      },\n    },\n  },\n};\n\n\n# historyapifallback\n\n * type: boolean | connecthistoryapifallbackoptions\n * default: false\n\n在需要对一些 404 响应或其他请求提供替代页面的场景，可通过 devserver.historyapifallback 进行设置：\n\nexport default {\n  tools: {\n    devserver: {\n      historyapifallback: true,\n    },\n  },\n};\n\n\n更多选项和详细信息可参考 connect-history-api-fallback 文档。\n\n# hot\n\n * type: boolean\n * default: true\n\n是否开启 hot module replacement 热更新能力。\n\n# https\n\n * type: boolean | { key: string; cert: string }\n * default: false\n\n默认情况下，devserver 会启用 http 服务器。通过设置 devserver.https 为 true 将开启对 https 的支持，同时会禁用 http 服务器。\n\n你也可以手动传入 https 服务器所需要的证书和对应的私钥：\n\nexport default {\n  tools: {\n    devserver: {\n      https: {\n        key: fs.readfilesync('certificates/private.pem'),\n        cert: fs.readfilesync('certificates/public.pem'),\n      },\n    },\n  },\n};\n\n\n# livereload\n\n * type: boolean\n * default: true\n\n默认情况下，当监听到文件变化时，devserver 将会刷新页面（为使 livereload 能够生效，devserver.hot 配置项应当禁用）。通过设置 devserver.livereload 为 false 可以关闭该行为。\n\n# setupmiddlewares\n\n * type:\n\narray<\n  (\n    middlewares: {\n      unshift: (...handlers: requesthandler[]) => void;\n      push: (...handlers: requesthandler[]) => void;\n    },\n    server: {\n      sockwrite: (\n        type: string,\n        data?: string | boolean | record<string, any>,\n      ) => void;\n    },\n  ) => void\n>;\n\n\n * default: undefined\n\n提供执行自定义函数和应用自定义中间件的能力。\n\n几种不同中间件之间的执行顺序是: devserver.before => unshift => 内置中间件 => push => devserver.after。\n\nexport default {\n  tools: {\n    devserver: {\n      setupmiddlewares: [\n        (middlewares, server) => {\n          middlewares.unshift((req, res, next) => {\n            next();\n          });\n\n          middlewares.push((req, res, next) => {\n            next();\n          });\n        },\n      ],\n    },\n  },\n};\n\n\n一些特殊场景需求可能需要使用服务器 api：\n\n * sockwrite。允许向 hmr 客户端传递一些消息，hmr 客户端将根据接收到的消息类型进行不同的处理。如果你发送一个 \"content-changed \" 的消息，页面将会重新加载。\n\nexport default {\n  tools: {\n    devserver: {\n      setupmiddlewares: [\n        (middlewares, server) => {\n          // 添加自定义 watcher 并在文件更新时触发页面刷新\n          watcher.on('change', changed => {\n            server.sockwrite('content-changed');\n          });\n        },\n      ],\n    },\n  },\n};\n\n\n# proxy\n\n * type: record<string, string> | record<string, proxydetail>\n * default: undefined\n\n代理请求到指定的服务上。\n\nexport default {\n  tools: {\n    devserver: {\n      proxy: {\n        '/api': 'http://localhost:3000',\n      },\n    },\n  },\n};\n\n\n此时，/api/users 请求将会代理到 http://localhost:3000/api/users。\n\n如果你不想传递 /api，可以通过 pathrewrite 重写请求路径：\n\nexport default {\n  tools: {\n    devserver: {\n      proxy: {\n        '/api': {\n          target: 'http://localhost:3000',\n          pathrewrite: { '^/api': '' },\n        },\n      },\n    },\n  },\n};\n\n\ndevserver proxy 基于 http-proxy-middleware 实现。你可以使用 http-proxy-middleware 的所有配置项，具体可以查看文档。\n\ndevserver proxy 完整类型定义为：\n\nimport type { options as httpproxyoptions } from 'http-proxy-middleware';\n\ntype proxydetail = httpproxyoptions & {\n  bypass?: (\n    req: incomingmessage,\n    res: serverresponse,\n    proxyoptions: proxyoptions,\n  ) => string | undefined | null | false;\n  context?: string | string[];\n};\n\ntype proxyoptions =\n  | record<string, string>\n  | record<string, proxydetail>\n  | proxydetail[]\n  | proxydetail;\n\n\n除了 http-proxy-middleware 的选项外，还支持 bypass 和 context 两个配置项：\n\n * bypass：根据函数的返回值绕过代理。\n   * 返回 null 或 undefined 会继续用代理处理请求。\n   * 返回 false 会返回 404 错误。\n   * 返回一个具体的服务路径，将会使用此路径替代原请求路径。\n * context：如果你想代理多个特定的路径到同一个目标，你可以使用 context 配置项。\n\n// 自定义 bypass 方法\nexport default {\n  tools: {\n    devserver: {\n      proxy: {\n        '/api': {\n          target: 'http://localhost:3000',\n          bypass: function (req, res, proxyoptions) {\n            if (req.headers.accept.indexof('html') !== -1) {\n              console.log('skipping proxy for browser request.');\n              return '/index.html';\n            }\n          },\n        },\n      },\n    },\n  },\n};\n\n\n// 代理多个路径到同一个目标\nexport default {\n  tools: {\n    devserver: {\n      proxy: [\n        {\n          context: ['/auth', '/api'],\n          target: 'http://localhost:3000',\n        },\n      ],\n    },\n  },\n};\n\n\n# watch\n\n * type: boolean\n * default: true\n\n是否监听 mock/、server/、api/ 等目录的文件变化。\n\n\n# tools.htmlplugin\n\n * type: false | object | function\n * default:\n\nconst defaulthtmlpluginoptions = {\n  inject, // 对应 html.inject 配置项\n  favicon, // 对应 html.favicon 配置项\n  filename, // 基于 output.distpath 和 entryname 生成\n  template, // 默认为内置的 html 模板路径\n  templateparameters, // 对应 html.templateparameters 配置项\n  chunks: [entryname],\n  minify: {\n    removecomments: true,\n    useshortdoctype: true,\n    keepclosingslash: true,\n    collapsewhitespace: true,\n    removeredundantattributes: true,\n    removescripttypeattributes: true,\n    removestylelinktypeattributes: true,\n  },\n};\n\n\n通过 tools.htmlplugin 可以修改 html-webpack-plugin 的配置项。\n\n\n# object 类型\n\n当 tools.htmlplugin 的值为 object 类型时，会与默认配置通过 object.assign 合并。\n\nexport default {\n  tools: {\n    htmlplugin: {\n      scriptloading: 'blocking',\n    },\n  },\n};\n\n\n\n# function 类型\n\n当 tools.htmlplugin 为 function 类型时：\n\n * 第一个参数是默认配置的对象，可以直接修改该对象。\n * 第二个参数是也是一个对象，包含了 entry 的名称和 entry 的值。\n * 函数可以 return 一个新的对象作为最终的配置。\n\nexport default {\n  tools: {\n    htmlplugin(config, { entryname, entryvalue }) {\n      if (entryname === 'main') {\n        config.scriptloading = 'blocking';\n      }\n    },\n  },\n};\n\n\n\n# boolean 类型\n\n将 tools.htmlplugin 配置为 false，可以禁用默认的 html-webpack-plugin 插件。\n\nexport default {\n  tools: {\n    htmlplugin: false,\n  },\n};\n\n\n\n# tools.inspector\n\n * type: object | function | undefined\n * default: undefined\n\n你可以通过 tools.inspector 开启或者配置 webpack 调试工具 webpack inspector。\n\n当配置不为 undefined 时，则表示开启了 webpack-inspector，此时 tools.inspector 的类型可以为 object 或者 function。\n\n\n# object 类型\n\n当 tools.inspector 的值为 object 类型时，会与默认配置通过 object.assign 合并。比如：\n\nexport default {\n  tools: {\n    inspector: {\n      // 默认端口为 3333\n      port: 3334,\n    },\n  },\n};\n\n\n\n# function 类型\n\n当 tools.inspector 为 function 类型时，默认配置作为第一个参数传入，可以直接修改配置对象，也可以返回一个值作为最终结果。比如：\n\nexport default {\n  tools: {\n    inspector(config) {\n      // 修改端口号\n      config.port = 3333;\n    },\n  },\n};\n\n\n\n# tools.less\n\n * type: object | function\n * default:\n\nconst defaultoptions = {\n  lessoptions: {\n    javascriptenabled: true,\n  },\n  // 默认在开发环境下启用 css 的 source map\n  sourcemap: isdev,\n};\n\n\n你可以通过 tools.less 修改 less-loader 的配置。\n\n\n# object 类型\n\n当 tools.less 的值为 object 类型时，会与默认配置通过 object.assign 进行浅层合并，值得注意的是，lessoptions 会通过 deepmerge 进行深层合并。\n\nexport default {\n  tools: {\n    less: {\n      lessoptions: {\n        javascriptenabled: false,\n      },\n    },\n  },\n};\n\n\n\n# function 类型\n\n当 tools.less 为 function 类型时，默认配置作为第一个参数传入，可以直接修改配置对象，也可以返回一个值作为最终结果，第二个参数提供了一些可以直接调用的工具函数：\n\nexport default {\n  tools: {\n    less(config) {\n      // 修改 lessoptions 配置\n      config.lessoptions = {\n        javascriptenabled: false,\n      };\n    },\n  },\n};\n\n\n\n# 工具函数\n\n# addexcludes\n\n * type: (excludes: regexp | regexp[]) => void\n\n用来指定 less-loader 不编译哪些文件，你可以传入一个或多个正则表达式来匹配 less 文件的路径。例如：\n\nexport default {\n  tools: {\n    less(config, { addexcludes }) {\n      addexcludes(/node_modules/);\n    },\n  },\n};\n\n\n\n# tools.minifycss\n\n * type: object | function | undefined\n * default:\n\nconst defaultoptions = {\n  minimizeroptions: {\n    preset: [\n      'default',\n      {\n        mergelonghand: false,\n      },\n    ],\n  },\n};\n\n\n在生产环境构建时，builder 会通过 css-minimizer-webpack-plugin 对 css 代码进行压缩优化。可以通过 tools.minifycss 修改 css-minimizer-webpack-plugin 的配置。\n\n\n# object 类型\n\n当 tools.minifycss 的值为 object 类型时，会与默认配置通过 object.assign 合并。\n\n例如下面修改 cssnano 的 preset 配置：\n\nexport default {\n  tools: {\n    minifycss: {\n      minimizeroptions: {\n        preset: require.resolve('cssnano-preset-simple'),\n      },\n    },\n  },\n};\n\n\n\n# function 类型\n\n当 tools.minifycss 配置为 function 类型时，默认配置作为第一个参数传入，可以直接修改配置对象，也可以返回一个值作为最终结果。\n\nexport default {\n   tools: {\n    minifycss: options => {\n      options.minimizeroptions = {\n        preset: require.resolve('cssnano-preset-simple'),\n      },\n    }\n  }\n};\n\n\n\n# tools.postcss\n\n * type: object | function\n * default:\n\nconst defaultoptions = {\n  postcssoptions: {\n    plugins: [\n      require('postcss-flexbugs-fixes'),\n      require('postcss-custom-properties'),\n      require('postcss-initial'),\n      require('postcss-page-break'),\n      require('postcss-font-variant'),\n      require('postcss-media-minmax'),\n      require('postcss-nesting'),\n      require('autoprefixer')({\n        flexbox: 'no-2009',\n      }),\n    ],\n    // 默认在开发环境下启用 css 的 source map\n    sourcemap: isdev,\n  },\n};\n\n\nbuilder 默认集成 postcss，你可以通过 tools.postcss 对 postcss-loader 进行配置。\n\n\n# function 类型\n\n值为 function 类型时，内部默认配置作为第一参数传入，可以直接修改配置对象不做返回，也可以返回一个对象作为最终结果；第二个参数为修改 postcss-loader 配置的工具函数集合。\n\n例如，需要在原有插件的基础上新增一个 postcss 插件，在 postcssoptions.plugins 数组中 push 一个新的插件即可：\n\nexport default {\n  tools: {\n    postcss: opts => {\n      opts.postcssoptions.plugins.push(require('postcss-px-to-viewport'));\n    },\n  },\n};\n\n\n需要给 postcss 插件传递参数时，可以通过函数参数的形式进行传入：\n\nexport default {\n  tools: {\n    postcss: opts => {\n      const viewportplugin = require('postcss-px-to-viewport')({\n        viewportwidth: 375,\n      });\n      opts.postcssoptions.plugins.push(viewportplugin);\n    },\n  },\n};\n\n\ntools.postcss 可以返回一个配置对象，并完全替换默认配置：\n\nexport default {\n  tools: {\n    postcss: () => {\n      return {\n        postcssoptions: {\n          plugins: [require('postcss-px-to-viewport')],\n        },\n      };\n    },\n  },\n};\n\n\n\n# object 类型\n\n当此值为 object 类型时，与默认配置通过 object.assign 合并。注意 object.assign 是浅拷贝，会完全覆盖内置的 plugins 数组，请谨慎使用。\n\nexport default {\n  tools: {\n    postcss: {\n      // 由于使用 `object.assign` 合并，因此默认的 postcssoptions 会被覆盖。\n      postcssoptions: {\n        plugins: [require('postcss-px-to-viewport')],\n      },\n    },\n  },\n};\n\n\n\n# 工具函数\n\n# addplugins\n\n * type: (plugins: postcssplugin | postcssplugin[]) => void\n\n用于添加额外的 postcss 插件，你可以传入单个 postcss 插件，也可以传入 postcss 插件数组。\n\nexport default {\n  tools: {\n    postcss: (config, { addplugins }) => {\n      // 添加一个插件\n      addplugins(require('postcss-preset-env'));\n      // 批量添加插件\n      addplugins([require('postcss-preset-env'), require('postcss-import')]);\n    },\n  },\n};\n\n\ntip\n\nbuilder 中使用的 postcss 版本为 v8，当你引入社区中的 postcss 插件时，请注意版本是否适配，部分旧版本插件可能无法在 postcss v8 下运行。\n\n\n# tools.pug\n\n * type: true | object | function | undefined\n * default: false\n\n配置 pug 模板引擎。\n\n\n# boolean 类型\n\nbuilder 默认不启用 pug 模板引擎，你可以将 tools.pug 设置为 true 来启用它。\n\nexport default {\n  tools: {\n    pug: true,\n  },\n};\n\n\n启用后，你可以在 html.template 中指定使用 index.pug 作为模板文件。\n\n\n# object 类型\n\n当 tools.terser 的值为 object 类型时，可以配置 pug 模板引擎的选项：\n\nexport default {\n  tools: {\n    pug: {\n      doctype: 'xml',\n    },\n  },\n};\n\n\n详细参数请查看 pug api reference。\n\n\n# function 类型\n\n当 tools.pug 配置为 function 类型时，默认配置作为第一个参数传入，可以直接修改配置对象，也可以返回一个值作为最终结果。\n\nexport default {\n  tools: {\n    pug(config) {\n      config.doctype = 'xml';\n    },\n  },\n};\n\n\n\n# tools.sass\n\n * type: object | function\n * default:\n\nconst defaultoptions = {\n  // 默认在开发环境下启用 css 的 source map\n  sourcemap: isdev,\n};\n\n\n你可以通过 tools.sass 修改 sass-loader 的配置。\n\n\n# object 类型\n\n当 tools.sass 的值为 object 类型时，会与默认配置通过 object.assign 进行浅层合并，值得注意的是，sassoptions 会通过 deepmerge 进行深层合并。\n\nexport default {\n  tools: {\n    sass: {\n      sourcemap: true,\n    },\n  },\n};\n\n\n\n# function 类型\n\n当 tools.sass 为 function 类型时，默认配置作为第一个参数传入，可以直接修改配置对象，也可以返回一个值作为最终结果，第二个参数提供了一些可以直接调用的工具函数：\n\nexport default {\n  tools: {\n    sass(config) {\n      // 修改 sourcemap 配置\n      config.additionaldata = async (content, loadercontext) => {\n        // ...\n      };\n    },\n  },\n};\n\n\n\n# 工具函数\n\n# addexcludes\n\n * type: (excludes: regexp | regexp[]) => void\n\n用来指定 sass-loader 不编译哪些文件，你可以传入一个或多个正则表达式来匹配 sass 文件的路径。例如：\n\nexport default {\n  tools: {\n    sass(config, { addexcludes }) {\n      addexcludes(/node_modules/);\n    },\n  },\n};\n\n\n\n# tools.styleloader\n\n * type: object | function\n * default: {}\n\n通过 tools.styleloader 可以设置 style-loader 的配置项。\n\n值得注意的是，builder 默认不会开启 style-loader，你可以通过 output.disablecssextract 配置项来开启它。\n\n\n# object 类型\n\n当此值为 object 类型时，与默认配置通过 object.assign 合并。比如：\n\nexport default {\n  tools: {\n    styleloader: {\n      insert: 'head',\n    },\n  },\n};\n\n\n\n# function 类型\n\n当此值为 function 类型时，默认配置作为第一个参数传入，你可以直接修改配置对象，也可以返回一个对象作为最终配置。比如：\n\nexport default {\n  tools: {\n    styleloader: config => {\n      config.insert = 'head';\n      return config;\n    },\n  },\n};\n\n\n\n# tools.styledcomponents\n\n * type: object | function\n * default\n\n{\n  pure: true,\n  displayname: true,\n  // 在 ssr 构建中 isssr 为 true\n  ssr: isssr,\n  transpiletemplateliterals: true,\n}\n\n\n对应 babel-plugin-styled-components 的配置。 值为 object 类型时，利用 object.assign 函数与默认配置合并。比如:\n\nexport default {\n  tools: {\n    styledcomponents: {\n      pure: false,\n    },\n  },\n};\n\n\n值为 function 类型时，第一个参数为默认配置，第二个参数提供了一些可以直接调用的工具函数：\n\nexport default {\n  tools: {\n    styledcomponents(config) {\n      // 修改 pure 配置\n      config.pure = false;\n    },\n  },\n};\n\n\n\n# tools.terser\n\n * type: object | function | undefined\n * default:\n\nconst defaultterseroptions = {\n  terseroptions: {\n    mangle: {\n      safari10: true,\n    },\n  },\n};\n\n\n在生产环境构建时，builder 会通过 terser-webpack-plugin 对 javascript 代码进行压缩优化。可以通过 tools.terser 修改 terser-webpack-plugin 的配置。\n\n\n# object 类型\n\n当 tools.terser 的值为 object 类型时，会与默认配置通过 object.assign 合并。\n\n例如通过 exclude 排除部分文件的压缩：\n\nexport default {\n  tools: {\n    terser: {\n      exclude: /\\/excludes/,\n    },\n  },\n};\n\n\n\n# function 类型\n\n当 tools.terser 配置为 function 类型时，默认配置作为第一个参数传入，可以直接修改配置对象，也可以返回一个值作为最终结果。\n\nexport default {\n  tools: {\n    terser: opts => {\n      opts.exclude = /\\/excludes/;\n    },\n  },\n};\n\n\n\n# tools.tsloader\n\n * type: object | function | undefined\n * default: undefined\n\n项目中默认不开启 ts-loader，当 tools.tsloader 不为 undefined 则表示开启 ts-loader，同时禁用 babel-loader 对 typescript 的编译。\n\n\n# object 类型\n\n当此值为 object 类型时，与默认配置通过 object.assign 合并。\n\n默认配置如下:\n\n{\n  \"compileroptions\": {\n    \"target\": \"es5\",\n    \"module\": \"esnext\"\n  },\n  \"transpileonly\": true,\n  \"allowtsinnodemodules\": true\n}\n\n\n你可以通过 tools.tsloader 配置项来覆盖默认配置:\n\nexport default {\n  tools: {\n    tsloader: {\n      allowtsinnodemodules: false,\n    },\n  },\n};\n\n\n\n# function 类型\n\n当此值为 function 类型时，默认配置作为第一参数传入，可以直接修改配置对象，也可以返回一个对象作为最终配置；第二个参数为修改 ts-loader 配置工具函数集合：\n\nexport default {\n  tools: {\n    tsloader: opts => {\n      opts.allowtsinnodemodules = false;\n    },\n  },\n};\n\n\n\n# 工具函数\n\ntools.tsloader 的值为 function 类型时，第二个参数可用的工具函数如下：\n\n# addincludes\n\n类型: (includes: string | regexp | array<string | regexp>) => void\n\n默认情况下只会编译 src 目录下的业务代码，使用 addincludes 可以指定 ts-loader 编译 node_modules 下的一些文件。比如:\n\nexport default {\n  tools: {\n    tsloader: (config, { addincludes }) => {\n      addincludes([/node_modules\\/react/]);\n    },\n  },\n};\n\n\n# addexcludes\n\n类型: (excludes: string | regexp | array<string | regexp>) => void\n\n和 addincludes 相反，指定 ts-loader 编译时排除某些文件。\n\n例如不编译 src/example 目录下的文件：\n\nexport default {\n  tools: {\n    tsloader: (config, { addexcludes }) => {\n      addexcludes([/src\\/example\\//]);\n    },\n  },\n};\n\n\n\n# tools.tschecker\n\n * type: object | function\n * default:\n\nconst defaultoptions = {\n  typescript: {\n    // avoid oom issue\n    memorylimit: 8192,\n    // use tsconfig of user project\n    configfile: tsconfigpath,\n    // use typescript of user project\n    typescriptpath: require.resolve('typescript'),\n  },\n  issue: {\n    exclude: [\n      { file: '**/*.(spec|test).ts' },\n      { file: '**/node_modules/**/*' },\n    ],\n  },\n  logger: {\n    log() {\n      // do nothing\n      // we only want to display error messages\n    },\n    error(message: string) {\n      console.error(message.replace(/error/g, 'type error'));\n    },\n  },\n},\n\n\n默认情况下，builder 会开启 fork-ts-checker-webpack-plugin 进行类型检查。你可以通过 output.disabletschecker 配置项来关闭类型检查。\n\n\n# object 类型\n\n当此值为 object 类型时，与默认配置通过 object.assign 合并。\n\n\n# function 类型\n\n当此值为 function 类型时，默认配置作为第一个参数传入，你可以直接修改配置对象，也可以返回一个对象作为最终配置。\n\n\n# tools.webpack\n\n * type: object | function | undefined\n * default: undefined\n\ntools.webpack 选项用于配置原生的 webpack。\n\n> tools.webpackchain 同样可以修改 webpack 配置，并且功能更加强大，建议优先使用 tools.webpackchain。\n\n\n# object 类型\n\n你可以配置为一个对象，这个对象将会和原始的 webpack 配置通过 webpack-merge 进行合并。比如：\n\nexport default {\n  tools: {\n    webpack: {\n      resolve: {\n        alias: {\n          '@util': 'src/util',\n        },\n      },\n    },\n  },\n};\n\n\n\n# function 类型\n\n你也可以配置为一个函数，这个函数接收一个参数，即原始的 webpack 配置，你可以对这个配置进行修改，然后返回一个新的配置。比如：\n\nexport default {\n  tools: {\n    webpack: config => {\n      config.resolve.alias['@util'] = 'src/util';\n      return config;\n    },\n  },\n};\n\n\n这个函数的第二个参数是一个对象，包含了一些工具集合的信息。详情如下：\n\n\n# 工具集合\n\n# env\n\n * type: 'development' | 'production' | 'test'\n\n通过 env 参数可以判断当前环境为 development、production 还是 test。比如：\n\nexport default {\n  tools: {\n    webpack: (config, { env }) => {\n      if (env === 'development') {\n        config.devtool = 'cheap-module-eval-source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\n# isprod\n\n * type: boolean\n\n通过 isprod 参数可以判断当前环境是否为 production。比如：\n\nexport default {\n  tools: {\n    webpack: (config, { isprod }) => {\n      if (isprod) {\n        config.devtool = 'source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\n# target\n\n * type: 'web' | 'node' | 'modern-web' | 'web-worker'\n\n通过 target 参数可以判断当前构建的目标运行时环境。比如：\n\nexport default {\n  tools: {\n    webpack: (config, { target }) => {\n      if (target === 'node') {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\n# isserver\n\n * type: boolean\n\n判断当前构建的目标运行时环境是否为 node，等价于 target === 'node'。\n\nexport default {\n  tools: {\n    webpack: (config, { isserver }) => {\n      if (isserver) {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\n# iswebworker\n\n * type: boolean\n\n判断当前构建的目标运行时环境是否为 web-worker，等价于 target === 'web-worker'。\n\nexport default {\n  tools: {\n    webpack: (config, { iswebworker }) => {\n      if (iswebworker) {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\n# webpack\n\n * type: typeof import('webpack')\n\n通过这个参数你可以拿到 webpack 实例。比如：\n\nexport default {\n  tools: {\n    webpack: (config, { webpack }) => {\n      config.plugins.push(new webpack.progressplugin());\n      return config;\n    },\n  },\n};\n\n\n\n# htmlwebpackplugin\n\n * type: typeof import('html-webpack-plugin')\n\n通过这个参数你可以拿到 htmlwebpackplugin 实例。\n\nexport default {\n  tools: {\n    webpackchain: (chain, { htmlwebpackplugin }) => {\n      console.log(htmlwebpackplugin);\n    },\n  },\n};\n\n\n\n# addrules\n\n * type: (rules: rulesetrule | rulesetrule[]) => void\n\n添加额外的 webpack rules。\n\n示例：\n\nexport default {\n  tools: {\n    webpack: (config, { addrules }) => {\n      // 添加单条规则\n      addrules({\n        test: /\\.foo/,\n        loader: require.resolve('foo-loader'),\n      });\n\n      // 以数组形式添加多条规则\n      addrules([\n        {\n          test: /\\.foo/,\n          loader: require.resolve('foo-loader'),\n        },\n        {\n          test: /\\.bar/,\n          loader: require.resolve('bar-loader'),\n        },\n      ]);\n    },\n  },\n};\n\n\n\n# prependplugins\n\n * type: (plugins: webpackplugininstance | webpackplugininstance[]) => void\n\n在内部 webpack 插件数组头部添加额外的插件，数组头部的插件会优先执行。\n\nexport default {\n  tools: {\n    webpack: (config, { prependplugins, webpack }) => {\n      // 添加单个插件\n      prependplugins(\n        new webpack.bannerplugin({\n          banner: 'hello world!',\n        }),\n      );\n\n      // 以数组形式添加多个插件\n      prependplugins([new plugina(), new pluginb()]);\n    },\n  },\n};\n\n\n\n# appendplugins\n\n * type: (plugins: webpackplugininstance | webpackplugininstance[]) => void\n\n在内部 webpack 插件数组尾部添加额外的插件，数组尾部的插件会在最后执行。\n\nexport default {\n  tools: {\n    webpack: (config, { appendplugins, webpack }) => {\n      // 添加单个插件\n      appendplugins([\n        new webpack.bannerplugin({\n          banner: 'hello world!',\n        }),\n      ]);\n\n      // 以数组形式添加多个插件\n      appendplugins([new plugina(), new pluginb()]);\n    },\n  },\n};\n\n\n\n# removeplugin\n\n * type: (name: string) => void\n\n删除内部的 webpack 插件，参数为该插件的 constructor.name。\n\n例如，删除内部的 fork-ts-checker-webpack-plugin：\n\nexport default {\n  tools: {\n    webpack: (config, { removeplugin }) => {\n      removeplugin('forktscheckerwebpackplugin');\n    },\n  },\n};\n\n\n\n# tools.webpackchain\n\n * type: function | undefined\n * default: undefined\n\n你可以通过 tools.webpackchain 来修改默认的 webpack 配置，值为 function 类型，接收两个参数：\n\n * 第一个参数为 webpack-chain 对象实例，你可以通过这个实例来修改默认的 webpack 配置。\n * 第二个参数为一个工具集合，包括env、isprod、chain_id 等。\n\n相比于 tools.webpack，webpack-chain 不仅支持链式调用，而且能够基于别名来定位到内置的 rule 或 plugin，从而实现精准的配置修改。我们推荐使用 tools.webpackchain 来代替 tools.webpack。\n\n> tools.webpackchain 的执行时机早于 tools.webpack，因此会被 tools.webpack 中的修改所覆盖。\n\n\n# 工具集合\n\n# env\n\n * type: 'development' | 'production' | 'test'\n\n通过 env 参数可以判断当前环境为 development、production 还是 test。比如：\n\nexport default {\n  tools: {\n    webpackchain: (chain, { env }) => {\n      if (env === 'development') {\n        chain.devtool('cheap-module-eval-source-map');\n      }\n    },\n  },\n};\n\n\n# isprod\n\n * type: boolean\n\n通过 isprod 参数可以判断当前环境是否为 production。比如：\n\nexport default {\n  tools: {\n    webpackchain: (chain, { isprod }) => {\n      if (isprod) {\n        chain.devtool('source-map');\n      }\n    },\n  },\n};\n\n\n# target\n\n * type: 'web' | 'node' | 'modern-web' | 'web-worker'\n\n通过 target 参数可以判断当前构建的目标运行时环境。比如：\n\nexport default {\n  tools: {\n    webpackchain: (chain, { target }) => {\n      if (target === 'node') {\n        // ...\n      }\n    },\n  },\n};\n\n\n# isserver\n\n * type: boolean\n\n判断当前构建的目标运行时环境是否为 node，等价于 target === 'node'。\n\nexport default {\n  tools: {\n    webpackchain: (chain, { isserver }) => {\n      if (isserver) {\n        // ...\n      }\n    },\n  },\n};\n\n\n# iswebworker\n\n * type: boolean\n\n判断当前构建的目标运行时环境是否为 web-worker，等价于 target === 'web-worker'。\n\nexport default {\n  tools: {\n    webpackchain: (chain, { iswebworker }) => {\n      if (iswebworker) {\n        // ...\n      }\n    },\n  },\n};\n\n\n# webpack\n\n * type: typeof import('webpack')\n\n通过这个参数你可以拿到 webpack 实例。比如：\n\nexport default {\n  tools: {\n    webpackchain: (chain, { webpack }) => {\n      chain.plugin('my-progress').use(webpack.progressplugin);\n    },\n  },\n};\n\n\n\n# htmlwebpackplugin\n\n * type: typeof import('html-webpack-plugin')\n\n通过这个参数你可以拿到 htmlwebpackplugin 实例。\n\nexport default {\n  tools: {\n    webpackchain: (chain, { htmlwebpackplugin }) => {\n      console.log(htmlwebpackplugin);\n    },\n  },\n};\n\n\n# chain_id\n\nbuilder 中预先定义了一些常用的 chain id，你可以通过这些 id 来定位到内置的 rule 或 plugin。\n\n# chain_id.rule\n\nid           描述\nrule.mjs     处理 mjs 的规则\nrule.js      处理 js 的规则\nrule.ts      处理 ts 的规则\nrule.css     处理 css 的规则\nrule.less    处理 less 的规则\nrule.sass    处理 sass 的规则\nrule.pug     处理 pug 的规则\nrule.toml    处理 toml 的规则\nrule.yaml    处理 yaml 的规则\nrule.font    处理字体的规则\nrule.image   处理图片的规则\nrule.media   处理媒体资源的规则\n\n\n# chain_id.one_of\n\n通过 one_of.xxx 可以匹配到规则数组中的某一类规则。\n\nid                  描述\none_of.svg          处理 svg 的规则，在 data uri 和单独文件之间自动选择\none_of.svg_url      处理 svg 的规则，输出为单独文件\none_of.svg_inline   处理 svg 的规则，作为 data uri 内联到 bundle 中\none_of.svg_assets   处理 svg 的规则，在 data uri 和单独文件之间自动选择\n\n\n# chain_id.use\n\n通过 use.xxx 可以匹配到对应的 loader。\n\nid                     描述\nuse.ts                 对应 ts-loader\nuse.css                对应 css-loader\nuse.less               对应 less-loader\nuse.sass               对应 sass-loader\nuse.pug                对应 pug-loader\nuse.toml               对应 toml-loader\nuse.yaml               对应 yaml-loader\nuse.file               对应 file-loader\nuse.url                对应 url-loader\nuse.svgr               对应 @svgr/webpack\nuse.babel              对应 babel-loader\nuse.style              对应 style-loader\nuse.postcss            对应 postcss-loader\nuse.markdown           对应 markdown-loader\nuse.css_modules_ts     对应 css-modules-typescript-loader\nuse.mini_css_extract   对应 mini-css-extract-plugin.loader\n\n\n# chain_id.plugin\n\n通过 plugin.xxx 可以匹配到对应的 plugin。\n\nid                             描述\nplugin.hmr                     对应 hotmodulereplacementplugin\nplugin.copy                    对应 copywebpackplugin\nplugin.html                    对应 htmlwebpackplugin，使用时需要拼接 entry\n                               名称：${plugin.html}-${entryname}\nplugin.define                  对应 defineplugin\nplugin.ignore                  对应 ignoreplugin\nplugin.banner                  对应 bannerplugin\nplugin.progress                对应 webpackbar\nplugin.app_icon                对应 appiconplugin\nplugin.loadable                对应 loadablewebpackplugin\nplugin.manifest                对应 webpackmanifestplugin\nplugin.ts_checker              对应 forktscheckerwebpackplugin\nplugin.inline_html             对应 inlinechunkhtmlplugin\nplugin.bundle_analyzer         对应 webpackbundleanalyzer\nplugin.bottom_template         对应 bottomtemplateplugin\nplugin.mini_css_extract        对应 minicssextractplugin\nplugin.react_fast_refresh      对应 reactfastrefreshplugin\nplugin.node_polyfill_provide   对应处理 node polyfill 的 provideplugin\nplugin.inspector               对应 @modern-js/inspector-webpack-plugin\nplugin.subresource_integrity   对应 webpack-subresource-integrity\nplugin.assets_retry            对应 builder 中的 webpack 静态资源重试插件 webpackassetsretryplugin\nplugin.auto_set_root_size      对应 builder 中的自动设置根字体大小插件 autosetrootsizeplugin\n\n\n# chain_id.minimizer\n\n通过 minimizer.xxx 可以匹配到对应的压缩工具。\n\nid                  描述\nminimizer.js        对应 terserwebpackplugin\nminimizer.css       对应 cssminimizerwebpackplugin\nminimizer.esbuild   对应 esbuildplugin\nminimizer.swc       对应 swcwebpackplugin\n\n\n# 常用 webpackchain 使用示例\n\n以下是一些常见的配置示例，完整的 webpack-chain api 请见 webpack-chain 文档。\n\n# 新增/修改/删除 loader\n\nexport default {\n  tools: {\n    webpackchain: (chain, { chain_id }) => {\n      // 新增 loader\n      chain.module\n        .rule('md')\n        .test(/\\.md$/)\n        .use('md-loader')\n        .loader('md-loader');\n\n      // 修改 loader\n      chain.module\n        .rule(chain_id.rule.js)\n        .use(chain_id.use.babel)\n        .tap(options => {\n          options.plugins.push('babel-plugin-xxx');\n          return options;\n        });\n\n      // 删除 loader\n      chain.module.rule(chain_id.rule.js).uses.delete(chain_id.use.babel);\n    },\n  },\n};\n\n\n# 新增/修改/删除 plugin\n\nexport default {\n  tools: {\n    webpackchain: (chain, { webpack, chain_id }) => {\n      // 新增插件\n      chain.plugin('define').use(webpack.defineplugin, [\n        {\n          'process.env': {\n            node_env: json.stringify(process.env.node_env),\n          },\n        },\n      ]);\n\n      // 修改插件\n      chain.plugin(chain_id.plugin.hmr).tap(options => {\n        options[0].fullbuildtimeout = 200;\n        return options;\n      });\n\n      // 删除插件\n      chain.plugins.delete(chain_id.plugin.hmr);\n    },\n  },\n};\n",charsets:{cjk:!0}},{frontmatter:{api:!0},regularPath:"/zh/api/",relativePath:"zh/api/index.md",key:"v-1d4ee519",path:"/zh/api/",lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"",normalizedContent:"",charsets:{}},{title:"Plugin Core",frontmatter:{extractApiHeaders:[2]},regularPath:"/zh/api/plugin-core.html",relativePath:"zh/api/plugin-core.md",key:"v-702e38d2",path:"/zh/api/plugin-core.html",headers:[{level:2,title:"BuilderPlugin",slug:"builderplugin",normalizedTitle:"builderplugin",charIndex:50},{level:2,title:"BuilderPluginAPI",slug:"builderpluginapi",normalizedTitle:"builderpluginapi",charIndex:181},{level:2,title:"api.context",slug:"api-context",normalizedTitle:"api.context",charIndex:1635},{level:2,title:"api.getBuilderConfig",slug:"api-getbuilderconfig",normalizedTitle:"api.getbuilderconfig",charIndex:1845},{level:2,title:"api.getNormalizedConfig",slug:"api-getnormalizedconfig",normalizedTitle:"api.getnormalizedconfig",charIndex:2134},{level:2,title:"api.isPluginExists",slug:"api-ispluginexists",normalizedTitle:"api.ispluginexists",charIndex:2545},{level:2,title:"api.getHTMLPaths",slug:"api-gethtmlpaths",normalizedTitle:"api.gethtmlpaths",charIndex:2773}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"BuilderPlugin BuilderPluginAPI api.context api.getBuilderConfig api.getNormalizedConfig api.isPluginExists api.getHTMLPaths",content:"# Plugin Core\n\n本章节描述了 Builder 插件核心的类型定义和 API。\n\n\n# BuilderPlugin\n\n插件对象的类型，插件对象包含以下属性：\n\n * name：插件的名称，唯一标识符。\n * setup：插件逻辑的主入口函数，可以是一个异步函数。该函数仅会在初始化插件时执行一次。\n\ntype BuilderPlugin<API = BuilderPluginAPI> = {\n  name: string;\n  setup: (api: API) => Promise<void> | void;\n};\n\n\n你可以从 @modern-js/builder 中导入该类型：\n\nimport type { BuilderPlugin } from '@modern-js/builder';\n\nexport default (): BuilderPlugin => ({\n  name: 'builder-plugin-foo',\n\n  setup: api => {\n    api.onAfterBuild(() => {\n      console.log('after build!');\n    });\n  },\n});\n\n\n\n# BuilderPluginAPI\n\n插件 API 对象的类型。插件 API 对象上挂载了提供给插件使用的上下文数据、工具函数和注册生命周期钩子的函数。\n\n关于生命周期钩子的完整介绍，请阅读 Plugin Hooks 章节。\n\n在使用 webpack provider 或 rspack provider 时，BuilderPluginAPI 的类型定义有一定不同，你可以根据插件的使用场景来引入对应的类型。\n\n\n# 适用于 webpack provider 的插件\n\n开发适用于 webpack provider 的插件时，请从 @modern-js/builder-webpack-provider 中引入 BuilderPluginAPI。\n\nimport type { BuilderPlugin } from '@modern-js/builder';\nimport type { BuilderPluginAPI } from '@modern-js/builder-webpack-provider';\n\nexport default (): BuilderPlugin<BuilderPluginAPI> => ({\n  name: 'builder-plugin-foo',\n\n  setup: api => {\n    api.modifyWebpackConfig(config => {\n      config.devtool = false;\n    });\n  },\n});\n\n\n\n# 适用于 rspack provider 的插件\n\n开发适用于 rspack provider 的插件时，请从 @modern-js/builder-rspack-provider 中引入 BuilderPluginAPI。\n\nimport type { BuilderPlugin } from '@modern-js/builder';\nimport type { BuilderPluginAPI } from '@modern-js/builder-rspack-provider';\n\nexport default (): BuilderPlugin<BuilderPluginAPI> => ({\n  name: 'builder-plugin-foo',\n\n  setup: api => {\n    api.modifyRspackConfig(config => {\n      config.devtool = false;\n    });\n  },\n});\n\n\n\n# api.context\n\napi.context 是一个只读对象，提供一些上下文信息。\n\napi.context 的内容与 builder.context 完全一致，请参考 builder.context。\n\n * Example\n\nconst PluginFoo = () => ({\n  setup(api) {\n    console.log(api.context.distPath);\n  }\n);\n\n\n\n# api.getBuilderConfig\n\n获取 Builder 配置，该方法必须在 modifyBuilderConfig 钩子执行完成后才能被调用。\n\n * Type\n\nfunction GetBuilderConfig(): Readonly<BuilderConfig>;\n\n\n * Example\n\nconst PluginFoo = () => ({\n  setup(api) {\n    const config = api.getBuilderConfig();\n    console.log(config.html?.title);\n  }\n);\n\n\n\n# api.getNormalizedConfig\n\n获取归一化后的 Builder 配置，该方法必须在 modifyBuilderConfig 钩子执行完成后才能被调用。\n\n相较于 getBuilderConfig 方法，该方法返回的配置经过了归一化处理，配置的类型定义会得到收敛，比如 config.html 的 undefined 类型将被移除。\n\n推荐优先使用该方法获取配置。\n\n * Type\n\nfunction GetNormalizedConfig(): Readonly<NormalizedConfig>;\n\n\n * Example\n\nconst PluginFoo = () => ({\n  setup(api) {\n    const config = api.getNormalizedConfig();\n    console.log(config.html.title);\n  }\n);\n\n\n\n# api.isPluginExists\n\n判断某个插件是否已经被注册。\n\n * Type\n\nfunction IsPluginExists(pluginName: string): boolean;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    console.log(api.isPluginExists('builder-plugin-foo'));\n  },\n});\n\n\n\n# api.getHTMLPaths\n\n获取所有 HTML 产物的路径信息。\n\n该方法会返回一个对象，对象的 key 为 entry 名称，value 为 HTML 文件在产物目录下的相对路径。\n\n * Type\n\nfunction GetHTMLPaths(): Record<string, string>;\n\n\n * Example\n\nconst PluginFoo = () => ({\n  setup(api) {\n    api.modifyWebpackChain(() => {\n      const htmlPaths = api.getHTMLPaths();\n      console.log(htmlPaths); // { main: 'html/main/index.html' };\n    });\n  }\n);\n",normalizedContent:"# plugin core\n\n本章节描述了 builder 插件核心的类型定义和 api。\n\n\n# builderplugin\n\n插件对象的类型，插件对象包含以下属性：\n\n * name：插件的名称，唯一标识符。\n * setup：插件逻辑的主入口函数，可以是一个异步函数。该函数仅会在初始化插件时执行一次。\n\ntype builderplugin<api = builderpluginapi> = {\n  name: string;\n  setup: (api: api) => promise<void> | void;\n};\n\n\n你可以从 @modern-js/builder 中导入该类型：\n\nimport type { builderplugin } from '@modern-js/builder';\n\nexport default (): builderplugin => ({\n  name: 'builder-plugin-foo',\n\n  setup: api => {\n    api.onafterbuild(() => {\n      console.log('after build!');\n    });\n  },\n});\n\n\n\n# builderpluginapi\n\n插件 api 对象的类型。插件 api 对象上挂载了提供给插件使用的上下文数据、工具函数和注册生命周期钩子的函数。\n\n关于生命周期钩子的完整介绍，请阅读 plugin hooks 章节。\n\n在使用 webpack provider 或 rspack provider 时，builderpluginapi 的类型定义有一定不同，你可以根据插件的使用场景来引入对应的类型。\n\n\n# 适用于 webpack provider 的插件\n\n开发适用于 webpack provider 的插件时，请从 @modern-js/builder-webpack-provider 中引入 builderpluginapi。\n\nimport type { builderplugin } from '@modern-js/builder';\nimport type { builderpluginapi } from '@modern-js/builder-webpack-provider';\n\nexport default (): builderplugin<builderpluginapi> => ({\n  name: 'builder-plugin-foo',\n\n  setup: api => {\n    api.modifywebpackconfig(config => {\n      config.devtool = false;\n    });\n  },\n});\n\n\n\n# 适用于 rspack provider 的插件\n\n开发适用于 rspack provider 的插件时，请从 @modern-js/builder-rspack-provider 中引入 builderpluginapi。\n\nimport type { builderplugin } from '@modern-js/builder';\nimport type { builderpluginapi } from '@modern-js/builder-rspack-provider';\n\nexport default (): builderplugin<builderpluginapi> => ({\n  name: 'builder-plugin-foo',\n\n  setup: api => {\n    api.modifyrspackconfig(config => {\n      config.devtool = false;\n    });\n  },\n});\n\n\n\n# api.context\n\napi.context 是一个只读对象，提供一些上下文信息。\n\napi.context 的内容与 builder.context 完全一致，请参考 builder.context。\n\n * example\n\nconst pluginfoo = () => ({\n  setup(api) {\n    console.log(api.context.distpath);\n  }\n);\n\n\n\n# api.getbuilderconfig\n\n获取 builder 配置，该方法必须在 modifybuilderconfig 钩子执行完成后才能被调用。\n\n * type\n\nfunction getbuilderconfig(): readonly<builderconfig>;\n\n\n * example\n\nconst pluginfoo = () => ({\n  setup(api) {\n    const config = api.getbuilderconfig();\n    console.log(config.html?.title);\n  }\n);\n\n\n\n# api.getnormalizedconfig\n\n获取归一化后的 builder 配置，该方法必须在 modifybuilderconfig 钩子执行完成后才能被调用。\n\n相较于 getbuilderconfig 方法，该方法返回的配置经过了归一化处理，配置的类型定义会得到收敛，比如 config.html 的 undefined 类型将被移除。\n\n推荐优先使用该方法获取配置。\n\n * type\n\nfunction getnormalizedconfig(): readonly<normalizedconfig>;\n\n\n * example\n\nconst pluginfoo = () => ({\n  setup(api) {\n    const config = api.getnormalizedconfig();\n    console.log(config.html.title);\n  }\n);\n\n\n\n# api.ispluginexists\n\n判断某个插件是否已经被注册。\n\n * type\n\nfunction ispluginexists(pluginname: string): boolean;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    console.log(api.ispluginexists('builder-plugin-foo'));\n  },\n});\n\n\n\n# api.gethtmlpaths\n\n获取所有 html 产物的路径信息。\n\n该方法会返回一个对象，对象的 key 为 entry 名称，value 为 html 文件在产物目录下的相对路径。\n\n * type\n\nfunction gethtmlpaths(): record<string, string>;\n\n\n * example\n\nconst pluginfoo = () => ({\n  setup(api) {\n    api.modifywebpackchain(() => {\n      const htmlpaths = api.gethtmlpaths();\n      console.log(htmlpaths); // { main: 'html/main/index.html' };\n    });\n  }\n);\n",charsets:{cjk:!0}},{title:"Plugin Hooks",frontmatter:{extractApiHeaders:[2]},regularPath:"/zh/api/plugin-hooks.html",relativePath:"zh/api/plugin-hooks.md",key:"v-648430a8",path:"/zh/api/plugin-hooks.html",headers:[{level:2,title:"概览",slug:"概览",normalizedTitle:"概览",charIndex:48},{level:2,title:"通用钩子",slug:"通用钩子",normalizedTitle:"通用钩子",charIndex:52},{level:2,title:"构建钩子",slug:"构建钩子",normalizedTitle:"构建钩子",charIndex:326},{level:2,title:"开发服务钩子",slug:"开发服务钩子",normalizedTitle:"开发服务钩子",charIndex:432},{level:2,title:"其他钩子",slug:"其他钩子",normalizedTitle:"其他钩子",charIndex:588}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"概览 通用钩子 构建钩子 开发服务钩子 其他钩子",content:"# Plugin Hooks\n\n本章节描述了 Builder 插件提供的生命周期钩子。\n\n\n# 概览\n\n通用钩子\n\n * modifyBuilderConfig：修改传递给 Builder 的配置项。\n * modifyWebpackChain：修改 webpack chain 配置。\n * modifyWebpackConfig：修改最终的 webpack 配置对象。\n * modifyRspackConfig：修改最终的 rspack 配置对象。\n * onBeforeCreateCompiler：在创建 compiler 实例前调用。\n * onAfterCreateCompiler：在创建 compiler 实例后、执行构建前调用。\n\n构建钩子：仅在执行 build 方法构建生产环境产物时调用。\n\n * onBeforeBuild：在执行生产环境构建前调用。\n * onAfterBuild：在执行生产环境构建后调用，可以获取到构建结果信息。\n\n开发服务钩子：仅在执行 startDevServer 方法运行开发服务器时调用。\n\n * onBeforeStartDevServer：在启动开发服务器前调用。\n * onAfterStartDevServer：在启动开发服务器后调用。\n * onDevCompileDone：在每次开发环境构建结束后调用。\n\n其他钩子\n\n * onExit：在进程即将退出时调用。\n\n\n# 通用钩子\n\n\n# modifyBuilderConfig\n\n修改传递给 Builder 的配置项，你可以直接修改传入的 config 对象，也可以返回一个新的对象来替换传入的对象。\n\n * Type\n\nfunction ModifyBuilderConfig(\n  callback: (\n    config: BuilderConfig,\n  ) => Promise<BuilderConfig | void> | BuilderConfig | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.modifyBuilderConfig(config => {\n      config.html = config.html || {};\n      config.html.title = 'Hello World!';\n    });\n  },\n});\n\n\n\n# modifyWebpackChain\n\n通过 webpack chain 来修改 webpack 配置。该方法仅在使用 webpack provider 时调用。\n\n * Type\n\ntype ModifyWebpackChainUtils = {\n  env: NodeEnv;\n  isProd: boolean;\n  target: BuilderTarget;\n  webpack: typeof import('webpack');\n  isServer: boolean;\n  isWebWorker: boolean;\n  CHAIN_ID: ChainIdentifier;\n  getCompiledPath: (name: string) => string;\n  HtmlWebpackPlugin: typeof import('html-webpack-plugin');\n};\n\nfunction ModifyWebpackChain(\n  callback: (\n    chain: WebpackChain,\n    utils: ModifyWebpackChainUtils,\n  ) => Promise<void> | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.modifyWebpackChain((chain, utils) => {\n      if (utils.env === 'development') {\n        chain.devtool('eval');\n      }\n    });\n  },\n});\n\n\n\n# modifyWebpackConfig\n\n修改最终的 webpack 配置对象，你可以直接修改传入的 config 对象，也可以返回一个新的对象来替换传入的对象。该方法仅在使用 webpack provider 时调用。\n\n该方法的调用时机晚于 modifyWebpackChain 钩子。\n\n * Type\n\ntype ModifyWebpackConfigUtils = {\n  env: NodeEnv;\n  isProd: boolean;\n  target: BuilderTarget;\n  webpack: typeof import('webpack');\n  isServer: boolean;\n  isWebWorker: boolean;\n  CHAIN_ID: ChainIdentifier;\n  getCompiledPath: (name: string) => string;\n  HtmlWebpackPlugin: typeof import('html-webpack-plugin');\n  addRules: (rules: RuleSetRule | RuleSetRule[]) => void;\n  prependPlugins: (\n    plugins: WebpackPluginInstance | WebpackPluginInstance[],\n  ) => void;\n  appendPlugins: (\n    plugins: WebpackPluginInstance | WebpackPluginInstance[],\n  ) => void;\n  removePlugin: (pluginName: string) => void;\n};\n\nfunction ModifyWebpackConfig(\n  callback: (\n    config: WebpackConfig,\n    utils: ModifyWebpackConfigUtils,\n  ) => Promise<WebpackConfig | void> | WebpackConfig | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.modifyWebpackConfig((config, utils) => {\n      if (utils.env === 'development') {\n        config.devtool = 'eval';\n      }\n    });\n  },\n});\n\n\n\n# modifyRspackConfig\n\n修改最终的 rspack 配置对象，你可以直接修改传入的 config 对象，也可以返回一个新的对象来替换传入的对象。该方法仅在使用 rspack provider 时调用。\n\n * Type\n\ntype ModifyRspackConfigUtils = {\n  env: NodeEnv;\n  isProd: boolean;\n  target: BuilderTarget;\n  isServer: boolean;\n  isWebWorker: boolean;\n  getCompiledPath: (name: string) => string;\n};\n\nfunction ModifyRspackConfig(\n  callback: (\n    config: RspackConfig,\n    utils: ModifyRspackConfigUtils,\n  ) => Promise<RspackConfig | void> | RspackConfig | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.modifyRspackConfig((config, utils) => {\n      if (utils.env === 'development') {\n        config.devtool = 'eval';\n      }\n    });\n  },\n});\n\n\n\n# onBeforeCreateCompiler\n\n在创建 compiler 实例前调用，当你执行 builder.startDevServer、builder.build 或 builder.createCompiler 时，都会调用此钩子。你可以通过 bundlerConfigs 参数获取到底层打包工具的最终配置对象。\n\n * Type\n\nfunction OnBeforeCreateCompiler(\n  callback: (params: {\n    bundlerConfigs: WebpackConfig[] | RspackConfig[];\n  }) => Promise<void> | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onBeforeCreateCompiler(({ bundlerConfigs }) => {\n      console.log('the bundler config is ', bundlerConfigs);\n    });\n  },\n});\n\n\n\n# onAfterCreateCompiler\n\n在创建 compiler 实例后、执行构建前调用，当你执行 builder.startDevServer、builder.build 或 builder.createCompiler 时，都会调用此钩子。你可以通过 compiler 参数获取到 compiler 实例对象。\n\n * Type\n\nfunction OnAfterCreateCompiler(callback: (params: {\n  compiler: Compiler | MultiCompiler;\n}) => Promise<void> | void;): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onAfterCreateCompiler(({ compiler }) => {\n      console.log('the compiler is ', compiler);\n    });\n  },\n});\n\n\n\n# 构建钩子\n\n\n# onBeforeBuild\n\n在执行生产环境构建前调用，你可以通过 bundlerConfigs 参数获取到底层打包工具的最终配置对象。\n\n * Type\n\nfunction OnBeforeBuild(\n  callback: (params: {\n    bundlerConfigs?: WebpackConfig[] | RspackConfig[];\n  }) => Promise<void> | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onBeforeBuild(({ bundlerConfigs }) => {\n      console.log('the bundler config is ', bundlerConfigs);\n    });\n  },\n});\n\n\n\n# onAfterBuild\n\n在执行生产环境构建后调用，你可以通过 stats 参数获取到构建结果信息。\n\n * Type\n\nfunction OnAfterBuild(\n  callback: (params: { stats?: Stats | MultiStats }) => Promise<void> | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onAfterBuild(({ stats }) => {\n      console.log(stats?.toJson());\n    });\n  },\n});\n\n\n\n# 开发服务钩子\n\n\n# onBeforeStartDevServer\n\n在启动开发服务器前调用。\n\n * Type\n\nfunction OnBeforeStartDevServer(callback: () => Promise<void> | void): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onBeforeStartDevServer(() => {\n      console.log('before start!');\n    });\n  },\n});\n\n\n\n# onAfterStartDevServer\n\n在启动开发服务器后调用，你可以通过 port 参数获得开发服务器监听的端口号。\n\n * Type\n\nfunction OnAfterStartDevServer(\n  callback: (params: { port: number }) => Promise<void> | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onAfterStartDevServer(({ port }) => {\n      console.log('this port is: ', port);\n    });\n  },\n});\n\n\n\n# onDevCompileDone\n\n在每次开发环境构建结束后调用，你可以通过 isFirstCompile 来判断是否为首次构建。\n\n * Type\n\nfunction OnDevCompileDone(\n  callback: (params: { isFirstCompile: boolean }) => Promise<void> | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onDevCompileDone(({ isFirstCompile }) => {\n      if (isFirstCompile) {\n        console.log('first compile!');\n      } else {\n        console.log('re-compile!');\n      }\n    });\n  },\n});\n\n\n\n# 其他钩子\n\n\n# onExit\n\n在进程即将退出时调用，这个钩子只能执行同步代码。\n\n * Type\n\nfunction OnExit(callback: () => void): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onExit(() => {\n      console.log('exit!');\n    });\n  },\n});\n",normalizedContent:"# plugin hooks\n\n本章节描述了 builder 插件提供的生命周期钩子。\n\n\n# 概览\n\n通用钩子\n\n * modifybuilderconfig：修改传递给 builder 的配置项。\n * modifywebpackchain：修改 webpack chain 配置。\n * modifywebpackconfig：修改最终的 webpack 配置对象。\n * modifyrspackconfig：修改最终的 rspack 配置对象。\n * onbeforecreatecompiler：在创建 compiler 实例前调用。\n * onaftercreatecompiler：在创建 compiler 实例后、执行构建前调用。\n\n构建钩子：仅在执行 build 方法构建生产环境产物时调用。\n\n * onbeforebuild：在执行生产环境构建前调用。\n * onafterbuild：在执行生产环境构建后调用，可以获取到构建结果信息。\n\n开发服务钩子：仅在执行 startdevserver 方法运行开发服务器时调用。\n\n * onbeforestartdevserver：在启动开发服务器前调用。\n * onafterstartdevserver：在启动开发服务器后调用。\n * ondevcompiledone：在每次开发环境构建结束后调用。\n\n其他钩子\n\n * onexit：在进程即将退出时调用。\n\n\n# 通用钩子\n\n\n# modifybuilderconfig\n\n修改传递给 builder 的配置项，你可以直接修改传入的 config 对象，也可以返回一个新的对象来替换传入的对象。\n\n * type\n\nfunction modifybuilderconfig(\n  callback: (\n    config: builderconfig,\n  ) => promise<builderconfig | void> | builderconfig | void,\n): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.modifybuilderconfig(config => {\n      config.html = config.html || {};\n      config.html.title = 'hello world!';\n    });\n  },\n});\n\n\n\n# modifywebpackchain\n\n通过 webpack chain 来修改 webpack 配置。该方法仅在使用 webpack provider 时调用。\n\n * type\n\ntype modifywebpackchainutils = {\n  env: nodeenv;\n  isprod: boolean;\n  target: buildertarget;\n  webpack: typeof import('webpack');\n  isserver: boolean;\n  iswebworker: boolean;\n  chain_id: chainidentifier;\n  getcompiledpath: (name: string) => string;\n  htmlwebpackplugin: typeof import('html-webpack-plugin');\n};\n\nfunction modifywebpackchain(\n  callback: (\n    chain: webpackchain,\n    utils: modifywebpackchainutils,\n  ) => promise<void> | void,\n): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.modifywebpackchain((chain, utils) => {\n      if (utils.env === 'development') {\n        chain.devtool('eval');\n      }\n    });\n  },\n});\n\n\n\n# modifywebpackconfig\n\n修改最终的 webpack 配置对象，你可以直接修改传入的 config 对象，也可以返回一个新的对象来替换传入的对象。该方法仅在使用 webpack provider 时调用。\n\n该方法的调用时机晚于 modifywebpackchain 钩子。\n\n * type\n\ntype modifywebpackconfigutils = {\n  env: nodeenv;\n  isprod: boolean;\n  target: buildertarget;\n  webpack: typeof import('webpack');\n  isserver: boolean;\n  iswebworker: boolean;\n  chain_id: chainidentifier;\n  getcompiledpath: (name: string) => string;\n  htmlwebpackplugin: typeof import('html-webpack-plugin');\n  addrules: (rules: rulesetrule | rulesetrule[]) => void;\n  prependplugins: (\n    plugins: webpackplugininstance | webpackplugininstance[],\n  ) => void;\n  appendplugins: (\n    plugins: webpackplugininstance | webpackplugininstance[],\n  ) => void;\n  removeplugin: (pluginname: string) => void;\n};\n\nfunction modifywebpackconfig(\n  callback: (\n    config: webpackconfig,\n    utils: modifywebpackconfigutils,\n  ) => promise<webpackconfig | void> | webpackconfig | void,\n): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.modifywebpackconfig((config, utils) => {\n      if (utils.env === 'development') {\n        config.devtool = 'eval';\n      }\n    });\n  },\n});\n\n\n\n# modifyrspackconfig\n\n修改最终的 rspack 配置对象，你可以直接修改传入的 config 对象，也可以返回一个新的对象来替换传入的对象。该方法仅在使用 rspack provider 时调用。\n\n * type\n\ntype modifyrspackconfigutils = {\n  env: nodeenv;\n  isprod: boolean;\n  target: buildertarget;\n  isserver: boolean;\n  iswebworker: boolean;\n  getcompiledpath: (name: string) => string;\n};\n\nfunction modifyrspackconfig(\n  callback: (\n    config: rspackconfig,\n    utils: modifyrspackconfigutils,\n  ) => promise<rspackconfig | void> | rspackconfig | void,\n): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.modifyrspackconfig((config, utils) => {\n      if (utils.env === 'development') {\n        config.devtool = 'eval';\n      }\n    });\n  },\n});\n\n\n\n# onbeforecreatecompiler\n\n在创建 compiler 实例前调用，当你执行 builder.startdevserver、builder.build 或 builder.createcompiler 时，都会调用此钩子。你可以通过 bundlerconfigs 参数获取到底层打包工具的最终配置对象。\n\n * type\n\nfunction onbeforecreatecompiler(\n  callback: (params: {\n    bundlerconfigs: webpackconfig[] | rspackconfig[];\n  }) => promise<void> | void,\n): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.onbeforecreatecompiler(({ bundlerconfigs }) => {\n      console.log('the bundler config is ', bundlerconfigs);\n    });\n  },\n});\n\n\n\n# onaftercreatecompiler\n\n在创建 compiler 实例后、执行构建前调用，当你执行 builder.startdevserver、builder.build 或 builder.createcompiler 时，都会调用此钩子。你可以通过 compiler 参数获取到 compiler 实例对象。\n\n * type\n\nfunction onaftercreatecompiler(callback: (params: {\n  compiler: compiler | multicompiler;\n}) => promise<void> | void;): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.onaftercreatecompiler(({ compiler }) => {\n      console.log('the compiler is ', compiler);\n    });\n  },\n});\n\n\n\n# 构建钩子\n\n\n# onbeforebuild\n\n在执行生产环境构建前调用，你可以通过 bundlerconfigs 参数获取到底层打包工具的最终配置对象。\n\n * type\n\nfunction onbeforebuild(\n  callback: (params: {\n    bundlerconfigs?: webpackconfig[] | rspackconfig[];\n  }) => promise<void> | void,\n): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.onbeforebuild(({ bundlerconfigs }) => {\n      console.log('the bundler config is ', bundlerconfigs);\n    });\n  },\n});\n\n\n\n# onafterbuild\n\n在执行生产环境构建后调用，你可以通过 stats 参数获取到构建结果信息。\n\n * type\n\nfunction onafterbuild(\n  callback: (params: { stats?: stats | multistats }) => promise<void> | void,\n): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.onafterbuild(({ stats }) => {\n      console.log(stats?.tojson());\n    });\n  },\n});\n\n\n\n# 开发服务钩子\n\n\n# onbeforestartdevserver\n\n在启动开发服务器前调用。\n\n * type\n\nfunction onbeforestartdevserver(callback: () => promise<void> | void): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.onbeforestartdevserver(() => {\n      console.log('before start!');\n    });\n  },\n});\n\n\n\n# onafterstartdevserver\n\n在启动开发服务器后调用，你可以通过 port 参数获得开发服务器监听的端口号。\n\n * type\n\nfunction onafterstartdevserver(\n  callback: (params: { port: number }) => promise<void> | void,\n): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.onafterstartdevserver(({ port }) => {\n      console.log('this port is: ', port);\n    });\n  },\n});\n\n\n\n# ondevcompiledone\n\n在每次开发环境构建结束后调用，你可以通过 isfirstcompile 来判断是否为首次构建。\n\n * type\n\nfunction ondevcompiledone(\n  callback: (params: { isfirstcompile: boolean }) => promise<void> | void,\n): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.ondevcompiledone(({ isfirstcompile }) => {\n      if (isfirstcompile) {\n        console.log('first compile!');\n      } else {\n        console.log('re-compile!');\n      }\n    });\n  },\n});\n\n\n\n# 其他钩子\n\n\n# onexit\n\n在进程即将退出时调用，这个钩子只能执行同步代码。\n\n * type\n\nfunction onexit(callback: () => void): void;\n\n\n * example\n\nexport default () => ({\n  setup: api => {\n    api.onexit(() => {\n      console.log('exit!');\n    });\n  },\n});\n",charsets:{cjk:!0}},{title:"路径别名",frontmatter:{},regularPath:"/zh/guide/advanced/alias.html",relativePath:"zh/guide/advanced/alias.md",key:"v-8e3f6ae8",path:"/zh/guide/advanced/alias.html",headers:[{level:2,title:"通过 source.alias 配置",slug:"通过-source-alias-配置",normalizedTitle:"通过 source.alias 配置",charIndex:250},{level:2,title:"通过 tsconfig.json 中的 paths 配置",slug:"通过-tsconfig-json-中的-paths-配置",normalizedTitle:"通过 tsconfig.json 中的 paths 配置",charIndex:273}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"通过 source.alias 配置 通过 tsconfig.json 中的 paths 配置",content:"# 路径别名\n\n路径别名（alias）允许开发者为模块定义别名，以便于在代码中更方便的引用它们。\n\n例如，假如你在项目中经常引用 src/common/request.ts 模块，你可以为它定义一个别名 @request，然后在代码中通过 import request from '@request' 来引用它，而不需要每次都写出完整的相对路径。同时，这也允许你将模块移动到不同的位置，而不需要更新代码中的所有 import 语法。\n\n在 Builder 中，你有两种方式可以设置路径别名:\n\n * 通过 source.alias 配置。\n * 通过 tsconfig.json 中的 paths 配置。\n\n\n# 通过 source.alias 配置\n\nsource.alias 对应 webpack 原生的 resolve.alias 配置，你可以通过对象或者函数的方式进行配置。\n\n首先你可以通过对象的方式进行配置，比如：\n\nexport default {\n  source: {\n    alias: {\n      '@common': './src/common',\n    },\n  },\n};\n\n\n其中的相对路径会被 Builder 自动补全为绝对路径。\n\n你也可以配置为一个函数，拿到预设的 alias 对象，对其进行修改，比如：\n\nexport default {\n  source: {\n    alias: alias => {\n      alias['@common'] = './src/common';\n      return alias;\n    },\n  },\n};\n\n\n\n# 通过 tsconfig.json 中的 paths 配置\n\n除了 source.alias，你还可以通过 tsconfig.json 中的 paths 进行配置，这是我们在 TypeScript 项目中推荐使用的方式，因为可以解决路径别名的类型问题。\n\n比如：\n\n{\n  \"compilerOptions\": {\n    \"paths\": {\n      \"@common/*\": [\"./src/common/*\"]\n    }\n  }\n}\n\n\n优先级\n\npaths 配置的优先级高于 source.alias。",normalizedContent:"# 路径别名\n\n路径别名（alias）允许开发者为模块定义别名，以便于在代码中更方便的引用它们。\n\n例如，假如你在项目中经常引用 src/common/request.ts 模块，你可以为它定义一个别名 @request，然后在代码中通过 import request from '@request' 来引用它，而不需要每次都写出完整的相对路径。同时，这也允许你将模块移动到不同的位置，而不需要更新代码中的所有 import 语法。\n\n在 builder 中，你有两种方式可以设置路径别名:\n\n * 通过 source.alias 配置。\n * 通过 tsconfig.json 中的 paths 配置。\n\n\n# 通过 source.alias 配置\n\nsource.alias 对应 webpack 原生的 resolve.alias 配置，你可以通过对象或者函数的方式进行配置。\n\n首先你可以通过对象的方式进行配置，比如：\n\nexport default {\n  source: {\n    alias: {\n      '@common': './src/common',\n    },\n  },\n};\n\n\n其中的相对路径会被 builder 自动补全为绝对路径。\n\n你也可以配置为一个函数，拿到预设的 alias 对象，对其进行修改，比如：\n\nexport default {\n  source: {\n    alias: alias => {\n      alias['@common'] = './src/common';\n      return alias;\n    },\n  },\n};\n\n\n\n# 通过 tsconfig.json 中的 paths 配置\n\n除了 source.alias，你还可以通过 tsconfig.json 中的 paths 进行配置，这是我们在 typescript 项目中推荐使用的方式，因为可以解决路径别名的类型问题。\n\n比如：\n\n{\n  \"compileroptions\": {\n    \"paths\": {\n      \"@common/*\": [\"./src/common/*\"]\n    }\n  }\n}\n\n\n优先级\n\npaths 配置的优先级高于 source.alias。",charsets:{cjk:!0}},{title:"浏览器兼容性",frontmatter:{},regularPath:"/zh/guide/advanced/browser-compatibility.html",relativePath:"zh/guide/advanced/browser-compatibility.md",key:"v-44fecf6c",path:"/zh/guide/advanced/browser-compatibility.html",headers:[{level:2,title:"设置浏览器范围",slug:"设置浏览器范围",normalizedTitle:"设置浏览器范围",charIndex:50},{level:2,title:"背景知识",slug:"背景知识",normalizedTitle:"背景知识",charIndex:339},{level:2,title:"降级方式",slug:"降级方式",normalizedTitle:"降级方式",charIndex:2898},{level:2,title:"Polyfill 方案",slug:"polyfill-方案",normalizedTitle:"polyfill 方案",charIndex:4311}],lastUpdated:"2022/12/21 09:20:25",lastUpdatedTimestamp:1671614425e3,headersStr:"设置浏览器范围 背景知识 降级方式 Polyfill 方案",content:"# 浏览器兼容性\n\n本章节介绍如何使用 Builder 提供的能力来处理浏览器兼容性问题。\n\n\n# 设置浏览器范围\n\n在处理兼容性问题之前，首先需要明确你的项目需要支持的浏览器范围，并添加相应的 browserslist 配置。\n\n * 如果你还没有设置浏览器范围，请先阅读 设置浏览器范围 章节。\n\n * 如果你已经设置了浏览器范围，那么 Builder 会自动根据该范围进行编译，对 JavaScript 语法和 CSS 语法进行降级处理，并注入所需的 polyfill 代码。大部分情况下，你可以放心地使用现代 ECMAScript 特性，无须担心兼容性问题。\n\n在设置浏览器范围之后，如果你依然在开发中遇到了一些兼容性问题，请继续阅读下面的内容来寻找解决方案。\n\n\n# 背景知识\n\n在处理兼容性问题之前，建议你了解以下背景知识，以更好地处理相关问题。\n\n\n# 语法降级和 API 降级\n\n当你在项目中使用高版本语法和 API 时，为了让编译后的代码能稳定运行在低版本浏览器中，需要完成两部分降级：语法降级和 API 降级。\n\nBuilder 通过语法转译来对语法进行降级，通过 polyfill 来对 API 进行进行降级。\n\n> 语法和 API 并不是强绑定的，浏览器厂商在实现引擎的时候，会根据规范或者自身需要提前支持一些语法或者提前实现一些 API。因此，同一时期的不同厂商的浏览器，对语法和 API 的兼容都不一定相同。所以在一般的实践中，语法和 API 是分成两个部分进行处理的。\n\n\n# 语法转译\n\n语法是编程语言如何组织代码的一系列规则，不遵守这些规则的代码无法被编程语言的引擎正确识别，因此无法被运行。在 JavaScript 中，以下几个示例都是语法规则：\n\n * 在 const foo = 1 中，const 表示声明一个不可变的常量。\n * 在 foo?.bar?.baz 中，?. 表示可选链访问属性。\n * 在 async function () {} 中，async 表示声明一个异步函数。\n\n由于不同浏览器的解析器所能支持的语法不同，尤其是旧版本浏览器引擎所能支持的语法较少，因此一些语法在低版本浏览器引擎中运行时，就会在解析 AST 的阶段报错。\n\n比如下面这段代码在 IE 浏览器或低版本 Node.js 下会报错：\n\nconst foo = {};\nfoo?.bar();\n\n\n我们在低版本 Node.js 中运行这段代码，会出现以下错误信息：\n\nSyntaxError: Unexpected token .\n  at Object.exports.runInThisContext (vm.js:73:16)\n  at Object.<anonymous> ([eval]-wrapper:6:22)\n  at Module._compile (module.js:460:26)\n  at evalScript (node.js:431:25)\n  at startup (node.js:90:7)\n  at node.js:814:3\n\n\n从错误信息里可以明显看到，这是一个语法错误（SyntaxError）。这说明这个语法在低版本的引擎中是不受支持的。\n\n语法是不能通过 polyfill 或者 shim 进行支持的。如果想在低版本浏览器中运行一些它原本不支持的语法，那么就需要对代码进行转译，转译成低版本引擎所能支持的语法。\n\n将上述代码转译为以下代码即可在低版本引擎中运行：\n\nvar foo = {};\nfoo === null || foo === void 0 ? void 0 : foo.bar();\n\n\n转译后，代码的语法变了，把一些低版本引擎无法理解的语法用其可理解的语法替代，但代码本身的意义没有变。\n\n如果引擎在转换为 AST 的时候遇到了无法识别的语法，就会报语法错误，并中止代码执行流程。在这种情况下，如果你的项目没有使用 SSR 或 SSG 等能力的话，页面将会直接白屏，导致页面不可用。\n\n如果代码被转换为 AST 成功，引擎会将 AST 转为可执行代码，并在引擎内部正常执行。\n\n\n# API Polyfill\n\nJavaScript 是解释型脚本语言，不同于 Rust 等编译型语言。Rust 会在编译阶段对代码中的调用进行检查，而 JavaScript 在真正运行到某一行代码之前，并不知道这一行代码所调用的函数是否存在，因此一些错误只有在运行时才会出现。\n\n举个例子，下面这段代码：\n\nvar str = 'Hello world!';\nconsole.log(str.notExistedMethod());\n\n\n上面这段代码有着正确的语法，在引擎运行时的第一个阶段也能正确转换为 AST，但是在真正运行的时候，由于 String.prototype 上不存在 notExistedMethod 这个方法，所以在实际运行的时候会报错：\n\nUncaught TypeError: str.notExistedMethod is not a function\n  at <anonymous>:2:17\n\n\n随着 ECMAScript 的迭代，一些内置对象也会迎来新的方法。比如 String.prototype.replaceAll 是在 ES2021 中被引入的，那么在大部分 2021 年前的浏览器的引擎的内置对象 String.prototype 中是不存在 replaceAll 方法的，因此下面这段代码在最新的 Chrome 里可以运行，但是在较早的版本里无法运行：\n\n'abc'.replaceAll('abc', 'xyz');\n\n\n为了解决在旧版浏览器中的 String.prototype 缺少 replaceAll 的问题，我们可以在老版本的浏览器里扩展 String.prototype 对象，给它加上 replaceAll 方法，例如：\n\n// 该 polyfill 的实现并不一定符合标准，仅作为示例。\nif (!String.prototype.replaceAll) {\n  String.prototype.replaceAll = function (str, newStr) {\n    // If a regex pattern\n    if (\n      Object.prototype.toString.call(str).toLowerCase() === '[object regexp]'\n    ) {\n      return this.replace(str, newStr);\n    }\n    // If a string\n    return this.replace(new RegExp(str, 'g'), newStr);\n  };\n}\n\n\n> 这种为旧环境提供实现来对齐新 API 的技术被称作 polyfill。\n\n\n# 降级方式\n\n在 Builder 中，我们将代码分为三类：\n\n * 第一类是当前项目中的源代码。\n * 第二类是通过 npm 安装的第三方依赖代码。\n * 第三类是非当前项目的代码，比如 monorepo 中其他目录下的代码。\n\n默认情况下，Builder 只会对第一类代码进行编译和降级，而其他类型的代码默认是不进行降级处理的。\n\n之所以这样处理，主要有几个考虑：\n\n * 将所有第三方依赖代码都进行降级的话会导致构建性能显著下降。\n * 大部分第三方依赖在发布前已经进行了降级处理，二次降级可能会引入新问题。\n * 非当前项目的代码可能已经经过了编译处理，或者编译所需的配置与当前项目并不相同。\n\n\n# 降级当前项目代码\n\n当前项目的代码会被默认降级，因此你不需要添加额外的配置，只需要保证正确设置了浏览器范围即可。\n\n\n# 降级第三方依赖\n\n当你发现某个第三方依赖的代码导致了兼容性问题时，你可以将这个依赖添加到 Builder 的 source.include 配置中，使 Builder 对该依赖进行额外的编译。\n\n以 query-string 这个 npm 包为例，你可以做如下的配置：\n\nimport path from 'path';\n\nexport default {\n  source: {\n    include: [\n      // 方法一:\n      // 先通过 require.resolve 来获取模块的路径\n      // 再通过 path.dirname 来指向对应的目录\n      path.dirname(require.resolve('query-string')),\n      // 方法二:\n      // 通过正则表达式进行匹配\n      // 所有包含 `/query-string/` 的路径都会被匹配到\n      /\\/query-string\\//,\n    ],\n  },\n};\n\n\n注意，该配置只会编译 query-string 自身的代码，不会编译 query-string 的子依赖。如果需要编译 query-string 的子依赖，则需要将对应的 npm 包也加入到 source.include 中。\n\n\n# 降级非当前项目的代码\n\n当你引用非当前项目的代码时，如果该代码未经过编译处理，那么你也需要配置 source.include 来对它进行编译。\n\n比如，你需要引用 monorepo 中 packages 目录下的某个模块，可以添加如下的配置：\n\nimport path from 'path';\n\nexport default {\n  source: {\n    include: [\n      // 方法一:\n      // 编译 Monorepo 的 package 目录下的所有文件\n      path.resolve(__dirname, '../../packages'),\n\n      // 方法二:\n      // 编译 Monorepo 的 package 目录里某个包的源代码\n      // 这种写法匹配的范围更加精准，对整体编译性能的影响更小\n      path.resolve(__dirname, '../../packages/xxx/src'),\n    ],\n  },\n};\n\n\n\n# Polyfill 方案\n\nBuilder 底层通过 babel 或 SWC 编译 JavaScript 代码，并注入 core-js、@babel/runtime、@swc/helpers 等 polyfill 库。\n\n在不同的使用场景下，你可能会需要不同的 polyfill 方案。Builder 提供了 output.polyfill 配置项来切换不同的 polyfill 方案。\n\n\n# entry 方案\n\nentry 为默认方案，无须手动设置。\n\n在使用 entry 方案时，Builder 会根据当前项目设置的浏览器范围来计算需要注入哪些 core-js 方法，并在每个页面的入口文件中进行注入。这种方式注入的 polyfill 较为全面，不需要再担心项目源码和第三方依赖的 polyfill 问题，但是因为包含了一些没有用到的 polyfill 代码，所以最终的包大小可能会有所增加。\n\nentry 方案对应的配置为：\n\nexport default {\n  output: {\n    polyfill: 'entry',\n  },\n};\n\n\n\n# usage 方案\n\nusage 方案可以更精确地控制需要注入哪些 core-js polyfill。\n\n当你开启 usage 方案时，Builder 会分析项目中的源代码，并判断需要注入哪些 polyfill。\n\n比如代码中使用了 Map:\n\nvar b = new Map();\n\n\n编译后，只会在该文件中注入 Map 所需的 polyfill：\n\nimport 'core-js/modules/es.map';\nvar b = new Map();\n\n\n这种方式的优点是注入的 polyfill 体积更小，适合对包体积有较高要求的项目使用。缺点是 polyfill 可能注入不全，因为第三方依赖默认不会被编译和降级处理，因此第三方依赖所需的 polyfill 不会被分析到，如果需要分析某个第三方依赖，也需要将其加入到 source.include 配置中。\n\nusage 方案对应的配置为：\n\nexport default {\n  output: {\n    polyfill: 'usage',\n  },\n};\n\n\n\n# 不注入 Polyfill\n\n你可以将 output.polyfill 设置为 'off' 来禁用 polyfill 注入的行为。\n\nexport default {\n  output: {\n    polyfill: 'off',\n  },\n};\n\n\n使用此选项时，你需要自行保证代码的兼容性，比如通过 source.preEntry 来手动引用所需的 polyfill 代码。",normalizedContent:"# 浏览器兼容性\n\n本章节介绍如何使用 builder 提供的能力来处理浏览器兼容性问题。\n\n\n# 设置浏览器范围\n\n在处理兼容性问题之前，首先需要明确你的项目需要支持的浏览器范围，并添加相应的 browserslist 配置。\n\n * 如果你还没有设置浏览器范围，请先阅读 设置浏览器范围 章节。\n\n * 如果你已经设置了浏览器范围，那么 builder 会自动根据该范围进行编译，对 javascript 语法和 css 语法进行降级处理，并注入所需的 polyfill 代码。大部分情况下，你可以放心地使用现代 ecmascript 特性，无须担心兼容性问题。\n\n在设置浏览器范围之后，如果你依然在开发中遇到了一些兼容性问题，请继续阅读下面的内容来寻找解决方案。\n\n\n# 背景知识\n\n在处理兼容性问题之前，建议你了解以下背景知识，以更好地处理相关问题。\n\n\n# 语法降级和 api 降级\n\n当你在项目中使用高版本语法和 api 时，为了让编译后的代码能稳定运行在低版本浏览器中，需要完成两部分降级：语法降级和 api 降级。\n\nbuilder 通过语法转译来对语法进行降级，通过 polyfill 来对 api 进行进行降级。\n\n> 语法和 api 并不是强绑定的，浏览器厂商在实现引擎的时候，会根据规范或者自身需要提前支持一些语法或者提前实现一些 api。因此，同一时期的不同厂商的浏览器，对语法和 api 的兼容都不一定相同。所以在一般的实践中，语法和 api 是分成两个部分进行处理的。\n\n\n# 语法转译\n\n语法是编程语言如何组织代码的一系列规则，不遵守这些规则的代码无法被编程语言的引擎正确识别，因此无法被运行。在 javascript 中，以下几个示例都是语法规则：\n\n * 在 const foo = 1 中，const 表示声明一个不可变的常量。\n * 在 foo?.bar?.baz 中，?. 表示可选链访问属性。\n * 在 async function () {} 中，async 表示声明一个异步函数。\n\n由于不同浏览器的解析器所能支持的语法不同，尤其是旧版本浏览器引擎所能支持的语法较少，因此一些语法在低版本浏览器引擎中运行时，就会在解析 ast 的阶段报错。\n\n比如下面这段代码在 ie 浏览器或低版本 node.js 下会报错：\n\nconst foo = {};\nfoo?.bar();\n\n\n我们在低版本 node.js 中运行这段代码，会出现以下错误信息：\n\nsyntaxerror: unexpected token .\n  at object.exports.runinthiscontext (vm.js:73:16)\n  at object.<anonymous> ([eval]-wrapper:6:22)\n  at module._compile (module.js:460:26)\n  at evalscript (node.js:431:25)\n  at startup (node.js:90:7)\n  at node.js:814:3\n\n\n从错误信息里可以明显看到，这是一个语法错误（syntaxerror）。这说明这个语法在低版本的引擎中是不受支持的。\n\n语法是不能通过 polyfill 或者 shim 进行支持的。如果想在低版本浏览器中运行一些它原本不支持的语法，那么就需要对代码进行转译，转译成低版本引擎所能支持的语法。\n\n将上述代码转译为以下代码即可在低版本引擎中运行：\n\nvar foo = {};\nfoo === null || foo === void 0 ? void 0 : foo.bar();\n\n\n转译后，代码的语法变了，把一些低版本引擎无法理解的语法用其可理解的语法替代，但代码本身的意义没有变。\n\n如果引擎在转换为 ast 的时候遇到了无法识别的语法，就会报语法错误，并中止代码执行流程。在这种情况下，如果你的项目没有使用 ssr 或 ssg 等能力的话，页面将会直接白屏，导致页面不可用。\n\n如果代码被转换为 ast 成功，引擎会将 ast 转为可执行代码，并在引擎内部正常执行。\n\n\n# api polyfill\n\njavascript 是解释型脚本语言，不同于 rust 等编译型语言。rust 会在编译阶段对代码中的调用进行检查，而 javascript 在真正运行到某一行代码之前，并不知道这一行代码所调用的函数是否存在，因此一些错误只有在运行时才会出现。\n\n举个例子，下面这段代码：\n\nvar str = 'hello world!';\nconsole.log(str.notexistedmethod());\n\n\n上面这段代码有着正确的语法，在引擎运行时的第一个阶段也能正确转换为 ast，但是在真正运行的时候，由于 string.prototype 上不存在 notexistedmethod 这个方法，所以在实际运行的时候会报错：\n\nuncaught typeerror: str.notexistedmethod is not a function\n  at <anonymous>:2:17\n\n\n随着 ecmascript 的迭代，一些内置对象也会迎来新的方法。比如 string.prototype.replaceall 是在 es2021 中被引入的，那么在大部分 2021 年前的浏览器的引擎的内置对象 string.prototype 中是不存在 replaceall 方法的，因此下面这段代码在最新的 chrome 里可以运行，但是在较早的版本里无法运行：\n\n'abc'.replaceall('abc', 'xyz');\n\n\n为了解决在旧版浏览器中的 string.prototype 缺少 replaceall 的问题，我们可以在老版本的浏览器里扩展 string.prototype 对象，给它加上 replaceall 方法，例如：\n\n// 该 polyfill 的实现并不一定符合标准，仅作为示例。\nif (!string.prototype.replaceall) {\n  string.prototype.replaceall = function (str, newstr) {\n    // if a regex pattern\n    if (\n      object.prototype.tostring.call(str).tolowercase() === '[object regexp]'\n    ) {\n      return this.replace(str, newstr);\n    }\n    // if a string\n    return this.replace(new regexp(str, 'g'), newstr);\n  };\n}\n\n\n> 这种为旧环境提供实现来对齐新 api 的技术被称作 polyfill。\n\n\n# 降级方式\n\n在 builder 中，我们将代码分为三类：\n\n * 第一类是当前项目中的源代码。\n * 第二类是通过 npm 安装的第三方依赖代码。\n * 第三类是非当前项目的代码，比如 monorepo 中其他目录下的代码。\n\n默认情况下，builder 只会对第一类代码进行编译和降级，而其他类型的代码默认是不进行降级处理的。\n\n之所以这样处理，主要有几个考虑：\n\n * 将所有第三方依赖代码都进行降级的话会导致构建性能显著下降。\n * 大部分第三方依赖在发布前已经进行了降级处理，二次降级可能会引入新问题。\n * 非当前项目的代码可能已经经过了编译处理，或者编译所需的配置与当前项目并不相同。\n\n\n# 降级当前项目代码\n\n当前项目的代码会被默认降级，因此你不需要添加额外的配置，只需要保证正确设置了浏览器范围即可。\n\n\n# 降级第三方依赖\n\n当你发现某个第三方依赖的代码导致了兼容性问题时，你可以将这个依赖添加到 builder 的 source.include 配置中，使 builder 对该依赖进行额外的编译。\n\n以 query-string 这个 npm 包为例，你可以做如下的配置：\n\nimport path from 'path';\n\nexport default {\n  source: {\n    include: [\n      // 方法一:\n      // 先通过 require.resolve 来获取模块的路径\n      // 再通过 path.dirname 来指向对应的目录\n      path.dirname(require.resolve('query-string')),\n      // 方法二:\n      // 通过正则表达式进行匹配\n      // 所有包含 `/query-string/` 的路径都会被匹配到\n      /\\/query-string\\//,\n    ],\n  },\n};\n\n\n注意，该配置只会编译 query-string 自身的代码，不会编译 query-string 的子依赖。如果需要编译 query-string 的子依赖，则需要将对应的 npm 包也加入到 source.include 中。\n\n\n# 降级非当前项目的代码\n\n当你引用非当前项目的代码时，如果该代码未经过编译处理，那么你也需要配置 source.include 来对它进行编译。\n\n比如，你需要引用 monorepo 中 packages 目录下的某个模块，可以添加如下的配置：\n\nimport path from 'path';\n\nexport default {\n  source: {\n    include: [\n      // 方法一:\n      // 编译 monorepo 的 package 目录下的所有文件\n      path.resolve(__dirname, '../../packages'),\n\n      // 方法二:\n      // 编译 monorepo 的 package 目录里某个包的源代码\n      // 这种写法匹配的范围更加精准，对整体编译性能的影响更小\n      path.resolve(__dirname, '../../packages/xxx/src'),\n    ],\n  },\n};\n\n\n\n# polyfill 方案\n\nbuilder 底层通过 babel 或 swc 编译 javascript 代码，并注入 core-js、@babel/runtime、@swc/helpers 等 polyfill 库。\n\n在不同的使用场景下，你可能会需要不同的 polyfill 方案。builder 提供了 output.polyfill 配置项来切换不同的 polyfill 方案。\n\n\n# entry 方案\n\nentry 为默认方案，无须手动设置。\n\n在使用 entry 方案时，builder 会根据当前项目设置的浏览器范围来计算需要注入哪些 core-js 方法，并在每个页面的入口文件中进行注入。这种方式注入的 polyfill 较为全面，不需要再担心项目源码和第三方依赖的 polyfill 问题，但是因为包含了一些没有用到的 polyfill 代码，所以最终的包大小可能会有所增加。\n\nentry 方案对应的配置为：\n\nexport default {\n  output: {\n    polyfill: 'entry',\n  },\n};\n\n\n\n# usage 方案\n\nusage 方案可以更精确地控制需要注入哪些 core-js polyfill。\n\n当你开启 usage 方案时，builder 会分析项目中的源代码，并判断需要注入哪些 polyfill。\n\n比如代码中使用了 map:\n\nvar b = new map();\n\n\n编译后，只会在该文件中注入 map 所需的 polyfill：\n\nimport 'core-js/modules/es.map';\nvar b = new map();\n\n\n这种方式的优点是注入的 polyfill 体积更小，适合对包体积有较高要求的项目使用。缺点是 polyfill 可能注入不全，因为第三方依赖默认不会被编译和降级处理，因此第三方依赖所需的 polyfill 不会被分析到，如果需要分析某个第三方依赖，也需要将其加入到 source.include 配置中。\n\nusage 方案对应的配置为：\n\nexport default {\n  output: {\n    polyfill: 'usage',\n  },\n};\n\n\n\n# 不注入 polyfill\n\n你可以将 output.polyfill 设置为 'off' 来禁用 polyfill 注入的行为。\n\nexport default {\n  output: {\n    polyfill: 'off',\n  },\n};\n\n\n使用此选项时，你需要自行保证代码的兼容性，比如通过 source.preentry 来手动引用所需的 polyfill 代码。",charsets:{cjk:!0}},{title:"设置浏览器范围",frontmatter:{},regularPath:"/zh/guide/advanced/browserslist.html",relativePath:"zh/guide/advanced/browserslist.md",key:"v-3acc1114",path:"/zh/guide/advanced/browserslist.html",headers:[{level:2,title:"什么是 Browserslist",slug:"什么是-browserslist",normalizedTitle:"什么是 browserslist",charIndex:63},{level:2,title:"设置 Browserslist",slug:"设置-browserslist",normalizedTitle:"设置 browserslist",charIndex:678},{level:2,title:"常用的浏览器范围",slug:"常用的浏览器范围",normalizedTitle:"常用的浏览器范围",charIndex:1707},{level:2,title:"Browserslist 默认值",slug:"browserslist-默认值",normalizedTitle:"browserslist 默认值",charIndex:2346},{level:2,title:"查询浏览器支持情况",slug:"查询浏览器支持情况",normalizedTitle:"查询浏览器支持情况",charIndex:2819}],lastUpdated:"2022/12/22 02:47:08",lastUpdatedTimestamp:1671677228e3,headersStr:"什么是 Browserslist 设置 Browserslist 常用的浏览器范围 Browserslist 默认值 查询浏览器支持情况",content:"# 设置浏览器范围\n\nBuilder 支持通过 Browserslist 来设置 Web 应用需要兼容的浏览器范围。\n\n\n# 什么是 Browserslist\n\n由于各种浏览器对 ECMAScript 和 CSS 的支持程度不同，因此开发者需要根据业务需求，为 Web 应用设置正确的浏览器范围。\n\nBrowserslist 可以指定 Web 应用能够在哪些浏览器中正常运行，它提供了统一的配置格式，并且已经成为了前端社区中的标准。Browserslist 被 Autoprefixer, Babel, ESLint, PostCSS，SWC 和 Webpack 等库所使用。\n\n当你通过 Browserslist 指定了一个浏览器范围时，Builder 会将 JavaScript 代码和 CSS 代码编译到指定的语法，并注入相应的 polyfill 代码。当你只需要兼容更现代的浏览器时，编译过程会引入更少的兼容代码和 polyfills，页面的性能会更好。\n\n比如，当你需要适配 IE11 浏览器时，Builder 会将代码编译至 ES5，并通过 core-js 注入 IE11 所需的 polyfill。\n\n什么是 polyfill\n\npolyfill 是一种用于解决浏览器兼容问题的技术。它用于模拟某些浏览器不支持的新特性，使得这些特性能在不支持的浏览器中正常工作。例如，如果某个浏览器不支持 Array.prototype.flat() 方法，那么我们可以使用 polyfill 来模拟这个方法，从而让代码在这个浏览器中也能正常工作。\n\n\n# 设置 Browserslist\n\n你可以在当前项目根目录的 package.json 或 .browserslistrc 文件里设置 Browserslist 的值。\n\n\n# 示例\n\n通过 package.json 的 browserslist 设置：\n\n{\n  \"browserslist\": [\n    \"iOS 9\",\n    \"Android 4.4\",\n    \"last 2 versions\",\n    \"> 0.2%\",\n    \"not dead\"\n  ]\n}\n\n\n通过独立的 .browserslistrc 文件设置：\n\niOS 9\nAndroid 4.4\nlast 2 versions\n> 0.2%\nnot dead\n\n\n\n# 使用 output.overrideBrowserslist 配置\n\n除了上述的标准用法，Builder 还提供了 output.overrideBrowserslist 配置项，同样可以设置 Browserslist 的值。\n\nexport default {\n  output: {\n    overrideBrowserslist: [\n      'iOS 9',\n      'Android 4.4',\n      'last 2 versions',\n      '> 0.2%',\n      'not dead',\n    ],\n  },\n};\n\n\n当你同时构建多种类型的产物时，你可以为不同的产物类型设置不同的目标浏览器范围。此时，你需要把 overrideBrowserslist 设置为一个对象，对象的 key 为对应的产物类型。\n\n比如为 web 和 node 设置不同的范围：\n\nexport default {\n  output: {\n    overrideBrowserslist: {\n      web: ['iOS 9', 'Android 4.4', 'last 2 versions', '> 0.2%', 'not dead'],\n      node: ['node >= 14'],\n    },\n  },\n};\n\n\n大多数场景下，推荐优先使用 .browserslistrc 文件，而不是使用 overrideBrowserslist 配置。因为 .browserslistrc 文件是官方定义的配置文件，通用性更强，可以被社区中的其他库识别。\n\n\n# 常用的浏览器范围\n\n以下是一些常用的浏览器范围，你可以根据自己的项目类型进行选择。\n\n\n# 移动端 H5 场景\n\n移动端 H5 场景主要兼容 iOS 和 Android 系统，通常我们将 Browserslist 设置为：\n\niOS 9\nAndroid 4.4\nlast 2 versions\n0.2%\nnot dead\n\n\n以上浏览器范围会将代码编译至 ES5 规范，可以兼容市面上绝大多数移动端场景，具体对应的浏览器列表可以查看 browserslist.dev。\n\n\n\n你也可以选择在 H5 场景使用 ES6 规范，这样会让页面的性能表现更好，对应的 Browserslist 如下：\n\niOS 10\nChrome 51\n> 0.2%\nnot dead\nnot op_mini all\n\n\n\n# 桌面端 PC 场景\n\n在桌面端 PC 场景下，如果你需要兼容 IE 11 浏览器，则可以将 Browserslist 设置为：\n\n> 0.5%\nnot dead\nIE 11\n\n\n以上浏览器范围会将代码编译至 ES5 规范，具体对应的浏览器列表可以查看 browserslist.dev。\n\n如果你不需要兼容 IE 11 浏览器，那么可以调整 Browserslist 来获得更高性能的产物，比如设置为支持原生 ES Modules 的浏览器：\n\nchrome > 61\nedge > 16\nfirefox > 60\nsafari > 11\nios_saf > 11\n\n\n\n# Browserslist 默认值\n\nBuilder 会根据构建产物类型来设置不同的 Browserslist 默认值，但我们推荐你在项目中显式设置 Browserslist，这会让项目的兼容范围更加明确。\n\n\n# Web 产物\n\nWeb 产物的默认值如下所示：\n\n> 0.01%\nnot dead\nnot op_mini all\n\n\n在该浏览器范围下，JavaScript 代码被会编译到 ES5 语法。\n\n\n# Node 产物\n\nNode 产物默认最低兼容到 Node.js 14.0 版本。\n\nnode >= 14\n\n\n\n# Web Worker 产物\n\nWeb Worker 产物默认的浏览器范围与 Web 一致。\n\n> 0.01%\nnot dead\nnot op_mini all\n\n\n\n# Modern Web 产物\n\nModern Web 产物默认最低兼容到支持原生 ES Modules 的浏览器。\n\nchrome > 61\nedge > 16\nfirefox > 60\nsafari > 11\nios_saf > 11\n\n\n\n# 查询浏览器支持情况\n\n在开发时，我们需要了解某些特性或 API 的浏览器支持情况，此时我们可以在 caniuse 网站上进行查询。\n\n比如我们需要知道 Promise 的浏览器支持情况，只需要在 caniuse 中输入 Promise，就可以看到以下结果：\n\n\n\n从上表可以看出，Promise 在 Chrome 33 和 iOS 8 中得到了原生支持，但是在 IE 11 中不被支持。",normalizedContent:"# 设置浏览器范围\n\nbuilder 支持通过 browserslist 来设置 web 应用需要兼容的浏览器范围。\n\n\n# 什么是 browserslist\n\n由于各种浏览器对 ecmascript 和 css 的支持程度不同，因此开发者需要根据业务需求，为 web 应用设置正确的浏览器范围。\n\nbrowserslist 可以指定 web 应用能够在哪些浏览器中正常运行，它提供了统一的配置格式，并且已经成为了前端社区中的标准。browserslist 被 autoprefixer, babel, eslint, postcss，swc 和 webpack 等库所使用。\n\n当你通过 browserslist 指定了一个浏览器范围时，builder 会将 javascript 代码和 css 代码编译到指定的语法，并注入相应的 polyfill 代码。当你只需要兼容更现代的浏览器时，编译过程会引入更少的兼容代码和 polyfills，页面的性能会更好。\n\n比如，当你需要适配 ie11 浏览器时，builder 会将代码编译至 es5，并通过 core-js 注入 ie11 所需的 polyfill。\n\n什么是 polyfill\n\npolyfill 是一种用于解决浏览器兼容问题的技术。它用于模拟某些浏览器不支持的新特性，使得这些特性能在不支持的浏览器中正常工作。例如，如果某个浏览器不支持 array.prototype.flat() 方法，那么我们可以使用 polyfill 来模拟这个方法，从而让代码在这个浏览器中也能正常工作。\n\n\n# 设置 browserslist\n\n你可以在当前项目根目录的 package.json 或 .browserslistrc 文件里设置 browserslist 的值。\n\n\n# 示例\n\n通过 package.json 的 browserslist 设置：\n\n{\n  \"browserslist\": [\n    \"ios 9\",\n    \"android 4.4\",\n    \"last 2 versions\",\n    \"> 0.2%\",\n    \"not dead\"\n  ]\n}\n\n\n通过独立的 .browserslistrc 文件设置：\n\nios 9\nandroid 4.4\nlast 2 versions\n> 0.2%\nnot dead\n\n\n\n# 使用 output.overridebrowserslist 配置\n\n除了上述的标准用法，builder 还提供了 output.overridebrowserslist 配置项，同样可以设置 browserslist 的值。\n\nexport default {\n  output: {\n    overridebrowserslist: [\n      'ios 9',\n      'android 4.4',\n      'last 2 versions',\n      '> 0.2%',\n      'not dead',\n    ],\n  },\n};\n\n\n当你同时构建多种类型的产物时，你可以为不同的产物类型设置不同的目标浏览器范围。此时，你需要把 overridebrowserslist 设置为一个对象，对象的 key 为对应的产物类型。\n\n比如为 web 和 node 设置不同的范围：\n\nexport default {\n  output: {\n    overridebrowserslist: {\n      web: ['ios 9', 'android 4.4', 'last 2 versions', '> 0.2%', 'not dead'],\n      node: ['node >= 14'],\n    },\n  },\n};\n\n\n大多数场景下，推荐优先使用 .browserslistrc 文件，而不是使用 overridebrowserslist 配置。因为 .browserslistrc 文件是官方定义的配置文件，通用性更强，可以被社区中的其他库识别。\n\n\n# 常用的浏览器范围\n\n以下是一些常用的浏览器范围，你可以根据自己的项目类型进行选择。\n\n\n# 移动端 h5 场景\n\n移动端 h5 场景主要兼容 ios 和 android 系统，通常我们将 browserslist 设置为：\n\nios 9\nandroid 4.4\nlast 2 versions\n0.2%\nnot dead\n\n\n以上浏览器范围会将代码编译至 es5 规范，可以兼容市面上绝大多数移动端场景，具体对应的浏览器列表可以查看 browserslist.dev。\n\n\n\n你也可以选择在 h5 场景使用 es6 规范，这样会让页面的性能表现更好，对应的 browserslist 如下：\n\nios 10\nchrome 51\n> 0.2%\nnot dead\nnot op_mini all\n\n\n\n# 桌面端 pc 场景\n\n在桌面端 pc 场景下，如果你需要兼容 ie 11 浏览器，则可以将 browserslist 设置为：\n\n> 0.5%\nnot dead\nie 11\n\n\n以上浏览器范围会将代码编译至 es5 规范，具体对应的浏览器列表可以查看 browserslist.dev。\n\n如果你不需要兼容 ie 11 浏览器，那么可以调整 browserslist 来获得更高性能的产物，比如设置为支持原生 es modules 的浏览器：\n\nchrome > 61\nedge > 16\nfirefox > 60\nsafari > 11\nios_saf > 11\n\n\n\n# browserslist 默认值\n\nbuilder 会根据构建产物类型来设置不同的 browserslist 默认值，但我们推荐你在项目中显式设置 browserslist，这会让项目的兼容范围更加明确。\n\n\n# web 产物\n\nweb 产物的默认值如下所示：\n\n> 0.01%\nnot dead\nnot op_mini all\n\n\n在该浏览器范围下，javascript 代码被会编译到 es5 语法。\n\n\n# node 产物\n\nnode 产物默认最低兼容到 node.js 14.0 版本。\n\nnode >= 14\n\n\n\n# web worker 产物\n\nweb worker 产物默认的浏览器范围与 web 一致。\n\n> 0.01%\nnot dead\nnot op_mini all\n\n\n\n# modern web 产物\n\nmodern web 产物默认最低兼容到支持原生 es modules 的浏览器。\n\nchrome > 61\nedge > 16\nfirefox > 60\nsafari > 11\nios_saf > 11\n\n\n\n# 查询浏览器支持情况\n\n在开发时，我们需要了解某些特性或 api 的浏览器支持情况，此时我们可以在 caniuse 网站上进行查询。\n\n比如我们需要知道 promise 的浏览器支持情况，只需要在 caniuse 中输入 promise，就可以看到以下结果：\n\n\n\n从上表可以看出，promise 在 chrome 33 和 ios 8 中得到了原生支持，但是在 ie 11 中不被支持。",charsets:{cjk:!0}},{title:"修改 webpack 配置",frontmatter:{},regularPath:"/zh/guide/advanced/custom-webpack-config.html",relativePath:"zh/guide/advanced/custom-webpack-config.md",key:"v-b91f0568",path:"/zh/guide/advanced/custom-webpack-config.html",headers:[{level:2,title:"修改 webpack 配置对象",slug:"修改-webpack-配置对象",normalizedTitle:"修改 webpack 配置对象",charIndex:29},{level:2,title:"使用 webpack-chain",slug:"使用-webpack-chain",normalizedTitle:"使用 webpack-chain",charIndex:472},{level:2,title:"webpack-chain 基础知识",slug:"webpack-chain-基础知识",normalizedTitle:"webpack-chain 基础知识",charIndex:1034},{level:2,title:"webpack-chain 示例",slug:"webpack-chain-示例",normalizedTitle:"webpack-chain 示例",charIndex:2042}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"修改 webpack 配置对象 使用 webpack-chain webpack-chain 基础知识 webpack-chain 示例",content:"# 修改 webpack 配置\n\nBuilder 支持直接修改 webpack 配置对象，也支持通过 webpack-chain 来深度定制 webpack 配置。\n\n\n# 修改 webpack 配置对象\n\n你可以使用 tools.webpack 来修改 webpack 配置对象。\n\nexport default {\n  tools: {\n    webpack: (config, { env }) => {\n      if (env === 'development') {\n        config.devtool = 'cheap-module-eval-source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\n何时使用\n\n当你只需要修改少量 webpack 配置时，可以使用 tools.webpack。但如果你需要修改 Builder 内置的 webpack plugins 或 loaders，请使用 tools.webpackChain 进行修改。\n\n\n# 使用 webpack-chain\n\nwebpack-chain 是区别于直接修改 webpack 配置的另一种配置修改方式，相较于直接修改 webpack 配置对象，webpack-chain 不仅支持链式调用，并且能够基于 id 来修改内置的 Rule 或 Plugin.\n\n\n# tools.webpackChain 配置项\n\nBuilder 提供了 tools.webpackChain 配置项来修改 webpack-chain。\n\ntools.webpackChain 的值为 Function 类型，接收两个参数：\n\n * 第一个参数为 webpack-chain 实例对象，你可以通过这个实例来修改默认的 webpack 配置。\n * 第二个参数为一个工具集合，包括 env、isProd、CHAIN_ID 等。\n\n下面是一个基本示例：\n\nexport default {\n  tools: {\n    webpackChain: (chain, { env }) => {\n      if (env === 'development') {\n        chain.devtool('cheap-module-eval-source-map');\n      }\n    },\n  },\n};\n\n\n\n# webpack-chain 基础知识\n\n在开始使用 webpack-chain 来修改 webpack 配置之前，建议你先了解一些基础知识。\n\n\n# webpack-chain 是如何快速定位的\n\n简单来说，webpack-chain 要求使用者为每个 Rule、Loader、Plugin、Minimizer 都设置一个独一无二的 id，通过这个 id，就可以便捷地从嵌套层级很深的对象中找到所需的对象。\n\nBuilder 将内部定义的全部 id 都通过 CHAIN_ID 对象导出，因此你可以通过这些导出的 id，快速定位到你想要修改的 Loader 或 Plugin，而不需要在 webpack 配置对象里通过复杂的遍历寻找。\n\n比如通过 CHAIN_ID.PLUGIN.HTML 来删除内置的 HTML 插件：\n\nexport default {\n  tools: {\n    webpackChain: (chain, { webpack, CHAIN_ID }) => {\n      //\n      chain.plugins.delete(CHAIN_ID.PLUGIN.HTML);\n    },\n  },\n};\n\n\n\n# webpack-chain id 的类型\n\nCHAIN_ID 对象包含了多种 id，对应的含义如下：\n\nCHAIN_ID 字段               对应的配置                    描述\nCHAIN_ID.PLUGIN           plugins[i]               对应 webpack 配置中的一个插件\nCHAIN_ID.RULE             module.rules[i]          对应 webpack 配置中的一个 Rule\nCHAIN_ID.USE              module.rules[i].loader   对应 webpack 配置中的一个 Loader\nCHAIN_ID.MINIMIZER        optimization.minimizer   对应 webpack 配置中的一个压缩工具\nCHAIN_ID.RESOLVE_PLUGIN   resolve.plugins[i]       对应 webpack 配置中的中的一个 Resolve 插件\n\n\n# webpack-chain 示例\n\n\n# 新增/修改/删除 loader\n\nexport default {\n  tools: {\n    webpackChain: (chain, { CHAIN_ID }) => {\n      // 新增 loader\n      chain.module\n        .rule('md')\n        .test(/\\.md$/)\n        .use('md-loader')\n        .loader('md-loader');\n\n      // 修改 loader\n      chain.module\n        .rule(CHAIN_ID.RULE.JS)\n        .use(CHAIN_ID.USE.BABEL)\n        .tap(options => {\n          options.plugins.push('babel-plugin-xxx');\n          return options;\n        });\n\n      // 删除 loader\n      chain.module.rule(CHAIN_ID.RULE.JS).uses.delete(CHAIN_ID.USE.BABEL);\n    },\n  },\n};\n\n\n\n# 新增/修改/删除 plugin\n\nexport default {\n  tools: {\n    webpackChain: (chain, { webpack, CHAIN_ID }) => {\n      // 新增插件\n      chain.plugin('define').use(webpack.DefinePlugin, [\n        {\n          'process.env': {\n            NODE_ENV: JSON.stringify(process.env.NODE_ENV),\n          },\n        },\n      ]);\n\n      // 修改插件\n      chain.plugin(CHAIN_ID.PLUGIN.HMR).tap(options => {\n        options[0].fullBuildTimeout = 200;\n        return options;\n      });\n\n      // 删除插件\n      chain.plugins.delete(CHAIN_ID.PLUGIN.HMR);\n    },\n  },\n};\n\n\n\n# 根据不同环境修改配置\n\n在工具集合中你可以拿到各种环境的标识，如开发/生产/测试环境构建、 SSR 构建、Web Worker 构建，从而实现不同环境下的配置修改。\n\nexport default {\n  tools: {\n    webpackChain: (chain, { env, isProd, target, isServer, isWebWorker }) => {\n      if (utils.env === 'development' || utils.env === 'test') {\n        // ...\n      }\n      if (utils.isProd) {\n        // ...\n      }\n      if (utils.target === 'node') {\n        // ...\n      }\n      if (utils.isServer) {\n        // ...\n      }\n      if (utils.isWebWorker) {\n        // ...\n      }\n    },\n  },\n};\n\n\n以上是一些常见的配置示例，完整的 webpack-chain API 请见 webpack-chain 文档。",normalizedContent:"# 修改 webpack 配置\n\nbuilder 支持直接修改 webpack 配置对象，也支持通过 webpack-chain 来深度定制 webpack 配置。\n\n\n# 修改 webpack 配置对象\n\n你可以使用 tools.webpack 来修改 webpack 配置对象。\n\nexport default {\n  tools: {\n    webpack: (config, { env }) => {\n      if (env === 'development') {\n        config.devtool = 'cheap-module-eval-source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\n何时使用\n\n当你只需要修改少量 webpack 配置时，可以使用 tools.webpack。但如果你需要修改 builder 内置的 webpack plugins 或 loaders，请使用 tools.webpackchain 进行修改。\n\n\n# 使用 webpack-chain\n\nwebpack-chain 是区别于直接修改 webpack 配置的另一种配置修改方式，相较于直接修改 webpack 配置对象，webpack-chain 不仅支持链式调用，并且能够基于 id 来修改内置的 rule 或 plugin.\n\n\n# tools.webpackchain 配置项\n\nbuilder 提供了 tools.webpackchain 配置项来修改 webpack-chain。\n\ntools.webpackchain 的值为 function 类型，接收两个参数：\n\n * 第一个参数为 webpack-chain 实例对象，你可以通过这个实例来修改默认的 webpack 配置。\n * 第二个参数为一个工具集合，包括 env、isprod、chain_id 等。\n\n下面是一个基本示例：\n\nexport default {\n  tools: {\n    webpackchain: (chain, { env }) => {\n      if (env === 'development') {\n        chain.devtool('cheap-module-eval-source-map');\n      }\n    },\n  },\n};\n\n\n\n# webpack-chain 基础知识\n\n在开始使用 webpack-chain 来修改 webpack 配置之前，建议你先了解一些基础知识。\n\n\n# webpack-chain 是如何快速定位的\n\n简单来说，webpack-chain 要求使用者为每个 rule、loader、plugin、minimizer 都设置一个独一无二的 id，通过这个 id，就可以便捷地从嵌套层级很深的对象中找到所需的对象。\n\nbuilder 将内部定义的全部 id 都通过 chain_id 对象导出，因此你可以通过这些导出的 id，快速定位到你想要修改的 loader 或 plugin，而不需要在 webpack 配置对象里通过复杂的遍历寻找。\n\n比如通过 chain_id.plugin.html 来删除内置的 html 插件：\n\nexport default {\n  tools: {\n    webpackchain: (chain, { webpack, chain_id }) => {\n      //\n      chain.plugins.delete(chain_id.plugin.html);\n    },\n  },\n};\n\n\n\n# webpack-chain id 的类型\n\nchain_id 对象包含了多种 id，对应的含义如下：\n\nchain_id 字段               对应的配置                    描述\nchain_id.plugin           plugins[i]               对应 webpack 配置中的一个插件\nchain_id.rule             module.rules[i]          对应 webpack 配置中的一个 rule\nchain_id.use              module.rules[i].loader   对应 webpack 配置中的一个 loader\nchain_id.minimizer        optimization.minimizer   对应 webpack 配置中的一个压缩工具\nchain_id.resolve_plugin   resolve.plugins[i]       对应 webpack 配置中的中的一个 resolve 插件\n\n\n# webpack-chain 示例\n\n\n# 新增/修改/删除 loader\n\nexport default {\n  tools: {\n    webpackchain: (chain, { chain_id }) => {\n      // 新增 loader\n      chain.module\n        .rule('md')\n        .test(/\\.md$/)\n        .use('md-loader')\n        .loader('md-loader');\n\n      // 修改 loader\n      chain.module\n        .rule(chain_id.rule.js)\n        .use(chain_id.use.babel)\n        .tap(options => {\n          options.plugins.push('babel-plugin-xxx');\n          return options;\n        });\n\n      // 删除 loader\n      chain.module.rule(chain_id.rule.js).uses.delete(chain_id.use.babel);\n    },\n  },\n};\n\n\n\n# 新增/修改/删除 plugin\n\nexport default {\n  tools: {\n    webpackchain: (chain, { webpack, chain_id }) => {\n      // 新增插件\n      chain.plugin('define').use(webpack.defineplugin, [\n        {\n          'process.env': {\n            node_env: json.stringify(process.env.node_env),\n          },\n        },\n      ]);\n\n      // 修改插件\n      chain.plugin(chain_id.plugin.hmr).tap(options => {\n        options[0].fullbuildtimeout = 200;\n        return options;\n      });\n\n      // 删除插件\n      chain.plugins.delete(chain_id.plugin.hmr);\n    },\n  },\n};\n\n\n\n# 根据不同环境修改配置\n\n在工具集合中你可以拿到各种环境的标识，如开发/生产/测试环境构建、 ssr 构建、web worker 构建，从而实现不同环境下的配置修改。\n\nexport default {\n  tools: {\n    webpackchain: (chain, { env, isprod, target, isserver, iswebworker }) => {\n      if (utils.env === 'development' || utils.env === 'test') {\n        // ...\n      }\n      if (utils.isprod) {\n        // ...\n      }\n      if (utils.target === 'node') {\n        // ...\n      }\n      if (utils.isserver) {\n        // ...\n      }\n      if (utils.iswebworker) {\n        // ...\n      }\n    },\n  },\n};\n\n\n以上是一些常见的配置示例，完整的 webpack-chain api 请见 webpack-chain 文档。",charsets:{cjk:!0}},{title:"环境变量",frontmatter:{},regularPath:"/zh/guide/advanced/define.html",relativePath:"zh/guide/advanced/define.md",key:"v-10b58620",path:"/zh/guide/advanced/define.html",headers:[{level:2,title:"默认环境变量",slug:"默认环境变量",normalizedTitle:"默认环境变量",charIndex:83},{level:2,title:"使用 define 配置项",slug:"使用-define-配置项",normalizedTitle:"使用 define 配置项",charIndex:526},{level:2,title:"设置环境变量",slug:"设置环境变量",normalizedTitle:"设置环境变量",charIndex:1263},{level:2,title:"声明环境变量类型",slug:"声明环境变量类型",normalizedTitle:"声明环境变量类型",charIndex:1879},{level:2,title:"Tree Shaking",slug:"tree-shaking",normalizedTitle:"tree shaking",charIndex:709},{level:2,title:"源码内联测试",slug:"源码内联测试",normalizedTitle:"源码内联测试",charIndex:2883}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"默认环境变量 使用 define 配置项 设置环境变量 声明环境变量类型 Tree Shaking 源码内联测试",content:"# 环境变量\n\nBuilder 支持在编译过程中向代码中注入环境变量或表达式，这对于区分运行环境、注入常量值等场景很有帮助。本章节会介绍环境变量的使用方式。\n\n\n# 默认环境变量\n\n默认情况下，Builder 会自动设置 process.env.NODE_ENV 环境变量，在开发模式为 'development'，生产模式为 'production'。\n\n你可以在配置文件和运行时的前端代码中直接使用 process.env.NODE_ENV。\n\nif (process.env.NODE_ENV === 'development') {\n  console.log('this is a development log');\n}\n\n\n在开发环境，以上代码会被编译为：\n\nif (true) {\n  console.log('this is a development log');\n}\n\n\n在生产环境，以上代码会被编译为：\n\nif (false) {\n  console.log('this is a development log');\n}\n\n\n在代码压缩过程中，if (false) { ... } 会被识别为无效代码，并被自动移除。\n\n\n# 使用 define 配置项\n\n通过配置 source.define 选项，你可以在构建时将代码中的变量替换成其它值或者表达式。\n\ndefine 类似于其它一些语言提供的宏定义能力，但得益于 JavaScript 强大的运行时表达能力，通常不需要像那些语言一样将其用作复杂代码的生成器。它常用于在构建环境向运行时传递环境变量等简单信息，或是辅助 Builder 进行 Tree Shaking 等操作。\n\n\n# 替换表达式\n\ndefine 最基础的用途是在构建时替换代码中的表达式。\n\n例如环境变量 NODE_ENV 的值会影响许多第三方模块的行为，在构建线上应用的产物时通常需要将它设置为 \"production\"：\n\nexport default {\n  source: {\n    define: {\n      'process.env.NODE_ENV': JSON.stringify(process.env.NODE_ENV),\n    },\n  },\n};\n\n\n需要注意的是这里提供的值必须是 JSON 字符串，例如 process.env.NODE_ENV 的值为 \"production\" 则传入的值应当是 \"\\\"production\\\"\" 才能够正确被处理。\n\n同理 { foo: \"bar\" } 也应该被转换成 \"{\\\"foo\\\":\\\"bar\\\"}\"，如果直接传入原始对象则意味着把表达式 process.env.NODE_ENV.foo 替换为标识符 bar。\n\nsource.define 的具体行为请参考 API 文档。\n\nTIP\n\n以上例子中的环境变量 NODE_ENV 已经由 Builder 自动注入，通常你不需要手动配置它的值。\n\n\n# 设置环境变量\n\n针对设置环境变量的高频场景，Builder 还提供了 source.globalVars 配置用于简化配置，它是 source.define 的一个语法糖，唯一的区别是 source.globalVars 会自动将传入的值进行 JSON 序列化处理，这使得设置环境变量的值更容易，避免大量书写 JSON.stringify(...) 转换语句：\n\nexport default {\n  source: {\n    globalVars: {\n      'process.env.NODE_ENV': 'production',\n      'import.meta.foo': { bar: 42 },\n      'import.meta.baz': false,\n    },\n  },\n};\n\n\n需要注意的是不论以上哪种方式都只会匹配完整的表达式，对表达式进行解构会让 Builder 无法正确识别：\n\nconsole.log(process.env.NODE_ENV);\n// => production\n\nconst { NODE_ENV } = process.env;\nconsole.log(NODE_ENV);\n// => undefined\n\nconst vars = process.env;\nconsole.log(vars.NODE_ENV);\n// => undefined\n\n\n\n# 声明环境变量类型\n\n当你在 TypeScript 代码中读取环境变量时，TypeScript 可能会提示该变量缺少类型定义，此时你需要添加相应的类型声明。\n\n比如你引用了一个 CUSTOM_VAR 变量，在 TypeScript 文件中会出现如下提示：\n\nTS2304: Cannot find name 'CUSTOM_VAR'.\n\n\n此时，你可以在项目中创建 src/env.d.ts 文件，并添加以下内容即可：\n\n// src/env.d.ts\ndeclare const CUSTOM_VAR: string;\n\n\n\n# Tree Shaking\n\nDefine 还可以用于标记死代码以协助 Builder 进行 Tree Shaking 优化。\n\n例如通过将 process.env.REGION 替换为具体值来实现针对不同地区的产物进行差异化构建：\n\nexport default {\n  source: {\n    define: {\n      'process.env.REGION': JSON.stringify(process.env.REGION),\n    },\n    // or...\n    globalVars: {\n      'process.env.REGION': process.env.REGION,\n    },\n  },\n};\n\n\n这样设置后对于存在地区控制的代码：\n\nconst App = () => {\n  if (process.env.REGION === 'cn') {\n    return <EntryFoo />;\n  } else if (process.env.REGION === 'sg') {\n    return <EntryBar />;\n  } else {\n    return <EntryBaz />;\n  }\n};\n\n\n指定环境变量 REGION=sg 并执行构建得到的产物会被剔除多余的代码：\n\nconst App = () => {\n  if (false) {\n  } else if (true) {\n    return <EntryBar />;\n  } else {\n  }\n};\n\n\n未用到的组件不会被打包到产物中，它们的外部依赖也会对应地被优化，最终即可得到体积和性能都更优的产物代码。\n\n\n# 源码内联测试\n\nVitest 支持将测试写在源码文件内，能够在不导出的情况下测试私有功能的行为，并且通过设置 Define 来在正式构建时剔除测试代码。详细指南请参考 Vitest 官方文档。\n\n// 函数实现\nfunction add(...args) {\n  return args.reduce((a, b) => a + b, 0);\n}\n\n// 源码内的测试套件\nif (import.meta.vitest) {\n  const { it, expect } = import.meta.vitest;\n  it('add', () => {\n    expect(add()).toBe(0);\n    expect(add(1)).toBe(1);\n    expect(add(1, 2, 3)).toBe(6);\n  });\n}\n",normalizedContent:"# 环境变量\n\nbuilder 支持在编译过程中向代码中注入环境变量或表达式，这对于区分运行环境、注入常量值等场景很有帮助。本章节会介绍环境变量的使用方式。\n\n\n# 默认环境变量\n\n默认情况下，builder 会自动设置 process.env.node_env 环境变量，在开发模式为 'development'，生产模式为 'production'。\n\n你可以在配置文件和运行时的前端代码中直接使用 process.env.node_env。\n\nif (process.env.node_env === 'development') {\n  console.log('this is a development log');\n}\n\n\n在开发环境，以上代码会被编译为：\n\nif (true) {\n  console.log('this is a development log');\n}\n\n\n在生产环境，以上代码会被编译为：\n\nif (false) {\n  console.log('this is a development log');\n}\n\n\n在代码压缩过程中，if (false) { ... } 会被识别为无效代码，并被自动移除。\n\n\n# 使用 define 配置项\n\n通过配置 source.define 选项，你可以在构建时将代码中的变量替换成其它值或者表达式。\n\ndefine 类似于其它一些语言提供的宏定义能力，但得益于 javascript 强大的运行时表达能力，通常不需要像那些语言一样将其用作复杂代码的生成器。它常用于在构建环境向运行时传递环境变量等简单信息，或是辅助 builder 进行 tree shaking 等操作。\n\n\n# 替换表达式\n\ndefine 最基础的用途是在构建时替换代码中的表达式。\n\n例如环境变量 node_env 的值会影响许多第三方模块的行为，在构建线上应用的产物时通常需要将它设置为 \"production\"：\n\nexport default {\n  source: {\n    define: {\n      'process.env.node_env': json.stringify(process.env.node_env),\n    },\n  },\n};\n\n\n需要注意的是这里提供的值必须是 json 字符串，例如 process.env.node_env 的值为 \"production\" 则传入的值应当是 \"\\\"production\\\"\" 才能够正确被处理。\n\n同理 { foo: \"bar\" } 也应该被转换成 \"{\\\"foo\\\":\\\"bar\\\"}\"，如果直接传入原始对象则意味着把表达式 process.env.node_env.foo 替换为标识符 bar。\n\nsource.define 的具体行为请参考 api 文档。\n\ntip\n\n以上例子中的环境变量 node_env 已经由 builder 自动注入，通常你不需要手动配置它的值。\n\n\n# 设置环境变量\n\n针对设置环境变量的高频场景，builder 还提供了 source.globalvars 配置用于简化配置，它是 source.define 的一个语法糖，唯一的区别是 source.globalvars 会自动将传入的值进行 json 序列化处理，这使得设置环境变量的值更容易，避免大量书写 json.stringify(...) 转换语句：\n\nexport default {\n  source: {\n    globalvars: {\n      'process.env.node_env': 'production',\n      'import.meta.foo': { bar: 42 },\n      'import.meta.baz': false,\n    },\n  },\n};\n\n\n需要注意的是不论以上哪种方式都只会匹配完整的表达式，对表达式进行解构会让 builder 无法正确识别：\n\nconsole.log(process.env.node_env);\n// => production\n\nconst { node_env } = process.env;\nconsole.log(node_env);\n// => undefined\n\nconst vars = process.env;\nconsole.log(vars.node_env);\n// => undefined\n\n\n\n# 声明环境变量类型\n\n当你在 typescript 代码中读取环境变量时，typescript 可能会提示该变量缺少类型定义，此时你需要添加相应的类型声明。\n\n比如你引用了一个 custom_var 变量，在 typescript 文件中会出现如下提示：\n\nts2304: cannot find name 'custom_var'.\n\n\n此时，你可以在项目中创建 src/env.d.ts 文件，并添加以下内容即可：\n\n// src/env.d.ts\ndeclare const custom_var: string;\n\n\n\n# tree shaking\n\ndefine 还可以用于标记死代码以协助 builder 进行 tree shaking 优化。\n\n例如通过将 process.env.region 替换为具体值来实现针对不同地区的产物进行差异化构建：\n\nexport default {\n  source: {\n    define: {\n      'process.env.region': json.stringify(process.env.region),\n    },\n    // or...\n    globalvars: {\n      'process.env.region': process.env.region,\n    },\n  },\n};\n\n\n这样设置后对于存在地区控制的代码：\n\nconst app = () => {\n  if (process.env.region === 'cn') {\n    return <entryfoo />;\n  } else if (process.env.region === 'sg') {\n    return <entrybar />;\n  } else {\n    return <entrybaz />;\n  }\n};\n\n\n指定环境变量 region=sg 并执行构建得到的产物会被剔除多余的代码：\n\nconst app = () => {\n  if (false) {\n  } else if (true) {\n    return <entrybar />;\n  } else {\n  }\n};\n\n\n未用到的组件不会被打包到产物中，它们的外部依赖也会对应地被优化，最终即可得到体积和性能都更优的产物代码。\n\n\n# 源码内联测试\n\nvitest 支持将测试写在源码文件内，能够在不导出的情况下测试私有功能的行为，并且通过设置 define 来在正式构建时剔除测试代码。详细指南请参考 vitest 官方文档。\n\n// 函数实现\nfunction add(...args) {\n  return args.reduce((a, b) => a + b, 0);\n}\n\n// 源码内的测试套件\nif (import.meta.vitest) {\n  const { it, expect } = import.meta.vitest;\n  it('add', () => {\n    expect(add()).tobe(0);\n    expect(add(1)).tobe(1);\n    expect(add(1, 2, 3)).tobe(6);\n  });\n}\n",charsets:{cjk:!0}},{title:"模块热替换",frontmatter:{},regularPath:"/zh/guide/advanced/hmr.html",relativePath:"zh/guide/advanced/hmr.md",key:"v-210da8ac",path:"/zh/guide/advanced/hmr.html",headers:[{level:2,title:"启用 HMR",slug:"启用-hmr",normalizedTitle:"启用 hmr",charIndex:222},{level:2,title:"自定义 HMR URL",slug:"自定义-hmr-url",normalizedTitle:"自定义 hmr url",charIndex:382},{level:2,title:"Live reloading 和 Hot reloading 的区别",slug:"live-reloading-和-hot-reloading-的区别",normalizedTitle:"live reloading 和 hot reloading 的区别",charIndex:652},{level:2,title:"常见问题",slug:"常见问题",normalizedTitle:"常见问题",charIndex:980}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"启用 HMR 自定义 HMR URL Live reloading 和 Hot reloading 的区别 常见问题",content:"# 模块热替换\n\n模块热替换(HMR - hot module replacement)功能会在应用程序运行过程中，替换、添加或删除模块，而无需重新加载整个页面。主要是通过以下几种方式，来显著加快开发速度：\n\n * 保留在完全重新加载页面期间丢失的应用程序状态。\n * 只更新变更内容，以节省宝贵的开发时间。\n * 在源代码中 CSS/JS 产生修改时，会立刻在浏览器中进行更新，这几乎相当于在浏览器 devtools 直接更改样式。\n\n\n# 启用 HMR\n\nBuilder 已内置了对 HMR 的支持，开发环境下默认启用。 可通过将 dev.hmr 设置为 false，关闭 HMR 能力，此时将不再提供热更新和 react-refresh 功能。\n\nexport default {\n  dev: {\n    hmr: false,\n  },\n};\n\n\n\n# 自定义 HMR URL\n\nBuilder 默认使用 local-ip 和当前端口号拼接 HMR 客户端的 URL，当出现连接失败的情况，可以通过自定义配置的方式指定可用的 URL。\n\n例如，通过将 host 和 path 设置为空将根据当前客户端情况自动推导 HMR 客户端 URL：\n\nexport default {\n  tools: {\n    devServer: {\n      client: {\n        port: '',\n        host: '',\n      },\n    },\n  },\n};\n\n\n\n# Live reloading 和 Hot reloading 的区别\n\n * Live reloading: 修改文件之后，webpack 重新编译，并强制刷新浏览器，属于全局（整个应用）刷新，相当于 window.location.reload()；\n * Hot reloading: 修改文件之后，webpack 重新编译对应模块，刷新时可以记住应用的状态，从而做到局部刷新，即热更新。\n\nDevServer 提供了 hot 和 liveReload 这两个配置项来控制更新方式。当 hot 和 liveReload 同时开启时，DevServer 会优先尝试使用 hot 模式 (HMR)，如果 HMR 更新失败后，会降级到重新加载页面。\n\n\n# 常见问题\n\n\n# External react/reactDom 后，热更新不生效？\n\n热更新能力生效需要用到 react 和 react-dom 的 development 模式， 而 CDN 上的 react 通常使用 production 模式。你需要切换到开发模式，或者在开发环境下不配置 external。\n\n如果不确定你当前使用的 React 模式，你可以参考：检查 React 模式\n\n\n# 开启 https 后，热更新不生效？\n\n当开启 https 时，由于证书的问题，会出现 HMR 连接失败的情况，此时打开控制台，会出现 HMR connect failed 的报错。\n\n\n\n此问题的解决方法为：点击 Chrome 浏览器问题页面的「高级」->「继续前往 xxx（不安全）」。\n\n\n\n> Tips: 当通过 Localhost 访问页面时，「您的连接不是私密连接」字样可能不会出现，可访问 Network 域名进行处理。\n\n\n# 热更新后 React 组件的 state 丢失？\n\nBuilder 使用 React 官方的 Fast Refresh 能力来进行组件热更新。\n\n在使用 Fast Refresh 时，要求组件不能为匿名函数，否则热更新后无法保留 React 组件的 state。\n\n以下写法都是不正确的：\n\n// 错误写法 1\nexport default function () {\n  return <div>Hello World</div>;\n}\n\n// 错误写法 2\nexport default () => <div>Hello World</div>;\n\n\n正确的写法为：\n\n// 正确写法 1\nexport default function MyComponent() {\n  return <div>Hello World</div>;\n}\n\n// 正确写法 2\nconst MyComponent = () => <div>Hello World</div>\n\nexport default MyComponent;\n",normalizedContent:"# 模块热替换\n\n模块热替换(hmr - hot module replacement)功能会在应用程序运行过程中，替换、添加或删除模块，而无需重新加载整个页面。主要是通过以下几种方式，来显著加快开发速度：\n\n * 保留在完全重新加载页面期间丢失的应用程序状态。\n * 只更新变更内容，以节省宝贵的开发时间。\n * 在源代码中 css/js 产生修改时，会立刻在浏览器中进行更新，这几乎相当于在浏览器 devtools 直接更改样式。\n\n\n# 启用 hmr\n\nbuilder 已内置了对 hmr 的支持，开发环境下默认启用。 可通过将 dev.hmr 设置为 false，关闭 hmr 能力，此时将不再提供热更新和 react-refresh 功能。\n\nexport default {\n  dev: {\n    hmr: false,\n  },\n};\n\n\n\n# 自定义 hmr url\n\nbuilder 默认使用 local-ip 和当前端口号拼接 hmr 客户端的 url，当出现连接失败的情况，可以通过自定义配置的方式指定可用的 url。\n\n例如，通过将 host 和 path 设置为空将根据当前客户端情况自动推导 hmr 客户端 url：\n\nexport default {\n  tools: {\n    devserver: {\n      client: {\n        port: '',\n        host: '',\n      },\n    },\n  },\n};\n\n\n\n# live reloading 和 hot reloading 的区别\n\n * live reloading: 修改文件之后，webpack 重新编译，并强制刷新浏览器，属于全局（整个应用）刷新，相当于 window.location.reload()；\n * hot reloading: 修改文件之后，webpack 重新编译对应模块，刷新时可以记住应用的状态，从而做到局部刷新，即热更新。\n\ndevserver 提供了 hot 和 livereload 这两个配置项来控制更新方式。当 hot 和 livereload 同时开启时，devserver 会优先尝试使用 hot 模式 (hmr)，如果 hmr 更新失败后，会降级到重新加载页面。\n\n\n# 常见问题\n\n\n# external react/reactdom 后，热更新不生效？\n\n热更新能力生效需要用到 react 和 react-dom 的 development 模式， 而 cdn 上的 react 通常使用 production 模式。你需要切换到开发模式，或者在开发环境下不配置 external。\n\n如果不确定你当前使用的 react 模式，你可以参考：检查 react 模式\n\n\n# 开启 https 后，热更新不生效？\n\n当开启 https 时，由于证书的问题，会出现 hmr 连接失败的情况，此时打开控制台，会出现 hmr connect failed 的报错。\n\n\n\n此问题的解决方法为：点击 chrome 浏览器问题页面的「高级」->「继续前往 xxx（不安全）」。\n\n\n\n> tips: 当通过 localhost 访问页面时，「您的连接不是私密连接」字样可能不会出现，可访问 network 域名进行处理。\n\n\n# 热更新后 react 组件的 state 丢失？\n\nbuilder 使用 react 官方的 fast refresh 能力来进行组件热更新。\n\n在使用 fast refresh 时，要求组件不能为匿名函数，否则热更新后无法保留 react 组件的 state。\n\n以下写法都是不正确的：\n\n// 错误写法 1\nexport default function () {\n  return <div>hello world</div>;\n}\n\n// 错误写法 2\nexport default () => <div>hello world</div>;\n\n\n正确的写法为：\n\n// 正确写法 1\nexport default function mycomponent() {\n  return <div>hello world</div>;\n}\n\n// 正确写法 2\nconst mycomponent = () => <div>hello world</div>\n\nexport default mycomponent;\n",charsets:{cjk:!0}},{title:"开启 REM 适配",frontmatter:{},regularPath:"/zh/guide/advanced/rem.html",relativePath:"zh/guide/advanced/rem.md",key:"v-7f0277e8",path:"/zh/guide/advanced/rem.html",headers:[{level:2,title:"开启 REM 的适配能力",slug:"开启-rem-的适配能力",normalizedTitle:"开启 rem 的适配能力",charIndex:104},{level:2,title:"CSS 属性值转换",slug:"css-属性值转换",normalizedTitle:"css 属性值转换",charIndex:265},{level:2,title:"根元素字体大小计算",slug:"根元素字体大小计算",normalizedTitle:"根元素字体大小计算",charIndex:769},{level:2,title:"自定义最大根元素字体值",slug:"自定义最大根元素字体值",normalizedTitle:"自定义最大根元素字体值",charIndex:1175}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"开启 REM 的适配能力 CSS 属性值转换 根元素字体大小计算 自定义最大根元素字体值",content:"# 开启 REM 适配\n\nBuilder 支持通过 output.convertToRem 一键开启 REM 适配能力，能够根据屏幕大小来动态调整字体大小，让网页在不同大小的屏幕上都能够自适应显示。\n\n\n# 开启 REM 的适配能力\n\n开启 convertToRem 后，会对页面进行如下两个操作：\n\n 1. 将 CSS 属性中的 px 转成 rem。\n 2. 对根元素的字体大小进行动态设置。\n\nexport default {\n  output: {\n    convertToRem: true,\n  },\n};\n\n\n\n# CSS 属性值转换\n\n由于默认的 rootFontSize 为 50。开启 rem 转换后，会按照 1rem = 50px 的比例，对 CSS 样式做如下转换：\n\n/* input */\nh1 {\n  margin: 0 0 16px;\n  font-size: 32px;\n  line-height: 1.2;\n  letter-spacing: 1px;\n}\n\n/* output */\nh1 {\n  margin: 0 0 0.32rem;\n  font-size: 0.64rem;\n  line-height: 1.2;\n  letter-spacing: 0.02rem;\n}\n\n\nBuilder 默认会对所有 CSS 属性进行转换，如果希望仅对 font-size 属性进行转换，可通过设置 pxtorem.propList 实现。\n\nexport default {\n  output: {\n    convertToRem: {\n      pxtorem: {\n        propList: ['font-size'],\n      },\n    },\n  },\n};\n\n\n\n# 根元素字体大小计算\n\n页面根元素的字体大小的计算公式为：\n\n根元素字体大小 = 当前客户端屏幕宽度  * 根元素字体值 / UI 设计图宽度\n\n(即：pageRootFontSize = clientWidth * rootFontSize / screenWidth)\n\n\n以屏幕宽度为 390 的手机端浏览器为例，根元素字体值的默认值为 50， UI 设计图宽度为 375。\n\n此时计算出的页面根元素的字体大小为 52 (390 * 50 / 375)。 此时 1 rem 为 52px，CSS 样式中的 32px（0.64 rem），实际页面效果为 33.28 px。\n\nexport default {\n  output: {\n    convertToRem: {\n      rootFontSize: 50,\n      screenWidth: 375,\n    },\n  },\n};\n\n\n\n# 自定义最大根元素字体值\n\n在桌面浏览器端，根据计算公式得到的页面根元素字体值往往过大，当计算出的结果超出了默认的最大根元素字体值时，则采用当前设置的最大根元素字体值为当前根元素字体值。\n\n以屏幕宽度为 1920 的桌面浏览器为例，此时计算出的根元素的字体大小为 349，超出了最大根元素字体值 64。则采用 64 为当前的根元素字体值。\n\nexport default {\n  output: {\n    convertToRem: {\n      maxRootFontSize: 64,\n    },\n  },\n};\n",normalizedContent:"# 开启 rem 适配\n\nbuilder 支持通过 output.converttorem 一键开启 rem 适配能力，能够根据屏幕大小来动态调整字体大小，让网页在不同大小的屏幕上都能够自适应显示。\n\n\n# 开启 rem 的适配能力\n\n开启 converttorem 后，会对页面进行如下两个操作：\n\n 1. 将 css 属性中的 px 转成 rem。\n 2. 对根元素的字体大小进行动态设置。\n\nexport default {\n  output: {\n    converttorem: true,\n  },\n};\n\n\n\n# css 属性值转换\n\n由于默认的 rootfontsize 为 50。开启 rem 转换后，会按照 1rem = 50px 的比例，对 css 样式做如下转换：\n\n/* input */\nh1 {\n  margin: 0 0 16px;\n  font-size: 32px;\n  line-height: 1.2;\n  letter-spacing: 1px;\n}\n\n/* output */\nh1 {\n  margin: 0 0 0.32rem;\n  font-size: 0.64rem;\n  line-height: 1.2;\n  letter-spacing: 0.02rem;\n}\n\n\nbuilder 默认会对所有 css 属性进行转换，如果希望仅对 font-size 属性进行转换，可通过设置 pxtorem.proplist 实现。\n\nexport default {\n  output: {\n    converttorem: {\n      pxtorem: {\n        proplist: ['font-size'],\n      },\n    },\n  },\n};\n\n\n\n# 根元素字体大小计算\n\n页面根元素的字体大小的计算公式为：\n\n根元素字体大小 = 当前客户端屏幕宽度  * 根元素字体值 / ui 设计图宽度\n\n(即：pagerootfontsize = clientwidth * rootfontsize / screenwidth)\n\n\n以屏幕宽度为 390 的手机端浏览器为例，根元素字体值的默认值为 50， ui 设计图宽度为 375。\n\n此时计算出的页面根元素的字体大小为 52 (390 * 50 / 375)。 此时 1 rem 为 52px，css 样式中的 32px（0.64 rem），实际页面效果为 33.28 px。\n\nexport default {\n  output: {\n    converttorem: {\n      rootfontsize: 50,\n      screenwidth: 375,\n    },\n  },\n};\n\n\n\n# 自定义最大根元素字体值\n\n在桌面浏览器端，根据计算公式得到的页面根元素字体值往往过大，当计算出的结果超出了默认的最大根元素字体值时，则采用当前设置的最大根元素字体值为当前根元素字体值。\n\n以屏幕宽度为 1920 的桌面浏览器为例，此时计算出的根元素的字体大小为 349，超出了最大根元素字体值 64。则采用 64 为当前的根元素字体值。\n\nexport default {\n  output: {\n    converttorem: {\n      maxrootfontsize: 64,\n    },\n  },\n};\n",charsets:{cjk:!0}},{title:"构建产物类型",frontmatter:{},regularPath:"/zh/guide/basic/build-target.html",relativePath:"zh/guide/basic/build-target.md",key:"v-5647fecc",path:"/zh/guide/basic/build-target.html",headers:[{level:2,title:"默认产物",slug:"默认产物",normalizedTitle:"默认产物",charIndex:145},{level:2,title:"可选类型",slug:"可选类型",normalizedTitle:"可选类型",charIndex:249},{level:2,title:"并行构建",slug:"并行构建",normalizedTitle:"并行构建",charIndex:508},{level:2,title:"Node 产物",slug:"node-产物",normalizedTitle:"node 产物",charIndex:667},{level:2,title:"Web Worker 产物",slug:"web-worker-产物",normalizedTitle:"web worker 产物",charIndex:1045},{level:2,title:"Modern Web 产物",slug:"modern-web-产物",normalizedTitle:"modern web 产物",charIndex:1466}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"默认产物 可选类型 并行构建 Node 产物 Web Worker 产物 Modern Web 产物",content:"# 构建产物类型\n\nBuilder 支持多种构建产物类型，分别适用于不同的目标运行环境。在设置正确的产物类型后，Builder 会针对该环境优化打包结果，在构建过程中启用一些对应的插件或者配置。\n\n你可以通过 createBuilder 方法的 target 参数来设置产物类型。\n\n\n# 默认产物\n\n默认情况下，target 会被设置为 'web'，并构建出运行在浏览器环境里的产物。\n\n同时，Builder 会读取项目中的 Browserslist 配置，以确定需要兼容的浏览器范围。\n\n\n# 可选类型\n\n除了 'web' 外，你还可以将 target 设置为以下值：\n\n * 'node': 构建出运行在 Node.js 环境的产物，通常用于 SSR 等场景。\n * 'web-worker'：构建出运行在 Web Worker 里的产物。\n * 'modern-web'：构建出运行在现代浏览器里的产物。\n\n比如构建出适用于 Node.js 环境的产物：\n\nconst builder = await createBuilder(provider, {\n  target: 'node',\n});\n\n\n\n# 并行构建\n\n当 target 为包含多个值的数组时，Builder 会并行构建，并生成多份不同的产物。\n\n比如同时构建浏览器产物和 SSR 产物：\n\nconst builder = await createBuilder(provider, {\n  target: ['web', 'node'],\n});\n\n\n\n# Node 产物\n\n指运行在 Node.js 环境的产物，通常用于 SSR 等场景。\n\n当 target 设置为 'node' 时，Builder 会进行以下处理：\n\n * 不会生成 HTML 文件，与 HTML 相关的逻辑也不会执行，因为 Node.js 环境不需要 HTML。\n * 不会打包或抽取 CSS 代码，但产物中会包含 CSS Modules 的 id 信息。\n * 不会开启默认的拆包策略，但 dynamic import 依然可以生效。\n * 不会开启热更新相关的能力。\n * 将 Browserslist 的默认值调整为 ['node >= 14']。\n\nTIP\n\n如果触发了并行构建，比如同时构建 web 产物和 node 产物，那么上述处理不会影响 web 产物，web 产物所需的 HTML、CSS 等文件依然会正确生成。\n\n\n# Web Worker 产物\n\n指运行在 Web Worker 环境的产物。\n\nWeb Worker\n\nWeb Workers 是一种 JavaScript API，它允许网页在后台线程中执行脚本，与主线程（网页）分离。这意味着，您可以使用 Web Workers 来执行计算密集型或长时间运行的任务，而无需阻塞主线程，进而影响网页的性能。\n\n当 target 设置为 'web-worker' 时，Builder 会进行以下处理：\n\n * 不会生成 HTML 文件，与 HTML 相关的逻辑也不会执行，因为 Web Worker 环境不需要 HTML。\n * 不会打包或抽取 CSS 代码，但产物中会包含 CSS Modules 的 id 信息。\n * 不会开启默认的拆包策略，并且 dynamic import 也不会生效，因为 Web Worker 仅运行支持单个 JavaScript 文件。\n * 不会开启热更新相关的能力。\n\n\n# Modern Web 产物\n\n指运行在现代浏览器环境的产物。\n\n什么是现代浏览器?\n\n现代浏览器是我们的一个约定用语，指支持 原生 ES Modules 的浏览器。\n\n当 target 设置为 'modern-web' 时，Builder 会进行以下处理：\n\n * 将 Browserslist 的默认值调整为：\n\nconst browserslist = [\n  'chrome > 61',\n  'edge > 16',\n  'firefox > 60',\n  'safari > 11',\n  'ios_saf > 11',\n];\n",normalizedContent:"# 构建产物类型\n\nbuilder 支持多种构建产物类型，分别适用于不同的目标运行环境。在设置正确的产物类型后，builder 会针对该环境优化打包结果，在构建过程中启用一些对应的插件或者配置。\n\n你可以通过 createbuilder 方法的 target 参数来设置产物类型。\n\n\n# 默认产物\n\n默认情况下，target 会被设置为 'web'，并构建出运行在浏览器环境里的产物。\n\n同时，builder 会读取项目中的 browserslist 配置，以确定需要兼容的浏览器范围。\n\n\n# 可选类型\n\n除了 'web' 外，你还可以将 target 设置为以下值：\n\n * 'node': 构建出运行在 node.js 环境的产物，通常用于 ssr 等场景。\n * 'web-worker'：构建出运行在 web worker 里的产物。\n * 'modern-web'：构建出运行在现代浏览器里的产物。\n\n比如构建出适用于 node.js 环境的产物：\n\nconst builder = await createbuilder(provider, {\n  target: 'node',\n});\n\n\n\n# 并行构建\n\n当 target 为包含多个值的数组时，builder 会并行构建，并生成多份不同的产物。\n\n比如同时构建浏览器产物和 ssr 产物：\n\nconst builder = await createbuilder(provider, {\n  target: ['web', 'node'],\n});\n\n\n\n# node 产物\n\n指运行在 node.js 环境的产物，通常用于 ssr 等场景。\n\n当 target 设置为 'node' 时，builder 会进行以下处理：\n\n * 不会生成 html 文件，与 html 相关的逻辑也不会执行，因为 node.js 环境不需要 html。\n * 不会打包或抽取 css 代码，但产物中会包含 css modules 的 id 信息。\n * 不会开启默认的拆包策略，但 dynamic import 依然可以生效。\n * 不会开启热更新相关的能力。\n * 将 browserslist 的默认值调整为 ['node >= 14']。\n\ntip\n\n如果触发了并行构建，比如同时构建 web 产物和 node 产物，那么上述处理不会影响 web 产物，web 产物所需的 html、css 等文件依然会正确生成。\n\n\n# web worker 产物\n\n指运行在 web worker 环境的产物。\n\nweb worker\n\nweb workers 是一种 javascript api，它允许网页在后台线程中执行脚本，与主线程（网页）分离。这意味着，您可以使用 web workers 来执行计算密集型或长时间运行的任务，而无需阻塞主线程，进而影响网页的性能。\n\n当 target 设置为 'web-worker' 时，builder 会进行以下处理：\n\n * 不会生成 html 文件，与 html 相关的逻辑也不会执行，因为 web worker 环境不需要 html。\n * 不会打包或抽取 css 代码，但产物中会包含 css modules 的 id 信息。\n * 不会开启默认的拆包策略，并且 dynamic import 也不会生效，因为 web worker 仅运行支持单个 javascript 文件。\n * 不会开启热更新相关的能力。\n\n\n# modern web 产物\n\n指运行在现代浏览器环境的产物。\n\n什么是现代浏览器?\n\n现代浏览器是我们的一个约定用语，指支持 原生 es modules 的浏览器。\n\n当 target 设置为 'modern-web' 时，builder 会进行以下处理：\n\n * 将 browserslist 的默认值调整为：\n\nconst browserslist = [\n  'chrome > 61',\n  'edge > 16',\n  'firefox > 60',\n  'safari > 11',\n  'ios_saf > 11',\n];\n",charsets:{cjk:!0}},{title:"Builder 配置项",frontmatter:{},regularPath:"/zh/guide/basic/builder-config.html",relativePath:"zh/guide/basic/builder-config.md",key:"v-4eefa60c",path:"/zh/guide/basic/builder-config.html",headers:[{level:2,title:"配置分类",slug:"配置分类",normalizedTitle:"配置分类",charIndex:54},{level:2,title:"配置默认值",slug:"配置默认值",normalizedTitle:"配置默认值",charIndex:331},{level:2,title:"使用配置",slug:"使用配置",normalizedTitle:"使用配置",charIndex:454},{level:2,title:"与框架配置的关系",slug:"与框架配置的关系",normalizedTitle:"与框架配置的关系",charIndex:1190},{level:2,title:"调试配置",slug:"调试配置",normalizedTitle:"调试配置",charIndex:1308}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"配置分类 配置默认值 使用配置 与框架配置的关系 调试配置",content:"# Builder 配置项\n\nBuilder 提供了丰富的配置项，以帮助使用者对构建行为进行定制。\n\n\n# 配置分类\n\nBuilder 中的配置可以分为以下几类：\n\n * Dev Config：与本地开发有关的配置。\n * Html Config：与 HTML 有关的配置。\n * Tools Config：与底层工具有关的配置。\n * Source Config：与源代码有关的配置。\n * Output Config：与构建产物有关的配置。\n * Security Config：与安全有关的配置。\n * Performance Config：与编译性能、产物性能有关的配置。\n\n你可以在 API Reference 页面找到所有配置项的详细说明。\n\n\n# 配置默认值\n\nBuilder 为每个配置项预设了一个默认值，默认值可以满足大部分使用场景。同时，上层框架也会基于垂直场景的需求，覆盖一部分配置的默认值。\n\n因此，在大多数情况下，你不需要声明任何 Builder 配置，直接开箱使用即可。\n\n\n# 使用配置\n\n\n# 在上层框架中使用\n\n当你使用一个基于 Builder 的上层框架时，你可以直接通过框架的配置文件来定义 Builder 配置，上层框架会自动将相关配置透传给 Builder。\n\n比如在 Modern.js 2.0 框架中，你可以直接在 modern.config.ts 文件里定义 Builder 的 source.alias 配置：\n\n// modern.config.ts\nexport default {\n  source: {\n    alias: {\n      '@common': './src/common',\n    },\n  },\n};\n\n\n常用的框架配置文件包括：\n\n框架              配置文件\nModern.js 2.0   modern.config.ts\nEdenX           edenx.config.ts\nPIA             pia.config.ts\n\n\n# 通过 Node API 使用\n\n当你通过 Node API 调用 Builder 时，你可以通过 Provider 的 builderConfig 配置项来传入 Builder 配置：\n\nimport { builderWebpackProvider } from '@modern-js/builder-webpack-provider';\n\nconst provider = builderWebpackProvider({\n  builderConfig: {\n    // some configs\n  },\n});\n\n\n关于 Node API 的完整用法，请参考 API - createBuilder。\n\n\n# 与框架配置的关系\n\n通常来说，Builder 配置是框架配置的子集。\n\nBuilder 配置只处理构建相关行为，而框架配置涵盖的范围更大，还包括运行时、服务端、部署等方面，因此框架是在 Builder 配置的基础上扩展出来的。\n\n\n# 调试配置\n\n在执行构建时，你可以添加 DEBUG=builder 环境变量，来开启 Builder 的调试模式。\n\nDEBUG=builder pnpm dev\n\n\n在调试模式下，Builder 会将内部最终生成的 Builder 配置写入到产物目录下，便于开发者查看和调试。\n\nInspect config succeed, open following files to view the content:\n\n  - Builder Config: /Project/demo/dist/builder.config.js\n  - Webpack Config (web): /Project/demo/dist/webpack.config.web.js\n\n\n打开生成的 /dist/builder.config.js 文件，即可查看 Builder 配置的完整内容。",normalizedContent:"# builder 配置项\n\nbuilder 提供了丰富的配置项，以帮助使用者对构建行为进行定制。\n\n\n# 配置分类\n\nbuilder 中的配置可以分为以下几类：\n\n * dev config：与本地开发有关的配置。\n * html config：与 html 有关的配置。\n * tools config：与底层工具有关的配置。\n * source config：与源代码有关的配置。\n * output config：与构建产物有关的配置。\n * security config：与安全有关的配置。\n * performance config：与编译性能、产物性能有关的配置。\n\n你可以在 api reference 页面找到所有配置项的详细说明。\n\n\n# 配置默认值\n\nbuilder 为每个配置项预设了一个默认值，默认值可以满足大部分使用场景。同时，上层框架也会基于垂直场景的需求，覆盖一部分配置的默认值。\n\n因此，在大多数情况下，你不需要声明任何 builder 配置，直接开箱使用即可。\n\n\n# 使用配置\n\n\n# 在上层框架中使用\n\n当你使用一个基于 builder 的上层框架时，你可以直接通过框架的配置文件来定义 builder 配置，上层框架会自动将相关配置透传给 builder。\n\n比如在 modern.js 2.0 框架中，你可以直接在 modern.config.ts 文件里定义 builder 的 source.alias 配置：\n\n// modern.config.ts\nexport default {\n  source: {\n    alias: {\n      '@common': './src/common',\n    },\n  },\n};\n\n\n常用的框架配置文件包括：\n\n框架              配置文件\nmodern.js 2.0   modern.config.ts\nedenx           edenx.config.ts\npia             pia.config.ts\n\n\n# 通过 node api 使用\n\n当你通过 node api 调用 builder 时，你可以通过 provider 的 builderconfig 配置项来传入 builder 配置：\n\nimport { builderwebpackprovider } from '@modern-js/builder-webpack-provider';\n\nconst provider = builderwebpackprovider({\n  builderconfig: {\n    // some configs\n  },\n});\n\n\n关于 node api 的完整用法，请参考 api - createbuilder。\n\n\n# 与框架配置的关系\n\n通常来说，builder 配置是框架配置的子集。\n\nbuilder 配置只处理构建相关行为，而框架配置涵盖的范围更大，还包括运行时、服务端、部署等方面，因此框架是在 builder 配置的基础上扩展出来的。\n\n\n# 调试配置\n\n在执行构建时，你可以添加 debug=builder 环境变量，来开启 builder 的调试模式。\n\ndebug=builder pnpm dev\n\n\n在调试模式下，builder 会将内部最终生成的 builder 配置写入到产物目录下，便于开发者查看和调试。\n\ninspect config succeed, open following files to view the content:\n\n  - builder config: /project/demo/dist/builder.config.js\n  - webpack config (web): /project/demo/dist/webpack.config.web.js\n\n\n打开生成的 /dist/builder.config.js 文件，即可查看 builder 配置的完整内容。",charsets:{cjk:!0}},{title:"使用 CSS Modules",frontmatter:{},regularPath:"/zh/guide/basic/css-modules.html",relativePath:"zh/guide/basic/css-modules.md",key:"v-2601e070",path:"/zh/guide/basic/css-modules.html",headers:[{level:2,title:"示例",slug:"示例",normalizedTitle:"示例",charIndex:291},{level:2,title:"为所有样式文件启用 CSS Modules",slug:"为所有样式文件启用-css-modules",normalizedTitle:"为所有样式文件启用 css modules",charIndex:576},{level:2,title:"自定义类名",slug:"自定义类名",normalizedTitle:"自定义类名",charIndex:1018},{level:2,title:"添加类型声明",slug:"添加类型声明",normalizedTitle:"添加类型声明",charIndex:1248},{level:2,title:"生成准确的类型定义",slug:"生成准确的类型定义",normalizedTitle:"生成准确的类型定义",charIndex:2541}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"示例 为所有样式文件启用 CSS Modules 自定义类名 添加类型声明 生成准确的类型定义",content:"# 使用 CSS Modules\n\nCSS Modules 让我们能以模块化的方式编写 CSS 代码，并且可以在 JavaScript 文件中导入和使用这些样式。使用 CSS Modules 可以自动生成唯一的类名，隔离不同模块之间的样式，避免类名冲突。\n\nBuilder 默认支持使用 CSS Modules，无需添加额外的配置。我们约定使用 [name].module.css 文件名来启用 CSS Modules。\n\n以下样式文件会被视为 CSS Modules：\n\n * *.module.scss\n * *.module.less\n * *.module.css\n\n\n# 示例\n\n * 编写样式：\n\n/* button.module.css */\n.error {\n  background: red;\n}\n\n\n * 使用样式：\n\n// Button.tsx\nimport React, { Component } from 'react';\n// 引入样式文件\nimport styles from './button.module.css';\n\nexport default () => {\n  return <button className={styles.error}>Error Button</button>;\n};\n\n\n\n# 为所有样式文件启用 CSS Modules\n\n在默认情况下，只有 *.module.css 结尾的文件才被视为 CSS Modules 模块。\n\n如果你想将源码目录下的所有 CSS 文件当做 CSS Modules 模块进行处理，可以通过开启 output.disableCssModuleExtension 来实现，比如：\n\nexport default {\n  output: {\n    disableCssModuleExtension: true,\n  },\n};\n\n\n设置后，以下两个文件都会被视为 CSS Modules：\n\nimport styles1 from './foo.module.css';\nimport styles2 from './bar.css';\n\n\nTIP\n\n我们不推荐开启此配置项，因为开启 disableCssModuleExtension 后，CSS Modules 文件和普通 CSS 文件无法得到明确的区分，不利于长期维护。\n\n\n# 自定义类名\n\n自定义 CSS Modules 生成的类名也是我们比较常用的功能，你可以使用 output.cssModuleLocalIdentName 来进行配置。\n\nexport default {\n  output: {\n    cssModuleLocalIdentName: '[hash:base64:4]',\n  },\n};\n\n\n如果你需要自定义 CSS Modules 的其他配置，可以通过 tools.cssLoader 进行设置。\n\n\n# 添加类型声明\n\n当你在 TypeScript 代码中引用 CSS Modules 时，TypeScript 可能会提示该模块缺少类型定义：\n\nTS2307: Cannot find module './index.module.css' or its corresponding type declarations.\n\n\n此时你需要为 CSS Modules 添加类型声明文件，请在项目中创建 src/global.d.ts 文件，并添加相应的类型声明：\n\n// src/global.d.ts\ndeclare module '*.module.css' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.module.scss' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.module.sass' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.module.less' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\n\n如果你开启了 disableCssModuleExtension 配置值，还需要添加以下类型：\n\n// src/global.d.ts\ndeclare module '*.css' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.scss' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.sass' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.less' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\n\n添加类型声明后，如果依然存在上述错误提示，请尝试重启当前 IDE，或者调整 global.d.ts 所在的目录，使 TypeScript 能够正确识别类型定义。\n\n\n# 生成准确的类型定义\n\n上述方法虽然可以解决 CSS Modules 在 TypeScript 中的类型问题，但是无法准确地提示出某个 CSS 文件导出了哪些类名。\n\nBuilder 支持为 CSS Modules 生成准确的类型声明，你只需要开启 output.enableCssModuleTSDeclaration 配置项，再执行构建命令，Builder 就会为项目中所有的 CSS Modules 文件生成相应的类型声明文件。\n\nexport default {\n  output: {\n    enableCssModuleTSDeclaration: true,\n  },\n};\n\n\n\n# 示例\n\n例如某个文件夹下面有 src/index.ts 和 src/index.module.scss 两个文件：\n\n// src/index.ts\nimport styles from './index.module.scss';\n\nexport default () => {\n  <div>\n    <div className={styles.pageHeader}>Page Header</div>\n  </div>;\n};\n\n\n// index.module.scss\n.page-header {\n  color: black;\n}\n\n\n执行构建命令后，会自动生成 src/index.module.scss.d.ts 类型声明文件：\n\n// src/index.module.scss.d.ts\n// This file is automatically generated.\n// Please do not change this file!\ninterface CssExports {\n  'page-header': string;\n  pageHeader: string;\n}\nexport const cssExports: CssExports;\nexport default cssExports;\n\n\n此时再打开 src/index.ts 文件，可以看到 styles 对象已经具备了准确的类型。\n\n\n# 相关配置\n\n在上述例子中，src/index.module.scss.d.ts 是编译生成的代码，你可以选择将它们提交到 Git 仓库里，也可以选择在 .gitignore 文件中忽略它们：\n\n# Ignore auto generated CSS declarations\n*.module.css.d.ts\n*.module.sass.d.ts\n*.module.scss.d.ts\n*.module.less.d.ts\n\n\n此外，如果生成的代码导致了 ESLint 报错，你也可以将上述配置添加到 .eslintignore 文件里。",normalizedContent:"# 使用 css modules\n\ncss modules 让我们能以模块化的方式编写 css 代码，并且可以在 javascript 文件中导入和使用这些样式。使用 css modules 可以自动生成唯一的类名，隔离不同模块之间的样式，避免类名冲突。\n\nbuilder 默认支持使用 css modules，无需添加额外的配置。我们约定使用 [name].module.css 文件名来启用 css modules。\n\n以下样式文件会被视为 css modules：\n\n * *.module.scss\n * *.module.less\n * *.module.css\n\n\n# 示例\n\n * 编写样式：\n\n/* button.module.css */\n.error {\n  background: red;\n}\n\n\n * 使用样式：\n\n// button.tsx\nimport react, { component } from 'react';\n// 引入样式文件\nimport styles from './button.module.css';\n\nexport default () => {\n  return <button classname={styles.error}>error button</button>;\n};\n\n\n\n# 为所有样式文件启用 css modules\n\n在默认情况下，只有 *.module.css 结尾的文件才被视为 css modules 模块。\n\n如果你想将源码目录下的所有 css 文件当做 css modules 模块进行处理，可以通过开启 output.disablecssmoduleextension 来实现，比如：\n\nexport default {\n  output: {\n    disablecssmoduleextension: true,\n  },\n};\n\n\n设置后，以下两个文件都会被视为 css modules：\n\nimport styles1 from './foo.module.css';\nimport styles2 from './bar.css';\n\n\ntip\n\n我们不推荐开启此配置项，因为开启 disablecssmoduleextension 后，css modules 文件和普通 css 文件无法得到明确的区分，不利于长期维护。\n\n\n# 自定义类名\n\n自定义 css modules 生成的类名也是我们比较常用的功能，你可以使用 output.cssmodulelocalidentname 来进行配置。\n\nexport default {\n  output: {\n    cssmodulelocalidentname: '[hash:base64:4]',\n  },\n};\n\n\n如果你需要自定义 css modules 的其他配置，可以通过 tools.cssloader 进行设置。\n\n\n# 添加类型声明\n\n当你在 typescript 代码中引用 css modules 时，typescript 可能会提示该模块缺少类型定义：\n\nts2307: cannot find module './index.module.css' or its corresponding type declarations.\n\n\n此时你需要为 css modules 添加类型声明文件，请在项目中创建 src/global.d.ts 文件，并添加相应的类型声明：\n\n// src/global.d.ts\ndeclare module '*.module.css' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.module.scss' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.module.sass' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.module.less' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\n\n如果你开启了 disablecssmoduleextension 配置值，还需要添加以下类型：\n\n// src/global.d.ts\ndeclare module '*.css' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.scss' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.sass' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.less' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\n\n添加类型声明后，如果依然存在上述错误提示，请尝试重启当前 ide，或者调整 global.d.ts 所在的目录，使 typescript 能够正确识别类型定义。\n\n\n# 生成准确的类型定义\n\n上述方法虽然可以解决 css modules 在 typescript 中的类型问题，但是无法准确地提示出某个 css 文件导出了哪些类名。\n\nbuilder 支持为 css modules 生成准确的类型声明，你只需要开启 output.enablecssmoduletsdeclaration 配置项，再执行构建命令，builder 就会为项目中所有的 css modules 文件生成相应的类型声明文件。\n\nexport default {\n  output: {\n    enablecssmoduletsdeclaration: true,\n  },\n};\n\n\n\n# 示例\n\n例如某个文件夹下面有 src/index.ts 和 src/index.module.scss 两个文件：\n\n// src/index.ts\nimport styles from './index.module.scss';\n\nexport default () => {\n  <div>\n    <div classname={styles.pageheader}>page header</div>\n  </div>;\n};\n\n\n// index.module.scss\n.page-header {\n  color: black;\n}\n\n\n执行构建命令后，会自动生成 src/index.module.scss.d.ts 类型声明文件：\n\n// src/index.module.scss.d.ts\n// this file is automatically generated.\n// please do not change this file!\ninterface cssexports {\n  'page-header': string;\n  pageheader: string;\n}\nexport const cssexports: cssexports;\nexport default cssexports;\n\n\n此时再打开 src/index.ts 文件，可以看到 styles 对象已经具备了准确的类型。\n\n\n# 相关配置\n\n在上述例子中，src/index.module.scss.d.ts 是编译生成的代码，你可以选择将它们提交到 git 仓库里，也可以选择在 .gitignore 文件中忽略它们：\n\n# ignore auto generated css declarations\n*.module.css.d.ts\n*.module.sass.d.ts\n*.module.scss.d.ts\n*.module.less.d.ts\n\n\n此外，如果生成的代码导致了 eslint 报错，你也可以将上述配置添加到 .eslintignore 文件里。",charsets:{cjk:!0}},{title:"引用样式资源",frontmatter:{},regularPath:"/zh/guide/basic/css-usage.html",relativePath:"zh/guide/basic/css-usage.md",key:"v-716e2e94",path:"/zh/guide/basic/css-usage.html",headers:[{level:2,title:"使用 Less 和 Sass",slug:"使用-less-和-sass",normalizedTitle:"使用 less 和 sass",charIndex:132},{level:2,title:"使用 PostCSS",slug:"使用-postcss",normalizedTitle:"使用 postcss",charIndex:240},{level:2,title:"使用 CSS Modules",slug:"使用-css-modules",normalizedTitle:"使用 css modules",charIndex:649},{level:2,title:"CSS 压缩",slug:"css-压缩",normalizedTitle:"css 压缩",charIndex:82},{level:2,title:"内联 CSS 文件",slug:"内联-css-文件",normalizedTitle:"内联 css 文件",charIndex:1023},{level:2,title:"引用 node_modules 里的样式",slug:"引用-node-modules-里的样式",normalizedTitle:"引用 node_modules 里的样式",charIndex:1328}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"使用 Less 和 Sass 使用 PostCSS 使用 CSS Modules CSS 压缩 内联 CSS 文件 引用 node_modules 里的样式",content:"# 引用样式资源\n\nBuilder 内置多种常用的样式资源处理方式，包括 Less / Sass 预处理器、PostCSS、CSS Modules、CSS 内联和 CSS 压缩。\n\n除此之外，Builder 也提供了多个配置项来自定义样式资源的处理规则。\n\n\n# 使用 Less 和 Sass\n\nBuilder 内置了社区流行的 CSS 预处理器，包括 Less 和 Sass。\n\n你可以通过配置 tools.less、tools.sass 来自定义相关 loader。\n\n\n# 使用 PostCSS\n\nBuilder 内置了 PostCSS 来转换 CSS 代码。你可以通过 tools.postcss 来配置 postcss-loader。\n\nexport default {\n  tools: {\n    postcss: opts => {\n      const viewportPlugin = require('postcss-px-to-viewport')({\n        viewportWidth: 375,\n      });\n      opts.postcssOptions.plugins.push(viewportPlugin);\n    },\n  },\n};\n\n\n在默认情况下，我们开启了 autoprefixer 来自动补齐 CSS 的浏览器前缀。如果你需要配置目标浏览器，可使用 output.overrideBrowserslist 进行配置。\n\n\n# 使用 CSS Modules\n\n请阅读 使用 CSS Modules 章节来了解 CSS Modules 的完整用法。\n\n\n# CSS 压缩\n\n通常情况下，在生产环境我们会将 CSS、JS 等静态资源进行压缩，以达到更好的传输效率。\n\nBuilder 通过 css-minimizer-webpack-plugin 在生产环境构建时自动压缩 CSS 代码（底层使用的压缩工具为 cssnano）。\n\n你可以通过 tools.minifyCss 配置项来修改 css-minimizer-webpack-plugin的配置。\n\n关于 cssnano\n\ncssnano 是一个用于优化和压缩 CSS 文件的工具。它通过删除未使用的规则、合并相同的规则、移除注释和空白符以及转换长度单位等方式来减小 CSS 文件的体积，从而提升网站的加载速度。\n\n\n# 内联 CSS 文件\n\n默认情况下，Builder 会把 CSS 提取为独立的 .css 文件，并输出到构建产物目录。\n\n如果你希望将样式内联到 JS 文件中，可以将 output.disableCssExtract 设置为 true 来禁用 CSS 提取逻辑。当浏览器请求到 JS 文件后，JS 将动态地向 HTML 插入 <style> 标签，以此加载 CSS 样式。\n\nexport default {\n  output: {\n    disableCssExtract: true,\n  },\n};\n\n\n这将会增大你的 JS Bundle 体积，因此通常情况下，不太建议禁用 CSS 提取逻辑。\n\n\n# 引用 node_modules 里的样式\n\n你可以直接引用 node_modules 里的样式文件。\n\n * 在组件中引用：\n\n// src/App.tsx\n// 引用 Arco Design 样式：\nimport '@arco-design/web-react/dist/css/arco.css';\n\n\n * 在样式文件中引用：\n\n/* src/App.css */\n/* 引用 normalize.css */\n/* https://github.com/necolas/normalize.css */\n@import 'normalize.css';\n\nbody {\n  /* */\n}\n",normalizedContent:"# 引用样式资源\n\nbuilder 内置多种常用的样式资源处理方式，包括 less / sass 预处理器、postcss、css modules、css 内联和 css 压缩。\n\n除此之外，builder 也提供了多个配置项来自定义样式资源的处理规则。\n\n\n# 使用 less 和 sass\n\nbuilder 内置了社区流行的 css 预处理器，包括 less 和 sass。\n\n你可以通过配置 tools.less、tools.sass 来自定义相关 loader。\n\n\n# 使用 postcss\n\nbuilder 内置了 postcss 来转换 css 代码。你可以通过 tools.postcss 来配置 postcss-loader。\n\nexport default {\n  tools: {\n    postcss: opts => {\n      const viewportplugin = require('postcss-px-to-viewport')({\n        viewportwidth: 375,\n      });\n      opts.postcssoptions.plugins.push(viewportplugin);\n    },\n  },\n};\n\n\n在默认情况下，我们开启了 autoprefixer 来自动补齐 css 的浏览器前缀。如果你需要配置目标浏览器，可使用 output.overridebrowserslist 进行配置。\n\n\n# 使用 css modules\n\n请阅读 使用 css modules 章节来了解 css modules 的完整用法。\n\n\n# css 压缩\n\n通常情况下，在生产环境我们会将 css、js 等静态资源进行压缩，以达到更好的传输效率。\n\nbuilder 通过 css-minimizer-webpack-plugin 在生产环境构建时自动压缩 css 代码（底层使用的压缩工具为 cssnano）。\n\n你可以通过 tools.minifycss 配置项来修改 css-minimizer-webpack-plugin的配置。\n\n关于 cssnano\n\ncssnano 是一个用于优化和压缩 css 文件的工具。它通过删除未使用的规则、合并相同的规则、移除注释和空白符以及转换长度单位等方式来减小 css 文件的体积，从而提升网站的加载速度。\n\n\n# 内联 css 文件\n\n默认情况下，builder 会把 css 提取为独立的 .css 文件，并输出到构建产物目录。\n\n如果你希望将样式内联到 js 文件中，可以将 output.disablecssextract 设置为 true 来禁用 css 提取逻辑。当浏览器请求到 js 文件后，js 将动态地向 html 插入 <style> 标签，以此加载 css 样式。\n\nexport default {\n  output: {\n    disablecssextract: true,\n  },\n};\n\n\n这将会增大你的 js bundle 体积，因此通常情况下，不太建议禁用 css 提取逻辑。\n\n\n# 引用 node_modules 里的样式\n\n你可以直接引用 node_modules 里的样式文件。\n\n * 在组件中引用：\n\n// src/app.tsx\n// 引用 arco design 样式：\nimport '@arco-design/web-react/dist/css/arco.css';\n\n\n * 在样式文件中引用：\n\n/* src/app.css */\n/* 引用 normalize.css */\n/* https://github.com/necolas/normalize.css */\n@import 'normalize.css';\n\nbody {\n  /* */\n}\n",charsets:{cjk:!0}},{title:"配置 HTML 模板",frontmatter:{},regularPath:"/zh/guide/basic/html-template.html",relativePath:"zh/guide/basic/html-template.md",key:"v-4210ca6c",path:"/zh/guide/basic/html-template.html",headers:[{level:2,title:"设置模板文件",slug:"设置模板文件",normalizedTitle:"设置模板文件",charIndex:127},{level:2,title:"设置页面标题",slug:"设置页面标题",normalizedTitle:"设置页面标题",charIndex:414},{level:2,title:"设置页面图标",slug:"设置页面图标",normalizedTitle:"设置页面图标",charIndex:781},{level:2,title:"设置 meta 标签",slug:"设置-meta-标签",normalizedTitle:"设置 meta 标签",charIndex:1117},{level:2,title:"设置模板参数",slug:"设置模板参数",normalizedTitle:"设置模板参数",charIndex:1409},{level:2,title:"模板引擎",slug:"模板引擎",normalizedTitle:"模板引擎",charIndex:2274}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"设置模板文件 设置页面标题 设置页面图标 设置 meta 标签 设置模板参数 模板引擎",content:"# 配置 HTML 模板\n\n在构建的过程中，Builder 会基于 HTML 模板文件和模板参数进行编译，生成若干份 HTML 文件。\n\nBuilder 提供了一些配置项来对 HTML 模板进行设置。通过本章节你可以了解到这些配置项的基本用法。\n\n\n# 设置模板文件\n\n通常来说，HTML 模板文件是由上层框架预先定义的。\n\n比如在 Modern.js 2.0 框架中，默认会预设一份 HTML 模板，同时也支持用户自定义模板的内容。你可以阅读 「Modern.js - HTML 模板」 章节来了解相关内容。\n\n在 Builder 中，你可以使用 html.template 和 html.templateByEntries 配置项来设置自定义的 HTML 模板文件。\n\nexport default {\n  html: {\n    template: './static/index.html',\n  },\n};\n\n\n\n# 设置页面标题\n\n你可以通过 html.title 和 html.titleByEntries 配置项来设置 HTML 的 <title> 标签。\n\n当你的项目中只有一个页面时，直接使用 html.title 设置即可：\n\nexport default {\n  html: {\n    title: 'example',\n  },\n};\n\n\n当你的项目中有多个页面时，请使用 html.titleByEntries 来为不同的页面设置对应的标题，html.titleByEntries 使用页面的「入口名称」作为 key。\n\nexport default {\n  html: {\n    titleByEntries: {\n      foo: 'Foo',\n      bar: 'Bar',\n    },\n  },\n};\n\n\n\n# 设置页面图标\n\nBuilder 支持设置 favicon 图标 和 iOS 系统下的 apple-touch-icon 图标。\n\n你可以通过 html.favicon 和 html.faviconByEntries 配置项来设置 favicon 图标。\n\nexport default {\n  html: {\n    favicon: './src/assets/icon.png',\n  },\n};\n\n\n也可以通过 html.appIcon 配置项来设置 iOS 下的 apple-touch-icon 图标。\n\nexport default {\n  html: {\n    appIcon: './src/assets/icon.png',\n  },\n};\n\n\n\n# 设置 meta 标签\n\n你可以通过 html.meta 和 html.metaByEntries 配置项来设置 HTML 的 <meta> 标签。\n\n比如设置 description：\n\nexport default {\n  html: {\n    meta: {\n      description: 'a description of the page',\n    },\n  },\n};\n\n\n最终在 HTML 中生成的 meta 标签为：\n\n<meta name=\"description\" content=\"a description of the page\" />\n\n\n\n# 设置模板参数\n\n在 HTML 模板中，你可以使用丰富的模板参数，Builder 默认注入的模板参数包括：\n\ntype DefaultParameters = {\n  meta: string; // 对应 html.meta 配置\n  title: string; // 对应 html.title 配置\n  mountId: string; // 对应 html.mountId 配置\n  entryName: string; // 入口名称\n  assetPrefix: string; // 对应 output.assetPrefix 配置\n  compilation: webpack.Compilation; // 对应 webpack 的 compilation 对象\n  webpackConfig: Configuration; // webpack 配置\n  // htmlWebpackPlugin 内置的参数\n  // 详见 https://github.com/jantimon/html-webpack-plugin\n  htmlWebpackPlugin: {\n    tags: object;\n    files: object;\n    options: object;\n  };\n};\n\n\n你也可以通过 html.templateParameters 和 html.templateParametersByEntries 配置项来传入自定义的模板参数。\n\n比如：\n\nexport default {\n  html: {\n    templateParameters: {\n      text: 'World',\n    },\n  },\n};\n\n\n接下来，你可以在 HTML 模板中，通过 <%= text %> 来读取参数：\n\n<div>hello <%= text %>!</div>\n\n\n经过编译后的最终 HTML 代码如下：\n\n<div>hello world!</div>\n\n\n\n# 模板引擎\n\nBuilder 支持 Lodash Template、EJS、Pug 等多个模板引擎，默认使用最基础的 Lodash Template 作为模板引擎。\n\n\n# Lodash Template\n\n当模板文件的后缀为 .html 时，Builder 会使用 Lodash Template 对模板进行编译。\n\n例如，在模板中定义一个 text 参数，值为 'world'，在构建时会自动将 <%= text %> 替换为对应的值。\n\n\x3c!-- 输入  --\x3e\n<div>hello <%= text %>!</div>\n\n\x3c!-- 输出 --\x3e\n<div>hello world!</div>\n\n\n请阅读 Lodash Template 文档来了解完整用法。\n\n\n# EJS\n\n当模板文件的后缀为 .ejs 时，Builder 会使用 EJS 模板引擎对模板进行编译。EJS 是一套简单的模板语言，支持直接在标签内书写简单、直白的 JavaScript 代码，并通过 JavaScript 输出最终所需的 HTML。\n\n例如，你可以先通过 html.template 配置项来引用一个 .ejs 模板文件：\n\nexport default {\n  html: {\n    template: './static/index.ejs',\n  },\n};\n\n\n接着在模板中定义一个 user 参数，值为 { name: 'Jack' }。在构建时，会自动将 <%= user.name %> 替换为对应的值。\n\n\x3c!-- 输入  --\x3e\n<% if (user) { %>\n<h2><%= user.name %></h2>\n<% } %>\n\n\x3c!-- 输出 --\x3e\n<h2>Jack</h2>\n\n\n请阅读 EJS 文档来了解完整用法。\n\n\n# Pug\n\n当模板文件的后缀为 .pug 时，Builder 会使用 Pug 模板引擎对模板进行编译。Pug 是一款健壮、灵活、功能丰富的模板引擎，专门为 Node.js 平台开发。\n\n使用 Pug 模板前，需要开启 tools.pug 配置项，并通过 html.template 配置项来引用一个 .pug 模板文件：\n\nexport default {\n  html: {\n    template: './static/index.pug',\n  },\n  tools: {\n    pug: true,\n  },\n};\n\n\n开启后，你可以在 .pug 模板中使用 Pug 语法：\n\n\x3c!-- 输入  --\x3e\np Hello #{text}!\n\n\x3c!-- 输出 --\x3e\n<p>Hello World!</p>\n\n\n请阅读 Pug 文档来了解完整用法。",normalizedContent:"# 配置 html 模板\n\n在构建的过程中，builder 会基于 html 模板文件和模板参数进行编译，生成若干份 html 文件。\n\nbuilder 提供了一些配置项来对 html 模板进行设置。通过本章节你可以了解到这些配置项的基本用法。\n\n\n# 设置模板文件\n\n通常来说，html 模板文件是由上层框架预先定义的。\n\n比如在 modern.js 2.0 框架中，默认会预设一份 html 模板，同时也支持用户自定义模板的内容。你可以阅读 「modern.js - html 模板」 章节来了解相关内容。\n\n在 builder 中，你可以使用 html.template 和 html.templatebyentries 配置项来设置自定义的 html 模板文件。\n\nexport default {\n  html: {\n    template: './static/index.html',\n  },\n};\n\n\n\n# 设置页面标题\n\n你可以通过 html.title 和 html.titlebyentries 配置项来设置 html 的 <title> 标签。\n\n当你的项目中只有一个页面时，直接使用 html.title 设置即可：\n\nexport default {\n  html: {\n    title: 'example',\n  },\n};\n\n\n当你的项目中有多个页面时，请使用 html.titlebyentries 来为不同的页面设置对应的标题，html.titlebyentries 使用页面的「入口名称」作为 key。\n\nexport default {\n  html: {\n    titlebyentries: {\n      foo: 'foo',\n      bar: 'bar',\n    },\n  },\n};\n\n\n\n# 设置页面图标\n\nbuilder 支持设置 favicon 图标 和 ios 系统下的 apple-touch-icon 图标。\n\n你可以通过 html.favicon 和 html.faviconbyentries 配置项来设置 favicon 图标。\n\nexport default {\n  html: {\n    favicon: './src/assets/icon.png',\n  },\n};\n\n\n也可以通过 html.appicon 配置项来设置 ios 下的 apple-touch-icon 图标。\n\nexport default {\n  html: {\n    appicon: './src/assets/icon.png',\n  },\n};\n\n\n\n# 设置 meta 标签\n\n你可以通过 html.meta 和 html.metabyentries 配置项来设置 html 的 <meta> 标签。\n\n比如设置 description：\n\nexport default {\n  html: {\n    meta: {\n      description: 'a description of the page',\n    },\n  },\n};\n\n\n最终在 html 中生成的 meta 标签为：\n\n<meta name=\"description\" content=\"a description of the page\" />\n\n\n\n# 设置模板参数\n\n在 html 模板中，你可以使用丰富的模板参数，builder 默认注入的模板参数包括：\n\ntype defaultparameters = {\n  meta: string; // 对应 html.meta 配置\n  title: string; // 对应 html.title 配置\n  mountid: string; // 对应 html.mountid 配置\n  entryname: string; // 入口名称\n  assetprefix: string; // 对应 output.assetprefix 配置\n  compilation: webpack.compilation; // 对应 webpack 的 compilation 对象\n  webpackconfig: configuration; // webpack 配置\n  // htmlwebpackplugin 内置的参数\n  // 详见 https://github.com/jantimon/html-webpack-plugin\n  htmlwebpackplugin: {\n    tags: object;\n    files: object;\n    options: object;\n  };\n};\n\n\n你也可以通过 html.templateparameters 和 html.templateparametersbyentries 配置项来传入自定义的模板参数。\n\n比如：\n\nexport default {\n  html: {\n    templateparameters: {\n      text: 'world',\n    },\n  },\n};\n\n\n接下来，你可以在 html 模板中，通过 <%= text %> 来读取参数：\n\n<div>hello <%= text %>!</div>\n\n\n经过编译后的最终 html 代码如下：\n\n<div>hello world!</div>\n\n\n\n# 模板引擎\n\nbuilder 支持 lodash template、ejs、pug 等多个模板引擎，默认使用最基础的 lodash template 作为模板引擎。\n\n\n# lodash template\n\n当模板文件的后缀为 .html 时，builder 会使用 lodash template 对模板进行编译。\n\n例如，在模板中定义一个 text 参数，值为 'world'，在构建时会自动将 <%= text %> 替换为对应的值。\n\n\x3c!-- 输入  --\x3e\n<div>hello <%= text %>!</div>\n\n\x3c!-- 输出 --\x3e\n<div>hello world!</div>\n\n\n请阅读 lodash template 文档来了解完整用法。\n\n\n# ejs\n\n当模板文件的后缀为 .ejs 时，builder 会使用 ejs 模板引擎对模板进行编译。ejs 是一套简单的模板语言，支持直接在标签内书写简单、直白的 javascript 代码，并通过 javascript 输出最终所需的 html。\n\n例如，你可以先通过 html.template 配置项来引用一个 .ejs 模板文件：\n\nexport default {\n  html: {\n    template: './static/index.ejs',\n  },\n};\n\n\n接着在模板中定义一个 user 参数，值为 { name: 'jack' }。在构建时，会自动将 <%= user.name %> 替换为对应的值。\n\n\x3c!-- 输入  --\x3e\n<% if (user) { %>\n<h2><%= user.name %></h2>\n<% } %>\n\n\x3c!-- 输出 --\x3e\n<h2>jack</h2>\n\n\n请阅读 ejs 文档来了解完整用法。\n\n\n# pug\n\n当模板文件的后缀为 .pug 时，builder 会使用 pug 模板引擎对模板进行编译。pug 是一款健壮、灵活、功能丰富的模板引擎，专门为 node.js 平台开发。\n\n使用 pug 模板前，需要开启 tools.pug 配置项，并通过 html.template 配置项来引用一个 .pug 模板文件：\n\nexport default {\n  html: {\n    template: './static/index.pug',\n  },\n  tools: {\n    pug: true,\n  },\n};\n\n\n开启后，你可以在 .pug 模板中使用 pug 语法：\n\n\x3c!-- 输入  --\x3e\np hello #{text}!\n\n\x3c!-- 输出 --\x3e\n<p>hello world!</p>\n\n\n请阅读 pug 文档来了解完整用法。",charsets:{cjk:!0}},{title:"引用 JSON 文件",frontmatter:{},regularPath:"/zh/guide/basic/json-files.html",relativePath:"zh/guide/basic/json-files.md",key:"v-2796ebcc",path:"/zh/guide/basic/json-files.html",headers:[{level:2,title:"JSON 文件",slug:"json-文件",normalizedTitle:"json 文件",charIndex:5},{level:2,title:"YAML 文件",slug:"yaml-文件",normalizedTitle:"yaml 文件",charIndex:398},{level:2,title:"添加类型声明",slug:"添加类型声明",normalizedTitle:"添加类型声明",charIndex:689},{level:2,title:"TOML 文件",slug:"toml-文件",normalizedTitle:"toml 文件",charIndex:52},{level:2,title:"添加类型声明",slug:"添加类型声明-2",normalizedTitle:"添加类型声明",charIndex:689}],lastUpdated:"2022/12/22 08:29:47",lastUpdatedTimestamp:1671697787e3,headersStr:"JSON 文件 YAML 文件 添加类型声明 TOML 文件 添加类型声明",content:"# 引用 JSON 文件\n\nBuilder 支持在代码中引用 JSON 文件，也支持引用 YAML 和 TOML 文件并将其转换为 JSON 格式。\n\n\n# JSON 文件\n\n你可以直接在 JavaScript 文件中引用 JSON 文件。\n\n\n# 示例\n\n// example.json\n{\n  \"name\": \"foo\",\n  \"items\": [1, 2]\n}\n\n\nimport example from './example.json';\n\nconsole.log(example.name); // 'foo';\nconsole.log(example.items); // [1, 2];\n\n\n\n# 具名引用\n\nBuilder 暂不支持通过 named import 来引用 JSON 文件：\n\nimport { name } from './example.json';\n\n\n\n# YAML 文件\n\nYAML 是一种数据序列化语言，通常用于编写配置文件。\n\n你可以直接在 JavaScript 中引用 .yaml 或 .yml 文件，它们会被自动转换为 JSON 格式。\n\n\n# 示例\n\n# example.yaml\n---\nhello: world\nfoo:\n  bar: baz\n\n\nimport example from './example.yaml';\n\nconsole.log(example.hello); // 'world';\nconsole.log(example.foo); // { bar: 'baz' };\n\n\n\n# 类型声明\n\n\n# 添加类型声明\n\n当你在 TypeScript 代码中引用 YAML 文件时，请在项目中创建 src/global.d.ts 文件，并添加相应的类型声明：\n\n// src/global.d.ts\ndeclare module '*.yaml' {\n  const content: Record<string, any>;\n  export default content;\n}\n\ndeclare module '*.yml' {\n  const content: Record<string, any>;\n  export default content;\n}\n\n\n\n# TOML 文件\n\nTOML 是一种语义明显、易于阅读的配置文件格式。\n\n你可以直接在 JavaScript 中引用 .toml 文件，它会被自动转换为 JSON 格式。\n\n\n# 示例\n\n# example.toml\nhello = \"world\"\n\n[foo]\nbar = \"baz\"\n\n\nimport example from './example.toml';\n\nconsole.log(example.hello); // 'world';\nconsole.log(example.foo); // { bar: 'baz' };\n\n\n\n# 添加类型声明\n\n当你在 TypeScript 代码中引用 TOML 文件时，请在项目中创建 src/global.d.ts 文件，并添加相应的类型声明：\n\n// src/global.d.ts\ndeclare module '*.toml' {\n  const content: Record<string, any>;\n  export default content;\n}\n",normalizedContent:"# 引用 json 文件\n\nbuilder 支持在代码中引用 json 文件，也支持引用 yaml 和 toml 文件并将其转换为 json 格式。\n\n\n# json 文件\n\n你可以直接在 javascript 文件中引用 json 文件。\n\n\n# 示例\n\n// example.json\n{\n  \"name\": \"foo\",\n  \"items\": [1, 2]\n}\n\n\nimport example from './example.json';\n\nconsole.log(example.name); // 'foo';\nconsole.log(example.items); // [1, 2];\n\n\n\n# 具名引用\n\nbuilder 暂不支持通过 named import 来引用 json 文件：\n\nimport { name } from './example.json';\n\n\n\n# yaml 文件\n\nyaml 是一种数据序列化语言，通常用于编写配置文件。\n\n你可以直接在 javascript 中引用 .yaml 或 .yml 文件，它们会被自动转换为 json 格式。\n\n\n# 示例\n\n# example.yaml\n---\nhello: world\nfoo:\n  bar: baz\n\n\nimport example from './example.yaml';\n\nconsole.log(example.hello); // 'world';\nconsole.log(example.foo); // { bar: 'baz' };\n\n\n\n# 类型声明\n\n\n# 添加类型声明\n\n当你在 typescript 代码中引用 yaml 文件时，请在项目中创建 src/global.d.ts 文件，并添加相应的类型声明：\n\n// src/global.d.ts\ndeclare module '*.yaml' {\n  const content: record<string, any>;\n  export default content;\n}\n\ndeclare module '*.yml' {\n  const content: record<string, any>;\n  export default content;\n}\n\n\n\n# toml 文件\n\ntoml 是一种语义明显、易于阅读的配置文件格式。\n\n你可以直接在 javascript 中引用 .toml 文件，它会被自动转换为 json 格式。\n\n\n# 示例\n\n# example.toml\nhello = \"world\"\n\n[foo]\nbar = \"baz\"\n\n\nimport example from './example.toml';\n\nconsole.log(example.hello); // 'world';\nconsole.log(example.foo); // { bar: 'baz' };\n\n\n\n# 添加类型声明\n\n当你在 typescript 代码中引用 toml 文件时，请在项目中创建 src/global.d.ts 文件，并添加相应的类型声明：\n\n// src/global.d.ts\ndeclare module '*.toml' {\n  const content: record<string, any>;\n  export default content;\n}\n",charsets:{cjk:!0}},{title:"构建产物目录",frontmatter:{},regularPath:"/zh/guide/basic/output-files.html",relativePath:"zh/guide/basic/output-files.md",key:"v-6937be2c",path:"/zh/guide/basic/output-files.html",headers:[{level:2,title:"默认产物目录",slug:"默认产物目录",normalizedTitle:"默认产物目录",charIndex:50},{level:2,title:"修改产物目录",slug:"修改产物目录",normalizedTitle:"修改产物目录",charIndex:721},{level:2,title:"静态资源",slug:"静态资源",normalizedTitle:"静态资源",charIndex:979},{level:2,title:"Node.js 产物目录",slug:"node-js-产物目录",normalizedTitle:"node.js 产物目录",charIndex:1607},{level:2,title:"扁平化产物目录",slug:"扁平化产物目录",normalizedTitle:"扁平化产物目录",charIndex:2023},{level:2,title:"产物不写入磁盘",slug:"产物不写入磁盘",normalizedTitle:"产物不写入磁盘",charIndex:2358}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"默认产物目录 修改产物目录 静态资源 Node.js 产物目录 扁平化产物目录 产物不写入磁盘",content:"# 构建产物目录\n\n本章节主要介绍构建产物的目录结构，以及如何控制不同类型产物的输出目录。\n\n\n# 默认产物目录\n\n下面是最基础的产物目录结构，默认情况下，构建产物会生成在当前项目的 dist 目录下。\n\ndist\n├── static\n│   ├── css\n│   │   ├── [name].[hash].css\n│   │   └── [name].[hash].css.map\n│   │\n│   └── js\n│       ├── [name].[hash].js\n│       ├── [name].[hash].js.LICENSE.txt\n│       └── [name].[hash].js.map\n│\n└── html\n    └── [name]\n        └── index.html\n\n\n最常见的产物是 HTML 文件、JS 文件和 CSS 文件：\n\n * HTML 文件：默认输出到 html 目录。\n * JS 文件：默认输出到 static/js 目录，\n * CSS 文件：默认输出到 static/css 目录。\n\n此外，JS 文件和 CSS 文件有时候会生成一些相关产物：\n\n * License 文件：包含开源许可证信息，默认输出到 JS 文件的同级目录，并添加 .LICENSE.txt 后缀。\n * Source Map 文件：包含保存源代码映射关系，默认输出到 JS 文件和 CSS 文件的同级目录，并添加 .map 后缀。\n\n在产物的文件名称中，[name] 表示这个文件对应的入口名称，比如 index, main。[hash] 则是基于该文件的内容生成的哈希值。\n\n\n# 修改产物目录\n\nBuilder 提供了多个配置项来修改产物目录和产物名称，你可以：\n\n * 通过 output.filename 来修改产物的文件名。\n * 通过 output.distPath 来修改产物的输出路径。\n * 通过 output.legalComments 来修改 License 文件的生成方式。\n * 通过 output.disableSourceMap 来移除 Source Map 文件。\n * 通过 html.disableHtmlFolder 移除 HTML 产物对应的文件夹。\n\n\n# 静态资源\n\n当你在代码中引用图片、SVG、字体、媒体等类型的静态资源时，它们也会被输出到 dist/static 目录下，并根据静态资源类型来自动分配到对应的子目录：\n\ndist\n└── static\n    ├── image\n    │   └── foo.[hash].png\n    │\n    ├── svg\n    │   └── bar.[hash].svg\n    │\n    ├── font\n    │   └── baz.[hash].woff2\n    │\n    └── media\n        └── qux.[hash].mp4\n\n\n你可以通过 output.distPath 配置项将这些静态资源统一输入到单个目录下，比如输出到 assets 目录：\n\nexport default {\n  output: {\n    distPath: {\n      image: 'assets',\n      svg: 'assets',\n      font: 'assets',\n      media: 'assets',\n    },\n  },\n};\n\n\n上方的配置会生成以下目录结构：\n\ndist\n└── assets\n    ├── foo.[hash].png\n    ├── bar.[hash].svg\n    ├── baz.[hash].woff2\n    └── qux.[hash].mp4\n\n\n\n# Node.js 产物目录\n\n当 Builder 的 构建产物类型 中包含 'node'，或者你在上层框架中开启了 SSR 等服务端功能时，Builder 会在构建后生成一份 Node.js 产物，并输出到 bundles 目录下：\n\ndist\n├── bundles\n│   └── [name].js\n├── static\n└── html\n\n\nNode.js 产物通常只包含 JS 文件，不包含 HTML、CSS 等文件。此外，Node 产物的 JS 文件名称也不会自动生成哈希值。\n\n你可以通过 output.distPath.server 配置项来修改 Node 产物的输出路径。\n\n比如，将 Node.js 产物输出到 server 目录：\n\nexport default {\n  output: {\n    distPath: {\n      server: 'server',\n    },\n  },\n};\n\n\n\n# 扁平化产物目录\n\n有时候你不想产物目录有太多层级，可以将目录设置为空字符串，使生成的产物目录扁平化。\n\n参考下方的例子：\n\nexport default {\n  output: {\n    distPath: {\n      js: '',\n      css: '',\n      html: '',\n    },\n    disableHtmlFolder: true,\n  },\n};\n\n\n上方的配置会生成以下目录结构：\n\ndist\n├── [name].[hash].css\n├── [name].[hash].css.map\n├── [name].[hash].js\n├── [name].[hash].js.map\n└── [name].html\n\n\n\n# 产物不写入磁盘\n\n默认情况下，Builder 会将构建产物写入磁盘，以方便开发者查看产物的内容，或是配置静态资源的代理规则。\n\n在开发环境，你可以选择将构建产物保存在 Dev Server 的内存中，从而减少文件操作产生的开销。\n\n将 dev.writeToDisk 配置项设置为 false 即可：\n\nexport default {\n  dev: {\n    writeToDisk: false,\n  },\n};\n",normalizedContent:"# 构建产物目录\n\n本章节主要介绍构建产物的目录结构，以及如何控制不同类型产物的输出目录。\n\n\n# 默认产物目录\n\n下面是最基础的产物目录结构，默认情况下，构建产物会生成在当前项目的 dist 目录下。\n\ndist\n├── static\n│   ├── css\n│   │   ├── [name].[hash].css\n│   │   └── [name].[hash].css.map\n│   │\n│   └── js\n│       ├── [name].[hash].js\n│       ├── [name].[hash].js.license.txt\n│       └── [name].[hash].js.map\n│\n└── html\n    └── [name]\n        └── index.html\n\n\n最常见的产物是 html 文件、js 文件和 css 文件：\n\n * html 文件：默认输出到 html 目录。\n * js 文件：默认输出到 static/js 目录，\n * css 文件：默认输出到 static/css 目录。\n\n此外，js 文件和 css 文件有时候会生成一些相关产物：\n\n * license 文件：包含开源许可证信息，默认输出到 js 文件的同级目录，并添加 .license.txt 后缀。\n * source map 文件：包含保存源代码映射关系，默认输出到 js 文件和 css 文件的同级目录，并添加 .map 后缀。\n\n在产物的文件名称中，[name] 表示这个文件对应的入口名称，比如 index, main。[hash] 则是基于该文件的内容生成的哈希值。\n\n\n# 修改产物目录\n\nbuilder 提供了多个配置项来修改产物目录和产物名称，你可以：\n\n * 通过 output.filename 来修改产物的文件名。\n * 通过 output.distpath 来修改产物的输出路径。\n * 通过 output.legalcomments 来修改 license 文件的生成方式。\n * 通过 output.disablesourcemap 来移除 source map 文件。\n * 通过 html.disablehtmlfolder 移除 html 产物对应的文件夹。\n\n\n# 静态资源\n\n当你在代码中引用图片、svg、字体、媒体等类型的静态资源时，它们也会被输出到 dist/static 目录下，并根据静态资源类型来自动分配到对应的子目录：\n\ndist\n└── static\n    ├── image\n    │   └── foo.[hash].png\n    │\n    ├── svg\n    │   └── bar.[hash].svg\n    │\n    ├── font\n    │   └── baz.[hash].woff2\n    │\n    └── media\n        └── qux.[hash].mp4\n\n\n你可以通过 output.distpath 配置项将这些静态资源统一输入到单个目录下，比如输出到 assets 目录：\n\nexport default {\n  output: {\n    distpath: {\n      image: 'assets',\n      svg: 'assets',\n      font: 'assets',\n      media: 'assets',\n    },\n  },\n};\n\n\n上方的配置会生成以下目录结构：\n\ndist\n└── assets\n    ├── foo.[hash].png\n    ├── bar.[hash].svg\n    ├── baz.[hash].woff2\n    └── qux.[hash].mp4\n\n\n\n# node.js 产物目录\n\n当 builder 的 构建产物类型 中包含 'node'，或者你在上层框架中开启了 ssr 等服务端功能时，builder 会在构建后生成一份 node.js 产物，并输出到 bundles 目录下：\n\ndist\n├── bundles\n│   └── [name].js\n├── static\n└── html\n\n\nnode.js 产物通常只包含 js 文件，不包含 html、css 等文件。此外，node 产物的 js 文件名称也不会自动生成哈希值。\n\n你可以通过 output.distpath.server 配置项来修改 node 产物的输出路径。\n\n比如，将 node.js 产物输出到 server 目录：\n\nexport default {\n  output: {\n    distpath: {\n      server: 'server',\n    },\n  },\n};\n\n\n\n# 扁平化产物目录\n\n有时候你不想产物目录有太多层级，可以将目录设置为空字符串，使生成的产物目录扁平化。\n\n参考下方的例子：\n\nexport default {\n  output: {\n    distpath: {\n      js: '',\n      css: '',\n      html: '',\n    },\n    disablehtmlfolder: true,\n  },\n};\n\n\n上方的配置会生成以下目录结构：\n\ndist\n├── [name].[hash].css\n├── [name].[hash].css.map\n├── [name].[hash].js\n├── [name].[hash].js.map\n└── [name].html\n\n\n\n# 产物不写入磁盘\n\n默认情况下，builder 会将构建产物写入磁盘，以方便开发者查看产物的内容，或是配置静态资源的代理规则。\n\n在开发环境，你可以选择将构建产物保存在 dev server 的内存中，从而减少文件操作产生的开销。\n\n将 dev.writetodisk 配置项设置为 false 即可：\n\nexport default {\n  dev: {\n    writetodisk: false,\n  },\n};\n",charsets:{cjk:!0}},{title:"引用静态资源",frontmatter:{},regularPath:"/zh/guide/basic/static-assets.html",relativePath:"zh/guide/basic/static-assets.md",key:"v-65d1537e",path:"/zh/guide/basic/static-assets.html",headers:[{level:2,title:"静态资源格式",slug:"静态资源格式",normalizedTitle:"静态资源格式",charIndex:203},{level:2,title:"在 JS 文件中引用",slug:"在-js-文件中引用",normalizedTitle:"在 js 文件中引用",charIndex:494},{level:2,title:"在 CSS 文件中引用",slug:"在-css-文件中引用",normalizedTitle:"在 css 文件中引用",charIndex:763},{level:2,title:"引用结果",slug:"引用结果",normalizedTitle:"引用结果",charIndex:938},{level:2,title:"构建产物",slug:"构建产物",normalizedTitle:"构建产物",charIndex:1e3},{level:2,title:"URL 前缀",slug:"url-前缀",normalizedTitle:"url 前缀",charIndex:1441},{level:2,title:"添加类型声明",slug:"添加类型声明",normalizedTitle:"添加类型声明",charIndex:1715},{level:2,title:"图片格式",slug:"图片格式",normalizedTitle:"图片格式",charIndex:2122}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"静态资源格式 在 JS 文件中引用 在 CSS 文件中引用 引用结果 构建产物 URL 前缀 添加类型声明 图片格式",content:"# 引用静态资源\n\nBuilder 支持在代码中引用图片、字体、媒体类型的静态资源。\n\n什么是静态资源\n\n静态资源是指 Web 应用中不会发生变化的文件。常见的静态资源包括图片、字体、视频、样式表和 JavaScript 文件。这些资源通常存储在服务器或 CDN 上，当用户访问 Web 应用时会被传送到用户的浏览器。由于它们不会发生变化，静态资源可以被浏览器缓存，从而提高 Web 应用的性能。\n\n\n# 静态资源格式\n\n以下是 Builder 默认支持的静态资源格式：\n\n * 图片：png、jpg、jpeg、gif、svg、bmp、webp、ico、apng、avif、tiff。\n * 字体：woff、woff2、eot、ttf、otf、ttc。\n * 媒体：mp4、webm、ogg、mp3、wav、flac、aac、mov。\n\n如果你需要引用其他格式的静态资源，请通过 GitHub Issues 进行反馈。\n\nSVG 图片\n\nSVG 图片是一种特殊情况，Builder 提供了 SVG 转 React 组件的能力，对 SVG 进行单独处理，详见 引用 SVG 资源。\n\n\n# 在 JS 文件中引用\n\n在 JS 文件中，可以直接通过 import 的方式引用相对路径下的静态资源：\n\n// 引用 static 目录下的 logo.png 图片\nimport logo from './static/logo.png';\n\nexport default = () => <img src={logo} />;\n\n\n也支持使用路径别名来引用：\n\nimport logo from '@/static/logo.png';\n\nexport default = () => <img src={logo} />;\n\n\n\n# 在 CSS 文件中引用\n\n在 CSS 文件中，可以引用相对路径下的静态资源：\n\n.logo {\n  background-image: url('../static/logo.png');\n}\n\n\n也支持使用路径别名来引用：\n\n.logo {\n  background-image: url('@/static/logo.png');\n}\n\n\n\n# 引用结果\n\n引用静态资源的结果取决于文件体积：\n\n * 当文件体积大于 10KB 时，会返回一个 URL，同时文件会被输出到构建产物目录下。\n * 当文件体积小于 10KB 时，会自动被内联为 Base64 格式。\n\nimport largeImage from './static/largeImage.png';\nimport smallImage from './static/smallImage.png';\n\nconsole.log(largeImage); // \"/static/largeImage.6c12aba3.png\"\nconsole.log(smallImage); // \"data:image/png;base64,iVBORw0KGgo...\"\n\n\n关于资源内联的更详细介绍，请参考 静态资源内联 章节。\n\n\n# 构建产物\n\n当静态资源被引用后，会自动被输出到构建产物的目录下，你可以：\n\n * 通过 output.filename 来修改产物的文件名。\n * 通过 output.distPath 来修改产物的输出路径。\n\n请阅读 构建产物目录 来了解更多细节。\n\n\n# URL 前缀\n\n引用静态资源后返回的 URL 中会自动包含路径前缀：\n\n * 在开发环境下，通过 dev.assetPrefix 设置路径前缀。\n * 在生产环境下，通过 output.assetPrefix 设置路径前缀。\n\n比如将 output.assetPrefix 设置为 https://modern.com：\n\nimport logo from './static/logo.png';\n\nconsole.log(logo); // \"https://modern.com/static/logo.6c12aba3.png\"\n\n\n\n# 添加类型声明\n\n当你在 TypeScript 代码中引用静态资源时，TypeScript 可能会提示该模块缺少类型定义：\n\nTS2307: Cannot find module './logo.png' or its corresponding type declarations.\n\n\n此时你需要为静态资源添加类型声明文件，请在项目中创建 src/global.d.ts 文件，并添加相应的类型声明。以 png 图片为例，需要添加以下声明：\n\n// src/global.d.ts\ndeclare module '*.png' {\n  const content: string;\n  export default content;\n}\n\n\n添加类型声明后，如果依然存在上述错误提示，请尝试重启当前 IDE，或者调整 global.d.ts 所在的目录，使 TypeScript 能够正确识别类型定义。\n\n\n# 图片格式\n\n在使用图片资源时，你可以根据下方表格中图片的优缺点以及适用场景，来选择合适的图片格式。\n\n格式     优点                                      缺点                    适用场景\nPNG    无损压缩，不会丢失图片细节，不失真，支持半透明                 不适合色表复杂的图片            适合颜色数量少，边界层次分明的图片，适合用在 logo、icon、透明图等场景\nJPG    颜色丰富                                    有损压缩，会导致图片失真，不支持透明度   适合颜色数量多，颜色带有渐变、过度复杂的图片，适合用在人像照片、风景图等场景\nWebP   同时支持有损压缩与无损压缩，支持透明度，体积比 PNG 和 JPG 小很多   iOS 兼容性不好             几乎任何场景的像素图片，支持 WebP 的宿主环境，都应该首选 WebP 图片格式\nSVG    无损格式，不失真,支持透明度                          不适合复杂图形               适合矢量图,适合用于 icon",normalizedContent:"# 引用静态资源\n\nbuilder 支持在代码中引用图片、字体、媒体类型的静态资源。\n\n什么是静态资源\n\n静态资源是指 web 应用中不会发生变化的文件。常见的静态资源包括图片、字体、视频、样式表和 javascript 文件。这些资源通常存储在服务器或 cdn 上，当用户访问 web 应用时会被传送到用户的浏览器。由于它们不会发生变化，静态资源可以被浏览器缓存，从而提高 web 应用的性能。\n\n\n# 静态资源格式\n\n以下是 builder 默认支持的静态资源格式：\n\n * 图片：png、jpg、jpeg、gif、svg、bmp、webp、ico、apng、avif、tiff。\n * 字体：woff、woff2、eot、ttf、otf、ttc。\n * 媒体：mp4、webm、ogg、mp3、wav、flac、aac、mov。\n\n如果你需要引用其他格式的静态资源，请通过 github issues 进行反馈。\n\nsvg 图片\n\nsvg 图片是一种特殊情况，builder 提供了 svg 转 react 组件的能力，对 svg 进行单独处理，详见 引用 svg 资源。\n\n\n# 在 js 文件中引用\n\n在 js 文件中，可以直接通过 import 的方式引用相对路径下的静态资源：\n\n// 引用 static 目录下的 logo.png 图片\nimport logo from './static/logo.png';\n\nexport default = () => <img src={logo} />;\n\n\n也支持使用路径别名来引用：\n\nimport logo from '@/static/logo.png';\n\nexport default = () => <img src={logo} />;\n\n\n\n# 在 css 文件中引用\n\n在 css 文件中，可以引用相对路径下的静态资源：\n\n.logo {\n  background-image: url('../static/logo.png');\n}\n\n\n也支持使用路径别名来引用：\n\n.logo {\n  background-image: url('@/static/logo.png');\n}\n\n\n\n# 引用结果\n\n引用静态资源的结果取决于文件体积：\n\n * 当文件体积大于 10kb 时，会返回一个 url，同时文件会被输出到构建产物目录下。\n * 当文件体积小于 10kb 时，会自动被内联为 base64 格式。\n\nimport largeimage from './static/largeimage.png';\nimport smallimage from './static/smallimage.png';\n\nconsole.log(largeimage); // \"/static/largeimage.6c12aba3.png\"\nconsole.log(smallimage); // \"data:image/png;base64,ivborw0kggo...\"\n\n\n关于资源内联的更详细介绍，请参考 静态资源内联 章节。\n\n\n# 构建产物\n\n当静态资源被引用后，会自动被输出到构建产物的目录下，你可以：\n\n * 通过 output.filename 来修改产物的文件名。\n * 通过 output.distpath 来修改产物的输出路径。\n\n请阅读 构建产物目录 来了解更多细节。\n\n\n# url 前缀\n\n引用静态资源后返回的 url 中会自动包含路径前缀：\n\n * 在开发环境下，通过 dev.assetprefix 设置路径前缀。\n * 在生产环境下，通过 output.assetprefix 设置路径前缀。\n\n比如将 output.assetprefix 设置为 https://modern.com：\n\nimport logo from './static/logo.png';\n\nconsole.log(logo); // \"https://modern.com/static/logo.6c12aba3.png\"\n\n\n\n# 添加类型声明\n\n当你在 typescript 代码中引用静态资源时，typescript 可能会提示该模块缺少类型定义：\n\nts2307: cannot find module './logo.png' or its corresponding type declarations.\n\n\n此时你需要为静态资源添加类型声明文件，请在项目中创建 src/global.d.ts 文件，并添加相应的类型声明。以 png 图片为例，需要添加以下声明：\n\n// src/global.d.ts\ndeclare module '*.png' {\n  const content: string;\n  export default content;\n}\n\n\n添加类型声明后，如果依然存在上述错误提示，请尝试重启当前 ide，或者调整 global.d.ts 所在的目录，使 typescript 能够正确识别类型定义。\n\n\n# 图片格式\n\n在使用图片资源时，你可以根据下方表格中图片的优缺点以及适用场景，来选择合适的图片格式。\n\n格式     优点                                      缺点                    适用场景\npng    无损压缩，不会丢失图片细节，不失真，支持半透明                 不适合色表复杂的图片            适合颜色数量少，边界层次分明的图片，适合用在 logo、icon、透明图等场景\njpg    颜色丰富                                    有损压缩，会导致图片失真，不支持透明度   适合颜色数量多，颜色带有渐变、过度复杂的图片，适合用在人像照片、风景图等场景\nwebp   同时支持有损压缩与无损压缩，支持透明度，体积比 png 和 jpg 小很多   ios 兼容性不好             几乎任何场景的像素图片，支持 webp 的宿主环境，都应该首选 webp 图片格式\nsvg    无损格式，不失真,支持透明度                          不适合复杂图形               适合矢量图,适合用于 icon",charsets:{cjk:!0}},{title:"引用 SVG 资源",frontmatter:{},regularPath:"/zh/guide/basic/svg-assets.html",relativePath:"zh/guide/basic/svg-assets.md",key:"v-54c5fce8",path:"/zh/guide/basic/svg-assets.html",headers:[{level:2,title:"在 JS 文件中引用",slug:"在-js-文件中引用",normalizedTitle:"在 js 文件中引用",charIndex:221},{level:2,title:"修改默认导出",slug:"修改默认导出",normalizedTitle:"修改默认导出",charIndex:592},{level:2,title:"在 CSS 文件中引用",slug:"在-css-文件中引用",normalizedTitle:"在 css 文件中引用",charIndex:887},{level:2,title:"静态资源处理",slug:"静态资源处理",normalizedTitle:"静态资源处理",charIndex:1016},{level:2,title:"添加类型声明",slug:"添加类型声明",normalizedTitle:"添加类型声明",charIndex:1137}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"在 JS 文件中引用 修改默认导出 在 CSS 文件中引用 静态资源处理 添加类型声明",content:"# 引用 SVG 资源\n\nBuilder 支持在代码中引用 SVG 资源，并将 SVG 图片转换为 React 组件或 URL。\n\n什么是 SVG\n\nSVG 是 Scalable Vector Graphics 的缩写，意为可伸缩矢量图形。SVG 是一种用来描述二维矢量图形的 XML-based 格式，可以用来创建可以无限放大或缩小而不失真的图像。因为 SVG 图形是由矢量图形元素组成的，所以可以轻松地在各种尺寸和分辨率下渲染。\n\n\n# 在 JS 文件中引用\n\n在 JS 文件中引用 SVG 资源时，如果你具名导入 ReactComponent 对象，Builder 会调用 SVGR，将 SVG 图片转换为一个 React 组件。\n\n// src/component/Logo.tsx\nimport { ReactComponent as Logo } from './static/logo.svg';\n\nexport default () => <Logo />;\n\n\n如果你使用默认导入，那么 SVG 会被当做普通的静态资源来处理，你会得到一个 URL 字符串：\n\nimport logoURL from './static/logo.svg';\n\nconsole.log(logoURL); // => \"/static/logo.6c12aba3.png\"\n\n\n\n# 修改默认导出\n\n你可以通过 output.svgDefaultExport 配置项来修改 SVG 文件默认导出的内容，比如把默认导出的内容设置为 React 组件：\n\nexport default {\n  output: {\n    svgDefaultExport: 'component',\n  },\n};\n\n\n此时再使用默认导入，你会得到一个 React 组件，而不是 URL：\n\n// src/component/Logo.tsx\nimport Logo from './static/logo.svg';\n\nexport default () => <Logo />;\n\n\n\n# 在 CSS 文件中引用\n\n在 CSS 文件中引用 SVG 资源时，SVG 会被当做一个普通的静态资源来处理，你会得到一个 URL：\n\n.logo {\n  background-image: url('../static/logo.svg');\n}\n\n\n\n# 静态资源处理\n\n当 SVG 不是作为 React 组件，而是作为一个普通的静态资源被引用时，它的处理逻辑和其他静态资源完全一致，也会受到静态资源内联、URL 前缀等规则的影响。\n\n请阅读 引用静态资源 章节来了解静态资源的处理规则。\n\n\n# 添加类型声明\n\n当你在 TypeScript 代码中引用 SVG 资源时，TypeScript 可能会提示该模块缺少类型定义：\n\nTS2307: Cannot find module './logo.svg' or its corresponding type declarations.\n\n\n此时你需要为 SVG 资源添加类型声明文件，请在项目中创建 src/global.d.ts 文件，并添加相应的类型声明：\n\ndeclare module '*.svg' {\n  export const ReactComponent: React.FunctionComponent<\n    React.SVGProps<SVGSVGElement>\n  >;\n\n  const content: string;\n  export default content;\n}\n\n\n如果你将 svgDefaultExport 设置为 'component'，则将类型声明修改为：\n\ndeclare module '*.svg' {\n  export const ReactComponent: React.FunctionComponent<\n    React.SVGProps<SVGSVGElement>\n  >;\n\n  export default ReactComponent;\n}\n\n\n添加类型声明后，如果依然存在上述错误提示，请尝试重启当前 IDE，或者调整 global.d.ts 所在的目录，使 TypeScript 能够正确识别类型定义。",normalizedContent:"# 引用 svg 资源\n\nbuilder 支持在代码中引用 svg 资源，并将 svg 图片转换为 react 组件或 url。\n\n什么是 svg\n\nsvg 是 scalable vector graphics 的缩写，意为可伸缩矢量图形。svg 是一种用来描述二维矢量图形的 xml-based 格式，可以用来创建可以无限放大或缩小而不失真的图像。因为 svg 图形是由矢量图形元素组成的，所以可以轻松地在各种尺寸和分辨率下渲染。\n\n\n# 在 js 文件中引用\n\n在 js 文件中引用 svg 资源时，如果你具名导入 reactcomponent 对象，builder 会调用 svgr，将 svg 图片转换为一个 react 组件。\n\n// src/component/logo.tsx\nimport { reactcomponent as logo } from './static/logo.svg';\n\nexport default () => <logo />;\n\n\n如果你使用默认导入，那么 svg 会被当做普通的静态资源来处理，你会得到一个 url 字符串：\n\nimport logourl from './static/logo.svg';\n\nconsole.log(logourl); // => \"/static/logo.6c12aba3.png\"\n\n\n\n# 修改默认导出\n\n你可以通过 output.svgdefaultexport 配置项来修改 svg 文件默认导出的内容，比如把默认导出的内容设置为 react 组件：\n\nexport default {\n  output: {\n    svgdefaultexport: 'component',\n  },\n};\n\n\n此时再使用默认导入，你会得到一个 react 组件，而不是 url：\n\n// src/component/logo.tsx\nimport logo from './static/logo.svg';\n\nexport default () => <logo />;\n\n\n\n# 在 css 文件中引用\n\n在 css 文件中引用 svg 资源时，svg 会被当做一个普通的静态资源来处理，你会得到一个 url：\n\n.logo {\n  background-image: url('../static/logo.svg');\n}\n\n\n\n# 静态资源处理\n\n当 svg 不是作为 react 组件，而是作为一个普通的静态资源被引用时，它的处理逻辑和其他静态资源完全一致，也会受到静态资源内联、url 前缀等规则的影响。\n\n请阅读 引用静态资源 章节来了解静态资源的处理规则。\n\n\n# 添加类型声明\n\n当你在 typescript 代码中引用 svg 资源时，typescript 可能会提示该模块缺少类型定义：\n\nts2307: cannot find module './logo.svg' or its corresponding type declarations.\n\n\n此时你需要为 svg 资源添加类型声明文件，请在项目中创建 src/global.d.ts 文件，并添加相应的类型声明：\n\ndeclare module '*.svg' {\n  export const reactcomponent: react.functioncomponent<\n    react.svgprops<svgsvgelement>\n  >;\n\n  const content: string;\n  export default content;\n}\n\n\n如果你将 svgdefaultexport 设置为 'component'，则将类型声明修改为：\n\ndeclare module '*.svg' {\n  export const reactcomponent: react.functioncomponent<\n    react.svgprops<svgsvgelement>\n  >;\n\n  export default reactcomponent;\n}\n\n\n添加类型声明后，如果依然存在上述错误提示，请尝试重启当前 ide，或者调整 global.d.ts 所在的目录，使 typescript 能够正确识别类型定义。",charsets:{cjk:!0}},{title:"使用 TypeScript",frontmatter:{},regularPath:"/zh/guide/basic/typescript.html",relativePath:"zh/guide/basic/typescript.md",key:"v-42403228",path:"/zh/guide/basic/typescript.html",headers:[{level:2,title:"TypeScript 转译",slug:"typescript-转译",normalizedTitle:"typescript 转译",charIndex:87},{level:2,title:"类型检查",slug:"类型检查",normalizedTitle:"类型检查",charIndex:42}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"TypeScript 转译 类型检查",content:"# 使用 TypeScript\n\nBuilder 对 TypeScript 的转译和类型检查做了默认支持，无需任何配置即可在项目中使用 .ts 和 .tsx 文件。\n\n\n# TypeScript 转译\n\nBuilder 有三种可选方式处理 TypeScript 文件。\n\nBabel\n\n在默认配置下，源码中所有的 TypeScript 文件会经过 Babel 转译。 可能你在查阅较老旧的资料时会发现，Babel 无法处理 const enum 以及 namespace alias 语法，但是其实在 7.15 版本已经得到了支持。Babel 无需手动开启，直接在项目中使用 TypeScript 文件即可。\n\nts-loader\n\nts-loader 使用 TypeScript 官方的 TSC 转译。当开启 ts-loader 后 TypeScript 文件不会再经过 Babel 编译处理，但处理后的 JavaScript 产物仍然会由 Babel 进行语法降级以及 Polyfill 注入。\n\n开启 ts-loader(使用默认配置):\n\nexport default {\n  tools: {\n    tsLoader: {},\n  },\n};\n\n\n更详细配置可见 tools.tsLoader。 如果开启 ts-loader，默认不会启用类型检查，只会进行转译。\n\nSWC\n\n如果想要更快的项目构建速度，并且项目没有依赖某些自定义的 Babel 插件，那么也可以选择 SWC 来对 JavaScript 和 TypeScript 进行转译和压缩。Builder 的 SWC 插件默认支持 TypeScript, TSX, Decorator，使用方式可见 SWC 插件。\n\n\n# 为什么默认使用 Babel\n\nBabel 除了没有类型检查以外，对 TypeScript 语法支持已经非常完善，而类型检查可以借助另外的工具更好地进行。转译到低版本的 JavaScript 时，某些语法 Babel 会处理得更符合标准，例如 Babel 会将类成员初始化为 undefined，将类方法标记不可枚举等行为。如果启用 ts-loader，为了更精确的语法降级和 Polyfill，最后还是会将处理后的产物再次经过 Babel 处理，产生不必要的性能开销。\n\n\n# 类型检查\n\n目前生产可用的类型检查工具只有官方的 TSC，TSC 类型检查耗时在大项目中往往是很慢的过程，Builder 中默认使用 tsChecker(fork-ts-checker-webpack-plugin) 在构建过程中异步进行类型检查，不阻塞项目的启动。\n\n配置 tsChecker(使用默认配置):\n\nexport default {\n  tools: {\n    tsChecker: {},\n  },\n};\n\n\n更多配置可见 tsChecker 配置。 如果开启 ts-loader 并且手动配置了 compileOnly: false，请关闭 tsChecker，避免重复类型检查。\n\nSTC\n\nSWC 作者新开源的基于 Rust 的类型检查工具 STC 目前还不可用于生产，还在起步阶段，不推荐用于项目中，等待之后更成熟，会集成到 Builder 的 SWC 插件中作为实验功能，敬请期待。",normalizedContent:"# 使用 typescript\n\nbuilder 对 typescript 的转译和类型检查做了默认支持，无需任何配置即可在项目中使用 .ts 和 .tsx 文件。\n\n\n# typescript 转译\n\nbuilder 有三种可选方式处理 typescript 文件。\n\nbabel\n\n在默认配置下，源码中所有的 typescript 文件会经过 babel 转译。 可能你在查阅较老旧的资料时会发现，babel 无法处理 const enum 以及 namespace alias 语法，但是其实在 7.15 版本已经得到了支持。babel 无需手动开启，直接在项目中使用 typescript 文件即可。\n\nts-loader\n\nts-loader 使用 typescript 官方的 tsc 转译。当开启 ts-loader 后 typescript 文件不会再经过 babel 编译处理，但处理后的 javascript 产物仍然会由 babel 进行语法降级以及 polyfill 注入。\n\n开启 ts-loader(使用默认配置):\n\nexport default {\n  tools: {\n    tsloader: {},\n  },\n};\n\n\n更详细配置可见 tools.tsloader。 如果开启 ts-loader，默认不会启用类型检查，只会进行转译。\n\nswc\n\n如果想要更快的项目构建速度，并且项目没有依赖某些自定义的 babel 插件，那么也可以选择 swc 来对 javascript 和 typescript 进行转译和压缩。builder 的 swc 插件默认支持 typescript, tsx, decorator，使用方式可见 swc 插件。\n\n\n# 为什么默认使用 babel\n\nbabel 除了没有类型检查以外，对 typescript 语法支持已经非常完善，而类型检查可以借助另外的工具更好地进行。转译到低版本的 javascript 时，某些语法 babel 会处理得更符合标准，例如 babel 会将类成员初始化为 undefined，将类方法标记不可枚举等行为。如果启用 ts-loader，为了更精确的语法降级和 polyfill，最后还是会将处理后的产物再次经过 babel 处理，产生不必要的性能开销。\n\n\n# 类型检查\n\n目前生产可用的类型检查工具只有官方的 tsc，tsc 类型检查耗时在大项目中往往是很慢的过程，builder 中默认使用 tschecker(fork-ts-checker-webpack-plugin) 在构建过程中异步进行类型检查，不阻塞项目的启动。\n\n配置 tschecker(使用默认配置):\n\nexport default {\n  tools: {\n    tschecker: {},\n  },\n};\n\n\n更多配置可见 tschecker 配置。 如果开启 ts-loader 并且手动配置了 compileonly: false，请关闭 tschecker，避免重复类型检查。\n\nstc\n\nswc 作者新开源的基于 rust 的类型检查工具 stc 目前还不可用于生产，还在起步阶段，不推荐用于项目中，等待之后更成熟，会集成到 builder 的 swc 插件中作为实验功能，敬请期待。",charsets:{cjk:!0}},{title:"使用 Webpack Inspector",frontmatter:{},regularPath:"/zh/guide/debug/inspector.html",relativePath:"zh/guide/debug/inspector.md",key:"v-2b55434a",path:"/zh/guide/debug/inspector.html",headers:[{level:2,title:"介绍",slug:"介绍",normalizedTitle:"介绍",charIndex:78},{level:2,title:"启用",slug:"启用",normalizedTitle:"启用",charIndex:365},{level:2,title:"调试面板",slug:"调试面板",normalizedTitle:"调试面板",charIndex:832}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"介绍 启用 调试面板",content:"# 使用 Webpack Inspector\n\nBuilder 内置了 webpack inspector 来辅助调试 webpack 构建问题。\n\n\n# 介绍\n\n由于 webpack 内部的工作流程比较黑盒，在使用 webpack 时，我们常常会遇到如下的一些问题:\n\n * 在使用上层框架时，不知道最终生成的 webpack 配置包含哪些内容。\n * 每个模块会经过不同的 loader 处理，经过各个 loader 的编译结果难以感知。\n * 难以感知 webpack 各个编译环节 (比如 babel-loader、ts-loader) 的耗时情况。\n\n为了更方便地进行 webpack 项目的错误排查、性能分析及 loader 开发，我们在 Builder 中内置了 webpack inspector 工具。\n\n\n# 启用\n\n你可以通过 tools.inspector 配置项来开启 webpack inspector:\n\nexport default {\n  tools: {\n    inspector: {},\n  },\n};\n\n\n为了避免 inspector 影响正常开发，建议配置仅在 DEBUG 时开启 inspector：\n\nexport default {\n  tools: {\n    inspector: process.env.DEBUG ? {} : undefined,\n  },\n};\n\n\n添加以上配置后，当你执行 DEBUG=true pnpm dev 时，Builder 会在编译完成后启动 inspector，此时 Shell 中可以看到如下信息：\n\ninfo    Starting dev server...\n\n【Webpack Inspector】🔥 started at http://localhost:3333\n\n\n打开 http://localhost:3333 地址，即可访问 inspector 的调试面板。\n\n\n# 调试面板\n\nInspector 的调试面板提供了多种模式，你可以通过右上角的开关进行切换。\n\n\n# 配置预览模式\n\n面板的默认模式为配置预览模式。此模式下可以查看 webpack 内部所有的配置信息，配置对象可自由展开和折叠:\n\n\n\n\n# 列表模式\n\n此模式下会展示出所有的模块信息:\n\n\n\n点击列表项会出现模块的编译详情信息:\n\n\n\n\n# Loader 统计数据\n\n点击如下的开关，可以查看 Loader 的统计数据:\n\n\n\n\n# 依赖图模式\n\n此模式下会展示出所有模块的依赖关系：\n\n\n\n点击图中的节点也会呈现具体模块的编译详情：\n\n\n\nTIP\n\n出于性能考虑，模块数量 > 100 时不会展示依赖图。",normalizedContent:"# 使用 webpack inspector\n\nbuilder 内置了 webpack inspector 来辅助调试 webpack 构建问题。\n\n\n# 介绍\n\n由于 webpack 内部的工作流程比较黑盒，在使用 webpack 时，我们常常会遇到如下的一些问题:\n\n * 在使用上层框架时，不知道最终生成的 webpack 配置包含哪些内容。\n * 每个模块会经过不同的 loader 处理，经过各个 loader 的编译结果难以感知。\n * 难以感知 webpack 各个编译环节 (比如 babel-loader、ts-loader) 的耗时情况。\n\n为了更方便地进行 webpack 项目的错误排查、性能分析及 loader 开发，我们在 builder 中内置了 webpack inspector 工具。\n\n\n# 启用\n\n你可以通过 tools.inspector 配置项来开启 webpack inspector:\n\nexport default {\n  tools: {\n    inspector: {},\n  },\n};\n\n\n为了避免 inspector 影响正常开发，建议配置仅在 debug 时开启 inspector：\n\nexport default {\n  tools: {\n    inspector: process.env.debug ? {} : undefined,\n  },\n};\n\n\n添加以上配置后，当你执行 debug=true pnpm dev 时，builder 会在编译完成后启动 inspector，此时 shell 中可以看到如下信息：\n\ninfo    starting dev server...\n\n【webpack inspector】🔥 started at http://localhost:3333\n\n\n打开 http://localhost:3333 地址，即可访问 inspector 的调试面板。\n\n\n# 调试面板\n\ninspector 的调试面板提供了多种模式，你可以通过右上角的开关进行切换。\n\n\n# 配置预览模式\n\n面板的默认模式为配置预览模式。此模式下可以查看 webpack 内部所有的配置信息，配置对象可自由展开和折叠:\n\n\n\n\n# 列表模式\n\n此模式下会展示出所有的模块信息:\n\n\n\n点击列表项会出现模块的编译详情信息:\n\n\n\n\n# loader 统计数据\n\n点击如下的开关，可以查看 loader 的统计数据:\n\n\n\n\n# 依赖图模式\n\n此模式下会展示出所有模块的依赖关系：\n\n\n\n点击图中的节点也会呈现具体模块的编译详情：\n\n\n\ntip\n\n出于性能考虑，模块数量 > 100 时不会展示依赖图。",charsets:{cjk:!0}},{title:"异常类问题",frontmatter:{},regularPath:"/zh/guide/faq/exceptions.html",relativePath:"zh/guide/faq/exceptions.md",key:"v-d360c268",path:"/zh/guide/faq/exceptions.html",headers:[{level:2,title:"webpack 编译出现 'compilation' argument 报错？",slug:"webpack-编译出现-compilation-argument-报错",normalizedTitle:"webpack 编译出现 'compilation' argument 报错？",charIndex:12},{level:2,title:"编译产物中存在未编译的 ES6+ 代码？",slug:"编译产物中存在未编译的-es6-代码",normalizedTitle:"编译产物中存在未编译的 es6+ 代码？",charIndex:782},{level:2,title:"在 Monorepo 中引用其他模块，代码没有被正确编译？",slug:"在-monorepo-中引用其他模块-代码没有被正确编译",normalizedTitle:"在 monorepo 中引用其他模块，代码没有被正确编译？",charIndex:960},{level:2,title:"编译时报错 You may need additional loader？",slug:"编译时报错-you-may-need-additional-loader",normalizedTitle:"编译时报错 you may need additional loader？",charIndex:1157},{level:2,title:"打开页面后报错，提示 exports is not defined？",slug:"打开页面后报错-提示-exports-is-not-defined",normalizedTitle:"打开页面后报错，提示 exports is not defined？",charIndex:1565},{level:2,title:'编译时报错 "Error: ES Modules may not assign module.exports or exports.*, Use ESM export syntax"？',slug:"编译时报错-error-es-modules-may-not-assign-module-exports-or-exports-use-esm-export-syntax",normalizedTitle:"编译时报错 &quot;error: es modules may not assign module.exports or exports.*, use esm export syntax&quot;？",charIndex:null},{level:2,title:"编译进度条卡死，但终端无 Error 日志？",slug:"编译进度条卡死-但终端无-error-日志",normalizedTitle:"编译进度条卡死，但终端无 error 日志？",charIndex:2415},{level:2,title:"webpack 编译缓存未生效，应该如何排查？",slug:"webpack-编译缓存未生效-应该如何排查",normalizedTitle:"webpack 编译缓存未生效，应该如何排查？",charIndex:3672},{level:2,title:"打包后发现 Tree Shaking 没有生效？",slug:"打包后发现-tree-shaking-没有生效",normalizedTitle:"打包后发现 tree shaking 没有生效？",charIndex:4153},{level:2,title:"打包时出现 JavaScript heap out of memory?",slug:"打包时出现-javascript-heap-out-of-memory",normalizedTitle:"打包时出现 javascript heap out of memory?",charIndex:4439},{level:2,title:"Less 文件中的除法不生效？",slug:"less-文件中的除法不生效",normalizedTitle:"less 文件中的除法不生效？",charIndex:4851},{level:2,title:"修改配置后，报错 ‘TypeError: Cannot delete property 'xxx' of #<Object\\>’",slug:"修改配置后-报错-typeerror-cannot-delete-property-xxx-of-object",normalizedTitle:"修改配置后，报错 ‘typeerror: cannot delete property 'xxx' of #&lt;object&gt;’",charIndex:null}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"webpack 编译出现 'compilation' argument 报错？ 编译产物中存在未编译的 ES6+ 代码？ 在 Monorepo 中引用其他模块，代码没有被正确编译？ 编译时报错 You may need additional loader？ 打开页面后报错，提示 exports is not defined？ 编译时报错 \"Error: ES Modules may not assign module.exports or exports.*, Use ESM export syntax\"？ 编译进度条卡死，但终端无 Error 日志？ webpack 编译缓存未生效，应该如何排查？ 打包后发现 Tree Shaking 没有生效？ 打包时出现 JavaScript heap out of memory? Less 文件中的除法不生效？ 修改配置后，报错 ‘TypeError: Cannot delete property 'xxx' of #<Object\\>’",content:"# 异常类问题\n\n\n# webpack 编译出现 'compilation' argument 报错？\n\n如果编译时出现以下报错，通常是由于项目中安装了错误的 webpack 版本，或者安装了多个 webpack 版本引起：\n\nTypeError: The 'compilation' argument must be an instance of Compilation\n\n\nwebpack 版本问题有以下几种情况：\n\n 1. 项目的 package.json 中直接声明了 webpack 依赖，并且与 Builder 依赖的 webpack 版本范围不同，无法匹配到同一个版本。\n 2. 项目里安装的多个 npm 包都依赖了 webpack，并且它们依赖的 webpack 版本范围不同，无法匹配到同一个版本。\n 3. 由于包管理器的 lock 机制，导致 lock 文件中产生了多个 webpack 版本。\n\n如果是第一种情况，建议从项目的 package.json 中移除 webpack 依赖。因为 Builder 默认封装了 webpack 相关能力，并且会在 tools.webpack 配置项中传入 webpack 对象。因此在大多数情况下，不建议在项目中额外安装 webpack 依赖。\n\n如果是第二种情况，建议看看能否升级某个 npm 包，使其依赖的 webpack 版本范围与 Builder 保持一致。也可以通过包管理器的能力来手动统一版本，比如使用 yarn resolutions 或 pnpm overrides。\n\n如果是第三种情况，可以使用第二种情况中提到的两种方法，也可以尝试删除 lock 文件后重新安装来解决。\n\nTIP\n\n删除 lock 文件会使项目中的依赖版本自动升级到指定范围下的最新版，请进行充分的测试。\n\n\n# 编译产物中存在未编译的 ES6+ 代码？\n\n默认情况下，Builder 不会通过 babel-loader 或 ts-loader 来编译 node_modules 下的文件。如果项目引入的 npm 包中含有 ES6+ 语法，会被打包进产物中。\n\n遇到这种情况时，可以通过 source.include 配置项来指定需要额外进行编译的目录或模块。\n\n\n# 在 Monorepo 中引用其他模块，代码没有被正确编译？\n\n出于编译性能的考虑，默认情况下，Builder 不会通过 babel-loader 或 ts-loader 来编译 node_modules 下的文件，也不会编译当前工程目录外部的文件。\n\n通过 source.include 配置项，可以指定需要额外进行编译的目录或模块。\n\n详见 source.include 用法介绍。\n\n\n# 编译时报错 You may need additional loader？\n\n如果编译过程中遇到了以下报错提示，表示存在个别文件无法被正确编译。\n\nModule parse failed: Unexpected token\nFile was processed with these loaders:\n * some-loader/index.js\n\nYou may need an additional loader to handle the result of these loaders.\n\n\n解决方法：\n\n * 如果是引用了当前工程外部的 .ts 文件，或者是 node_modules 下的 .ts 文件，请添加 source.include 配置项，指定需要额外进行编译的文件。\n * 如果是引用了 Builder 不支持的文件格式，请自行配置对应的 webpack loader 进行编译。\n\n\n# 打开页面后报错，提示 exports is not defined？\n\n如果编译正常，但是打开页面后出现 exports is not defined 报错，通常是因为在项目中使用 babel 编译了一个 CommonJS 模块，导致 babel 出现异常。\n\n在正常情况下，Builder 是不会使用 babel 来编译 CommonJS 模块的。如果项目中使用了 source.include 配置项，或使用了 tools.babel 的 addIncludes 方法，则可能会把一些 CommonJS 模块加入到 babel 编译中。\n\n该问题有两种解决方法：\n\n 1. 避免将 CommonJS 模块加入到 babel 编译中。\n 2. 将 babel 的 sourceType 配置项设置为 unambiguous，示例如下：\n\nexport default {\n  tools: {\n    babel(config) {\n      config.sourceType = 'unambiguous';\n    },\n  },\n};\n\n\n将 sourceType 设置为 unambiguous 可能会产生一些其他影响，请参考 babel 官方文档。\n\n\n# 编译时报错 \"Error: ES Modules may not assign module.exports or exports.*, Use ESM export syntax\"？\n\n如果编译时出现以下报错，通常也是因为在项目中使用 babel 编译了一个 CommonJS 模块，解决方法与上述的 exports is not defined 问题一致。\n\nError: ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: 581\n\n\n更多信息请参考 issue：babel#12731。\n\n\n# 编译进度条卡死，但终端无 Error 日志？\n\n当编译进度条卡死，但终端无 Error 日志时，通常是因为编译过程中出现了异常。在某些情况下，当 Error 被 webpack 或其他模块捕获后，错误日志不会被正确输出。最为常见的场景是 Babel 配置出现异常，抛出 Error 后被 webpack 捕获，而 webpack 在个别情况下吞掉了 Error。\n\n解决方法：\n\n如果你修改 Babel 配置后出现此问题，建议检查是否有以下错误用法：\n\n 1. 配置了一个不存在的 plugin 或 preset，可能是名称拼写错误，或是未正确安装。\n\n// 错误示例\nexport default {\n  tools: {\n    babel(config, { addPlugins }) {\n      // 该插件名称错误，或者未安装\n      addPlugins('babel-plugin-not-exists');\n    },\n  },\n};\n\n\n 2. 是否配置了多个 babel-plugin-import，但是没有在数组的第三项声明每一个 babel-plugin-import 的名称。\n\n// 错误示例\nexport default {\n  tools: {\n    babel(config, { addPlugins }) {\n      addPlugins([\n        [\n          'babel-plugin-import',\n          { libraryName: 'antd', libraryDirectory: 'es' },\n        ],\n        [\n          'babel-plugin-import',\n          { libraryName: 'antd-mobile', libraryDirectory: 'es' },\n        ],\n      ]);\n    },\n  },\n};\n\n\n// 正确示例\nexport default {\n  tools: {\n    babel(config, { addPlugins }) {\n      addPlugins([\n        [\n          'babel-plugin-import',\n          { libraryName: 'antd', libraryDirectory: 'es' },\n          'antd',\n        ],\n        [\n          'babel-plugin-import',\n          { libraryName: 'antd-mobile', libraryDirectory: 'es' },\n          'antd-mobile',\n        ],\n      ]);\n    },\n  },\n};\n\n\n\n# webpack 编译缓存未生效，应该如何排查？\n\nBuilder 默认开启了 webpack 的持久化缓存。\n\n首次编译完成后，会自动生成缓存文件，并输出到 ./node_modules/.cache/webpack 目录下。执行第二次编译时，会命中缓存，并大幅度提高编译速度。\n\n当 package.json 等配置文件被修改时，缓存会自动失效。\n\n如果项目中 webpack 编译缓存一直未生效，可以添加以下配置进行排查：\n\nexport default {\n  tools: {\n    webpack(config) {\n      config.infrastructureLogging = {\n        ...config.infrastructureLogging,\n        debug: /webpack\\.cache/,\n      };\n    },\n  },\n};\n\n\n添加以上配置后，webpack 会输出日志用于 debug，请参考 PackFileCacheStrategy 相关的日志来了解缓存失效的原因。\n\n\n# 打包后发现 Tree Shaking 没有生效？\n\nBuilder 在生产构建时会默认开启 webpack 的 Tree Shaking 功能，Tree Shaking 是否能够生效，取决于业务代码能否满足 webpack 的 Tree Shaking 条件。\n\n如果你遇到了 Tree Shaking 不生效的问题，可以检查下相关 npm 包的 sideEffects 配置是否正确，如果不了解 sideEffects 是什么，可以阅读以下两篇文档：\n\n * webpack 官方文档 - Tree Shaking\n * Tree Shaking 问题排查指南\n\n\n# 打包时出现 JavaScript heap out of memory?\n\n该报错表示打包过程中出现了内存溢出问题，大多数情况下是由于打包的内容较多，超出了 Node.js 默认的内存上限。\n\n如果出现 OOM 问题，最简单的方法是通过增加内存上限来解决，Node.js 提供了 --max-old-space-size 选项来对此进行设置。你可以在 CLI 命令前添加 NODE_OPTIONS 来设置此参数：\n\nNODE_OPTIONS=--max_old_space_size=16384 modern build\n\n\n参数的值代表内存上限大小（MB)，一般情况下设置为 16384（16GB）即可。\n\nNode.js 官方文档中有对以下参数更详细的解释：\n\n * NODE_OPTIONS\n * --max-old-space-size\n\n除了增加内存上限，通过开启一些编译策略来提升效率也是一个解决方案。\n\n\n# Less 文件中的除法不生效？\n\nLess v4 版本与 v3 版本相比，除法的写法有一些区别：\n\n// Less v3\n.math {\n  width: 2px / 2; // 1px\n  width: 2px ./ 2; // 1px\n  width: (2px / 2); // 1px\n}\n\n// Less v4\n.math {\n  width: 2px / 2; // 2px / 2\n  width: 2px ./ 2; // 1px\n  width: (2px / 2); // 1px\n}\n\n\nBuilder 内置的 Less 版本为 v4，低版本的写法不会生效，请注意区分。\n\nLess 中除法的写法也可以通过配置项来修改，详见 Less - Math。\n\n\n# 修改配置后，报错 ‘TypeError: Cannot delete property 'xxx' of #<Object>’\n\n该报错表示在编译过程中对一个只读配置项进行了删除操作。通常情况下，我们不希望编译过程中的任何操作会直接对传入的配置进行修改，但难以限制底层插件（如 postcss-loader 等）的行为，如果出现该报错，请联系 builder 开发人员，我们需要对该配置进行单独处理。\n\n同类型报错还有：\n\n * 'TypeError: Cannot add property xxx, object is not extensible'\n * 'TypeError: Cannot assign to read only property 'xxx' of object '#<Object>'",normalizedContent:"# 异常类问题\n\n\n# webpack 编译出现 'compilation' argument 报错？\n\n如果编译时出现以下报错，通常是由于项目中安装了错误的 webpack 版本，或者安装了多个 webpack 版本引起：\n\ntypeerror: the 'compilation' argument must be an instance of compilation\n\n\nwebpack 版本问题有以下几种情况：\n\n 1. 项目的 package.json 中直接声明了 webpack 依赖，并且与 builder 依赖的 webpack 版本范围不同，无法匹配到同一个版本。\n 2. 项目里安装的多个 npm 包都依赖了 webpack，并且它们依赖的 webpack 版本范围不同，无法匹配到同一个版本。\n 3. 由于包管理器的 lock 机制，导致 lock 文件中产生了多个 webpack 版本。\n\n如果是第一种情况，建议从项目的 package.json 中移除 webpack 依赖。因为 builder 默认封装了 webpack 相关能力，并且会在 tools.webpack 配置项中传入 webpack 对象。因此在大多数情况下，不建议在项目中额外安装 webpack 依赖。\n\n如果是第二种情况，建议看看能否升级某个 npm 包，使其依赖的 webpack 版本范围与 builder 保持一致。也可以通过包管理器的能力来手动统一版本，比如使用 yarn resolutions 或 pnpm overrides。\n\n如果是第三种情况，可以使用第二种情况中提到的两种方法，也可以尝试删除 lock 文件后重新安装来解决。\n\ntip\n\n删除 lock 文件会使项目中的依赖版本自动升级到指定范围下的最新版，请进行充分的测试。\n\n\n# 编译产物中存在未编译的 es6+ 代码？\n\n默认情况下，builder 不会通过 babel-loader 或 ts-loader 来编译 node_modules 下的文件。如果项目引入的 npm 包中含有 es6+ 语法，会被打包进产物中。\n\n遇到这种情况时，可以通过 source.include 配置项来指定需要额外进行编译的目录或模块。\n\n\n# 在 monorepo 中引用其他模块，代码没有被正确编译？\n\n出于编译性能的考虑，默认情况下，builder 不会通过 babel-loader 或 ts-loader 来编译 node_modules 下的文件，也不会编译当前工程目录外部的文件。\n\n通过 source.include 配置项，可以指定需要额外进行编译的目录或模块。\n\n详见 source.include 用法介绍。\n\n\n# 编译时报错 you may need additional loader？\n\n如果编译过程中遇到了以下报错提示，表示存在个别文件无法被正确编译。\n\nmodule parse failed: unexpected token\nfile was processed with these loaders:\n * some-loader/index.js\n\nyou may need an additional loader to handle the result of these loaders.\n\n\n解决方法：\n\n * 如果是引用了当前工程外部的 .ts 文件，或者是 node_modules 下的 .ts 文件，请添加 source.include 配置项，指定需要额外进行编译的文件。\n * 如果是引用了 builder 不支持的文件格式，请自行配置对应的 webpack loader 进行编译。\n\n\n# 打开页面后报错，提示 exports is not defined？\n\n如果编译正常，但是打开页面后出现 exports is not defined 报错，通常是因为在项目中使用 babel 编译了一个 commonjs 模块，导致 babel 出现异常。\n\n在正常情况下，builder 是不会使用 babel 来编译 commonjs 模块的。如果项目中使用了 source.include 配置项，或使用了 tools.babel 的 addincludes 方法，则可能会把一些 commonjs 模块加入到 babel 编译中。\n\n该问题有两种解决方法：\n\n 1. 避免将 commonjs 模块加入到 babel 编译中。\n 2. 将 babel 的 sourcetype 配置项设置为 unambiguous，示例如下：\n\nexport default {\n  tools: {\n    babel(config) {\n      config.sourcetype = 'unambiguous';\n    },\n  },\n};\n\n\n将 sourcetype 设置为 unambiguous 可能会产生一些其他影响，请参考 babel 官方文档。\n\n\n# 编译时报错 \"error: es modules may not assign module.exports or exports.*, use esm export syntax\"？\n\n如果编译时出现以下报错，通常也是因为在项目中使用 babel 编译了一个 commonjs 模块，解决方法与上述的 exports is not defined 问题一致。\n\nerror: es modules may not assign module.exports or exports.*, use esm export syntax, instead: 581\n\n\n更多信息请参考 issue：babel#12731。\n\n\n# 编译进度条卡死，但终端无 error 日志？\n\n当编译进度条卡死，但终端无 error 日志时，通常是因为编译过程中出现了异常。在某些情况下，当 error 被 webpack 或其他模块捕获后，错误日志不会被正确输出。最为常见的场景是 babel 配置出现异常，抛出 error 后被 webpack 捕获，而 webpack 在个别情况下吞掉了 error。\n\n解决方法：\n\n如果你修改 babel 配置后出现此问题，建议检查是否有以下错误用法：\n\n 1. 配置了一个不存在的 plugin 或 preset，可能是名称拼写错误，或是未正确安装。\n\n// 错误示例\nexport default {\n  tools: {\n    babel(config, { addplugins }) {\n      // 该插件名称错误，或者未安装\n      addplugins('babel-plugin-not-exists');\n    },\n  },\n};\n\n\n 2. 是否配置了多个 babel-plugin-import，但是没有在数组的第三项声明每一个 babel-plugin-import 的名称。\n\n// 错误示例\nexport default {\n  tools: {\n    babel(config, { addplugins }) {\n      addplugins([\n        [\n          'babel-plugin-import',\n          { libraryname: 'antd', librarydirectory: 'es' },\n        ],\n        [\n          'babel-plugin-import',\n          { libraryname: 'antd-mobile', librarydirectory: 'es' },\n        ],\n      ]);\n    },\n  },\n};\n\n\n// 正确示例\nexport default {\n  tools: {\n    babel(config, { addplugins }) {\n      addplugins([\n        [\n          'babel-plugin-import',\n          { libraryname: 'antd', librarydirectory: 'es' },\n          'antd',\n        ],\n        [\n          'babel-plugin-import',\n          { libraryname: 'antd-mobile', librarydirectory: 'es' },\n          'antd-mobile',\n        ],\n      ]);\n    },\n  },\n};\n\n\n\n# webpack 编译缓存未生效，应该如何排查？\n\nbuilder 默认开启了 webpack 的持久化缓存。\n\n首次编译完成后，会自动生成缓存文件，并输出到 ./node_modules/.cache/webpack 目录下。执行第二次编译时，会命中缓存，并大幅度提高编译速度。\n\n当 package.json 等配置文件被修改时，缓存会自动失效。\n\n如果项目中 webpack 编译缓存一直未生效，可以添加以下配置进行排查：\n\nexport default {\n  tools: {\n    webpack(config) {\n      config.infrastructurelogging = {\n        ...config.infrastructurelogging,\n        debug: /webpack\\.cache/,\n      };\n    },\n  },\n};\n\n\n添加以上配置后，webpack 会输出日志用于 debug，请参考 packfilecachestrategy 相关的日志来了解缓存失效的原因。\n\n\n# 打包后发现 tree shaking 没有生效？\n\nbuilder 在生产构建时会默认开启 webpack 的 tree shaking 功能，tree shaking 是否能够生效，取决于业务代码能否满足 webpack 的 tree shaking 条件。\n\n如果你遇到了 tree shaking 不生效的问题，可以检查下相关 npm 包的 sideeffects 配置是否正确，如果不了解 sideeffects 是什么，可以阅读以下两篇文档：\n\n * webpack 官方文档 - tree shaking\n * tree shaking 问题排查指南\n\n\n# 打包时出现 javascript heap out of memory?\n\n该报错表示打包过程中出现了内存溢出问题，大多数情况下是由于打包的内容较多，超出了 node.js 默认的内存上限。\n\n如果出现 oom 问题，最简单的方法是通过增加内存上限来解决，node.js 提供了 --max-old-space-size 选项来对此进行设置。你可以在 cli 命令前添加 node_options 来设置此参数：\n\nnode_options=--max_old_space_size=16384 modern build\n\n\n参数的值代表内存上限大小（mb)，一般情况下设置为 16384（16gb）即可。\n\nnode.js 官方文档中有对以下参数更详细的解释：\n\n * node_options\n * --max-old-space-size\n\n除了增加内存上限，通过开启一些编译策略来提升效率也是一个解决方案。\n\n\n# less 文件中的除法不生效？\n\nless v4 版本与 v3 版本相比，除法的写法有一些区别：\n\n// less v3\n.math {\n  width: 2px / 2; // 1px\n  width: 2px ./ 2; // 1px\n  width: (2px / 2); // 1px\n}\n\n// less v4\n.math {\n  width: 2px / 2; // 2px / 2\n  width: 2px ./ 2; // 1px\n  width: (2px / 2); // 1px\n}\n\n\nbuilder 内置的 less 版本为 v4，低版本的写法不会生效，请注意区分。\n\nless 中除法的写法也可以通过配置项来修改，详见 less - math。\n\n\n# 修改配置后，报错 ‘typeerror: cannot delete property 'xxx' of #<object>’\n\n该报错表示在编译过程中对一个只读配置项进行了删除操作。通常情况下，我们不希望编译过程中的任何操作会直接对传入的配置进行修改，但难以限制底层插件（如 postcss-loader 等）的行为，如果出现该报错，请联系 builder 开发人员，我们需要对该配置进行单独处理。\n\n同类型报错还有：\n\n * 'typeerror: cannot add property xxx, object is not extensible'\n * 'typeerror: cannot assign to read only property 'xxx' of object '#<object>'",charsets:{cjk:!0}},{title:"功能类问题",frontmatter:{},regularPath:"/zh/guide/faq/features.html",relativePath:"zh/guide/faq/features.md",key:"v-68848fec",path:"/zh/guide/faq/features.html",headers:[{level:2,title:"如何配置组件库按需引入？",slug:"如何配置组件库按需引入",normalizedTitle:"如何配置组件库按需引入？",charIndex:12},{level:2,title:"如何在编译过程中进行 ESLint 代码校验？",slug:"如何在编译过程中进行-eslint-代码校验",normalizedTitle:"如何在编译过程中进行 eslint 代码校验？",charIndex:387},{level:2,title:"如何配置静态资源的 CDN 路径？",slug:"如何配置静态资源的-cdn-路径",normalizedTitle:"如何配置静态资源的 cdn 路径？",charIndex:826},{level:2,title:"如何清空 webpack 编译缓存？",slug:"如何清空-webpack-编译缓存",normalizedTitle:"如何清空 webpack 编译缓存？",charIndex:1014},{level:2,title:"如何移除代码中的 console？",slug:"如何移除代码中的-console",normalizedTitle:"如何移除代码中的 console？",charIndex:1161}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"如何配置组件库按需引入？ 如何在编译过程中进行 ESLint 代码校验？ 如何配置静态资源的 CDN 路径？ 如何清空 webpack 编译缓存？ 如何移除代码中的 console？",content:"# 功能类问题\n\n\n# 如何配置组件库按需引入？\n\n如果需要配置组件库的按需引入，可以通过 tools.babel 配置 babel-plugin-import 插件。\n\nexport default {\n  tools: {\n    babel: (config, { addPlugins }) => {\n      addPlugins([\n        [\n          'babel-plugin-import',\n          {\n            libraryName: 'xxx-components',\n            libraryDirectory: 'es',\n            style: true,\n          },\n        ],\n      ]);\n    },\n  },\n};\n\n\n\n# 如何在编译过程中进行 ESLint 代码校验？\n\n出于编译性能的考虑，Builder 默认不会在编译过程中进行 ESLint 校验，如果需要该功能，可以手动安装并注册社区中的 eslint-webpack-plugin。\n\n注册该插件的示例代码如下：\n\nimport ESLintPlugin from 'eslint-webpack-plugin';\n\nexport default {\n  tools: {\n    webpackChain(chain) {\n      chain.plugin('eslint-plugin').use(ESLintPlugin, [\n        {\n          extensions: ['.js', '.ts', '.jsx', 'tsx', '.mjs'],\n        },\n      ]);\n    },\n  },\n};\n\n\n> 更详细的用法请参考 eslint-webpack-plugin 文档。\n\n\n# 如何配置静态资源的 CDN 路径？\n\n如果需要将 JS、CSS 等静态资源上传到 CDN 使用，那么可以通过 output.assetPrefix 配置来设置静态资源的 URL 前缀。\n\nexport default {\n  output: {\n    assetPrefix: 'https://cdn.example.com/assets/',\n  },\n};\n\n\n\n# 如何清空 webpack 编译缓存？\n\n默认情况下，Builder 的 webpack 编译缓存生成在 ./node_modules/.cache/webpack 目录下。\n\n如果需要清空本地的编译缓存，可以执行以下命令：\n\nrm -rf ./node_modules/.cache\n\n\n\n# 如何移除代码中的 console？\n\n在生产环境构建时，我们可以移除代码中的 console，从而避免开发环境的日志被输出到生产环境。\n\nBuilder 默认提供了移除 console 的配置项，请查看 performance.removeConsole。",normalizedContent:"# 功能类问题\n\n\n# 如何配置组件库按需引入？\n\n如果需要配置组件库的按需引入，可以通过 tools.babel 配置 babel-plugin-import 插件。\n\nexport default {\n  tools: {\n    babel: (config, { addplugins }) => {\n      addplugins([\n        [\n          'babel-plugin-import',\n          {\n            libraryname: 'xxx-components',\n            librarydirectory: 'es',\n            style: true,\n          },\n        ],\n      ]);\n    },\n  },\n};\n\n\n\n# 如何在编译过程中进行 eslint 代码校验？\n\n出于编译性能的考虑，builder 默认不会在编译过程中进行 eslint 校验，如果需要该功能，可以手动安装并注册社区中的 eslint-webpack-plugin。\n\n注册该插件的示例代码如下：\n\nimport eslintplugin from 'eslint-webpack-plugin';\n\nexport default {\n  tools: {\n    webpackchain(chain) {\n      chain.plugin('eslint-plugin').use(eslintplugin, [\n        {\n          extensions: ['.js', '.ts', '.jsx', 'tsx', '.mjs'],\n        },\n      ]);\n    },\n  },\n};\n\n\n> 更详细的用法请参考 eslint-webpack-plugin 文档。\n\n\n# 如何配置静态资源的 cdn 路径？\n\n如果需要将 js、css 等静态资源上传到 cdn 使用，那么可以通过 output.assetprefix 配置来设置静态资源的 url 前缀。\n\nexport default {\n  output: {\n    assetprefix: 'https://cdn.example.com/assets/',\n  },\n};\n\n\n\n# 如何清空 webpack 编译缓存？\n\n默认情况下，builder 的 webpack 编译缓存生成在 ./node_modules/.cache/webpack 目录下。\n\n如果需要清空本地的编译缓存，可以执行以下命令：\n\nrm -rf ./node_modules/.cache\n\n\n\n# 如何移除代码中的 console？\n\n在生产环境构建时，我们可以移除代码中的 console，从而避免开发环境的日志被输出到生产环境。\n\nbuilder 默认提供了移除 console 的配置项，请查看 performance.removeconsole。",charsets:{cjk:!0}},{title:"通用类问题",frontmatter:{},regularPath:"/zh/guide/faq/general.html",relativePath:"zh/guide/faq/general.md",key:"v-c2df693c",path:"/zh/guide/faq/general.html",headers:[{level:2,title:"Modern.js Builder 和 Modern.js 的关系？",slug:"modern-js-builder-和-modern-js-的关系",normalizedTitle:"modern.js builder 和 modern.js 的关系？",charIndex:12},{level:2,title:"Builder 能否用于构建工具库或组件库？",slug:"builder-能否用于构建工具库或组件库",normalizedTitle:"builder 能否用于构建工具库或组件库？",charIndex:225},{level:2,title:"Builder 是否会接入 Turbopack？",slug:"builder-是否会接入-turbopack",normalizedTitle:"builder 是否会接入 turbopack？",charIndex:345},{level:2,title:"Builder 是否会接入 Vite？",slug:"builder-是否会接入-vite",normalizedTitle:"builder 是否会接入 vite？",charIndex:525}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"Modern.js Builder 和 Modern.js 的关系？ Builder 能否用于构建工具库或组件库？ Builder 是否会接入 Turbopack？ Builder 是否会接入 Vite？",content:"# 通用类问题\n\n\n# Modern.js Builder 和 Modern.js 的关系？\n\nModern.js 2.0 的构建能力是基于 Modern.js Builder 实现的。\n\n在开发 Modern.js 2.0 的过程中，我们把 Builder 作为独立的模块进行设计，并明确划分 Builder 与 Modern.js 的职责界限。 因此，Builder 可以脱离 Modern.js 框架使用，被单独应用于其他框架或场景。\n\n\n# Builder 能否用于构建工具库或组件库？\n\nBuilder 专注于解决 Web 应用构建场景，我们不推荐你使用 Builder 来构建工具库或组件库。\n\n如果需要构建工具库或组件库，推荐使用 Modern.js 模块工程方案。\n\n\n# Builder 是否会接入 Turbopack？\n\n尽管 Builder 已经在对接 rspack，对于 webpack 的继任者 —— Turbopack，我们也会持续关注它后续的发展情况。\n\n目前 Turbopack 仅支持在 Next.js 中使用，当 Turbopack 支持独立使用，并且完成度和社区生态达到一定水平时，我们会考虑进行接入。\n\n\n# Builder 是否会接入 Vite？\n\nVite 是一个非常优秀的工具，但 Builder 的目标是使用 Rust Bundler 替换 webpack，Rust Builder 能提供极致的编译速度，同时能保持开发环境和生产环境的打包行为一致。\n\nBuilder 会聚焦于从 webpack 演进至 Rust Builder 的过程，因此不会接入 Vite。",normalizedContent:"# 通用类问题\n\n\n# modern.js builder 和 modern.js 的关系？\n\nmodern.js 2.0 的构建能力是基于 modern.js builder 实现的。\n\n在开发 modern.js 2.0 的过程中，我们把 builder 作为独立的模块进行设计，并明确划分 builder 与 modern.js 的职责界限。 因此，builder 可以脱离 modern.js 框架使用，被单独应用于其他框架或场景。\n\n\n# builder 能否用于构建工具库或组件库？\n\nbuilder 专注于解决 web 应用构建场景，我们不推荐你使用 builder 来构建工具库或组件库。\n\n如果需要构建工具库或组件库，推荐使用 modern.js 模块工程方案。\n\n\n# builder 是否会接入 turbopack？\n\n尽管 builder 已经在对接 rspack，对于 webpack 的继任者 —— turbopack，我们也会持续关注它后续的发展情况。\n\n目前 turbopack 仅支持在 next.js 中使用，当 turbopack 支持独立使用，并且完成度和社区生态达到一定水平时，我们会考虑进行接入。\n\n\n# builder 是否会接入 vite？\n\nvite 是一个非常优秀的工具，但 builder 的目标是使用 rust bundler 替换 webpack，rust builder 能提供极致的编译速度，同时能保持开发环境和生产环境的打包行为一致。\n\nbuilder 会聚焦于从 webpack 演进至 rust builder 的过程，因此不会接入 vite。",charsets:{cjk:!0}},{title:"功能导航",frontmatter:{},regularPath:"/zh/guide/features.html",relativePath:"zh/guide/features.md",key:"v-6076e08c",path:"/zh/guide/features.html",headers:[{level:2,title:"JavaScript 编译",slug:"javascript-编译",normalizedTitle:"javascript 编译",charIndex:50},{level:2,title:"CSS 编译",slug:"css-编译",normalizedTitle:"css 编译",charIndex:1626},{level:2,title:"HTML 编译",slug:"html-编译",normalizedTitle:"html 编译",charIndex:3020},{level:2,title:"开发调试相关",slug:"开发调试相关",normalizedTitle:"开发调试相关",charIndex:4020},{level:2,title:"React 相关",slug:"react-相关",normalizedTitle:"react 相关",charIndex:4240},{level:2,title:"静态资源相关",slug:"静态资源相关",normalizedTitle:"静态资源相关",charIndex:4494},{level:2,title:"性能相关",slug:"性能相关",normalizedTitle:"性能相关",charIndex:5075}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"JavaScript 编译 CSS 编译 HTML 编译 开发调试相关 React 相关 静态资源相关 性能相关",content:"# 功能导航\n\n在这里，你可以了解到 Modern.js Builder 支持的主要功能。\n\n\n# JavaScript 编译\n\n功能              描述                                                    相关链接\nBabel 编译        默认开启 Babel 编译，将 JavaScript 和 TypeScript 代码转换为向后兼容的     * tools.babel\n                JavaScript 语法\nTS 编译           默认通过 Babel 编译 TS 文件，支持切换为 ts-loader 编译                 * TypeScript 转译\n                                                                       * tools.babel\n                                                                       * tools.tsLoader\nTS 类型检查         默认通过 TS Checker 检查类型问题                                 * 类型检查\n                                                                       * tools.tsChecker\nJS 压缩           默认在生产环境构建时开启压缩                                         * tools.terser\nPolyfill        默认会注入 core-js 等 Polyfill                               * output.polyfill\nSourceMap 生成    默认在生产环境构建时生成高质量 SourceMap                              * output.disableSourceMap\n文件别名            可选功能，通过 alias 设置文件别名                                   * 路径别名\n                                                                       * source.alias\n限制源代码路径         可选功能，限制源代码的引用路径                                        * source.moduleScopes\nesbuild 编译      可选功能，通过 esbuild 对 JavaScript 和 TypeScript 代码进行转译和压缩    * esbuild 插件\nSWC 编译          可选功能，通过 SWC 对 JavaScript 和 TypeScript 代码进行转译和压缩        * SWC 插件\nNode 产物         可选功能，支持构建出运行在 Node.js 环境的 JavaScript 产物                * Node 产物\nWeb Worker 产物   可选功能，支持构建出运行在 Web Worker 环境的 JavaScript 产物             * Web Worker 产物\n浏览器范围           可选功能，通过 browserslist 来设置 Web 应用需要兼容的浏览器范围              * 浏览器范围\n\n\n# CSS 编译\n\n功能                  描述                                      相关链接\nPostCSS 编译          默认开启 PostCSS 编译，内置 autoprefixer 等多个插件    * 引用样式资源\n                                                             * tools.postcss\n                                                             * tools.autoprefixer\nSass 预处理            默认支持编译 .scss 和 .sass 文件                  * 引用样式资源\n                                                             * tools.sass\nLess 预处理            默认支持编译 .less 文件                          * 引用样式资源\n                                                             * tools.less\nCSS Modules 编译      默认支持编译 CSS Modules 文件                    * 使用 CSS Modules\n                                                             * tools.cssLoader\nCSS Modules 类型提示    可选功能，自动生成 CSS Modules 的类型定义文件            * 使用 CSS Modules\n                                                             * enableCssModuleTSDeclaration\nCSS 压缩              默认在生产环境构建时开启压缩                           * 引用样式资源\n                                                             * tools.minifyCss\n抽取 CSS 文件           默认会将 CSS 抽取为独立的文件                        * tools.cssExtract\nStyled Components   默认支持 styled-components 编译                * tools.styledComponents\n内联 CSS 到 JS 中       可选功能，将 CSS 文件内联到 JS 文件中                  * 引用样式资源\n                                                             * output.disableCssExtract\n\n\n# HTML 编译\n\n功能            描述                       相关链接\n设置标题          设置 HTML 的 title 标签        * 设置页面标题\n                                        * html.title\n                                        * html.titleByEntries\n设置 meta       设置 HTML 的 meta 标签         * 设置 meta 标签\n                                        * html.meta\n                                        * html.metaByEntries\n设置 favicon    设置页面的 favicon 图标          * 设置页面图标\n                                        * html.favicon\n                                        * html.faviconByEntries\n设置 app 图标     设置 iOS 系统下的 apple icon    * 设置页面图标\n                                        * html.appIcon\n使用 EJS 模板引擎   可选功能，使用 EJS 模板语法          * 模板引擎 - EJS\n使用 Pug 模板引擎   可选功能，使用 Pug 模板语法          * 模板引擎 - Pug\n内联 JS 文件      可选功能，将 JS 内联到 HTML 中      * 静态资源内联\n                                        * output.enableInlineScripts\n内联 CSS 文件     可选功能，将 CSS 内联到 HTML 中     * 静态资源内联\n                                        * output.enableInlineStyles\n\n\n# 开发调试相关\n\n功能                 描述                                     相关链接\n自动打开页面             可选功能，在启动 Dev Server 时自动在浏览器中打开页面 URL    * dev.startUrl\nHTTPS Dev Server   可选功能，开启 Dev Server 对 HTTPS 的支持          * dev.https\n\n\n# React 相关\n\n功能               描述                           相关链接\nReact Refresh    默认支持 React Refresh 热更新        * dev.hmr\nSVG 转 React 组件   默认支持在 React 组件中引用 SVG 作为组件    * 引用 SVG 资源\n                                               * output.svgDefaultExport\n\n\n# 静态资源相关\n\n功能               描述                             相关链接\n引用图片资源           支持在代码中引用图片资源                    * 引用静态资源\n引用字体资源           支持在代码中引用字体资源                    * 引用静态资源\n引用视频资源           支持在代码中引用视频资源                    * 引用静态资源\n静态资源内联           默认将体积较小的图片等资源内联到 JS 中           * 静态资源内联\n                                                 * output.dataUriLimit\n清理静态资源           每次开始构建前，自动清理 dist 目录下的静态资源      * output.cleanDistPath\n拷贝静态资源           可选功能，将静态资源拷贝到 dist 目录下          * output.copy\n生成 manifest 文件   可选功能，生成包含静态资源信息的 manifest 文件    * output.enableAssetManifest\n\n\n# 性能相关\n\n功能                描述                                    相关链接\n产物自动拆包            Builder 中内置了多种拆包策略，自动将代码包拆分为体积适中的文件    * 拆包最佳实践\n                                                         * performance.chunkSplit\n展示产物体积            在生产环境构建后，默认展示所有静态资源的体积信息               * performance.printFileSize\n分析产物体积            可选功能，通过 Bundle Analyzer 分析产物体积         * performance.bundleAnalyze\n移除 console        可选功能，移除代码中的 console.xx                 * performance.removeConsole\n优化 moment.js 体积   可选功能，移除 moment.js 多余的 locale 文件        * performance.removeMomentLocale",normalizedContent:"# 功能导航\n\n在这里，你可以了解到 modern.js builder 支持的主要功能。\n\n\n# javascript 编译\n\n功能              描述                                                    相关链接\nbabel 编译        默认开启 babel 编译，将 javascript 和 typescript 代码转换为向后兼容的     * tools.babel\n                javascript 语法\nts 编译           默认通过 babel 编译 ts 文件，支持切换为 ts-loader 编译                 * typescript 转译\n                                                                       * tools.babel\n                                                                       * tools.tsloader\nts 类型检查         默认通过 ts checker 检查类型问题                                 * 类型检查\n                                                                       * tools.tschecker\njs 压缩           默认在生产环境构建时开启压缩                                         * tools.terser\npolyfill        默认会注入 core-js 等 polyfill                               * output.polyfill\nsourcemap 生成    默认在生产环境构建时生成高质量 sourcemap                              * output.disablesourcemap\n文件别名            可选功能，通过 alias 设置文件别名                                   * 路径别名\n                                                                       * source.alias\n限制源代码路径         可选功能，限制源代码的引用路径                                        * source.modulescopes\nesbuild 编译      可选功能，通过 esbuild 对 javascript 和 typescript 代码进行转译和压缩    * esbuild 插件\nswc 编译          可选功能，通过 swc 对 javascript 和 typescript 代码进行转译和压缩        * swc 插件\nnode 产物         可选功能，支持构建出运行在 node.js 环境的 javascript 产物                * node 产物\nweb worker 产物   可选功能，支持构建出运行在 web worker 环境的 javascript 产物             * web worker 产物\n浏览器范围           可选功能，通过 browserslist 来设置 web 应用需要兼容的浏览器范围              * 浏览器范围\n\n\n# css 编译\n\n功能                  描述                                      相关链接\npostcss 编译          默认开启 postcss 编译，内置 autoprefixer 等多个插件    * 引用样式资源\n                                                             * tools.postcss\n                                                             * tools.autoprefixer\nsass 预处理            默认支持编译 .scss 和 .sass 文件                  * 引用样式资源\n                                                             * tools.sass\nless 预处理            默认支持编译 .less 文件                          * 引用样式资源\n                                                             * tools.less\ncss modules 编译      默认支持编译 css modules 文件                    * 使用 css modules\n                                                             * tools.cssloader\ncss modules 类型提示    可选功能，自动生成 css modules 的类型定义文件            * 使用 css modules\n                                                             * enablecssmoduletsdeclaration\ncss 压缩              默认在生产环境构建时开启压缩                           * 引用样式资源\n                                                             * tools.minifycss\n抽取 css 文件           默认会将 css 抽取为独立的文件                        * tools.cssextract\nstyled components   默认支持 styled-components 编译                * tools.styledcomponents\n内联 css 到 js 中       可选功能，将 css 文件内联到 js 文件中                  * 引用样式资源\n                                                             * output.disablecssextract\n\n\n# html 编译\n\n功能            描述                       相关链接\n设置标题          设置 html 的 title 标签        * 设置页面标题\n                                        * html.title\n                                        * html.titlebyentries\n设置 meta       设置 html 的 meta 标签         * 设置 meta 标签\n                                        * html.meta\n                                        * html.metabyentries\n设置 favicon    设置页面的 favicon 图标          * 设置页面图标\n                                        * html.favicon\n                                        * html.faviconbyentries\n设置 app 图标     设置 ios 系统下的 apple icon    * 设置页面图标\n                                        * html.appicon\n使用 ejs 模板引擎   可选功能，使用 ejs 模板语法          * 模板引擎 - ejs\n使用 pug 模板引擎   可选功能，使用 pug 模板语法          * 模板引擎 - pug\n内联 js 文件      可选功能，将 js 内联到 html 中      * 静态资源内联\n                                        * output.enableinlinescripts\n内联 css 文件     可选功能，将 css 内联到 html 中     * 静态资源内联\n                                        * output.enableinlinestyles\n\n\n# 开发调试相关\n\n功能                 描述                                     相关链接\n自动打开页面             可选功能，在启动 dev server 时自动在浏览器中打开页面 url    * dev.starturl\nhttps dev server   可选功能，开启 dev server 对 https 的支持          * dev.https\n\n\n# react 相关\n\n功能               描述                           相关链接\nreact refresh    默认支持 react refresh 热更新        * dev.hmr\nsvg 转 react 组件   默认支持在 react 组件中引用 svg 作为组件    * 引用 svg 资源\n                                               * output.svgdefaultexport\n\n\n# 静态资源相关\n\n功能               描述                             相关链接\n引用图片资源           支持在代码中引用图片资源                    * 引用静态资源\n引用字体资源           支持在代码中引用字体资源                    * 引用静态资源\n引用视频资源           支持在代码中引用视频资源                    * 引用静态资源\n静态资源内联           默认将体积较小的图片等资源内联到 js 中           * 静态资源内联\n                                                 * output.dataurilimit\n清理静态资源           每次开始构建前，自动清理 dist 目录下的静态资源      * output.cleandistpath\n拷贝静态资源           可选功能，将静态资源拷贝到 dist 目录下          * output.copy\n生成 manifest 文件   可选功能，生成包含静态资源信息的 manifest 文件    * output.enableassetmanifest\n\n\n# 性能相关\n\n功能                描述                                    相关链接\n产物自动拆包            builder 中内置了多种拆包策略，自动将代码包拆分为体积适中的文件    * 拆包最佳实践\n                                                         * performance.chunksplit\n展示产物体积            在生产环境构建后，默认展示所有静态资源的体积信息               * performance.printfilesize\n分析产物体积            可选功能，通过 bundle analyzer 分析产物体积         * performance.bundleanalyze\n移除 console        可选功能，移除代码中的 console.xx                 * performance.removeconsole\n优化 moment.js 体积   可选功能，移除 moment.js 多余的 locale 文件        * performance.removemomentlocale",charsets:{cjk:!0}},{title:"名词解释",frontmatter:{},regularPath:"/zh/guide/glossary.html",relativePath:"zh/guide/glossary.md",key:"v-3f1bddec",path:"/zh/guide/glossary.html",headers:[{level:2,title:"Bundler",slug:"bundler",normalizedTitle:"bundler",charIndex:11},{level:2,title:"Rspack",slug:"rspack",normalizedTitle:"rspack",charIndex:196},{level:2,title:"Builder",slug:"builder",normalizedTitle:"builder",charIndex:543},{level:2,title:"Builder Provider",slug:"builder-provider",normalizedTitle:"builder provider",charIndex:799},{level:2,title:"Modern.js",slug:"modern-js",normalizedTitle:"modern.js",charIndex:1031},{level:2,title:"EdenX",slug:"edenx",normalizedTitle:"edenx",charIndex:1157}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"Bundler Rspack Builder Builder Provider Modern.js EdenX",content:"# 名词解释\n\n\n# Bundler\n\n指 webpack、turbopack、rspack 等模块打包工具。\n\n打包工具的主要目标是将 JavaScript、CSS 等文件打包在一起，打包后的文件可以在浏览器、Node.js 等环境中使用。当 Bundler 处理 Web 应用时，它会构建一个依赖关系图，其中包含应用需要的各个模块，然后将所有模块打包成一个或多个 bundle。\n\n\n# Rspack\n\n字节跳动 Web Infra 团队自研的 Rust Bundler，核心架构对齐 webpack 实现，并对社区常用的构建能力做了开箱即用的支持。从长期来看，rspack 会对齐 webpack 的主要 API，兼容主流的 webpack loader 与 plugin 生态，以保证开发者可以平滑地从 webpack 迁移到 rspack。\n\nRspack 通过以下方式来提升编译性能：\n\n * 高度 LTO 优化的 Native code。\n * 充分利用多核优势，整个编译过程充分进行多线程优化。\n * 基于请求的按需编译（Lazy Compilation），减小每次编译的模块数目，以提升冷启动的速度。\n\nTIP\n\nRspack 目前仍在研发过程中，尚未开源。\n\n\n# Builder\n\nBuilder 可以翻译为「构建引擎」，Builder 的目标是「复用构建工具的最佳实践」。\n\n因为 webpack 等 Bundler 是比较底层的，如果我们基于 webpack 来构建一个项目，需要充分理解 webpack 的各个配置项和三方插件，并进行大量的配置组装和性能调优等工作。\n\nBuilder 比 Bundler 的封装程度更高，默认集成代码转换、代码压缩等能力。通过接入 Builder，可以快速获得构建现代 Web 应用的能力。\n\nBuilder 内部的分层如下：\n\n\n# Builder Provider\n\nBuilder Provider 是 Builder 的组成部分之一，Provider 基于特定 bundler 实现了对应的构建能力。\n\n目前 Builder 提供了两个 Provider：\n\n * @modern-js/builder-webpack-provider：底层基于 webpack 来实现。\n * @modern-js/builder-rspack-provider：底层基于 rspack 来实现。\n\n\n# Modern.js\n\n现代 Web 工程方案。\n\nModern.js 由字节跳动 Web Infra 团队开源，提供了一系列现代 Web 开发的最佳工程实践，如前后端一体化、约定式路由、构建方案、样式方案等。\n\nModern.js 官网地址。\n\n\n# EdenX\n\n字节跳动内部的 Web 工程方案，基于 Modern.js 实现。",normalizedContent:"# 名词解释\n\n\n# bundler\n\n指 webpack、turbopack、rspack 等模块打包工具。\n\n打包工具的主要目标是将 javascript、css 等文件打包在一起，打包后的文件可以在浏览器、node.js 等环境中使用。当 bundler 处理 web 应用时，它会构建一个依赖关系图，其中包含应用需要的各个模块，然后将所有模块打包成一个或多个 bundle。\n\n\n# rspack\n\n字节跳动 web infra 团队自研的 rust bundler，核心架构对齐 webpack 实现，并对社区常用的构建能力做了开箱即用的支持。从长期来看，rspack 会对齐 webpack 的主要 api，兼容主流的 webpack loader 与 plugin 生态，以保证开发者可以平滑地从 webpack 迁移到 rspack。\n\nrspack 通过以下方式来提升编译性能：\n\n * 高度 lto 优化的 native code。\n * 充分利用多核优势，整个编译过程充分进行多线程优化。\n * 基于请求的按需编译（lazy compilation），减小每次编译的模块数目，以提升冷启动的速度。\n\ntip\n\nrspack 目前仍在研发过程中，尚未开源。\n\n\n# builder\n\nbuilder 可以翻译为「构建引擎」，builder 的目标是「复用构建工具的最佳实践」。\n\n因为 webpack 等 bundler 是比较底层的，如果我们基于 webpack 来构建一个项目，需要充分理解 webpack 的各个配置项和三方插件，并进行大量的配置组装和性能调优等工作。\n\nbuilder 比 bundler 的封装程度更高，默认集成代码转换、代码压缩等能力。通过接入 builder，可以快速获得构建现代 web 应用的能力。\n\nbuilder 内部的分层如下：\n\n\n# builder provider\n\nbuilder provider 是 builder 的组成部分之一，provider 基于特定 bundler 实现了对应的构建能力。\n\n目前 builder 提供了两个 provider：\n\n * @modern-js/builder-webpack-provider：底层基于 webpack 来实现。\n * @modern-js/builder-rspack-provider：底层基于 rspack 来实现。\n\n\n# modern.js\n\n现代 web 工程方案。\n\nmodern.js 由字节跳动 web infra 团队开源，提供了一系列现代 web 开发的最佳工程实践，如前后端一体化、约定式路由、构建方案、样式方案等。\n\nmodern.js 官网地址。\n\n\n# edenx\n\n字节跳动内部的 web 工程方案，基于 modern.js 实现。",charsets:{cjk:!0}},{title:"介绍",frontmatter:{},regularPath:"/zh/guide/introduction.html",relativePath:"zh/guide/introduction.md",key:"v-3e0f736c",path:"/zh/guide/introduction.html",headers:[{level:2,title:"Rust 化",slug:"rust-化",normalizedTitle:"rust 化",charIndex:240},{level:2,title:"定位",slug:"定位",normalizedTitle:"定位",charIndex:641},{level:2,title:"特性",slug:"特性",normalizedTitle:"特性",charIndex:971},{level:2,title:"npm 包",slug:"npm-包",normalizedTitle:"npm 包",charIndex:1912},{level:2,title:"下一步",slug:"下一步",normalizedTitle:"下一步",charIndex:2676}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"Rust 化 定位 特性 npm 包 下一步",content:"# 介绍\n\nModern.js Builder 是一个面向现代 Web 开发场景的构建引擎。\n\n随着前端生态的发展，社区中出现了多样化的编译工具和插件。对于大部分开发者来说，构建一个 Web 应用所需的配置和依赖已变得十分复杂。在追求最佳实践的过程中，开发者需要付出的成本也在不断上升。\n\n为了减少构建的复杂性，降低上手门槛，我们基于 Modern.js 在 Web 应用构建方面的实践经验，抽象其中的构建能力，打造出 Modern.js Builder 这个开源工具。\n\n\n# Rust 化\n\n近年来，前端工具链的发展趋势是使用 Rust 等编程语言重新实现 —— 以获得更好的性能表现。社区中出现 SWC、esbuild、Turbopack 等高性能工具，并且应用领域在逐步扩宽。但这些 Rust 工具与 JavaScript 工具之间存在较多差异，包括功能不完整、配置不一致等，导致使用者需要承担一定的迁移成本。\n\n前端工具链 Rust 化的进程还会持续较长一段时间，Modern.js Builder 期望能帮助开发者更好地过渡到 Rust 工具。不管是 JavaScript 工具，还是 Rust 工具，甚至是 webpack 等底层 bundler，在 Modern.js Builder 中都是可替换的零部件。你可以通过开启配置或启用插件的方式，对这些零部件进行渐进式替换，Modern.js Builder 会抹平其中的主要差异，帮助使用者进行低成本迁移。\n\n\n# 定位\n\nModern.js Builder (简称 Builder) 的定位是服务于上层框架的构建引擎，它专注于解决 Web 应用构建面临的各类问题，期望能为前端框架提供开箱即用的构建能力。\n\n如果你正在开发一个前端框架，或是开发一个前端应用的脚手架，那么 Builder 可以为你完成前端框架中大部分与构建有关的逻辑，让你能够聚焦于实现框架的其他功能。\n\n如果你是一名业务开发者，大部分情况下，你不需要在业务项目中手动接入 Builder，我们推荐你直接使用一些基于 Builder 的上层框架。\n\n目前已经接入 Builder 的前端框架有：\n\n * 开源的 Modern.js 2.0 框架。\n * 字节跳动内部的 EdenX、PIA 等框架。\n\n\n# 特性\n\n\n# 支持多种打包工具\n\n在架构上，Builder 支持多种打包工具，使用者可以根据自身需求来使用不同的打包工具。\n\n默认情况下，Builder 使用 webpack 5 作为打包工具，尽管 webpack 的编译速度不是很理想，但它依然是社区中功能最完整、生态最丰富的打包工具。Builder 在 webpack 的基础上，集成了 babel、postcss、terser 等工具进行代码转义和压缩。Builder 也支持替换部分编译能力为原生工具来提升编译速度，比如将 babel/terser 替换为 swc 或 esbuild。\n\n除了 webpack 打包，Builder 也正在对接字节跳动 Web Infra 团队自研的 Rust Bundler —— rspack，以提供更快的编译速度。\n\n目前，Builder 基于 webpack 的构建已经成熟可用，基于 rspack 的构建仍在开发过程中，敬请期待。\n\n关于 Turbopack\n\n尽管 Builder 已经在对接 rspack，对于 webpack 的继任者 —— Turbopack，我们也会持续关注它后续的发展情况。\n\n目前 Turbopack 仅支持在 Next.js 中使用，当 Turbopack 支持独立使用，并且完成度和社区生态达到一定水平时，我们会考虑进行接入。\n\n\n# 深度优化构建产物\n\nBuilder 充分利用 webpack 生态内的各种优化手段，保证生产环境的产物性能得到深度优化，并在稳定性上提供保障。\n\n以拆包场景为例，webpack 原生的 splitChunks 配置较为复杂，Builder 将其封装为开箱即用的 performance.chunkSplit 配置项，默认将常见的三方库拆分为体积适中的 chunk，使页面加载速度达到最优状态。\n\n\n# 易于扩展的插件系统\n\nBuilder 提供丰富的配置项和可插拔的插件系统，支持对各项能力进行扩展和定制。\n\n对于 Builder 来说，所有的构建能力都是通过插件来实现的：\n\n * 大部分插件较为轻量，被内置在 Builder 内部，开发者可以通过配置项来控制启用。\n * 少部分插件较为复杂，被外置为独立 npm 包，开发者可以按需进行安装和使用。\n\nBuilder 也支持自定义插件，因此框架开发者可以开发自定义的插件，实现定制化的构建需求。\n\n\n# npm 包\n\nBuilder 已发布的 npm 包有：\n\n包名                                         版本   描述\n@modern-js/builder                              Builder 核心包\n@modern-js/builder-webpack-provider             提供 webpack 构建能力\n@modern-js/builder-rspack-provider              提供 rspack 构建能力\n@modern-js/builder-plugin-swc                   SWC 插件\n@modern-js/builder-plugin-esbuild               Esbuild 插件\n@modern-js/builder-plugin-node-polyfill         Node Polyfill 插件\n@modern-js/builder-plugin-image-compress        Image Compress 插件\n@modern-js/builder-shared                       Builder 内部的公共模块\n@modern-js/builder-doc                          提供可复用的文档片段\n\n你可以在 modern.js 仓库的 packages/builder 目录下查看这些包的源代码。\n\n\n# 下一步\n\n你可能想要：",normalizedContent:"# 介绍\n\nmodern.js builder 是一个面向现代 web 开发场景的构建引擎。\n\n随着前端生态的发展，社区中出现了多样化的编译工具和插件。对于大部分开发者来说，构建一个 web 应用所需的配置和依赖已变得十分复杂。在追求最佳实践的过程中，开发者需要付出的成本也在不断上升。\n\n为了减少构建的复杂性，降低上手门槛，我们基于 modern.js 在 web 应用构建方面的实践经验，抽象其中的构建能力，打造出 modern.js builder 这个开源工具。\n\n\n# rust 化\n\n近年来，前端工具链的发展趋势是使用 rust 等编程语言重新实现 —— 以获得更好的性能表现。社区中出现 swc、esbuild、turbopack 等高性能工具，并且应用领域在逐步扩宽。但这些 rust 工具与 javascript 工具之间存在较多差异，包括功能不完整、配置不一致等，导致使用者需要承担一定的迁移成本。\n\n前端工具链 rust 化的进程还会持续较长一段时间，modern.js builder 期望能帮助开发者更好地过渡到 rust 工具。不管是 javascript 工具，还是 rust 工具，甚至是 webpack 等底层 bundler，在 modern.js builder 中都是可替换的零部件。你可以通过开启配置或启用插件的方式，对这些零部件进行渐进式替换，modern.js builder 会抹平其中的主要差异，帮助使用者进行低成本迁移。\n\n\n# 定位\n\nmodern.js builder (简称 builder) 的定位是服务于上层框架的构建引擎，它专注于解决 web 应用构建面临的各类问题，期望能为前端框架提供开箱即用的构建能力。\n\n如果你正在开发一个前端框架，或是开发一个前端应用的脚手架，那么 builder 可以为你完成前端框架中大部分与构建有关的逻辑，让你能够聚焦于实现框架的其他功能。\n\n如果你是一名业务开发者，大部分情况下，你不需要在业务项目中手动接入 builder，我们推荐你直接使用一些基于 builder 的上层框架。\n\n目前已经接入 builder 的前端框架有：\n\n * 开源的 modern.js 2.0 框架。\n * 字节跳动内部的 edenx、pia 等框架。\n\n\n# 特性\n\n\n# 支持多种打包工具\n\n在架构上，builder 支持多种打包工具，使用者可以根据自身需求来使用不同的打包工具。\n\n默认情况下，builder 使用 webpack 5 作为打包工具，尽管 webpack 的编译速度不是很理想，但它依然是社区中功能最完整、生态最丰富的打包工具。builder 在 webpack 的基础上，集成了 babel、postcss、terser 等工具进行代码转义和压缩。builder 也支持替换部分编译能力为原生工具来提升编译速度，比如将 babel/terser 替换为 swc 或 esbuild。\n\n除了 webpack 打包，builder 也正在对接字节跳动 web infra 团队自研的 rust bundler —— rspack，以提供更快的编译速度。\n\n目前，builder 基于 webpack 的构建已经成熟可用，基于 rspack 的构建仍在开发过程中，敬请期待。\n\n关于 turbopack\n\n尽管 builder 已经在对接 rspack，对于 webpack 的继任者 —— turbopack，我们也会持续关注它后续的发展情况。\n\n目前 turbopack 仅支持在 next.js 中使用，当 turbopack 支持独立使用，并且完成度和社区生态达到一定水平时，我们会考虑进行接入。\n\n\n# 深度优化构建产物\n\nbuilder 充分利用 webpack 生态内的各种优化手段，保证生产环境的产物性能得到深度优化，并在稳定性上提供保障。\n\n以拆包场景为例，webpack 原生的 splitchunks 配置较为复杂，builder 将其封装为开箱即用的 performance.chunksplit 配置项，默认将常见的三方库拆分为体积适中的 chunk，使页面加载速度达到最优状态。\n\n\n# 易于扩展的插件系统\n\nbuilder 提供丰富的配置项和可插拔的插件系统，支持对各项能力进行扩展和定制。\n\n对于 builder 来说，所有的构建能力都是通过插件来实现的：\n\n * 大部分插件较为轻量，被内置在 builder 内部，开发者可以通过配置项来控制启用。\n * 少部分插件较为复杂，被外置为独立 npm 包，开发者可以按需进行安装和使用。\n\nbuilder 也支持自定义插件，因此框架开发者可以开发自定义的插件，实现定制化的构建需求。\n\n\n# npm 包\n\nbuilder 已发布的 npm 包有：\n\n包名                                         版本   描述\n@modern-js/builder                              builder 核心包\n@modern-js/builder-webpack-provider             提供 webpack 构建能力\n@modern-js/builder-rspack-provider              提供 rspack 构建能力\n@modern-js/builder-plugin-swc                   swc 插件\n@modern-js/builder-plugin-esbuild               esbuild 插件\n@modern-js/builder-plugin-node-polyfill         node polyfill 插件\n@modern-js/builder-plugin-image-compress        image compress 插件\n@modern-js/builder-shared                       builder 内部的公共模块\n@modern-js/builder-doc                          提供可复用的文档片段\n\n你可以在 modern.js 仓库的 packages/builder 目录下查看这些包的源代码。\n\n\n# 下一步\n\n你可能想要：",charsets:{cjk:!0}},{title:"提升构建性能",frontmatter:{},regularPath:"/zh/guide/optimization/build-performance.html",relativePath:"zh/guide/optimization/build-performance.md",key:"v-04d8f7e8",path:"/zh/guide/optimization/build-performance.html",headers:[{level:2,title:"通用优化策略",slug:"通用优化策略",normalizedTitle:"通用优化策略",charIndex:180},{level:2,title:"开发环境优化策略",slug:"开发环境优化策略",normalizedTitle:"开发环境优化策略",charIndex:1320},{level:2,title:"生产环境优化策略",slug:"生产环境优化策略",normalizedTitle:"生产环境优化策略",charIndex:2578}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"通用优化策略 开发环境优化策略 生产环境优化策略",content:'# 提升构建性能\n\nModern.js Builder 默认对构建性能进行了充分优化，但是随着业务场景变复杂、项目代码量变大，你可能会遇到一些构建性能的问题。\n\n本文档提供了一些可选的提速策略，开发者可以根据实际场景选取其中的部分策略，从而进一步提升构建速度。\n\n📢 注意\n\n在优化产物体积一文中介绍的策略也可以用于提升构建性能，这里不再重复介绍。\n\n\n# 通用优化策略\n\n以下是一些通用的优化策略，对开发环境和生产环境均有提速效果，其中部分策略对包体积也有优化。\n\n\n# 升级 Node.js 版本\n\n通常来说，将 Node.js 更新到最新的 LTS 版本，有助于提升构建性能。\n\n尤其是对于 Apple M1/M2 芯片的机型，推荐使用 Node 16 或 Node 18 进行构建。\n\nNode 16 默认提供了 Apple Silicon binaries，因此在 M1/M2 机型上性能会比 Node 14 有大幅度提升。根据我们的测试，从 Node 14 切换到 Node 16 后，编译速度可以提升 100% 以上。\n\n你可以通过以下步骤来切换到 Node 16：\n\n# 安装 Node.js v16\nnvm install 16\n\n# 切换到 Node 16\nnvm use 16\n\n# 将 Node 16 设置为默认版本\nnvm default 16\n\n# 查看 Node 版本\nnode -v\n\n\n\n# 使用 SWC 或 esbuild 编译\n\nSWC (Speedy Web Compiler) 是基于 Rust 语言编写的高性能 JavaScript 和 TypeScript 转译和压缩工具。在 Polyfill 和语法降级方面可以和 Babel 提供一致的能力，并且性能比 Babel 高出一个数量级。\n\nesbuild 是一款基于 Golang 开发的前端构建工具，具有打包、编译和压缩 JavaScript 代码的功能，相比传统的打包编译工具，esbuild 在性能上有显著提升。\n\nBuilder 提供了 SWC 插件和 esbuild 插件，让你能使用 SWC 或 esbuild 代替 babel-loader、ts-loader 和 terser 等库进行代码编译和压缩。详见：\n\n * SWC 插件文档\n * esbuild 插件文档\n\nSWC vs esbuild\n\nSWC 编译产物的兼容性较好，支持注入 core-js 等 Polyfill，并且功能更加完备，因此推荐优先使用 SWC 插件。\n\n\n# 避免使用 ts-loader\n\n默认情况下，Builder 使用 Babel 编译 TS 文件，开启 tools.tsLoader 选项后，会使用 ts-loader 编译 TS 文件。\n\n由于 ts-loader 需要进行额外的语法解析和类型检查，因此会导致项目构建速度变慢，请避免使用。\n\nexport default {\n  tools: {\n    // 移除这项配置\n    tsLoader: {},\n  },\n};\n\n\n详见 tools.tsLoader 文档。\n\n\n# 开发环境优化策略\n\n以下是针对开发环境进行提速的策略。\n\n\n# 开启延迟编译\n\n你可以开启延迟编译（即按需编译）功能，来提升编译启动速度。\n\nexport default {\n  experiments: {\n    lazyCompilation: {\n      imports: true,\n      entries: false,\n    },\n  },\n};\n\n\n这是一项实验性功能，在某些场景下可能无法正确工作，请查看 experiments.lazyCompilation 来了解具体用法。\n\n\n# 调整 Source Map 格式\n\n为了提供良好的调试体验，Builder 在开发环境下默认使用 cheap-module-source-map 格式 Source Map，这是一种高质量的 Source Map 格式，会带来一定的性能开销。\n\n你可以通过调整开发环境的 Source Map 格式来提升构建速度。\n\n比如禁用 Source Map：\n\nexport default {\n  tools: {\n    webpackChain(chain, { env }) {\n      if (env === \'development\') {\n        chain.devtool(false);\n      }\n    },\n  },\n};\n\n\n或是把开发环境的 Source Map 格式设置为开销最小的 eval 格式：\n\nexport default {\n  tools: {\n    webpackChain(chain, { env }) {\n      if (env === \'development\') {\n        chain.devtool(\'eval\');\n      }\n    },\n  },\n};\n\n\n> 关于不同 Source Map 格式之间的详细差异，请查看 webpack - devtool。\n\n\n# 调整 Browserslist 范围\n\n这项优化的原理与「提升 Browserslist 范围」类似，区别在于，我们可以为开发环境和生产环境设置不同的 browserslist，从而减少开发环境下的编译开销。\n\n比如，你可以在 package.json 中添加以下配置，表示在开发环境下只兼容最新的浏览器，在生产环境下兼容实际需要的浏览器：\n\n{\n  "browserslist": {\n    "production": [">0.2%", "not dead", "not op_mini all"],\n    "development": [\n      "last 1 chrome version",\n      "last 1 firefox version",\n      "last 1 safari version"\n    ]\n  }\n}\n\n\n注意，这项优化策略会导致开发环境与生产环境的构建产物存在一定差异。\n\n\n# 生产环境优化策略\n\n以下是针对生产环境进行提速的策略。\n\n\n# 禁用 Source Map\n\n如果项目在生产环境下不需要 Source Map，可以通过 disableSourceMap 配置项关闭，从而提升 build 构建的速度。\n\nexport default {\n  output: {\n    disableSourceMap: true,\n  },\n};\n\n\n详见 output.disableSourceMap。',normalizedContent:'# 提升构建性能\n\nmodern.js builder 默认对构建性能进行了充分优化，但是随着业务场景变复杂、项目代码量变大，你可能会遇到一些构建性能的问题。\n\n本文档提供了一些可选的提速策略，开发者可以根据实际场景选取其中的部分策略，从而进一步提升构建速度。\n\n📢 注意\n\n在优化产物体积一文中介绍的策略也可以用于提升构建性能，这里不再重复介绍。\n\n\n# 通用优化策略\n\n以下是一些通用的优化策略，对开发环境和生产环境均有提速效果，其中部分策略对包体积也有优化。\n\n\n# 升级 node.js 版本\n\n通常来说，将 node.js 更新到最新的 lts 版本，有助于提升构建性能。\n\n尤其是对于 apple m1/m2 芯片的机型，推荐使用 node 16 或 node 18 进行构建。\n\nnode 16 默认提供了 apple silicon binaries，因此在 m1/m2 机型上性能会比 node 14 有大幅度提升。根据我们的测试，从 node 14 切换到 node 16 后，编译速度可以提升 100% 以上。\n\n你可以通过以下步骤来切换到 node 16：\n\n# 安装 node.js v16\nnvm install 16\n\n# 切换到 node 16\nnvm use 16\n\n# 将 node 16 设置为默认版本\nnvm default 16\n\n# 查看 node 版本\nnode -v\n\n\n\n# 使用 swc 或 esbuild 编译\n\nswc (speedy web compiler) 是基于 rust 语言编写的高性能 javascript 和 typescript 转译和压缩工具。在 polyfill 和语法降级方面可以和 babel 提供一致的能力，并且性能比 babel 高出一个数量级。\n\nesbuild 是一款基于 golang 开发的前端构建工具，具有打包、编译和压缩 javascript 代码的功能，相比传统的打包编译工具，esbuild 在性能上有显著提升。\n\nbuilder 提供了 swc 插件和 esbuild 插件，让你能使用 swc 或 esbuild 代替 babel-loader、ts-loader 和 terser 等库进行代码编译和压缩。详见：\n\n * swc 插件文档\n * esbuild 插件文档\n\nswc vs esbuild\n\nswc 编译产物的兼容性较好，支持注入 core-js 等 polyfill，并且功能更加完备，因此推荐优先使用 swc 插件。\n\n\n# 避免使用 ts-loader\n\n默认情况下，builder 使用 babel 编译 ts 文件，开启 tools.tsloader 选项后，会使用 ts-loader 编译 ts 文件。\n\n由于 ts-loader 需要进行额外的语法解析和类型检查，因此会导致项目构建速度变慢，请避免使用。\n\nexport default {\n  tools: {\n    // 移除这项配置\n    tsloader: {},\n  },\n};\n\n\n详见 tools.tsloader 文档。\n\n\n# 开发环境优化策略\n\n以下是针对开发环境进行提速的策略。\n\n\n# 开启延迟编译\n\n你可以开启延迟编译（即按需编译）功能，来提升编译启动速度。\n\nexport default {\n  experiments: {\n    lazycompilation: {\n      imports: true,\n      entries: false,\n    },\n  },\n};\n\n\n这是一项实验性功能，在某些场景下可能无法正确工作，请查看 experiments.lazycompilation 来了解具体用法。\n\n\n# 调整 source map 格式\n\n为了提供良好的调试体验，builder 在开发环境下默认使用 cheap-module-source-map 格式 source map，这是一种高质量的 source map 格式，会带来一定的性能开销。\n\n你可以通过调整开发环境的 source map 格式来提升构建速度。\n\n比如禁用 source map：\n\nexport default {\n  tools: {\n    webpackchain(chain, { env }) {\n      if (env === \'development\') {\n        chain.devtool(false);\n      }\n    },\n  },\n};\n\n\n或是把开发环境的 source map 格式设置为开销最小的 eval 格式：\n\nexport default {\n  tools: {\n    webpackchain(chain, { env }) {\n      if (env === \'development\') {\n        chain.devtool(\'eval\');\n      }\n    },\n  },\n};\n\n\n> 关于不同 source map 格式之间的详细差异，请查看 webpack - devtool。\n\n\n# 调整 browserslist 范围\n\n这项优化的原理与「提升 browserslist 范围」类似，区别在于，我们可以为开发环境和生产环境设置不同的 browserslist，从而减少开发环境下的编译开销。\n\n比如，你可以在 package.json 中添加以下配置，表示在开发环境下只兼容最新的浏览器，在生产环境下兼容实际需要的浏览器：\n\n{\n  "browserslist": {\n    "production": [">0.2%", "not dead", "not op_mini all"],\n    "development": [\n      "last 1 chrome version",\n      "last 1 firefox version",\n      "last 1 safari version"\n    ]\n  }\n}\n\n\n注意，这项优化策略会导致开发环境与生产环境的构建产物存在一定差异。\n\n\n# 生产环境优化策略\n\n以下是针对生产环境进行提速的策略。\n\n\n# 禁用 source map\n\n如果项目在生产环境下不需要 source map，可以通过 disablesourcemap 配置项关闭，从而提升 build 构建的速度。\n\nexport default {\n  output: {\n    disablesourcemap: true,\n  },\n};\n\n\n详见 output.disablesourcemap。',charsets:{cjk:!0}},{title:"静态资源内联",frontmatter:{},regularPath:"/zh/guide/optimization/inline-assets.html",relativePath:"zh/guide/optimization/inline-assets.md",key:"v-7bb93a4c",path:"/zh/guide/optimization/inline-assets.html",headers:[{level:2,title:"自动内联",slug:"自动内联",normalizedTitle:"自动内联",charIndex:190},{level:2,title:"强制内联",slug:"强制内联",normalizedTitle:"强制内联",charIndex:232},{level:2,title:"强制不内联",slug:"强制不内联",normalizedTitle:"强制不内联",charIndex:238},{level:2,title:"内联 JS 文件",slug:"内联-js-文件",normalizedTitle:"内联 js 文件",charIndex:1750},{level:2,title:"内联 CSS 文件",slug:"内联-css-文件",normalizedTitle:"内联 css 文件",charIndex:2021},{level:2,title:"添加类型声明",slug:"添加类型声明",normalizedTitle:"添加类型声明",charIndex:2214}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"自动内联 强制内联 强制不内联 内联 JS 文件 内联 CSS 文件 添加类型声明",content:"# 静态资源内联\n\n静态资源内联是一种优化网页性能的方法，它指的是将静态资源直接内联到 HTML 或 JS 文件中，而不是使用外部文件引用的方式。这样做的好处是减少了浏览器发起的请求数，从而提高页面的加载速度。\n\n不过，静态资源内联也有一些缺点，比如增加了单个文件的体积，可能会导致加载变慢。所以在实际应用中，需要根据具体情况来决定是否使用静态资源内联。\n\nBuilder 默认会自动内联体积小于 10KB 的静态资源，但有时候你可能需要手动控制某些特殊资源，让其强制内联或者强制不内联，这篇文档阐述了如何进行精确地控制静态资源内联行为。\n\n\n# 自动内联\n\n默认情况下，当图片、字体、媒体等类型的文件体积小于阈值（默认为 10KB）时，Builder 会将资源进行内联处理，资源内联后，会被转换成一个 Base64 编码的字符串，不再会发送独立的 HTTP 请求。当文件体积大于或等于该阈值时，则会被作为单独的资源文件，通过独立的 HTTP 请求来加载。\n\n自动内联的体积阈值可以通过 output.dataUriLimit 配置项修改。例如，修改图片资源的阈值为 5000 字节，设置视频资源不内联：\n\nexport default {\n  output: {\n    dataUriLimit: {\n      image: 5000,\n      media: Infinite,\n    },\n  },\n};\n\n\n\n# 强制内联\n\n你可以通过在引入资源时添加 inline URL 参数来强制内联该资源，无论该资源的体积是否小于阈值。\n\nimport React from 'react';\nimport img from './foo.png?inline';\n\nexport default function Foo() {\n  return <img src={img} />;\n}\n\n\n在上面这个例子中，foo.png 图片将始终被内联，无论该图片的大小是否大于阈值。\n\n除了 inline 参数以外，你也可以使用 __inline 参数来强制内联该资源：\n\nimport img from './foo.png?__inline';\n\n\n\n# 从 CSS 文件中引用\n\n当你在 CSS 文件中引用静态资源时，同样可以通过 inline 或 __inline 参数来强制内联资源。\n\n.foo {\n  background-image: url('./icon.png?inline');\n}\n\n\n你真的需要强制内联吗？\n\n内联体积过大的资源时，会显著增加页面的白屏时间或首次可交互时间，这会损害用户体验。并且当你将一个静态资源多次内联到 CSS 文件中时，base64 内容会重复注入，导致产物体积增大。因此，请酌情使用强制内联。\n\n\n# 强制不内联\n\n当你想把一些资源始终作为单独的资源文件来处理，无论该资源的体积多小时，你可以添加 url URL 参数来强制不内联该资源。\n\nimport React from 'react';\nimport img from './foo.png?url';\n\nexport default function Foo() {\n  return <img src={img} />;\n}\n\n\n在上面这个例子中，foo.png 图片将始终通过单独的资源文件加载，无论该图片的大小是否小于阈值。\n\n除了 url 参数以外，你也可以使用 __inline=false 参数来强制不内联该资源：\n\nimport img from './foo.png?__inline=false';\n\n\n\n# 从 CSS 文件中引用\n\n当你在 CSS 文件中引用静态资源时，同样可以通过 url 或 __inline=false 参数来强制不内联资源。\n\n.foo {\n  background-image: url('./icon.png?url');\n}\n\n\n你真的需要把资源排除内联吗？\n\n将资源排除内联将增加 Web App 需要加载的资源数量，这对于弱网环境，或是未开启 HTTP2 的场景下，将会降低资源加载效率，因此，请酌情使用强制不内联。\n\n\n# 内联 JS 文件\n\n除了将静态资源文件内联到 JS 文件里，Builder 也支持将 JS 文件内联到 HTML 文件中。\n\n只需要开启 output.enableInlineScripts 配置项，构建生成的 JS 文件将不会被写入产物目录下，而是会直接内联到对应的 HTML 文件中。\n\nexport default {\n  output: {\n    enableInlineScripts: true,\n  },\n};\n\n\nTIP\n\n内联 JS 文件可能会导致 HTML 单文件体积过大，并且不利于静态资源缓存，请酌情使用。\n\n\n# 内联 CSS 文件\n\n你也可以将 CSS 文件内联到 HTML 文件中。\n\n只需要开启 output.enableInlineStyles 配置项，构建生成的 CSS 文件将不会被写入产物目录下，而是会直接内联到对应的 HTML 文件中。\n\nexport default {\n  output: {\n    enableInlineStyles: true,\n  },\n};\n\n\n\n# 添加类型声明\n\n当你在 TypeScript 代码中使用 ?inline 和 ?url 等 URL 参数时，TypeScript 可能会提示该模块缺少类型定义：\n\nTS2307: Cannot find module './logo.png?inline' or its corresponding type declarations.\n\n\n此时你需要为这些 URL 参数添加类型声明，请在项目中创建 src/global.d.ts 文件，并添加以下类型声明：\n\ndeclare module '*?inline' {\n  const content: string;\n  export default content;\n}\n\ndeclare module '*?inline' {\n  const content: string;\n  export default content;\n}\n\ndeclare module '*?__inline' {\n  const content: string;\n  export default content;\n}\n\ndeclare module '*?inline=false' {\n  const content: string;\n  export default content;\n}\n",normalizedContent:"# 静态资源内联\n\n静态资源内联是一种优化网页性能的方法，它指的是将静态资源直接内联到 html 或 js 文件中，而不是使用外部文件引用的方式。这样做的好处是减少了浏览器发起的请求数，从而提高页面的加载速度。\n\n不过，静态资源内联也有一些缺点，比如增加了单个文件的体积，可能会导致加载变慢。所以在实际应用中，需要根据具体情况来决定是否使用静态资源内联。\n\nbuilder 默认会自动内联体积小于 10kb 的静态资源，但有时候你可能需要手动控制某些特殊资源，让其强制内联或者强制不内联，这篇文档阐述了如何进行精确地控制静态资源内联行为。\n\n\n# 自动内联\n\n默认情况下，当图片、字体、媒体等类型的文件体积小于阈值（默认为 10kb）时，builder 会将资源进行内联处理，资源内联后，会被转换成一个 base64 编码的字符串，不再会发送独立的 http 请求。当文件体积大于或等于该阈值时，则会被作为单独的资源文件，通过独立的 http 请求来加载。\n\n自动内联的体积阈值可以通过 output.dataurilimit 配置项修改。例如，修改图片资源的阈值为 5000 字节，设置视频资源不内联：\n\nexport default {\n  output: {\n    dataurilimit: {\n      image: 5000,\n      media: infinite,\n    },\n  },\n};\n\n\n\n# 强制内联\n\n你可以通过在引入资源时添加 inline url 参数来强制内联该资源，无论该资源的体积是否小于阈值。\n\nimport react from 'react';\nimport img from './foo.png?inline';\n\nexport default function foo() {\n  return <img src={img} />;\n}\n\n\n在上面这个例子中，foo.png 图片将始终被内联，无论该图片的大小是否大于阈值。\n\n除了 inline 参数以外，你也可以使用 __inline 参数来强制内联该资源：\n\nimport img from './foo.png?__inline';\n\n\n\n# 从 css 文件中引用\n\n当你在 css 文件中引用静态资源时，同样可以通过 inline 或 __inline 参数来强制内联资源。\n\n.foo {\n  background-image: url('./icon.png?inline');\n}\n\n\n你真的需要强制内联吗？\n\n内联体积过大的资源时，会显著增加页面的白屏时间或首次可交互时间，这会损害用户体验。并且当你将一个静态资源多次内联到 css 文件中时，base64 内容会重复注入，导致产物体积增大。因此，请酌情使用强制内联。\n\n\n# 强制不内联\n\n当你想把一些资源始终作为单独的资源文件来处理，无论该资源的体积多小时，你可以添加 url url 参数来强制不内联该资源。\n\nimport react from 'react';\nimport img from './foo.png?url';\n\nexport default function foo() {\n  return <img src={img} />;\n}\n\n\n在上面这个例子中，foo.png 图片将始终通过单独的资源文件加载，无论该图片的大小是否小于阈值。\n\n除了 url 参数以外，你也可以使用 __inline=false 参数来强制不内联该资源：\n\nimport img from './foo.png?__inline=false';\n\n\n\n# 从 css 文件中引用\n\n当你在 css 文件中引用静态资源时，同样可以通过 url 或 __inline=false 参数来强制不内联资源。\n\n.foo {\n  background-image: url('./icon.png?url');\n}\n\n\n你真的需要把资源排除内联吗？\n\n将资源排除内联将增加 web app 需要加载的资源数量，这对于弱网环境，或是未开启 http2 的场景下，将会降低资源加载效率，因此，请酌情使用强制不内联。\n\n\n# 内联 js 文件\n\n除了将静态资源文件内联到 js 文件里，builder 也支持将 js 文件内联到 html 文件中。\n\n只需要开启 output.enableinlinescripts 配置项，构建生成的 js 文件将不会被写入产物目录下，而是会直接内联到对应的 html 文件中。\n\nexport default {\n  output: {\n    enableinlinescripts: true,\n  },\n};\n\n\ntip\n\n内联 js 文件可能会导致 html 单文件体积过大，并且不利于静态资源缓存，请酌情使用。\n\n\n# 内联 css 文件\n\n你也可以将 css 文件内联到 html 文件中。\n\n只需要开启 output.enableinlinestyles 配置项，构建生成的 css 文件将不会被写入产物目录下，而是会直接内联到对应的 html 文件中。\n\nexport default {\n  output: {\n    enableinlinestyles: true,\n  },\n};\n\n\n\n# 添加类型声明\n\n当你在 typescript 代码中使用 ?inline 和 ?url 等 url 参数时，typescript 可能会提示该模块缺少类型定义：\n\nts2307: cannot find module './logo.png?inline' or its corresponding type declarations.\n\n\n此时你需要为这些 url 参数添加类型声明，请在项目中创建 src/global.d.ts 文件，并添加以下类型声明：\n\ndeclare module '*?inline' {\n  const content: string;\n  export default content;\n}\n\ndeclare module '*?inline' {\n  const content: string;\n  export default content;\n}\n\ndeclare module '*?__inline' {\n  const content: string;\n  export default content;\n}\n\ndeclare module '*?inline=false' {\n  const content: string;\n  export default content;\n}\n",charsets:{cjk:!0}},{title:"产物体积优化",frontmatter:{},regularPath:"/zh/guide/optimization/optimize-bundle.html",relativePath:"zh/guide/optimization/optimize-bundle.md",key:"v-eeaadaa8",path:"/zh/guide/optimization/optimize-bundle.html",headers:[{level:2,title:"减少重复依赖",slug:"减少重复依赖",normalizedTitle:"减少重复依赖",charIndex:89},{level:2,title:"使用更轻量的库",slug:"使用更轻量的库",normalizedTitle:"使用更轻量的库",charIndex:366},{level:2,title:"提升 Browserslist 范围",slug:"提升-browserslist-范围",normalizedTitle:"提升 browserslist 范围",charIndex:600},{level:2,title:"按需引入 Polyfill",slug:"按需引入-polyfill",normalizedTitle:"按需引入 polyfill",charIndex:875},{level:2,title:"使用图片压缩",slug:"使用图片压缩",normalizedTitle:"使用图片压缩",charIndex:1090},{level:2,title:"代码拆包",slug:"代码拆包",normalizedTitle:"代码拆包",charIndex:1373}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"减少重复依赖 使用更轻量的库 提升 Browserslist 范围 按需引入 Polyfill 使用图片压缩 代码拆包",content:"# 产物体积优化\n\n产物体积的优化在生产环境中是非常重要的，因为它直接影响到了线上的用户体验。在这篇文档中，我们将介绍在 Builder 中一些常见的产物体积优化方式。\n\n\n# 减少重复依赖\n\n在业务项目中，会存在某些第三方依赖被安装了多个版本的现象。重复依赖会导致包体积变大、构建速度变慢。\n\n我们可以通过社区中的一些工具来检测或消除重复依赖。\n\n如果你在使用 pnpm，可以使用 pnpm-deduplicate 来分析出所有的重复依赖，并通过升级依赖或声明 pnpm overrides 进行版本合并。\n\nnpx pnpm-deduplicate --list\n\n\n如果你在使用 yarn，可以使用 yarn-deduplicate 来自动合并重复依赖：\n\nnpx yarn-deduplicate && yarn\n\n\n\n# 使用更轻量的库\n\n建议将项目中体积较大的三方库替换为更轻量的库，比如将 moment 替换为 day.js。\n\n如果你需要找出项目中体积较大的三方库，可以在执行构建时添加 BUNDLE_ANALYZE=true 环境变量：\n\nBUNDLE_ANALYZE=true pnpm build\n\n\n添加该参数后，Builder 会生成一个分析构建产物体积的 HTML 文件，手动在浏览器中打开该文件，可以看到打包产物的瓦片图。区块的面积越大，说明该模块的体积越大。\n\n\n# 提升 Browserslist 范围\n\nBuilder 会根据项目的 Browserslist 配置范围进行代码编译，并注入相应的 Polyfill。如果项目不需要兼容旧版浏览器，可以根据实际情况来提升 Browserslist 范围，从而减少在语法和 Polyfill 上的编译开销。\n\nBuilder 默认的 Browserslist 配置为：\n\n['> 0.01%', 'not dead', 'not op_mini all'];\n\n\n比如只兼容 Chrome 61 以上的浏览器，可以改成：\n\n['Chrome >= 61'];\n\n\n\n# 按需引入 Polyfill\n\n在明确第三方依赖不需要额外 Polyfill 的情况下，你可以将 output.polyfill 设置为 usage。\n\n在 usage 模式下，Builder 会分析源代码中使用的语法，按需注入所需的 Polyfill 代码，从而减少 Polyfill 的代码量。\n\nexport default {\n  output: {\n    polyfill: 'usage',\n  },\n};\n\n\n\n# 使用图片压缩\n\n在一般的前端项目中，图片资源的体积往往是项目产物体积的大头，因此如果能尽可能精简图片的体积，那么将会对项目的打包产物体积起到明显的优化效果。你可以在 Builder 中注册插件来启用图片压缩功能:\n\nimport { PluginImageCompress } from '@modern-js/builder-plugin-image-compress';\n\n// 往 builder 实例上添加插件\nbuilder.addPlugins([PluginImageCompress()]);\n\n\n详见 Image Compress 插件。\n\n\n# 代码拆包\n\n良好的拆包策略对于提升应用的加载性能是十分重要的，可以充分利用浏览器的缓存机制，减少请求数量，加快页面加载速度。\n\n在 Builder 中内置了多种拆包策略，可以满足大部分应用的需求，你也可以根据自己的业务场景，自定义拆包配置，比如下面的配置:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-experience',\n      forceSplitting: {\n        // 比如将 react-query 包拆分为一个 Chunk\n        react_query: [/node_modules\\/react-query/],\n      },\n    },\n  },\n};\n",normalizedContent:"# 产物体积优化\n\n产物体积的优化在生产环境中是非常重要的，因为它直接影响到了线上的用户体验。在这篇文档中，我们将介绍在 builder 中一些常见的产物体积优化方式。\n\n\n# 减少重复依赖\n\n在业务项目中，会存在某些第三方依赖被安装了多个版本的现象。重复依赖会导致包体积变大、构建速度变慢。\n\n我们可以通过社区中的一些工具来检测或消除重复依赖。\n\n如果你在使用 pnpm，可以使用 pnpm-deduplicate 来分析出所有的重复依赖，并通过升级依赖或声明 pnpm overrides 进行版本合并。\n\nnpx pnpm-deduplicate --list\n\n\n如果你在使用 yarn，可以使用 yarn-deduplicate 来自动合并重复依赖：\n\nnpx yarn-deduplicate && yarn\n\n\n\n# 使用更轻量的库\n\n建议将项目中体积较大的三方库替换为更轻量的库，比如将 moment 替换为 day.js。\n\n如果你需要找出项目中体积较大的三方库，可以在执行构建时添加 bundle_analyze=true 环境变量：\n\nbundle_analyze=true pnpm build\n\n\n添加该参数后，builder 会生成一个分析构建产物体积的 html 文件，手动在浏览器中打开该文件，可以看到打包产物的瓦片图。区块的面积越大，说明该模块的体积越大。\n\n\n# 提升 browserslist 范围\n\nbuilder 会根据项目的 browserslist 配置范围进行代码编译，并注入相应的 polyfill。如果项目不需要兼容旧版浏览器，可以根据实际情况来提升 browserslist 范围，从而减少在语法和 polyfill 上的编译开销。\n\nbuilder 默认的 browserslist 配置为：\n\n['> 0.01%', 'not dead', 'not op_mini all'];\n\n\n比如只兼容 chrome 61 以上的浏览器，可以改成：\n\n['chrome >= 61'];\n\n\n\n# 按需引入 polyfill\n\n在明确第三方依赖不需要额外 polyfill 的情况下，你可以将 output.polyfill 设置为 usage。\n\n在 usage 模式下，builder 会分析源代码中使用的语法，按需注入所需的 polyfill 代码，从而减少 polyfill 的代码量。\n\nexport default {\n  output: {\n    polyfill: 'usage',\n  },\n};\n\n\n\n# 使用图片压缩\n\n在一般的前端项目中，图片资源的体积往往是项目产物体积的大头，因此如果能尽可能精简图片的体积，那么将会对项目的打包产物体积起到明显的优化效果。你可以在 builder 中注册插件来启用图片压缩功能:\n\nimport { pluginimagecompress } from '@modern-js/builder-plugin-image-compress';\n\n// 往 builder 实例上添加插件\nbuilder.addplugins([pluginimagecompress()]);\n\n\n详见 image compress 插件。\n\n\n# 代码拆包\n\n良好的拆包策略对于提升应用的加载性能是十分重要的，可以充分利用浏览器的缓存机制，减少请求数量，加快页面加载速度。\n\n在 builder 中内置了多种拆包策略，可以满足大部分应用的需求，你也可以根据自己的业务场景，自定义拆包配置，比如下面的配置:\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'split-by-experience',\n      forcesplitting: {\n        // 比如将 react-query 包拆分为一个 chunk\n        react_query: [/node_modules\\/react-query/],\n      },\n    },\n  },\n};\n",charsets:{cjk:!0}},{title:"拆包最佳实践",frontmatter:{},regularPath:"/zh/guide/optimization/split-chunk.html",relativePath:"zh/guide/optimization/split-chunk.md",key:"v-64ccadac",path:"/zh/guide/optimization/split-chunk.html",headers:[{level:2,title:"拆包策略",slug:"拆包策略",normalizedTitle:"拆包策略",charIndex:13},{level:2,title:"自定义拆包",slug:"自定义拆包",normalizedTitle:"自定义拆包",charIndex:116}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"拆包策略 自定义拆包",content:"# 拆包最佳实践\n\n良好的拆包策略对于提升应用的加载性能是十分重要的，可以充分利用浏览器的缓存机制，减少请求数量，加快页面加载速度。\n\n在 Builder 中内置了多种拆包策略，可以满足大部分应用的需求，你也可以根据自己的业务场景，自定义拆包配置。\n\n\n# 拆包策略\n\n> Builder 的拆包配置集中在 performance.chunkSplit 中。\n\nBuilder 中包括如下的拆包策略：\n\n * split-by-experience: 根据经验内置拆分策略（由 Builder 根据经验制定的拆分策略）。\n * split-by-module: 根据模块进行拆分，每一个 NPM 包就是一个 chunk。\n * all-in-one: 业务代码和第三方代码都在一个 chunk 中。\n * single-vendor: 第三方代码在一个 vendor chunk 中。\n * split-by-size: 根据模块大小进行拆分。\n\n\n# split-by-experience\n\n# 分包策略\n\n根据以往的经验，内置的拆分组包括：\n\n * React (react, react-dom)\n * Router (react-router, react-router-dom, history)\n * Polyfill (core-js, @babel/runtime)\n * Semi (@ies/semi, @douyinfe/semi-ui)\n * Arco (@arco-design/web-react)\n * Lodash (lodash, lodash-es)\n\n这种拆包策略将常用的包进行分组，然后拆分为单独的 Chunk，一般 Chunk 的数量不会很多，适合绝大部分应用，同时也是我们推荐的拆包策略。\n\n# 配置\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-experience',\n    },\n  },\n};\n\n\n\n# split-by-module\n\n# 分包策略\n\n将每一个 NPM 包拆分为一个 Chunk。\n\n注意\n\n这样会最细化地拆分 node_modules，同时在 HTTP/2 下因为多路复用会加快资源的加载时间，不过在非 HTTP/2 的环境下因为 HTTP 队头阻塞问题需要慎用。\n\n# 配置\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-module',\n    },\n  },\n};\n\n\n\n# all-in-one\n\n# 分包策略\n\n此分包策略将业务代码、第三方依赖打包在同一个 Chunk 中。\n\n# 配置\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'all-in-one',\n    },\n  },\n};\n\n\n\n# single-vendor\n\n# 分包策略\n\n此分包策略将第三方依赖打包在一个 Chunk 中，业务代码打包在另外的 Chunk 中。\n\n# 配置\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'single-vendor',\n    },\n  },\n};\n\n\n\n# split-by-size\n\n# 分包策略\n\n该策略下，设置 minSize、maxSize 为一个固定值后，Webpack 会自动进行拆分，无需干预。\n\n# 配置\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-size',\n      minSize: 30000,\n      maxSize: 50000,\n    },\n  },\n};\n\n\n\n# 自定义拆包\n\n除了使用内置的拆包策略外，你也可以通过 Builder 自定义拆包功能来满足更多的定制化需求。自定义拆包分为两部分:\n\n * 自定义拆包分组\n * 自定义原生 webpack 拆包配置\n\n值得注意的是，这两种自定义拆包能力可以和内置的拆包策略一起使用，也就是说，你可以使用内置的拆包策略来拆分常用的包，然后再使用自定义拆包功能来拆分其他的包。\n\n\n# 自定义分组\n\nBuilder 支持自定义拆包分组，这样比内置拆包策略更灵活，同时比手写 webpack 配置更简单。比如:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-experience',\n      forceSplitting: {\n        // 将 lodash 拆分为一个 Chunk\n        lodash: [/node_modules\\/lodash/, /node_modules\\/lodash-es/],\n      },\n    }\n  }\n}\n\n\n通过 forceSplitting 配置，你可以很方便把某些包拆分为一个 Chunk。\n\n\n# 自定义 webpack 拆包配置\n\n除了使用自定义分组外，你还可以通过 override 配置项来自定义原生 webpack 拆包配置，比如:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-experience',\n      override: {\n        chunks: 'all',\n        minSize: 30000,\n      }\n    }\n  }\n}\n\n\n其中 override 中的配置会和 webpack 的配置进行合并，具体配置项请参考 webpack 官方文档。",normalizedContent:"# 拆包最佳实践\n\n良好的拆包策略对于提升应用的加载性能是十分重要的，可以充分利用浏览器的缓存机制，减少请求数量，加快页面加载速度。\n\n在 builder 中内置了多种拆包策略，可以满足大部分应用的需求，你也可以根据自己的业务场景，自定义拆包配置。\n\n\n# 拆包策略\n\n> builder 的拆包配置集中在 performance.chunksplit 中。\n\nbuilder 中包括如下的拆包策略：\n\n * split-by-experience: 根据经验内置拆分策略（由 builder 根据经验制定的拆分策略）。\n * split-by-module: 根据模块进行拆分，每一个 npm 包就是一个 chunk。\n * all-in-one: 业务代码和第三方代码都在一个 chunk 中。\n * single-vendor: 第三方代码在一个 vendor chunk 中。\n * split-by-size: 根据模块大小进行拆分。\n\n\n# split-by-experience\n\n# 分包策略\n\n根据以往的经验，内置的拆分组包括：\n\n * react (react, react-dom)\n * router (react-router, react-router-dom, history)\n * polyfill (core-js, @babel/runtime)\n * semi (@ies/semi, @douyinfe/semi-ui)\n * arco (@arco-design/web-react)\n * lodash (lodash, lodash-es)\n\n这种拆包策略将常用的包进行分组，然后拆分为单独的 chunk，一般 chunk 的数量不会很多，适合绝大部分应用，同时也是我们推荐的拆包策略。\n\n# 配置\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'split-by-experience',\n    },\n  },\n};\n\n\n\n# split-by-module\n\n# 分包策略\n\n将每一个 npm 包拆分为一个 chunk。\n\n注意\n\n这样会最细化地拆分 node_modules，同时在 http/2 下因为多路复用会加快资源的加载时间，不过在非 http/2 的环境下因为 http 队头阻塞问题需要慎用。\n\n# 配置\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'split-by-module',\n    },\n  },\n};\n\n\n\n# all-in-one\n\n# 分包策略\n\n此分包策略将业务代码、第三方依赖打包在同一个 chunk 中。\n\n# 配置\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'all-in-one',\n    },\n  },\n};\n\n\n\n# single-vendor\n\n# 分包策略\n\n此分包策略将第三方依赖打包在一个 chunk 中，业务代码打包在另外的 chunk 中。\n\n# 配置\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'single-vendor',\n    },\n  },\n};\n\n\n\n# split-by-size\n\n# 分包策略\n\n该策略下，设置 minsize、maxsize 为一个固定值后，webpack 会自动进行拆分，无需干预。\n\n# 配置\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'split-by-size',\n      minsize: 30000,\n      maxsize: 50000,\n    },\n  },\n};\n\n\n\n# 自定义拆包\n\n除了使用内置的拆包策略外，你也可以通过 builder 自定义拆包功能来满足更多的定制化需求。自定义拆包分为两部分:\n\n * 自定义拆包分组\n * 自定义原生 webpack 拆包配置\n\n值得注意的是，这两种自定义拆包能力可以和内置的拆包策略一起使用，也就是说，你可以使用内置的拆包策略来拆分常用的包，然后再使用自定义拆包功能来拆分其他的包。\n\n\n# 自定义分组\n\nbuilder 支持自定义拆包分组，这样比内置拆包策略更灵活，同时比手写 webpack 配置更简单。比如:\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'split-by-experience',\n      forcesplitting: {\n        // 将 lodash 拆分为一个 chunk\n        lodash: [/node_modules\\/lodash/, /node_modules\\/lodash-es/],\n      },\n    }\n  }\n}\n\n\n通过 forcesplitting 配置，你可以很方便把某些包拆分为一个 chunk。\n\n\n# 自定义 webpack 拆包配置\n\n除了使用自定义分组外，你还可以通过 override 配置项来自定义原生 webpack 拆包配置，比如:\n\nexport default {\n  performance: {\n    chunksplit: {\n      strategy: 'split-by-experience',\n      override: {\n        chunks: 'all',\n        minsize: 30000,\n      }\n    }\n  }\n}\n\n\n其中 override 中的配置会和 webpack 的配置进行合并，具体配置项请参考 webpack 官方文档。",charsets:{cjk:!0}},{title:"总览",frontmatter:{},regularPath:"/zh/plugins/list.html",relativePath:"zh/plugins/list.md",key:"v-9b4b2228",path:"/zh/plugins/list.html",headers:[{level:2,title:"官方插件",slug:"官方插件",normalizedTitle:"官方插件",charIndex:9}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"官方插件",content:"# 总览\n\n\n# 官方插件\n\n * @modern-js/builder-plugin-swc：使用 SWC 进行代码编译和压缩以提升构建性能。\n * @modern-js/builder-plugin-esbuild：使用 esbuild 进行代码编译和压缩以提升构建性能。\n * @modern-js/builder-plugin-node-polyfill：注入 Node 核心模块在浏览器端的 Polyfills。\n * @modern-js/builder-plugin-image-compress：将项目中用到的图片资源进行压缩处理。\n\n你可以在 modern.js/packages/builder 目录下找到这些插件的源代码。",normalizedContent:"# 总览\n\n\n# 官方插件\n\n * @modern-js/builder-plugin-swc：使用 swc 进行代码编译和压缩以提升构建性能。\n * @modern-js/builder-plugin-esbuild：使用 esbuild 进行代码编译和压缩以提升构建性能。\n * @modern-js/builder-plugin-node-polyfill：注入 node 核心模块在浏览器端的 polyfills。\n * @modern-js/builder-plugin-image-compress：将项目中用到的图片资源进行压缩处理。\n\n你可以在 modern.js/packages/builder 目录下找到这些插件的源代码。",charsets:{cjk:!0}},{title:"Esbuild 插件",frontmatter:{},regularPath:"/zh/plugins/plugin-esbuild.html",relativePath:"zh/plugins/plugin-esbuild.md",key:"v-0f10356c",path:"/zh/plugins/plugin-esbuild.html",headers:[{level:2,title:"快速开始",slug:"快速开始",normalizedTitle:"快速开始",charIndex:334},{level:2,title:"配置",slug:"配置",normalizedTitle:"配置",charIndex:592},{level:2,title:"esbuild 局限性",slug:"esbuild-局限性",normalizedTitle:"esbuild 局限性",charIndex:2223}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"快速开始 配置 esbuild 局限性",content:"# Esbuild 插件\n\nesbuild 介绍\n\nesbuild 是一款基于 Golang 开发的前端构建工具，具有打包、编译和压缩 JavaScript 代码的功能，相比传统的打包编译工具，esbuild 在性能上有显著提升。在代码压缩方面，相比 webpack 内置的 terser 压缩器，esbuild 在性能上有数十倍的提升。\n\nBuilder 提供了 esbuild 插件，让你能使用 esbuild 代替 babel-loader、ts-loader 和 terser 等库进行代码编译和压缩。在大型工程中启用 esbuild 后，可以大幅度减少代码编译和压缩所需的时间，同时有效避免 OOM (heap out of memory) 问题。\n\n\n# 快速开始\n\n\n# 安装插件\n\n你可以通过如下的命令安装插件:\n\n# npm\nnpm install @modern-js/builder-plugin-esbuild -D\n\n# yarn\nyarn add @modern-js/builder-plugin-esbuild -D\n\n# pnpm\npnpm install @modern-js/builder-plugin-esbuild -D\n\n\n\n# 注册插件\n\n在 Modern.js / EdenX 等上层框架中，你可以通过 builderPlugins 配置项来注册 esbuild 插件：\n\nimport { PluginEsbuild } from '@modern-js/builder-plugin-esbuild';\n\nexport default {\n  builderPlugins: [PluginEsbuild()],\n};\n\n\n当你直接调用 Builder 的 Node API 时，可以通过 addPlugins 方法来注册 esbuild 插件：\n\nimport { PluginEsbuild } from '@modern-js/builder-plugin-esbuild';\n\n// 往 builder 实例上添加插件\nbuilder.addPlugins([PluginEsbuild()]);\n\n\n\n# 配置\n\n插件默认会开启代码转译和代码压缩的功能，你也可以通过配置来自定义插件的行为。\n\n\n# loader\n\n * Type:\n\ntype LoaderOptions = EsbuildLoaderOptions | false | undefined;\n\n\n * Default:\n\nconst defaultOptions = {\n  target: 'es2015',\n  charset: builderConfig.output.charset,\n};\n\n\n这个选项用于启用 JavaScript 和 TypeScript 的转译，启用时将会使用 esbuild-loader 替换 babel-loader 和 ts-loader。\n\n如果你需要修改转译参数，可以查看 esbuild-loader 文档。\n\n# 修改目标环境\n\n通过 target 选项来修改代码转译的目标环境。target 可以直接设置为 JavaScript 语言版本，比如 es6，es2020；也可以设置为若干个目标环境，每个目标环境都是一个环境名称后跟一个版本号，比如 ['chrome58', 'edge16' ,'firefox57']。target 字段的详细介绍可以参考 esbuild - target。\n\ntarget 支持设置为以下环境：\n\n * chrome\n * edge\n * firefox\n * ie\n * ios\n * node\n * opera\n * safari\n\nPluginEsbuild({\n  loader: {\n    target: 'chrome61',\n  },\n});\n\n\n# 关闭代码转译\n\n将 loader 设置为 false 来关闭 esbuild 代码转译，此时 Builder 会继续使用 Babel 来进行代码转译。\n\nPluginEsbuild({\n  loader: false,\n});\n\n\n\n# minimize\n\n * Type:\n\ntype MinimizeOptions = EsbuildMinifyOptions | false | undefined;\n\n\n * Default:\n\nconst defaultOptions = {\n  css: true,\n  target: 'es2015',\n};\n\n\n这个选项用于启用 JavaScript 和 CSS 的代码压缩。\n\n如果你需要修改压缩参数，可以查看 esbuild-loader 文档。\n\n# 修改目标环境\n\n通过 target 选项来修改代码压缩的目标环境。\n\nPluginEsbuild({\n  minimize: {\n    target: 'chrome61',\n  },\n});\n\n\n# 关闭代码压缩\n\n将 minimize 设置为 false 来关闭 esbuild 代码压缩，此时 Builder 会继续使用 Terser 进行代码压缩。\n\nPluginEsbuild({\n  minimize: false,\n});\n\n\n\n# esbuild 局限性\n\n虽然 esbuild 能给现有的 webpack 项目带来明显的构建性能提升，但这个工具在接入 Builder 时还存在一定的局限性，需要大家在接入的时候格外注意。\n\n\n# 兼容性\n\n使用 esbuild 进行代码转译时（即 loader 能力），esbuild 通常最低支持到 ES2015（即 ES6）语法，并且不具备自动注入 Polyfill 的能力。如果生产环境需要降级到 ES5 及以下的语法，建议使用 SWC 编译。\n\n你可以通过如下的配置指定目标语法版本:\n\nPluginEsbuild({\n  loader: {\n    target: 'es2015',\n  },\n});\n\n\n使用 esbuild 进行代码压缩时（即 minimize 能力），esbuild 可以在生产环境中进行压缩和混淆，通常最低支持到 ES2015 语法。\n\n如果设置压缩的 target 为 es5，需要保证所有代码已经被转义为 ES5 代码，否则会导致 esbuild 编译报错：Transforming 'xxx' to the configured target environment (\"es5\") is not supported yet。\n\n因此，对于生产环境需要兼容 ES5 及以下语法的项目，请谨慎开启 minimize 能力，建议使用 SWC 压缩。\n\n你可以通过如下的配置指定目标语法版本:\n\nPluginEsbuild({\n  minimize: {\n    target: 'es2015',\n  },\n});\n\n\n\n# 不支持 Babel 插件\n\n使用 esbuild 进行代码转译时，诸如 babel-plugin-import 等原有 Babel 插件的语法编译功能在开启 esbuild 后无法使用。并且由于 Builder 底层使用的是 esbuild 的 Transform API，因此不支持使用额外 esbuild 插件来进行自定义编译过程。\n\n如果你有 babel-plugin-import 等 Babel 插件相关诉求，可以使用 SWC 插件。\n\n\n# 产物体积\n\n使用 esbuild 压缩虽然带来了构建效率上的提升，但 esbuild 的压缩比例是低于 terser 的，因此构建产物的体积会增大，请根据业务情况酌情使用。通常来说，esbuild 比较适合中后台等对体积不敏感的场景。\n\n对于压缩工具之间的详细对比，可以参考 minification-benchmarks。",normalizedContent:"# esbuild 插件\n\nesbuild 介绍\n\nesbuild 是一款基于 golang 开发的前端构建工具，具有打包、编译和压缩 javascript 代码的功能，相比传统的打包编译工具，esbuild 在性能上有显著提升。在代码压缩方面，相比 webpack 内置的 terser 压缩器，esbuild 在性能上有数十倍的提升。\n\nbuilder 提供了 esbuild 插件，让你能使用 esbuild 代替 babel-loader、ts-loader 和 terser 等库进行代码编译和压缩。在大型工程中启用 esbuild 后，可以大幅度减少代码编译和压缩所需的时间，同时有效避免 oom (heap out of memory) 问题。\n\n\n# 快速开始\n\n\n# 安装插件\n\n你可以通过如下的命令安装插件:\n\n# npm\nnpm install @modern-js/builder-plugin-esbuild -d\n\n# yarn\nyarn add @modern-js/builder-plugin-esbuild -d\n\n# pnpm\npnpm install @modern-js/builder-plugin-esbuild -d\n\n\n\n# 注册插件\n\n在 modern.js / edenx 等上层框架中，你可以通过 builderplugins 配置项来注册 esbuild 插件：\n\nimport { pluginesbuild } from '@modern-js/builder-plugin-esbuild';\n\nexport default {\n  builderplugins: [pluginesbuild()],\n};\n\n\n当你直接调用 builder 的 node api 时，可以通过 addplugins 方法来注册 esbuild 插件：\n\nimport { pluginesbuild } from '@modern-js/builder-plugin-esbuild';\n\n// 往 builder 实例上添加插件\nbuilder.addplugins([pluginesbuild()]);\n\n\n\n# 配置\n\n插件默认会开启代码转译和代码压缩的功能，你也可以通过配置来自定义插件的行为。\n\n\n# loader\n\n * type:\n\ntype loaderoptions = esbuildloaderoptions | false | undefined;\n\n\n * default:\n\nconst defaultoptions = {\n  target: 'es2015',\n  charset: builderconfig.output.charset,\n};\n\n\n这个选项用于启用 javascript 和 typescript 的转译，启用时将会使用 esbuild-loader 替换 babel-loader 和 ts-loader。\n\n如果你需要修改转译参数，可以查看 esbuild-loader 文档。\n\n# 修改目标环境\n\n通过 target 选项来修改代码转译的目标环境。target 可以直接设置为 javascript 语言版本，比如 es6，es2020；也可以设置为若干个目标环境，每个目标环境都是一个环境名称后跟一个版本号，比如 ['chrome58', 'edge16' ,'firefox57']。target 字段的详细介绍可以参考 esbuild - target。\n\ntarget 支持设置为以下环境：\n\n * chrome\n * edge\n * firefox\n * ie\n * ios\n * node\n * opera\n * safari\n\npluginesbuild({\n  loader: {\n    target: 'chrome61',\n  },\n});\n\n\n# 关闭代码转译\n\n将 loader 设置为 false 来关闭 esbuild 代码转译，此时 builder 会继续使用 babel 来进行代码转译。\n\npluginesbuild({\n  loader: false,\n});\n\n\n\n# minimize\n\n * type:\n\ntype minimizeoptions = esbuildminifyoptions | false | undefined;\n\n\n * default:\n\nconst defaultoptions = {\n  css: true,\n  target: 'es2015',\n};\n\n\n这个选项用于启用 javascript 和 css 的代码压缩。\n\n如果你需要修改压缩参数，可以查看 esbuild-loader 文档。\n\n# 修改目标环境\n\n通过 target 选项来修改代码压缩的目标环境。\n\npluginesbuild({\n  minimize: {\n    target: 'chrome61',\n  },\n});\n\n\n# 关闭代码压缩\n\n将 minimize 设置为 false 来关闭 esbuild 代码压缩，此时 builder 会继续使用 terser 进行代码压缩。\n\npluginesbuild({\n  minimize: false,\n});\n\n\n\n# esbuild 局限性\n\n虽然 esbuild 能给现有的 webpack 项目带来明显的构建性能提升，但这个工具在接入 builder 时还存在一定的局限性，需要大家在接入的时候格外注意。\n\n\n# 兼容性\n\n使用 esbuild 进行代码转译时（即 loader 能力），esbuild 通常最低支持到 es2015（即 es6）语法，并且不具备自动注入 polyfill 的能力。如果生产环境需要降级到 es5 及以下的语法，建议使用 swc 编译。\n\n你可以通过如下的配置指定目标语法版本:\n\npluginesbuild({\n  loader: {\n    target: 'es2015',\n  },\n});\n\n\n使用 esbuild 进行代码压缩时（即 minimize 能力），esbuild 可以在生产环境中进行压缩和混淆，通常最低支持到 es2015 语法。\n\n如果设置压缩的 target 为 es5，需要保证所有代码已经被转义为 es5 代码，否则会导致 esbuild 编译报错：transforming 'xxx' to the configured target environment (\"es5\") is not supported yet。\n\n因此，对于生产环境需要兼容 es5 及以下语法的项目，请谨慎开启 minimize 能力，建议使用 swc 压缩。\n\n你可以通过如下的配置指定目标语法版本:\n\npluginesbuild({\n  minimize: {\n    target: 'es2015',\n  },\n});\n\n\n\n# 不支持 babel 插件\n\n使用 esbuild 进行代码转译时，诸如 babel-plugin-import 等原有 babel 插件的语法编译功能在开启 esbuild 后无法使用。并且由于 builder 底层使用的是 esbuild 的 transform api，因此不支持使用额外 esbuild 插件来进行自定义编译过程。\n\n如果你有 babel-plugin-import 等 babel 插件相关诉求，可以使用 swc 插件。\n\n\n# 产物体积\n\n使用 esbuild 压缩虽然带来了构建效率上的提升，但 esbuild 的压缩比例是低于 terser 的，因此构建产物的体积会增大，请根据业务情况酌情使用。通常来说，esbuild 比较适合中后台等对体积不敏感的场景。\n\n对于压缩工具之间的详细对比，可以参考 minification-benchmarks。",charsets:{cjk:!0}},{title:"Image Compress 插件",frontmatter:{},regularPath:"/zh/plugins/plugin-image-compress.html",relativePath:"zh/plugins/plugin-image-compress.md",key:"v-5dd5c348",path:"/zh/plugins/plugin-image-compress.html",headers:[{level:2,title:"快速开始",slug:"快速开始",normalizedTitle:"快速开始",charIndex:85},{level:2,title:"配置项",slug:"配置项",normalizedTitle:"配置项",charIndex:364}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"快速开始 配置项",content:"# Image Compress 插件\n\nImage Compress 插件会将项目中用到的图片资源进行压缩处理，进而在图片视觉观感不受影响的同时减小产物体积。\n\n\n# 快速开始\n\n\n# 安装插件\n\n你可以通过如下的命令安装插件:\n\n# npm\nnpm install @modern-js/builder-plugin-image-compress -D\n\n# yarn\nyarn add @modern-js/builder-plugin-image-compress -D\n\n# pnpm\npnpm install @modern-js/builder-plugin-image-compress -D\n\n\n\n# 注册插件\n\n在 Modern.js / EdenX 等上层框架中，你可以通过 builderPlugins 配置项来注册 Image Compress 插件：\n\nimport { PluginImageCompress } from '@modern-js/builder-plugin-image-compress';\n\nexport default {\n  builderPlugins: [PluginImageCompress()],\n};\n\n\n当你直接调用 Builder 的 Node API 时，可以通过 addPlugins 方法来注册 Image Compress 插件：\n\nimport { PluginImageCompress } from '@modern-js/builder-plugin-image-compress';\n\n// 往 builder 实例上添加插件\nbuilder.addPlugins([PluginImageCompress()]);\n\n\n\n# 配置项\n\n插件接受一系列压缩器配置项组成的数组，数组的每一项既可以是字符串也可以是对象。字符串代表使用对应名称的压缩器并启用其默认配置， 或是使用对象格式配置并在 use 字段指定压缩器，对象的剩余字段将作为压缩器的配置项。\n\n插件默认会开启 jpeg, png, ico 三种图片压缩器，即等同于如下两种写法的配置：\n\nPluginImageCompress(['jpeg', 'png', 'ico']);\n\n\nPluginImageCompress([\n  { use: 'jpeg' },\n  { use: 'png' },\n  { use: 'ico' },\n]);\n\n\n通过指定配置项可以覆盖默认配置，例如让 jpeg 压缩器识别新的拓展名并设置 png 压缩器的质量：\n\nPluginImageCompress([\n  { use: 'jpeg', test: /\\.(jpg|jpeg|jpe)$/ },\n  { use: 'png', minQuality: 50 },\n  'ico',\n]);\n\n\n默认的 png 压缩器为有损压缩，如果需要将其替换为无损压缩器，你可以使用如下配置：\n\nPluginImageCompress(['jpeg', 'pngLossless', 'ico']);\n\n\n配置项列表最终会转换成对应的 bundler loader 配置，因此压缩器也遵循从下到上依次匹配的规则。 例如对于如下配置，png 压缩器会优先于 pngLossless 压缩器生效：\n\nPluginImageCompress(['jpeg', 'pngLossless', 'ico', 'png']);\n\n\n压缩器的具体配置项请参考 @napi-rs/image。",normalizedContent:"# image compress 插件\n\nimage compress 插件会将项目中用到的图片资源进行压缩处理，进而在图片视觉观感不受影响的同时减小产物体积。\n\n\n# 快速开始\n\n\n# 安装插件\n\n你可以通过如下的命令安装插件:\n\n# npm\nnpm install @modern-js/builder-plugin-image-compress -d\n\n# yarn\nyarn add @modern-js/builder-plugin-image-compress -d\n\n# pnpm\npnpm install @modern-js/builder-plugin-image-compress -d\n\n\n\n# 注册插件\n\n在 modern.js / edenx 等上层框架中，你可以通过 builderplugins 配置项来注册 image compress 插件：\n\nimport { pluginimagecompress } from '@modern-js/builder-plugin-image-compress';\n\nexport default {\n  builderplugins: [pluginimagecompress()],\n};\n\n\n当你直接调用 builder 的 node api 时，可以通过 addplugins 方法来注册 image compress 插件：\n\nimport { pluginimagecompress } from '@modern-js/builder-plugin-image-compress';\n\n// 往 builder 实例上添加插件\nbuilder.addplugins([pluginimagecompress()]);\n\n\n\n# 配置项\n\n插件接受一系列压缩器配置项组成的数组，数组的每一项既可以是字符串也可以是对象。字符串代表使用对应名称的压缩器并启用其默认配置， 或是使用对象格式配置并在 use 字段指定压缩器，对象的剩余字段将作为压缩器的配置项。\n\n插件默认会开启 jpeg, png, ico 三种图片压缩器，即等同于如下两种写法的配置：\n\npluginimagecompress(['jpeg', 'png', 'ico']);\n\n\npluginimagecompress([\n  { use: 'jpeg' },\n  { use: 'png' },\n  { use: 'ico' },\n]);\n\n\n通过指定配置项可以覆盖默认配置，例如让 jpeg 压缩器识别新的拓展名并设置 png 压缩器的质量：\n\npluginimagecompress([\n  { use: 'jpeg', test: /\\.(jpg|jpeg|jpe)$/ },\n  { use: 'png', minquality: 50 },\n  'ico',\n]);\n\n\n默认的 png 压缩器为有损压缩，如果需要将其替换为无损压缩器，你可以使用如下配置：\n\npluginimagecompress(['jpeg', 'pnglossless', 'ico']);\n\n\n配置项列表最终会转换成对应的 bundler loader 配置，因此压缩器也遵循从下到上依次匹配的规则。 例如对于如下配置，png 压缩器会优先于 pnglossless 压缩器生效：\n\npluginimagecompress(['jpeg', 'pnglossless', 'ico', 'png']);\n\n\n压缩器的具体配置项请参考 @napi-rs/image。",charsets:{cjk:!0}},{title:"Node Polyfill 插件",frontmatter:{},regularPath:"/zh/plugins/plugin-node-polyfill.html",relativePath:"zh/plugins/plugin-node-polyfill.md",key:"v-89347ba8",path:"/zh/plugins/plugin-node-polyfill.html",headers:[{level:2,title:"快速开始",slug:"快速开始",normalizedTitle:"快速开始",charIndex:233},{level:2,title:"Node Polyfills",slug:"node-polyfills",normalizedTitle:"node polyfills",charIndex:896}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"快速开始 Node Polyfills",content:"# Node Polyfill 插件\n\nNode Polyfill 介绍\n\n通常情况下，我们不会在浏览器端使用 Node 模块。但在当前代码需要同时在 Node 端和浏览器端运行时，用到一些 Node 模块是有可能的。Node Polyfill 为这些 Node 模块提供了浏览器版本的 polyfills。\n\n通过使用 Node Polyfill 插件，会自动注入 Node 核心模块在浏览器端的 polyfills，让你可以在浏览器端放心使用这些模块。\n\n\n# 快速开始\n\n\n# 安装插件\n\n你可以通过如下的命令安装插件:\n\n# npm\nnpm install @modern-js/builder-plugin-node-polyfill -D\n\n# yarn\nyarn add @modern-js/builder-plugin-node-polyfill -D\n\n# pnpm\npnpm install @modern-js/builder-plugin-node-polyfill -D\n\n\n\n# 注册插件\n\n在 Modern.js / EdenX 等上层框架中，你可以通过 builderPlugins 配置项来注册 node polyfill 插件：\n\nimport { PluginNodePolyfill } from '@modern-js/builder-plugin-node-polyfill';\n\nexport default {\n  builderPlugins: [PluginNodePolyfill()],\n};\n\n\n当你直接调用 Builder 的 Node API 时，可以通过 addPlugins 方法来注册 node polyfill 插件：\n\nimport { PluginNodePolyfill } from '@modern-js/builder-plugin-node-polyfill';\n\n// 往 builder 实例上添加插件\nbuilder.addPlugins([PluginNodePolyfill()]);\n\n\n\n# Node Polyfills\n\n\n# Globals\n\n * Buffer\n * process\n\n当直接在代码中使用以上模块时，对应 polyfill 会被注入。\n\nconst bufferData = Buffer.from('xxxx');\n\n\n\n# Modules\n\n * assert\n * buffer\n * console\n * constants\n * crypto\n * domain\n * events\n * http\n * https\n * os\n * path\n * punycode\n * process\n * querystring\n * stream\n * _stream_duplex\n * _stream_passthrough\n * _stream_readable\n * _stream_transform\n * _stream_writable\n * string_decoder\n * sys\n * timers\n * tty\n * url\n * util\n * vm\n * zlib\n\n当通过 import / require 等语法在代码中引用以上模块时，对应 polyfill 会被注入。\n\nimport { Buffer } from 'buffer';\n\nconst bufferData = Buffer.from('xxxx');\n",normalizedContent:"# node polyfill 插件\n\nnode polyfill 介绍\n\n通常情况下，我们不会在浏览器端使用 node 模块。但在当前代码需要同时在 node 端和浏览器端运行时，用到一些 node 模块是有可能的。node polyfill 为这些 node 模块提供了浏览器版本的 polyfills。\n\n通过使用 node polyfill 插件，会自动注入 node 核心模块在浏览器端的 polyfills，让你可以在浏览器端放心使用这些模块。\n\n\n# 快速开始\n\n\n# 安装插件\n\n你可以通过如下的命令安装插件:\n\n# npm\nnpm install @modern-js/builder-plugin-node-polyfill -d\n\n# yarn\nyarn add @modern-js/builder-plugin-node-polyfill -d\n\n# pnpm\npnpm install @modern-js/builder-plugin-node-polyfill -d\n\n\n\n# 注册插件\n\n在 modern.js / edenx 等上层框架中，你可以通过 builderplugins 配置项来注册 node polyfill 插件：\n\nimport { pluginnodepolyfill } from '@modern-js/builder-plugin-node-polyfill';\n\nexport default {\n  builderplugins: [pluginnodepolyfill()],\n};\n\n\n当你直接调用 builder 的 node api 时，可以通过 addplugins 方法来注册 node polyfill 插件：\n\nimport { pluginnodepolyfill } from '@modern-js/builder-plugin-node-polyfill';\n\n// 往 builder 实例上添加插件\nbuilder.addplugins([pluginnodepolyfill()]);\n\n\n\n# node polyfills\n\n\n# globals\n\n * buffer\n * process\n\n当直接在代码中使用以上模块时，对应 polyfill 会被注入。\n\nconst bufferdata = buffer.from('xxxx');\n\n\n\n# modules\n\n * assert\n * buffer\n * console\n * constants\n * crypto\n * domain\n * events\n * http\n * https\n * os\n * path\n * punycode\n * process\n * querystring\n * stream\n * _stream_duplex\n * _stream_passthrough\n * _stream_readable\n * _stream_transform\n * _stream_writable\n * string_decoder\n * sys\n * timers\n * tty\n * url\n * util\n * vm\n * zlib\n\n当通过 import / require 等语法在代码中引用以上模块时，对应 polyfill 会被注入。\n\nimport { buffer } from 'buffer';\n\nconst bufferdata = buffer.from('xxxx');\n",charsets:{cjk:!0}},{title:"SWC 插件",frontmatter:{},regularPath:"/zh/plugins/plugin-swc.html",relativePath:"zh/plugins/plugin-swc.md",key:"v-179524e8",path:"/zh/plugins/plugin-swc.html",headers:[{level:2,title:"快速开始",slug:"快速开始",normalizedTitle:"快速开始",charIndex:238},{level:2,title:"配置",slug:"配置",normalizedTitle:"配置",charIndex:482},{level:2,title:"限制",slug:"限制",normalizedTitle:"限制",charIndex:4352}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"快速开始 配置 限制",content:"# SWC 插件\n\nSWC (Speedy Web Compiler) 是基于 Rust 语言编写的高性能 JavaScript 和 TypeScript 转译和压缩工具。在 Polyfill 和语法降级方面可以和 Babel 提供一致的能力，并且性能比 Babel 高出一个数量级。\n\nModern.js Builder 提供了开箱即用的 SWC 插件，可以为你的 Web 应用提供语法降级、Polyfill 以及压缩，并且移植了一些额外常见的 Babel 插件。\n\n\n# 快速开始\n\n\n# 安装\n\n你可以通过如下的命令安装插件:\n\n# npm\nnpm install @modern-js/builder-plugin-swc -D\n\n# yarn\nyarn add @modern-js/builder-plugin-swc -D\n\n# pnpm\npnpm install @modern-js/builder-plugin-swc -D\n\n\n\n# 注册插件\n\n在 Modern.js / EdenX 等上层框架中，你可以通过 builderPlugins 配置项来注册 SWC 插件：\n\nimport { PluginSwc } from '@modern-js/builder-plugin-swc';\n\nexport default {\n  builderPlugins: [PluginSwc()],\n};\n\n\n当你直接调用 Builder 的 Node API 时，可以通过 addPlugins 方法来注册 SWC 插件：\n\nimport { PluginSwc } from '@modern-js/builder-plugin-swc';\n\n// 往 builder 实例上添加插件\nbuilder.addPlugins([PluginSwc()]);\n\n\nThat's it !\n\n现在你可以在项目中无缝使用 SWC 的转译和压缩能力了。\n\n\n# 配置\n\n * 类型: PluginConfig\n\ntype PluginConfig = {\n  presetReact?: ReactConfig;\n  presetEnv?: EnvConfig;\n  jsMinify?: boolean | JsMinifyOptions;\n  extensions?: Extensions;\n};\n\n\n\n# presetReact\n\n * 类型: SWC 中的 presetReact。\n\n对标 @babel/preset-react。传入的值会与默认配置进行合并。\n\n插件默认会自动根据你的 tsconfig.json 文件设置一些配置选项。\n\n * runtime: compilerOptions 中 jsx 字段。\n * importSource: compilerOptions 中 jsxImportSource 字段。\n * pragma: compilerOptions 中 jsxFactory 字段。\n * pragmaFrag: compilerOptions 中 jsxFragmentFactory 字段。\n\n如果没有找到 tsconfig.json 文件，默认配置是 { runtime: automatic }。\n\n\n# presetEnv\n\n * 类型: SWC 中的 presetEnv。\n\n对标 @babel/preset-env。传入的值会与默认配置进行合并。 默认配置为:\n\n{\n  targets: '', // 自动从项目中获取 browserslist\n  mode: 'usage',\n}\n\n\n\n# jsMinify\n\n * 类型: boolean 或者 terser 中的 compress 配置。\n\n默认配置为: { compress: {}, mangle: true }。\n\n如果配置 false 将不会使用 SWC 的压缩能力，配置 true 会启用默认压缩配置，如果配置是对象，则会与默认配置进行合并。\n\n\n# extensions\n\n * 类型: Object\n\n从 Babel 移植过来的一些插件能力。\n\n# extensions.pluginImport\n\n * 类型\n\ntype PluginImportOptions = Array<{\n  fromSource: string;\n  replaceJs?: {\n    ignoreEsComponent?: string[];\n    template?: string;\n    replaceExpr?: (member: string) => string | false;\n    transformToDefaultImport?: boolean;\n  };\n  replaceCss?: {\n    ignoreStyleComponent?: string[];\n    template?: string;\n    replaceExpr?: (member: string) => string | false;\n  };\n}>;\n\n\n移植自 babel-plugin-import。\n\nfromSource\n\n * 类型: string\n\n需要转换的包名，import { a } from 'foo' 中的 foo。\n\nreplaceJs.ignoreEsComponent\n\n * 类型: string[]\n * 默认值: []\n\n需要忽略掉的引入。\n\nreplaceJs.template\n\n * 类型: string\n * 默认值: undefined\n\n用于替换的规则模版，例如对于:\n\nimport { MyButton as Btn } from 'foo';\n\n\n添加以下配置：\n\nPluginSWC({\n  extensions: {\n    pluginImport: [\n      {\n        replaceJs: {\n          template: 'foo/es/{{member}}',\n        },\n      },\n    ],\n  },\n});\n\n\n会将上面的导入语句替换成:\n\nimport Btn from 'foo/es/MyButton';\n\n\n模版语句中还内置了一些辅助工具，还是以上面的导入语句为例，配置成：\n\nPluginSWC({\n  extensions: {\n    pluginImport: [\n      {\n        replaceJs: {\n          template: 'foo/es/{{ kebabCase member }}',\n        },\n      },\n    ],\n  },\n});\n\n\n会转换成下面的结果:\n\nimport Btn from 'foo/es/my-button';\n\n\n除了 kebabCase 以外还有 camelCase，snakeCase，upperCase，lowerCase 可以使用。 模版语法是来自 Handlebars。\n\nreplaceJs.replaceExpr\n\n * 类型: (member: string) => string\n * 默认值: undefined\n\n用于转换导入成员，传入的参数就是引入的成员，例如 import { a as b } from 'foo' 中的 a。 该函数会通过 node-api 被 Rust 调用，并且需要是同步函数。推荐使用上面的模版，由 node-api 调用 js 函数会将该函数放入任务队列中，等待在合适的时机执行，因此如果此时 js 线程任务较重可能会阻塞 Rust 线程的执行，造成性能的损失。\n\ntransformToDefaultImport\n\n * 类型: boolean\n * 默认值: true\n\n是否转换成默认导入。\n\n# extensions.reactUtils\n\n * 类型: Object\n\ntype ReactUtilsOptions = {\n  autoImportReact?: boolean;\n  removeEffect?: boolean;\n  removePropTypes?: {\n    mode?: 'remove' | 'unwrap' | 'unsafe-wrap';\n    removeImport?: boolean;\n    ignoreFilenames?: string[];\n    additionalLibraries?: string[];\n    classNameMatchers?: string[];\n  };\n};\n\n\n一些用于 React 的工具，包括以下配置项:\n\nreactUtils.autoImportReact\n\n * 类型: boolean\n\n自动引入 React, import React from 'react'，用于 jsx 转换使用 React.createElement。\n\nreactUtils.removeEffect\n\n * 类型: boolean\n\n移除 useEffect 调用。\n\nreactUtils.removePropTypes\n\n * 类型:\n\ntype RemovePropTypesOptions = {\n  mode?: 'remove' | 'unwrap' | 'unsafe-wrap';\n  removeImport?: boolean;\n  ignoreFilenames?: string[];\n  additionalLibraries?: string[];\n  classNameMatchers?: string[];\n};\n\n\n移除 React 组件在运行时的类型判断。移植自 @babel/plugin-react-transform-remove-prop-types。\n\n相应配置和 @babel/plugin-react-transform-remove-prop-types 插件保持一致。\n\n# extensions.lodash\n\n * 类型: { cwd?: string; ids?: string;}\n * 默认值: { cwd: process.cwd(), ids: [] }\n\n移植自 @babel/plugin-lodash。\n\n\n# 限制\n\n不支持 @babel/plugin-transform-runtime 以及其他自定义的 Babel 插件。",normalizedContent:"# swc 插件\n\nswc (speedy web compiler) 是基于 rust 语言编写的高性能 javascript 和 typescript 转译和压缩工具。在 polyfill 和语法降级方面可以和 babel 提供一致的能力，并且性能比 babel 高出一个数量级。\n\nmodern.js builder 提供了开箱即用的 swc 插件，可以为你的 web 应用提供语法降级、polyfill 以及压缩，并且移植了一些额外常见的 babel 插件。\n\n\n# 快速开始\n\n\n# 安装\n\n你可以通过如下的命令安装插件:\n\n# npm\nnpm install @modern-js/builder-plugin-swc -d\n\n# yarn\nyarn add @modern-js/builder-plugin-swc -d\n\n# pnpm\npnpm install @modern-js/builder-plugin-swc -d\n\n\n\n# 注册插件\n\n在 modern.js / edenx 等上层框架中，你可以通过 builderplugins 配置项来注册 swc 插件：\n\nimport { pluginswc } from '@modern-js/builder-plugin-swc';\n\nexport default {\n  builderplugins: [pluginswc()],\n};\n\n\n当你直接调用 builder 的 node api 时，可以通过 addplugins 方法来注册 swc 插件：\n\nimport { pluginswc } from '@modern-js/builder-plugin-swc';\n\n// 往 builder 实例上添加插件\nbuilder.addplugins([pluginswc()]);\n\n\nthat's it !\n\n现在你可以在项目中无缝使用 swc 的转译和压缩能力了。\n\n\n# 配置\n\n * 类型: pluginconfig\n\ntype pluginconfig = {\n  presetreact?: reactconfig;\n  presetenv?: envconfig;\n  jsminify?: boolean | jsminifyoptions;\n  extensions?: extensions;\n};\n\n\n\n# presetreact\n\n * 类型: swc 中的 presetreact。\n\n对标 @babel/preset-react。传入的值会与默认配置进行合并。\n\n插件默认会自动根据你的 tsconfig.json 文件设置一些配置选项。\n\n * runtime: compileroptions 中 jsx 字段。\n * importsource: compileroptions 中 jsximportsource 字段。\n * pragma: compileroptions 中 jsxfactory 字段。\n * pragmafrag: compileroptions 中 jsxfragmentfactory 字段。\n\n如果没有找到 tsconfig.json 文件，默认配置是 { runtime: automatic }。\n\n\n# presetenv\n\n * 类型: swc 中的 presetenv。\n\n对标 @babel/preset-env。传入的值会与默认配置进行合并。 默认配置为:\n\n{\n  targets: '', // 自动从项目中获取 browserslist\n  mode: 'usage',\n}\n\n\n\n# jsminify\n\n * 类型: boolean 或者 terser 中的 compress 配置。\n\n默认配置为: { compress: {}, mangle: true }。\n\n如果配置 false 将不会使用 swc 的压缩能力，配置 true 会启用默认压缩配置，如果配置是对象，则会与默认配置进行合并。\n\n\n# extensions\n\n * 类型: object\n\n从 babel 移植过来的一些插件能力。\n\n# extensions.pluginimport\n\n * 类型\n\ntype pluginimportoptions = array<{\n  fromsource: string;\n  replacejs?: {\n    ignoreescomponent?: string[];\n    template?: string;\n    replaceexpr?: (member: string) => string | false;\n    transformtodefaultimport?: boolean;\n  };\n  replacecss?: {\n    ignorestylecomponent?: string[];\n    template?: string;\n    replaceexpr?: (member: string) => string | false;\n  };\n}>;\n\n\n移植自 babel-plugin-import。\n\nfromsource\n\n * 类型: string\n\n需要转换的包名，import { a } from 'foo' 中的 foo。\n\nreplacejs.ignoreescomponent\n\n * 类型: string[]\n * 默认值: []\n\n需要忽略掉的引入。\n\nreplacejs.template\n\n * 类型: string\n * 默认值: undefined\n\n用于替换的规则模版，例如对于:\n\nimport { mybutton as btn } from 'foo';\n\n\n添加以下配置：\n\npluginswc({\n  extensions: {\n    pluginimport: [\n      {\n        replacejs: {\n          template: 'foo/es/{{member}}',\n        },\n      },\n    ],\n  },\n});\n\n\n会将上面的导入语句替换成:\n\nimport btn from 'foo/es/mybutton';\n\n\n模版语句中还内置了一些辅助工具，还是以上面的导入语句为例，配置成：\n\npluginswc({\n  extensions: {\n    pluginimport: [\n      {\n        replacejs: {\n          template: 'foo/es/{{ kebabcase member }}',\n        },\n      },\n    ],\n  },\n});\n\n\n会转换成下面的结果:\n\nimport btn from 'foo/es/my-button';\n\n\n除了 kebabcase 以外还有 camelcase，snakecase，uppercase，lowercase 可以使用。 模版语法是来自 handlebars。\n\nreplacejs.replaceexpr\n\n * 类型: (member: string) => string\n * 默认值: undefined\n\n用于转换导入成员，传入的参数就是引入的成员，例如 import { a as b } from 'foo' 中的 a。 该函数会通过 node-api 被 rust 调用，并且需要是同步函数。推荐使用上面的模版，由 node-api 调用 js 函数会将该函数放入任务队列中，等待在合适的时机执行，因此如果此时 js 线程任务较重可能会阻塞 rust 线程的执行，造成性能的损失。\n\ntransformtodefaultimport\n\n * 类型: boolean\n * 默认值: true\n\n是否转换成默认导入。\n\n# extensions.reactutils\n\n * 类型: object\n\ntype reactutilsoptions = {\n  autoimportreact?: boolean;\n  removeeffect?: boolean;\n  removeproptypes?: {\n    mode?: 'remove' | 'unwrap' | 'unsafe-wrap';\n    removeimport?: boolean;\n    ignorefilenames?: string[];\n    additionallibraries?: string[];\n    classnamematchers?: string[];\n  };\n};\n\n\n一些用于 react 的工具，包括以下配置项:\n\nreactutils.autoimportreact\n\n * 类型: boolean\n\n自动引入 react, import react from 'react'，用于 jsx 转换使用 react.createelement。\n\nreactutils.removeeffect\n\n * 类型: boolean\n\n移除 useeffect 调用。\n\nreactutils.removeproptypes\n\n * 类型:\n\ntype removeproptypesoptions = {\n  mode?: 'remove' | 'unwrap' | 'unsafe-wrap';\n  removeimport?: boolean;\n  ignorefilenames?: string[];\n  additionallibraries?: string[];\n  classnamematchers?: string[];\n};\n\n\n移除 react 组件在运行时的类型判断。移植自 @babel/plugin-react-transform-remove-prop-types。\n\n相应配置和 @babel/plugin-react-transform-remove-prop-types 插件保持一致。\n\n# extensions.lodash\n\n * 类型: { cwd?: string; ids?: string;}\n * 默认值: { cwd: process.cwd(), ids: [] }\n\n移植自 @babel/plugin-lodash。\n\n\n# 限制\n\n不支持 @babel/plugin-transform-runtime 以及其他自定义的 babel 插件。",charsets:{cjk:!0}},{title:"测试",frontmatter:{},regularPath:"/zh/plugins/testing.html",relativePath:"zh/plugins/testing.md",key:"v-2b0ade98",path:"/zh/plugins/testing.html",lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"# 测试",normalizedContent:"# 测试",charsets:{cjk:!0}},{frontmatter:{},regularPath:"/zh/shared/getBuilderConfig.html",relativePath:"zh/shared/getBuilderConfig.md",key:"v-03937a10",path:"/zh/shared/getBuilderConfig.html",lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"获取 Builder 配置，该方法必须在 modifyBuilderConfig 钩子执行完成后才能被调用。\n\n * Type\n\nfunction GetBuilderConfig(): Readonly<BuilderConfig>;\n",normalizedContent:"获取 builder 配置，该方法必须在 modifybuilderconfig 钩子执行完成后才能被调用。\n\n * type\n\nfunction getbuilderconfig(): readonly<builderconfig>;\n",charsets:{cjk:!0}},{frontmatter:{},regularPath:"/zh/shared/getHTMLPaths.html",relativePath:"zh/shared/getHTMLPaths.md",key:"v-6c2cd7a8",path:"/zh/shared/getHTMLPaths.html",lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"获取所有 HTML 产物的路径信息。\n\n该方法会返回一个对象，对象的 key 为 entry 名称，value 为 HTML 文件在产物目录下的相对路径。\n\n * Type\n\nfunction GetHTMLPaths(): Record<string, string>;\n",normalizedContent:"获取所有 html 产物的路径信息。\n\n该方法会返回一个对象，对象的 key 为 entry 名称，value 为 html 文件在产物目录下的相对路径。\n\n * type\n\nfunction gethtmlpaths(): record<string, string>;\n",charsets:{cjk:!0}},{frontmatter:{},regularPath:"/zh/shared/getNormalizedConfig.html",relativePath:"zh/shared/getNormalizedConfig.md",key:"v-7df4d328",path:"/zh/shared/getNormalizedConfig.html",lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"获取归一化后的 Builder 配置，该方法必须在 modifyBuilderConfig 钩子执行完成后才能被调用。\n\n相较于 getBuilderConfig 方法，该方法返回的配置经过了归一化处理，配置的类型定义会得到收敛，比如 config.html 的 undefined 类型将被移除。\n\n推荐优先使用该方法获取配置。\n\n * Type\n\nfunction GetNormalizedConfig(): Readonly<NormalizedConfig>;\n",normalizedContent:"获取归一化后的 builder 配置，该方法必须在 modifybuilderconfig 钩子执行完成后才能被调用。\n\n相较于 getbuilderconfig 方法，该方法返回的配置经过了归一化处理，配置的类型定义会得到收敛，比如 config.html 的 undefined 类型将被移除。\n\n推荐优先使用该方法获取配置。\n\n * type\n\nfunction getnormalizedconfig(): readonly<normalizedconfig>;\n",charsets:{cjk:!0}},{frontmatter:{},regularPath:"/zh/shared/isPluginExists.html",relativePath:"zh/shared/isPluginExists.md",key:"v-610e0894",path:"/zh/shared/isPluginExists.html",lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"判断某个插件是否已经被注册。\n\n * Type\n\nfunction IsPluginExists(pluginName: string): boolean;\n",normalizedContent:"判断某个插件是否已经被注册。\n\n * type\n\nfunction ispluginexists(pluginname: string): boolean;\n",charsets:{cjk:!0}},{frontmatter:{},regularPath:"/zh/shared/onAfterBuild.html",relativePath:"zh/shared/onAfterBuild.md",key:"v-7e33e2b8",path:"/zh/shared/onAfterBuild.html",lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"在执行生产环境构建后调用，你可以通过 stats 参数获取到构建结果信息。\n\n * Type\n\nfunction OnAfterBuild(\n  callback: (params: { stats?: Stats | MultiStats }) => Promise<void> | void,\n): void;\n",normalizedContent:"在执行生产环境构建后调用，你可以通过 stats 参数获取到构建结果信息。\n\n * type\n\nfunction onafterbuild(\n  callback: (params: { stats?: stats | multistats }) => promise<void> | void,\n): void;\n",charsets:{cjk:!0}},{frontmatter:{},regularPath:"/zh/shared/onAfterCreateCompiler.html",relativePath:"zh/shared/onAfterCreateCompiler.md",key:"v-2ebe6e8c",path:"/zh/shared/onAfterCreateCompiler.html",lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"在创建 compiler 实例后、执行构建前调用，当你执行 builder.startDevServer、builder.build 或 builder.createCompiler 时，都会调用此钩子。你可以通过 compiler 参数获取到 compiler 实例对象。\n\n * Type\n\nfunction OnAfterCreateCompiler(callback: (params: {\n  compiler: Compiler | MultiCompiler;\n}) => Promise<void> | void;): void;\n",normalizedContent:"在创建 compiler 实例后、执行构建前调用，当你执行 builder.startdevserver、builder.build 或 builder.createcompiler 时，都会调用此钩子。你可以通过 compiler 参数获取到 compiler 实例对象。\n\n * type\n\nfunction onaftercreatecompiler(callback: (params: {\n  compiler: compiler | multicompiler;\n}) => promise<void> | void;): void;\n",charsets:{cjk:!0}},{frontmatter:{},regularPath:"/zh/shared/onAfterStartDevServer.html",relativePath:"zh/shared/onAfterStartDevServer.md",key:"v-7e6a746c",path:"/zh/shared/onAfterStartDevServer.html",lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"在启动开发服务器后调用，你可以通过 port 参数获得开发服务器监听的端口号。\n\n * Type\n\nfunction OnAfterStartDevServer(\n  callback: (params: { port: number }) => Promise<void> | void,\n): void;\n",normalizedContent:"在启动开发服务器后调用，你可以通过 port 参数获得开发服务器监听的端口号。\n\n * type\n\nfunction onafterstartdevserver(\n  callback: (params: { port: number }) => promise<void> | void,\n): void;\n",charsets:{cjk:!0}},{frontmatter:{},regularPath:"/zh/shared/onBeforeBuild.html",relativePath:"zh/shared/onBeforeBuild.md",key:"v-4b8e348c",path:"/zh/shared/onBeforeBuild.html",lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"在执行生产环境构建前调用，你可以通过 bundlerConfigs 参数获取到底层打包工具的最终配置对象。\n\n * Type\n\nfunction OnBeforeBuild(\n  callback: (params: {\n    bundlerConfigs?: WebpackConfig[] | RspackConfig[];\n  }) => Promise<void> | void,\n): void;\n",normalizedContent:"在执行生产环境构建前调用，你可以通过 bundlerconfigs 参数获取到底层打包工具的最终配置对象。\n\n * type\n\nfunction onbeforebuild(\n  callback: (params: {\n    bundlerconfigs?: webpackconfig[] | rspackconfig[];\n  }) => promise<void> | void,\n): void;\n",charsets:{cjk:!0}},{frontmatter:{},regularPath:"/zh/shared/onBeforeCreateCompiler.html",relativePath:"zh/shared/onBeforeCreateCompiler.md",key:"v-223d54d4",path:"/zh/shared/onBeforeCreateCompiler.html",lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"在创建 compiler 实例前调用，当你执行 builder.startDevServer、builder.build 或 builder.createCompiler 时，都会调用此钩子。你可以通过 bundlerConfigs 参数获取到底层打包工具的最终配置对象。\n\n * Type\n\nfunction OnBeforeCreateCompiler(\n  callback: (params: {\n    bundlerConfigs: WebpackConfig[] | RspackConfig[];\n  }) => Promise<void> | void,\n): void;\n",normalizedContent:"在创建 compiler 实例前调用，当你执行 builder.startdevserver、builder.build 或 builder.createcompiler 时，都会调用此钩子。你可以通过 bundlerconfigs 参数获取到底层打包工具的最终配置对象。\n\n * type\n\nfunction onbeforecreatecompiler(\n  callback: (params: {\n    bundlerconfigs: webpackconfig[] | rspackconfig[];\n  }) => promise<void> | void,\n): void;\n",charsets:{cjk:!0}},{frontmatter:{},regularPath:"/zh/shared/onBeforeStartDevServer.html",relativePath:"zh/shared/onBeforeStartDevServer.md",key:"v-626a7ec4",path:"/zh/shared/onBeforeStartDevServer.html",lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"在启动开发服务器前调用。\n\n * Type\n\nfunction OnBeforeStartDevServer(callback: () => Promise<void> | void): void;\n",normalizedContent:"在启动开发服务器前调用。\n\n * type\n\nfunction onbeforestartdevserver(callback: () => promise<void> | void): void;\n",charsets:{cjk:!0}},{frontmatter:{},regularPath:"/zh/shared/onDevCompileDone.html",relativePath:"zh/shared/onDevCompileDone.md",key:"v-1d61f788",path:"/zh/shared/onDevCompileDone.html",lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"在每次开发环境构建结束后调用，你可以通过 isFirstCompile 来判断是否为首次构建。\n\n * Type\n\nfunction OnDevCompileDone(\n  callback: (params: { isFirstCompile: boolean }) => Promise<void> | void,\n): void;\n",normalizedContent:"在每次开发环境构建结束后调用，你可以通过 isfirstcompile 来判断是否为首次构建。\n\n * type\n\nfunction ondevcompiledone(\n  callback: (params: { isfirstcompile: boolean }) => promise<void> | void,\n): void;\n",charsets:{cjk:!0}},{frontmatter:{},regularPath:"/zh/shared/onExit.html",relativePath:"zh/shared/onExit.md",key:"v-52c66bcc",path:"/zh/shared/onExit.html",lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"在进程即将退出时调用，这个钩子只能执行同步代码。\n\n * Type\n\nfunction OnExit(callback: () => void): void;\n",normalizedContent:"在进程即将退出时调用，这个钩子只能执行同步代码。\n\n * type\n\nfunction onexit(callback: () => void): void;\n",charsets:{cjk:!0}},{title:"接入框架",frontmatter:{},regularPath:"/zh/plugins/integration.html",relativePath:"zh/plugins/integration.md",key:"v-1231f5e0",path:"/zh/plugins/integration.html",lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:null,content:"# 接入框架\n\nTODO",normalizedContent:"# 接入框架\n\ntodo",charsets:{cjk:!0}},{title:"快速上手",frontmatter:{},regularPath:"/zh/guide/quick-start.html",relativePath:"zh/guide/quick-start.md",key:"v-0c3100fc",path:"/zh/guide/quick-start.html",headers:[{level:2,title:"使用 Modern.js 应用",slug:"使用-modern-js-应用",normalizedTitle:"使用 modern.js 应用",charIndex:11},{level:2,title:"在前端框架中接入",slug:"在前端框架中接入",normalizedTitle:"在前端框架中接入",charIndex:207},{level:2,title:"下一步",slug:"下一步",normalizedTitle:"下一步",charIndex:1726}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"使用 Modern.js 应用 在前端框架中接入 下一步",content:"# 快速上手\n\n\n# 使用 Modern.js 应用\n\nModern.js 应用从 2.0 版本开始，默认使用 Modern.js Builder 作为构建引擎。\n\n因此，如果你是一名业务开发者，那么不需要手动接入 Builder，只需要创建一个 Modern.js 2.0 项目，直接就可以使用 Builder 提供的所有能力。\n\n> Tips: Modern.js 2.0 仍在开发中，尚未正式发布。\n\n\n# 在前端框架中接入\n\n如果你正在开发一个前端框架，可以通过下面的步骤来接入 Builder:\n\n\n# 1. 安装 Builder\n\n你需要安装两个包，其中：\n\n * @modern-js/builder 为 Builder 的核心包，导出了 Builder 的核心 API。\n * @modern-js/builder-webpack-provider 为 Builder 的一个 Provider，提供了基于 webpack 的构建能力。\n\npnpm add @modern-js/builder@beta @modern-js/builder-webpack-provider@beta -D\n\n\n> 在进行版本升级时，请确保你安装的 builder 和 provider 为同一个版本。\n\n\n# 2. 创建 Builder 实例\n\n创建 Builder 实例的过程分两步：\n\n首先你需要初始化 Builder Provider，并传入 builderConfig 配置对象。Builder 提供了丰富的配置项，允许你对构建行为进行灵活定制。此时你还不需要了解配置项的具体内容，传入一个空对象即可。你可以在 API - 配置 中找到所有可用的配置项。\n\nimport { createBuilder } from '@modern-js/builder';\nimport { builderWebpackProvider } from '@modern-js/builder-webpack-provider';\n\nconst provider = builderWebpackProvider({\n  builderConfig: {\n    // some configs\n  },\n});\n\n\n拿到 provider 对象后，你可以调用 createBuilder 方法来创建一个 Builder 实例对象：\n\nconst builder = await createBuilder(provider, {\n  entry: {\n    index: './src/index.ts',\n  },\n});\n\n\n除了上述示例中的 entry 选项，createBuilder 方法也提供了一些其他的选项，你可以在 API - createBuilder 中进一步了解。\n\n\n# 3. 调用 Builder 实例方法\n\nBuilder 实例提供了与构建相关的各个方法，你可以根据实际场景来进行使用。\n\n在本地开发场景，建议使用 builder.startDevServer 方法，调用后会启动本地 Dev Server。\n\nawait builder.startDevServer();\n\n\n成功启动 Dev Server 后，可以看到以下日志信息：\n\ninfo    Starting dev server...\ninfo    Dev server running at:\n\n  > Local:    http://localhost:8081\n  > Network:  http://192.168.0.1:8081\n\n\n在生产环境部署场景，建议使用 builder.build 方法，调用后会构建出生产环境产物。\n\nawait builder.build();\n\n\n> 关于 Builder 实例方法的更多介绍，请阅读 Builder Instance 章节。\n\n通过以上三个步骤，你已经了解了 Builder 基本的使用方法。接下来你可以通过 Builder 插件和 Builder 配置来对构建流程进行定制。\n\n\n# 下一步\n\n你可能想要：",normalizedContent:"# 快速上手\n\n\n# 使用 modern.js 应用\n\nmodern.js 应用从 2.0 版本开始，默认使用 modern.js builder 作为构建引擎。\n\n因此，如果你是一名业务开发者，那么不需要手动接入 builder，只需要创建一个 modern.js 2.0 项目，直接就可以使用 builder 提供的所有能力。\n\n> tips: modern.js 2.0 仍在开发中，尚未正式发布。\n\n\n# 在前端框架中接入\n\n如果你正在开发一个前端框架，可以通过下面的步骤来接入 builder:\n\n\n# 1. 安装 builder\n\n你需要安装两个包，其中：\n\n * @modern-js/builder 为 builder 的核心包，导出了 builder 的核心 api。\n * @modern-js/builder-webpack-provider 为 builder 的一个 provider，提供了基于 webpack 的构建能力。\n\npnpm add @modern-js/builder@beta @modern-js/builder-webpack-provider@beta -d\n\n\n> 在进行版本升级时，请确保你安装的 builder 和 provider 为同一个版本。\n\n\n# 2. 创建 builder 实例\n\n创建 builder 实例的过程分两步：\n\n首先你需要初始化 builder provider，并传入 builderconfig 配置对象。builder 提供了丰富的配置项，允许你对构建行为进行灵活定制。此时你还不需要了解配置项的具体内容，传入一个空对象即可。你可以在 api - 配置 中找到所有可用的配置项。\n\nimport { createbuilder } from '@modern-js/builder';\nimport { builderwebpackprovider } from '@modern-js/builder-webpack-provider';\n\nconst provider = builderwebpackprovider({\n  builderconfig: {\n    // some configs\n  },\n});\n\n\n拿到 provider 对象后，你可以调用 createbuilder 方法来创建一个 builder 实例对象：\n\nconst builder = await createbuilder(provider, {\n  entry: {\n    index: './src/index.ts',\n  },\n});\n\n\n除了上述示例中的 entry 选项，createbuilder 方法也提供了一些其他的选项，你可以在 api - createbuilder 中进一步了解。\n\n\n# 3. 调用 builder 实例方法\n\nbuilder 实例提供了与构建相关的各个方法，你可以根据实际场景来进行使用。\n\n在本地开发场景，建议使用 builder.startdevserver 方法，调用后会启动本地 dev server。\n\nawait builder.startdevserver();\n\n\n成功启动 dev server 后，可以看到以下日志信息：\n\ninfo    starting dev server...\ninfo    dev server running at:\n\n  > local:    http://localhost:8081\n  > network:  http://192.168.0.1:8081\n\n\n在生产环境部署场景，建议使用 builder.build 方法，调用后会构建出生产环境产物。\n\nawait builder.build();\n\n\n> 关于 builder 实例方法的更多介绍，请阅读 builder instance 章节。\n\n通过以上三个步骤，你已经了解了 builder 基本的使用方法。接下来你可以通过 builder 插件和 builder 配置来对构建流程进行定制。\n\n\n# 下一步\n\n你可能想要：",charsets:{cjk:!0}},{title:"插件系统",frontmatter:{},regularPath:"/zh/plugins/introduction.html",relativePath:"zh/plugins/introduction.md",key:"v-31efbb28",path:"/zh/plugins/introduction.html",headers:[{level:2,title:"开发插件",slug:"开发插件",normalizedTitle:"开发插件",charIndex:348},{level:2,title:"生命周期钩子",slug:"生命周期钩子",normalizedTitle:"生命周期钩子",charIndex:1056},{level:2,title:"使用配置项",slug:"使用配置项",normalizedTitle:"使用配置项",charIndex:1222},{level:2,title:"修改 webpack 配置",slug:"修改-webpack-配置",normalizedTitle:"修改 webpack 配置",charIndex:2963},{level:2,title:"参考范例",slug:"参考范例",normalizedTitle:"参考范例",charIndex:3301}],lastUpdated:"2022/12/21 07:37:07",lastUpdatedTimestamp:1671608227e3,headersStr:"开发插件 生命周期钩子 使用配置项 修改 webpack 配置 参考范例",content:"# 插件系统\n\nBuilder 提供了一套轻量强大的插件系统，用以实现自身的大多数功能，并允许用户进行扩展。 开发者编写的插件能够修改 Builder 的默认行为并添加各类额外功能，包括但不限于：\n\n * 修改 bundler 配置\n * 处理新的文件类型\n * 修改或编译文件\n * 部署产物\n\nBuilder 底层支持 webpack 和 rspack 等 bundler，并提供统一的 Node.js API 来抹平插件开发的差异， 进而接入不同的上层框架、降低用户对底层 bundler 切换的感知。\n\n用户可能无法在上层框架中直接使用 Builder 插件。因为这些框架（如 modern.js）只复用了 Builder 提供的构建能力， 针对其应用场景还会添加许多额外设计。\n\n\n# 开发插件\n\n插件提供类似 (options?: PluginOptions) => BuilderPlugin 的函数作为入口。\n\nimport type { BuilderPlugin } from '@modern-js/builder-webpack-provider';\n\nexport interface PluginFooOptions {\n  message?: string;\n}\n\nexport const PluginFoo = (options?: PluginFooOptions): BuilderPlugin => ({\n  name: 'plugin-foo',\n  setup(api) {\n    api.onExit(() => {\n      const msg = options.message || 'finish.';\n      console.log(msg)\n    });\n  }\n});\n\nbuilder.addPlugins([\n  PluginFoo({ message: 'some other message.' })\n]);\n\n\n函数形式的插件可以 接受选项对象 并 返回插件实例，并通过闭包机制管理内部状态。\n\n其中各部分的作用分别为：\n\n * name 属性用于标注插件名称\n * setup 作为插件逻辑的主入口\n * api 对象包含了各类钩子和工具函数\n\n为了便于识别，插件名称需要包含约定的 builder-plugin 前缀，例如 builder-plugin-foo @scope/builder-plugin-bar 等。\n\n\n# 生命周期钩子\n\nBuilder 在内部按照约定的生命周期进行任务调度，插件可以通过注册钩子来介入工作流程的任意阶段，并实现自己的功能。\n\nBuilder 生命周期钩子的完整列表参考 API 文档。\n\nBuilder 不会接管底层 Bundler 的生命周期，相关生命周期钩子的使用方式见对应文档：webpack hooks\n\n\n# 使用配置项\n\n自行编写的插件通常使用初始化时传入函数的参数作为配置项即可，开发者可以随意定义和使用函数的入参。\n\n但某些情况下插件可能需要读取 / 修改 Builder 公用的配置项，这时就需要了解 Builder 内部对配置项的生产和消费流程：\n\n * 读取、解析配置并合并默认值\n * 插件通过 api.modifyBuilderConfig(...) 回调修改配置项\n * 归一化配置项并提供给插件后续消费，此后无法再修改配置项\n\n整套流程可以通过这个简单的插件体现：\n\nexport const PluginUploadDist = (): BuilderPlugin => ({\n  name: 'plugin-upload-dist',\n  setup(api) {\n    api.modifyBuilderConfig(config => {\n      // 尝试关闭代码压缩，需要自己填充默认值\n      config.output ||= {};\n      config.output.disableMinimize = true;\n      // 轮到其它插件修改配置...\n    });\n    api.onBeforeBuild(() => {\n      // 读取最终的配置\n      const config = api.getNormalizedConfig();\n      if (!config.output.disableMinimize) {\n        // 其它插件又启用了压缩则报错\n        throw new Error('You must disable minimize to upload readable dist files.');\n      }\n    });\n    api.onAfterBuild(() => {\n      const config = api.getNormalizedConfig();\n      const distRoot = config.output.distPath.root;\n      // TODO: 上传 `distRoot` 目录下所有产物文件\n    });\n  }\n});\n\n\n插件中有三种方式使用配置项对象：\n\n * api.modifyBuilderConfig(config => {}) 在回调中修改配置\n * api.getBuilderConfig() 获取配置项\n * api.getNormalizedConfig() 获取归一化后的配置项\n\n归一化的配置项会再次合并默认值并移除大部分可选类型，对于 PluginUploadDist 的例子其部分类型定义为：\n\napi.modifyBuilderConfig((config: BuilderConfig) => {});\napi.getBuilderConfig() as BuilderConfig;\ntype BuilderConfig = {\n  output?: {\n    disableMinimize?: boolean;\n    distPath?: { root?: string };\n  };\n};\n\napi.getNormalizedConfig() as NormalizedConfig;\ntype NormalizedConfig = {\n  output: {\n    disableMinimize: boolean;\n    distPath: { root: string };\n  };\n};\n\n\ngetNormalizedConfig() 的返回值类型与 BuilderConfig 的略有不同、相比文档其它地方描述的类型进行了收窄， 在使用时无需自行判空、填充默认值。\n\n因此使用配置项的最佳方式应该是：\n\n * 通过 api.modifyBuilderConfig(config => {}) 来修改配置\n * 在其后的生命周期中读取 api.getNormalizedConfig() 作为插件实际使用的配置\n\n\n# 修改 webpack 配置\n\n插件可以通过多种方式修改 webpack 的配置项。\n\n * api.modifyWebpackChain(chain => {}) 修改 webpack-chain\n * api.modifyWebpackConfig(config => {}) 修改最终的 webpack 配置\n * api.onAfterCreateCompiler(compiler => {}) 直接操作 webpack 实例\n\n通常推荐使用 neutrinojs/webpack-chain 提供的链式 API 来修改 webpack 配置的工作。\n\nBuilder 使用的是兼容 webpack5 的修改版本：sorrycc/webpack-chain。\n\n\n# 参考范例\n\n\n# 修改 Loader\n\nLoader 可以读取和处理不同类型的文件模块，具体参考 concepts 和 loaders。\n\nimport type { BuilderPlugin } from '@modern-js/builder-webpack-provider';\n\nexport const PluginTypeScriptExt = (): BuilderPlugin => ({\n  name: 'builder-typescript-ext',\n  setup(api) {\n    api.modifyWebpackChain(async chain => {\n      // 设置 ts-loader 将更多的文件识别为 typescript 模块\n      chain.module\n        .rule(CHAIN_ID.RULE.TS)\n        .test(/\\.(ts|mts|cts|tsx|tss|tsm)$/);\n    });\n  },\n});\n\n\n\n# 添加模块入口\n\nimport type { BuilderPlugin } from '@modern-js/builder-webpack-provider';\n\nexport const PluginAdminPanel = (): BuilderPlugin => ({\n  name: 'builder-admin-panel',\n  setup(api) {\n    api.modifyWebpackChain(async chain => {\n      config\n        .entry('admin-panel')\n        .add('src/admin/panel.js');\n    });\n  },\n});\n\n\n\n# 接入 webpack 插件\n\n开发者可以在 Builder 插件中接入已有的 webpack 插件来平缓迁移项目：\n\nimport type { BuilderPlugin } from '@modern-js/builder-webpack-provider';\nimport type { Options } from '@modern-js/inspector-webpack-plugin';\n\nexport const PluginInspector = (options?: Options): BuilderPlugin => ({\n  name: 'builder-plugin-inspector',\n  setup(api) {\n    api.modifyWebpackChain(async chain => {\n      // 仅在需要的时候动态加载模块，避免不必要的性能消耗\n      const { InspectorWebpackPlugin } = await import(\n        '@modern-js/inspector-webpack-plugin'\n      );\n      // 修改 webpack chain 接入插件\n      chain\n        .plugin('inspector-webpack-plugin')\n        .use(InspectorWebpackPlugin, [inspectorOptions]);\n    });\n  },\n});\n",normalizedContent:"# 插件系统\n\nbuilder 提供了一套轻量强大的插件系统，用以实现自身的大多数功能，并允许用户进行扩展。 开发者编写的插件能够修改 builder 的默认行为并添加各类额外功能，包括但不限于：\n\n * 修改 bundler 配置\n * 处理新的文件类型\n * 修改或编译文件\n * 部署产物\n\nbuilder 底层支持 webpack 和 rspack 等 bundler，并提供统一的 node.js api 来抹平插件开发的差异， 进而接入不同的上层框架、降低用户对底层 bundler 切换的感知。\n\n用户可能无法在上层框架中直接使用 builder 插件。因为这些框架（如 modern.js）只复用了 builder 提供的构建能力， 针对其应用场景还会添加许多额外设计。\n\n\n# 开发插件\n\n插件提供类似 (options?: pluginoptions) => builderplugin 的函数作为入口。\n\nimport type { builderplugin } from '@modern-js/builder-webpack-provider';\n\nexport interface pluginfoooptions {\n  message?: string;\n}\n\nexport const pluginfoo = (options?: pluginfoooptions): builderplugin => ({\n  name: 'plugin-foo',\n  setup(api) {\n    api.onexit(() => {\n      const msg = options.message || 'finish.';\n      console.log(msg)\n    });\n  }\n});\n\nbuilder.addplugins([\n  pluginfoo({ message: 'some other message.' })\n]);\n\n\n函数形式的插件可以 接受选项对象 并 返回插件实例，并通过闭包机制管理内部状态。\n\n其中各部分的作用分别为：\n\n * name 属性用于标注插件名称\n * setup 作为插件逻辑的主入口\n * api 对象包含了各类钩子和工具函数\n\n为了便于识别，插件名称需要包含约定的 builder-plugin 前缀，例如 builder-plugin-foo @scope/builder-plugin-bar 等。\n\n\n# 生命周期钩子\n\nbuilder 在内部按照约定的生命周期进行任务调度，插件可以通过注册钩子来介入工作流程的任意阶段，并实现自己的功能。\n\nbuilder 生命周期钩子的完整列表参考 api 文档。\n\nbuilder 不会接管底层 bundler 的生命周期，相关生命周期钩子的使用方式见对应文档：webpack hooks\n\n\n# 使用配置项\n\n自行编写的插件通常使用初始化时传入函数的参数作为配置项即可，开发者可以随意定义和使用函数的入参。\n\n但某些情况下插件可能需要读取 / 修改 builder 公用的配置项，这时就需要了解 builder 内部对配置项的生产和消费流程：\n\n * 读取、解析配置并合并默认值\n * 插件通过 api.modifybuilderconfig(...) 回调修改配置项\n * 归一化配置项并提供给插件后续消费，此后无法再修改配置项\n\n整套流程可以通过这个简单的插件体现：\n\nexport const pluginuploaddist = (): builderplugin => ({\n  name: 'plugin-upload-dist',\n  setup(api) {\n    api.modifybuilderconfig(config => {\n      // 尝试关闭代码压缩，需要自己填充默认值\n      config.output ||= {};\n      config.output.disableminimize = true;\n      // 轮到其它插件修改配置...\n    });\n    api.onbeforebuild(() => {\n      // 读取最终的配置\n      const config = api.getnormalizedconfig();\n      if (!config.output.disableminimize) {\n        // 其它插件又启用了压缩则报错\n        throw new error('you must disable minimize to upload readable dist files.');\n      }\n    });\n    api.onafterbuild(() => {\n      const config = api.getnormalizedconfig();\n      const distroot = config.output.distpath.root;\n      // todo: 上传 `distroot` 目录下所有产物文件\n    });\n  }\n});\n\n\n插件中有三种方式使用配置项对象：\n\n * api.modifybuilderconfig(config => {}) 在回调中修改配置\n * api.getbuilderconfig() 获取配置项\n * api.getnormalizedconfig() 获取归一化后的配置项\n\n归一化的配置项会再次合并默认值并移除大部分可选类型，对于 pluginuploaddist 的例子其部分类型定义为：\n\napi.modifybuilderconfig((config: builderconfig) => {});\napi.getbuilderconfig() as builderconfig;\ntype builderconfig = {\n  output?: {\n    disableminimize?: boolean;\n    distpath?: { root?: string };\n  };\n};\n\napi.getnormalizedconfig() as normalizedconfig;\ntype normalizedconfig = {\n  output: {\n    disableminimize: boolean;\n    distpath: { root: string };\n  };\n};\n\n\ngetnormalizedconfig() 的返回值类型与 builderconfig 的略有不同、相比文档其它地方描述的类型进行了收窄， 在使用时无需自行判空、填充默认值。\n\n因此使用配置项的最佳方式应该是：\n\n * 通过 api.modifybuilderconfig(config => {}) 来修改配置\n * 在其后的生命周期中读取 api.getnormalizedconfig() 作为插件实际使用的配置\n\n\n# 修改 webpack 配置\n\n插件可以通过多种方式修改 webpack 的配置项。\n\n * api.modifywebpackchain(chain => {}) 修改 webpack-chain\n * api.modifywebpackconfig(config => {}) 修改最终的 webpack 配置\n * api.onaftercreatecompiler(compiler => {}) 直接操作 webpack 实例\n\n通常推荐使用 neutrinojs/webpack-chain 提供的链式 api 来修改 webpack 配置的工作。\n\nbuilder 使用的是兼容 webpack5 的修改版本：sorrycc/webpack-chain。\n\n\n# 参考范例\n\n\n# 修改 loader\n\nloader 可以读取和处理不同类型的文件模块，具体参考 concepts 和 loaders。\n\nimport type { builderplugin } from '@modern-js/builder-webpack-provider';\n\nexport const plugintypescriptext = (): builderplugin => ({\n  name: 'builder-typescript-ext',\n  setup(api) {\n    api.modifywebpackchain(async chain => {\n      // 设置 ts-loader 将更多的文件识别为 typescript 模块\n      chain.module\n        .rule(chain_id.rule.ts)\n        .test(/\\.(ts|mts|cts|tsx|tss|tsm)$/);\n    });\n  },\n});\n\n\n\n# 添加模块入口\n\nimport type { builderplugin } from '@modern-js/builder-webpack-provider';\n\nexport const pluginadminpanel = (): builderplugin => ({\n  name: 'builder-admin-panel',\n  setup(api) {\n    api.modifywebpackchain(async chain => {\n      config\n        .entry('admin-panel')\n        .add('src/admin/panel.js');\n    });\n  },\n});\n\n\n\n# 接入 webpack 插件\n\n开发者可以在 builder 插件中接入已有的 webpack 插件来平缓迁移项目：\n\nimport type { builderplugin } from '@modern-js/builder-webpack-provider';\nimport type { options } from '@modern-js/inspector-webpack-plugin';\n\nexport const plugininspector = (options?: options): builderplugin => ({\n  name: 'builder-plugin-inspector',\n  setup(api) {\n    api.modifywebpackchain(async chain => {\n      // 仅在需要的时候动态加载模块，避免不必要的性能消耗\n      const { inspectorwebpackplugin } = await import(\n        '@modern-js/inspector-webpack-plugin'\n      );\n      // 修改 webpack chain 接入插件\n      chain\n        .plugin('inspector-webpack-plugin')\n        .use(inspectorwebpackplugin, [inspectoroptions]);\n    });\n  },\n});\n",charsets:{cjk:!0}}],themeConfig:{logo:"https://lf3-static.bytednsdoc.com/obj/eden-cn/zq-uylkvT/ljhwZthlaukjlkulzlp/eden-x-logo.png",repo:"https://github.com/modern-js-dev/modern.js/tree/main/packages/builder",repoLabel:"GitHub",docsDir:"docs/docs/src",enableDarkMode:!0,locales:{"/zh/":{label:"简体中文",selectText:"语言",ariaLabel:"语言",lastUpdated:"上次更新",searchMaxSuggestions:10,searchPlaceholder:"Search",nav:[{text:"指南",link:"/zh/guide/introduction"},{text:"API",link:"/zh/api/"},{text:"插件",link:"/zh/plugins/introduction"}],sidebar:{"/zh/guide/":[{collapsable:!1,title:"开始",children:["/zh/guide/introduction","/zh/guide/quick-start","/zh/guide/glossary","/zh/guide/features"]},{collapsable:!1,title:"基础",children:["/zh/guide/basic/builder-config","/zh/guide/basic/build-target","/zh/guide/basic/output-files","/zh/guide/basic/css-usage","/zh/guide/basic/static-assets","/zh/guide/basic/svg-assets","/zh/guide/basic/json-files","/zh/guide/basic/html-template","/zh/guide/basic/css-modules","/zh/guide/basic/typescript"]},{collapsable:!1,title:"进阶",children:["/zh/guide/advanced/alias","/zh/guide/advanced/define","/zh/guide/advanced/hmr","/zh/guide/advanced/rem","/zh/guide/advanced/browserslist","/zh/guide/advanced/browser-compatibility","/zh/guide/advanced/custom-webpack-config"]},{collapsable:!1,title:"优化",children:["/zh/guide/optimization/optimize-bundle","/zh/guide/optimization/build-performance","/zh/guide/optimization/split-chunk","/zh/guide/optimization/inline-assets"]},{collapsable:!1,title:"调试",children:["/zh/guide/debug/inspector"]},{collapsable:!1,title:"常见问题",children:["/zh/guide/faq/general","/zh/guide/faq/features","/zh/guide/faq/exceptions"]}],"/zh/api/":[{title:"API 总览",path:"/zh/api/"},{title:"配置",collapsable:!1,children:["/zh/api/config-source","/zh/api/config-html","/zh/api/config-dev","/zh/api/config-output","/zh/api/config-security","/zh/api/config-tools","/zh/api/config-performance","/zh/api/config-experiments"]},{title:"Node API",collapsable:!1,children:["/zh/api/builder-core","/zh/api/builder-instance","/zh/api/builder-types"]},{title:"Plugin API",collapsable:!1,children:["/zh/api/plugin-core","/zh/api/plugin-hooks"]}],"/zh/plugins":[{collapsable:!1,title:"指南",children:["/zh/plugins/introduction"]},{collapsable:!1,title:"列表",children:["/zh/plugins/list","/zh/plugins/plugin-swc","/zh/plugins/plugin-esbuild","/zh/plugins/plugin-node-polyfill","/zh/plugins/plugin-image-compress"]}]}},"/en/":{label:"English",selectText:"Languages",ariaLabel:"Select language",lastUpdated:"Last Updated",searchMaxSuggestions:10,searchPlaceholder:"Search",nav:[{text:"Guide",link:"/en/guide/introduction"},{text:"API",link:"/en/api/"},{text:"Plugins",link:"/en/plugins/introduction"}],sidebar:{"/en/guide/":[{collapsable:!1,title:"Getting Started",children:["/en/guide/introduction","/en/guide/quick-start","/en/guide/glossary","/en/guide/features"]},{collapsable:!1,title:"Basic",children:["/en/guide/basic/builder-config","/en/guide/basic/build-target","/en/guide/basic/output-files","/en/guide/basic/css-usage","/en/guide/basic/static-assets","/en/guide/basic/svg-assets","/en/guide/basic/json-files","/en/guide/basic/html-template","/en/guide/basic/css-modules","/en/guide/basic/typescript"]},{collapsable:!1,title:"Advanced",children:["/en/guide/advanced/alias","/en/guide/advanced/define","/en/guide/advanced/hmr","/en/guide/advanced/rem","/en/guide/advanced/browserslist","/en/guide/advanced/browser-compatibility","/en/guide/advanced/custom-webpack-config"]},{collapsable:!1,title:"Optimization",children:["/en/guide/optimization/optimize-bundle","/en/guide/optimization/build-performance","/en/guide/optimization/split-chunk","/en/guide/optimization/inline-assets"]},{collapsable:!1,title:"Debug",children:["/en/guide/debug/inspector"]},{collapsable:!1,title:"FAQ",children:["/en/guide/faq/general","/en/guide/faq/features","/en/guide/faq/exceptions"]}],"/en/api/":[{title:"API Reference",path:"/en/api/"},{title:"Config",collapsable:!1,children:["/en/api/config-source","/en/api/config-html","/en/api/config-dev","/en/api/config-output","/en/api/config-security","/en/api/config-tools","/en/api/config-performance","/en/api/config-experiments"]},{title:"Node API",collapsable:!1,children:["/en/api/builder-core","/en/api/builder-instance","/en/api/builder-types"]},{title:"Plugin API",collapsable:!1,children:["/en/api/plugin-core","/en/api/plugin-hooks"]}],"/en/plugins":[{collapsable:!1,title:"Guide",children:["/en/plugins/introduction"]},{collapsable:!1,title:"List",children:["/en/plugins/list","/en/plugins/plugin-swc","/en/plugins/plugin-esbuild","/en/plugins/plugin-node-polyfill","/en/plugins/plugin-image-compress"]}]}}}},locales:{"/zh/":{lang:"zh-CN",title:"Modern.js Builder",description:"一个面向现代 Web 开发场景的构建引擎",path:"/zh/"},"/en/":{lang:"en-US",title:"Modern.js Builder",description:"A Build Engine for Modern Web Development",path:"/en/"}}};t(149);o.a.component("Badge",()=>Promise.all([t.e(0),t.e(3)]).then(t.bind(null,365))),o.a.component("CodeBlock",()=>Promise.all([t.e(0),t.e(4)]).then(t.bind(null,233))),o.a.component("CodeGroup",()=>Promise.all([t.e(0),t.e(5)]).then(t.bind(null,234))),o.a.component("Details",()=>Promise.all([t.e(0),t.e(6)]).then(t.bind(null,366))),o.a.component("NextSteps",()=>Promise.all([t.e(0),t.e(7)]).then(t.bind(null,367))),o.a.component("Step",()=>Promise.all([t.e(0),t.e(8)]).then(t.bind(null,235))),o.a.component("Summary",()=>Promise.all([t.e(0),t.e(9)]).then(t.bind(null,368))),o.a.component("VPIconExternalLink",()=>Promise.all([t.e(0),t.e(10)]).then(t.bind(null,369))),o.a.component("VPLink",()=>t.e(12).then(t.bind(null,236)));o.a.component("CodeSwitcher",()=>Promise.all([t.e(0),t.e(11)]).then(t.bind(null,231)));t(150);var Je={name:"BackToTop",props:{threshold:{type:Number,default:300}},data:()=>({scrollTop:null}),computed:{show(){return this.scrollTop>this.threshold}},mounted(){this.scrollTop=this.getScrollTop(),window.addEventListener("scroll",Te()(()=>{this.scrollTop=this.getScrollTop()},100))},methods:{getScrollTop:()=>window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,scrollToTop(){window.scrollTo({top:0,behavior:"smooth"}),this.scrollTop=0}}},Ge=(t(151),Object(Fe.a)(Je,(function(){var n=this._self._c;return n("transition",{attrs:{name:"fade"}},[this.show?n("svg",{staticClass:"go-to-top",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 49.484 28.284"},on:{click:this.scrollToTop}},[n("g",{attrs:{transform:"translate(-229 -126.358)"}},[n("rect",{attrs:{fill:"currentColor",width:"35",height:"5",rx:"2",transform:"translate(229 151.107) rotate(-45)"}}),this._v(" "),n("rect",{attrs:{fill:"currentColor",width:"35",height:"5",rx:"2",transform:"translate(274.949 154.642) rotate(-135)"}})])]):this._e()])}),[],!1,null,"710b6954",null).exports),Ve=t(24);const Ye={locales:!0};var Ke=[({Vue:n,options:e,router:t,siteData:o})=>{n.mixin({methods:{$withLocale:function(n){return n.startsWith("/")?this.$localePath+n.replace(/^\//,""):n}}})},{},({Vue:n})=>{n.mixin({computed:{$dataBlock(){return this.$options.__data__block__}}})},{},{},{},({Vue:n})=>{n.component("BackToTop",Ge)},({router:n,siteData:e})=>{const{routes:t=[]}=n.options,{redirectors:o=[]}=Ye;function i(n){return t.some(e=>e.path.toLowerCase()===n.toLowerCase())}function r(n){if(i(n))return n;if(!/\/$/.test(n)){const e=n+"/";if(i(e))return e}if(!/\.html$/.test(n)){const e=n.replace(/\/$/,"")+".html";if(i(e))return e}return null}if(Ye.locales&&e.locales){const n=e.locales,t=Object.keys(n),i=t.map(e=>({key:e.replace(/^\/|\/$/,""),lang:n[e].lang}));"object"!=typeof Ye.locales&&(Ye.locales={});const{fallback:r,storage:s=!0}=Ye.locales;r&&t.unshift(r),o.unshift({storage:s,base:"/",alternative(){if("undefined"!=typeof window&&window.navigator){const n=window.navigator.languages||[window.navigator.language],e=i.find(({lang:e})=>n.includes(e));if(e)return e.key}return t}})}const s=o.map(({base:n="/",storage:e=!1,alternative:t})=>{let o=!1;if(e)if("object"!=typeof e){const t="string"!=typeof e?"vuepress:redirect:"+n:e;o={get:()=>"undefined"==typeof localStorage?null:localStorage.getItem(t),set(n){"undefined"!=typeof localStorage&&localStorage.setItem(t,n)}}}else e.get&&e.set&&(o=e);return{base:n,storage:o,alternative:t}});n.beforeEach((n,e,t)=>{if(r(n.path))return t();let o;for(const e of s){const{base:t="/",storage:i=!1}=e;let{alternative:s}=e;if(!n.path.startsWith(t))continue;const a=n.path.slice(t.length)||"/";if(i){const n=i.get(e);if(n){const e=r(Object(Ve.join)(t,n,a));if(e){o=e;break}}}if("function"==typeof s&&(s=s(a)),s){"string"==typeof s&&(s=[s]);for(const n of s){const e=r(Object(Ve.join)(t,n,a));if(e){o=e;break}}if(o)break}}t(o)}),n.afterEach(n=>{if(i(n.path))for(const e of s){const{base:t,storage:o}=e;if(!o||!n.path.startsWith(t))continue;const i=n.path.slice(t.length).split("/")[0];i&&o.set(i,e)}})}],Xe=["BackToTop"];class Ze extends class{constructor(){this.store=new o.a({data:{state:{}}})}$get(n){return this.store.state[n]}$set(n,e){o.a.set(this.store.state,n,e)}$emit(...n){this.store.$emit(...n)}$on(...n){this.store.$on(...n)}}{}Object.assign(Ze.prototype,{getPageAsyncComponent:de,getLayoutAsyncComponent:ce,getAsyncComponent:ue,getVueComponent:pe});var Qe={install(n){const e=new Ze;n.$vuepress=e,n.prototype.$vuepress=e}};function nt(n,e){const t=e.toLowerCase();return n.options.routes.some(n=>n.path.toLowerCase()===t)}var et={props:{pageKey:String,slotKey:{type:String,default:"default"}},render(n){const e=this.pageKey||this.$parent.$page.key;return fe("pageKey",e),o.a.component(e)||o.a.component(e,de(e)),o.a.component(e)?n(e):n("")}},tt={functional:!0,props:{slotKey:String,required:!0},render:(n,{props:e,slots:t})=>n("div",{class:["content__"+e.slotKey]},t()[e.slotKey])},ot={computed:{openInNewWindowTitle(){return this.$themeLocaleConfig.openNewWindowText||"(opens new window)"}}},it=(t(152),t(153),Object(Fe.a)(ot,(function(){var n=this._self._c;return n("span",[n("svg",{staticClass:"icon outbound",attrs:{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15"}},[n("path",{attrs:{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}}),this._v(" "),n("polygon",{attrs:{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"}})]),this._v(" "),n("span",{staticClass:"sr-only"},[this._v(this._s(this.openInNewWindowTitle))])])}),[],!1,null,null,null).exports),rt={functional:!0,render(n,{parent:e,children:t}){if(e._isMounted)return t;e.$once("hook:mounted",()=>{e.$forceUpdate()})}};o.a.config.productionTip=!1,o.a.use(Gn),o.a.use(Qe),o.a.mixin(function(n,e,t=o.a){!function(n){n.locales&&Object.keys(n.locales).forEach(e=>{n.locales[e].path=e});Object.freeze(n)}(e),t.$vuepress.$set("siteData",e);const i=new(n(t.$vuepress.$get("siteData"))),r=Object.getOwnPropertyDescriptors(Object.getPrototypeOf(i)),s={};return Object.keys(r).reduce((n,e)=>(e.startsWith("$")&&(n[e]=r[e].get),n),s),{computed:s}}(n=>class{setPage(n){this.__page=n}get $site(){return n}get $themeConfig(){return this.$site.themeConfig}get $frontmatter(){return this.$page.frontmatter}get $localeConfig(){const{locales:n={}}=this.$site;let e,t;for(const o in n)"/"===o?t=n[o]:0===this.$page.path.indexOf(o)&&(e=n[o]);return e||t||{}}get $siteTitle(){return this.$localeConfig.title||this.$site.title||""}get $canonicalUrl(){const{canonicalUrl:n}=this.$page.frontmatter;return"string"==typeof n&&n}get $title(){const n=this.$page,{metaTitle:e}=this.$page.frontmatter;if("string"==typeof e)return e;const t=this.$siteTitle,o=n.frontmatter.home?null:n.frontmatter.title||n.title;return t?o?o+" | "+t:t:o||"VuePress"}get $description(){const n=function(n){if(n){const e=n.filter(n=>"description"===n.name)[0];if(e)return e.content}}(this.$page.frontmatter.meta);return n||(this.$page.frontmatter.description||this.$localeConfig.description||this.$site.description||"")}get $lang(){return this.$page.frontmatter.lang||this.$localeConfig.lang||"en-US"}get $localePath(){return this.$localeConfig.path||"/"}get $themeLocaleConfig(){return(this.$site.themeConfig.locales||{})[this.$localePath]||{}}get $page(){return this.__page?this.__page:function(n,e){for(let t=0;t<n.length;t++){const o=n[t];if(o.path.toLowerCase()===e.toLowerCase())return o}return{path:"",frontmatter:{}}}(this.$site.pages,this.$route.path)}},$e)),o.a.component("Content",et),o.a.component("ContentSlotsDistributor",tt),o.a.component("OutboundLink",it),o.a.component("ClientOnly",rt),o.a.component("Layout",ce("Layout")),o.a.component("NotFound",ce("NotFound")),o.a.prototype.$withBase=function(n){const e=this.$site.base;return"/"===n.charAt(0)?e+n.slice(1):n},window.__VUEPRESS__={version:"1.9.5",hash:"4d8321e"},async function(n){const e="undefined"!=typeof window&&window.__VUEPRESS_ROUTER_BASE__?window.__VUEPRESS_ROUTER_BASE__:$e.routerBase||$e.base,t=new Gn({base:e,mode:"history",fallback:!1,routes:qe,scrollBehavior:(n,e,t)=>t||(n.hash?!o.a.$vuepress.$get("disableScrollBehavior")&&{selector:decodeURIComponent(n.hash)}:{x:0,y:0})});!function(n){n.beforeEach((e,t,o)=>{if(nt(n,e.path))o();else if(/(\/|\.html)$/.test(e.path))if(/\/$/.test(e.path)){const t=e.path.replace(/\/$/,"")+".html";nt(n,t)?o(t):o()}else o();else{const t=e.path+"/",i=e.path+".html";nt(n,i)?o(i):nt(n,t)?o(t):o()}})}(t);const i={};try{await Promise.all(Ke.filter(n=>"function"==typeof n).map(e=>e({Vue:o.a,options:i,router:t,siteData:$e,isServer:n})))}catch(n){console.error(n)}return{app:new o.a(Object.assign(i,{router:t,render:n=>n("div",{attrs:{id:"app"}},[n("RouterView",{ref:"layout"}),n("div",{class:"global-ui"},Xe.map(e=>n(e)))])})),router:t}}(!1).then(({app:n,router:e})=>{e.onReady(()=>{n.$mount("#app")})})}]);